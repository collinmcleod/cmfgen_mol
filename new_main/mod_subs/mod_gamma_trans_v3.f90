	MODULE MOD_GAMMA_V3
	USE SET_KIND_MODULE
	IMPLICIT NONE
!
	INTEGER :: NF_GRID_PTS
        INTEGER, DIMENSION(:), ALLOCATABLE :: KDW_INDEX
        INTEGER, DIMENSION(:), ALLOCATABLE :: NU_END
!
	REAL(KIND=LDP) :: GAMRAY_LUM
!
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: NU_GRID_VEC
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: ETA_NORM_CONST
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAM_ENERGY_DEP
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: NU_VEC !vector of gamma frequencies used from nuc_decay_data file
        REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: WORK1
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: CROSS_KN
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: XCHI,E_SCAT_CHI
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAM_OPAC,GAM_OPAC_CLUMP,GAM_OPAC_COPY
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAM_E_ME ! will be h*nu/mec^2 thus unitless
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAM_NU_MAX ! will be h*nu/mec^2 thus unitless
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAMRAY_LUM_VEC
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAMRAY_EMISS
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: ED_TOT
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: DECAY_KIN_E
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: TOTAL_DECAY_LUM
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAMMA_TAU
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: XRAY_TAU
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAMMA_FLUX
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: NU_VEC_15
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAMMA_NU_STORE
	REAL(KIND=LDP), DIMENSION(:), ALLOCATABLE :: GAMMA_LAM
!
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: KLEIN_ARRAY
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: GAM_ETA !array that gets passed as (mu,depth)
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: GAM_INT
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: ETA_ISO
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: E_SCAT_ARRAY
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: CHI_ARRAY_ABS
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: GAMMA_J
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: GAM_ETA_MUAVG
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: GAM_ETA_NUAVG
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: GAMMA_STORE
	REAL(KIND=LDP), DIMENSION(:,:), ALLOCATABLE :: GAM_I_STORE
!
	REAL(KIND=LDP), DIMENSION(:,:,:), ALLOCATABLE :: GAM_ETA_SCAT
	REAL(KIND=LDP), DIMENSION(:,:,:), ALLOCATABLE :: GAM_ETA_SCAT_T  ! Will be used as the transpose array
	REAL(KIND=LDP), DIMENSION(:,:,:), ALLOCATABLE :: GAM_I
	REAL(KIND=LDP), DIMENSION(:,:,:), ALLOCATABLE :: GAM_I_T  	 ! Will be used as the transpose array
!
	REAL(KIND=LDP), PARAMETER :: PLANCK = 4.135668D-21 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN MeV
!	REAL(KIND=LDP), PARAMETER :: SOL = 299792 ! Units of km/s
	REAL(KIND=LDP), PARAMETER :: home = 8.09330118D-21	! home = h/mc^2 in units of seconds
!
	END MODULE
