 
Current directory is:
/home/hillier/wnode04/cmf_testing
 
 
Comparing files in ./com with those in  /home/hillier/wnode04/cmf_testing_real8//com
 
./com/aliases_for_cmfgen.sh
    setenv cmfdist  ~hillier/wnode04/cur_cmf							   |	    setenv cmfdist  ~hillier/wnode04/cmf_testing
    setenv CMFDIST  ~hillier/wnode04/cur_cmf							   |	    setenv CMFDIST  ~hillier/wnode04/cmf_testing
./com/assign_txt_files.sh
./com/assign_txt_files_tcsh.sh
./com/clean.sh
./com/com_diff.sh
./com/cpmod.sh
												   >	if(-e $1/current_nonlocal_decay_energy.dat)then
												   >	  cp $1/current_nonlocal_decay_energy.dat  $2/
												   >	  echo " "
												   >	  echo " Copyed current_nonlocal_decay_energy.dat"
												   >	endif
												   >
./com/drad_cpmod.sh
./com/for_diff.sh
./com/for_to_f.sh
./com/full_diff.sh
./com/in2in.sh
./com/inc2inc.sh
./com/INC_diff.sh
./com/main_diff.sh
./com/mv_n.sh
./com/mvscr.sh
./com/out2in.sh
./com/sm_inc_diff.sh
./com/sn_update.sh
 
Comparing files in ./blas with those in  /home/hillier/wnode04/cmf_testing_real8//blas
 
./blas/Makefile
./blas/caxpy.f
./blas/ccopy.f
./blas/cdotc.f
./blas/cdotu.f
./blas/cgbmv.f
./blas/cgemm.f
./blas/cgemv.f
./blas/cgerc.f
./blas/cgeru.f
./blas/chbmv.f
./blas/chemm.f
./blas/chemv.f
./blas/cher2.f
./blas/cher2k.f
./blas/cher.f
./blas/cherk.f
./blas/chpmv.f
./blas/chpr2.f
./blas/chpr.f
./blas/crotg.f
./blas/cscal.f
./blas/csscal.f
./blas/cswap.f
./blas/csymm.f
./blas/csyr2k.f
./blas/csyrk.f
./blas/ctbmv.f
./blas/ctbsv.f
./blas/ctpmv.f
./blas/ctpsv.f
./blas/ctrmm.f
./blas/ctrmv.f
./blas/ctrsm.f
./blas/ctrsv.f
./blas/dasum.f
      REAL(10) function dasum(n,dx,incx)							   |	      double precision function dasum(n,dx,incx)
      REAL(10) dx(*),dtemp									   |	      double precision dx(*),dtemp
        dtemp = dtemp + abs(dx(i))								   |	        dtemp = dtemp + dabs(dx(i))
        dtemp = dtemp + abs(dx(i))								   |	        dtemp = dtemp + dabs(dx(i))
        dtemp = dtemp + abs(dx(i)) + abs(dx(i + 1)) + abs(dx(i + 2))				   |	        dtemp = dtemp + dabs(dx(i)) + dabs(dx(i + 1)) + dabs(dx(i + 2))
     *  + abs(dx(i + 3)) + abs(dx(i + 4)) + abs(dx(i + 5))					   |	     *  + dabs(dx(i + 3)) + dabs(dx(i + 4)) + dabs(dx(i + 5))
./blas/daxpy.f
      REAL(10) dx(*),dy(*),da									   |	      double precision dx(*),dy(*),da
./blas/dcabs1.f
      REAL(10) function dcabs1(z)								   |	      double precision function dcabs1(z)
      REAL(10) t(2)										   |	      double precision t(2)
      dcabs1 = abs(t(1)) + abs(t(2))								   |	      dcabs1 = dabs(t(1)) + dabs(t(2))
./blas/dcopy.f
      REAL(10) dx(*),dy(*)									   |	      double precision dx(*),dy(*)
./blas/ddot.f
      REAL(10) function ddot(n,dx,incx,dy,incy)							   |	      double precision function ddot(n,dx,incx,dy,incy)
      REAL(10) dx(*),dy(*),dtemp								   |	      double precision dx(*),dy(*),dtemp
./blas/dgbmv.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   A( LDA, * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of DIMENSION at least						   |	*  X      - DOUBLE PRECISION array of DIMENSION at least
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  Y      - REAL(10) array of DIMENSION at least						   |	*  Y      - DOUBLE PRECISION array of DIMENSION at least
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dgemm.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), B( LDB, * ), C( LDC, * )						   |	      DOUBLE PRECISION   A( LDA, * ), B( LDB, * ), C( LDC, * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, ka ), where ka is				   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, ka ), where ka is
*  B      - REAL(10) array of DIMENSION ( LDB, kb ), where kb is				   |	*  B      - DOUBLE PRECISION array of DIMENSION ( LDB, kb ), where kb is
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  C      - REAL(10) array of DIMENSION ( LDC, n ).						   |	*  C      - DOUBLE PRECISION array of DIMENSION ( LDC, n ).
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
./blas/dgemv.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   A( LDA, * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of DIMENSION at least						   |	*  X      - DOUBLE PRECISION array of DIMENSION at least
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  Y      - REAL(10) array of DIMENSION at least						   |	*  Y      - DOUBLE PRECISION array of DIMENSION at least
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dger.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
      REAL(10)   A( LDA, * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   A( LDA, * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
*  Y      - REAL(10) array of dimension at least						   |	*  Y      - DOUBLE PRECISION array of dimension at least
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dnrm2.f
      REAL(10) FUNCTION DNRM2 ( N, X, INCX )							   |	      DOUBLE PRECISION FUNCTION DNRM2 ( N, X, INCX )
      REAL(10)                  X( * )								   |	      DOUBLE PRECISION                  X( * )
      REAL(10)      ONE         , ZERO								   |	      DOUBLE PRECISION      ONE         , ZERO
      REAL(10)      ABSXI, NORM, SCALE, SSQ							   |	      DOUBLE PRECISION      ABSXI, NORM, SCALE, SSQ
./blas/drot.f
      REAL(10) dx(*),dy(*),dtemp,c,s								   |	      double precision dx(*),dy(*),dtemp,c,s
./blas/drotg.f
      REAL(10) da,db,c,s,roe,scale,r,z								   |	      double precision da,db,c,s,roe,scale,r,z
      if( abs(da) .gt. abs(db) ) roe = da							   |	      if( dabs(da) .gt. dabs(db) ) roe = da
      scale = abs(da) + abs(db)									   |	      scale = dabs(da) + dabs(db)
   10 r = scale*sqrt((da/scale)**2 + (db/scale)**2)						   |	   10 r = scale*dsqrt((da/scale)**2 + (db/scale)**2)
      r = sign(r,roe)     !sign(1.0d0,roe)*r							   |	      r = dsign(1.0d0,roe)*r
      if( abs(da) .gt. abs(db) ) z = s								   |	      if( dabs(da) .gt. dabs(db) ) z = s
      if( abs(db) .ge. abs(da) .and. c .ne. 0.0d0 ) z = 1.0d0/c					   |	      if( dabs(db) .ge. dabs(da) .and. c .ne. 0.0d0 ) z = 1.0d0/c
./blas/dsbmv.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   A( LDA, * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of DIMENSION at least						   |	*  X      - DOUBLE PRECISION array of DIMENSION at least
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  Y      - REAL(10) array of DIMENSION at least						   |	*  Y      - DOUBLE PRECISION array of DIMENSION at least
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
      REAL(10)   TEMP1, TEMP2									   |	      DOUBLE PRECISION   TEMP1, TEMP2
./blas/dscal.f
      REAL(10) da,dx(*)										   |	      double precision da,dx(*)
./blas/dspmv.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   AP( * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   AP( * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  AP     - REAL(10) array of DIMENSION at least						   |	*  AP     - DOUBLE PRECISION array of DIMENSION at least
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  Y      - REAL(10) array of dimension at least						   |	*  Y      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
      REAL(10)   TEMP1, TEMP2									   |	      DOUBLE PRECISION   TEMP1, TEMP2
./blas/dspr2.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
      REAL(10)   AP( * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   AP( * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
*  Y      - REAL(10) array of dimension at least						   |	*  Y      - DOUBLE PRECISION array of dimension at least
*  AP     - REAL(10) array of DIMENSION at least						   |	*  AP     - DOUBLE PRECISION array of DIMENSION at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP1, TEMP2									   |	      DOUBLE PRECISION   TEMP1, TEMP2
./blas/dspr.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
      REAL(10)   AP( * ), X( * )								   |	      DOUBLE PRECISION   AP( * ), X( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
*  AP     - REAL(10) array of DIMENSION at least						   |	*  AP     - DOUBLE PRECISION array of DIMENSION at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dswap.f
      REAL(10) dx(*),dy(*),dtemp								   |	      double precision dx(*),dy(*),dtemp
./blas/dsymm.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), B( LDB, * ), C( LDC, * )						   |	      DOUBLE PRECISION   A( LDA, * ), B( LDB, * ), C( LDC, * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, ka ), where ka is				   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, ka ), where ka is
*  B      - REAL(10) array of DIMENSION ( LDB, n ).						   |	*  B      - DOUBLE PRECISION array of DIMENSION ( LDB, n ).
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  C      - REAL(10) array of DIMENSION ( LDC, n ).						   |	*  C      - DOUBLE PRECISION array of DIMENSION ( LDC, n ).
      REAL(10)   TEMP1, TEMP2									   |	      DOUBLE PRECISION   TEMP1, TEMP2
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
./blas/dsymv.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   A( LDA, * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  Y      - REAL(10) array of dimension at least						   |	*  Y      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
      REAL(10)   TEMP1, TEMP2									   |	      DOUBLE PRECISION   TEMP1, TEMP2
./blas/dsyr2.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
      REAL(10)   A( LDA, * ), X( * ), Y( * )							   |	      DOUBLE PRECISION   A( LDA, * ), X( * ), Y( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
*  Y      - REAL(10) array of dimension at least						   |	*  Y      - DOUBLE PRECISION array of dimension at least
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP1, TEMP2									   |	      DOUBLE PRECISION   TEMP1, TEMP2
./blas/dsyr2k.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), B( LDB, * ), C( LDC, * )						   |	      DOUBLE PRECISION   A( LDA, * ), B( LDB, * ), C( LDC, * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, ka ), where ka is				   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, ka ), where ka is
*  B      - REAL(10) array of DIMENSION ( LDB, kb ), where kb is				   |	*  B      - DOUBLE PRECISION array of DIMENSION ( LDB, kb ), where kb is
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  C      - REAL(10) array of DIMENSION ( LDC, n ).						   |	*  C      - DOUBLE PRECISION array of DIMENSION ( LDC, n ).
      REAL(10)   TEMP1, TEMP2									   |	      DOUBLE PRECISION   TEMP1, TEMP2
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
./blas/dsyr.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
      REAL(10)   A( LDA, * ), X( * )								   |	      DOUBLE PRECISION   A( LDA, * ), X( * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dsyrk.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
      REAL(10)   A( LDA, * ), C( LDC, * )							   |	      DOUBLE PRECISION   A( LDA, * ), C( LDC, * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, ka ), where ka is				   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, ka ), where ka is
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
*  C      - REAL(10) array of DIMENSION ( LDC, n ).						   |	*  C      - DOUBLE PRECISION array of DIMENSION ( LDC, n ).
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
      REAL(10)   ONE ,         ZERO								   |	      DOUBLE PRECISION   ONE ,         ZERO
./blas/dtbmv.f
      REAL(10)   A( LDA, * ), X( * )								   |	      DOUBLE PRECISION   A( LDA, * ), X( * )
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dtbsv.f
      REAL(10)   A( LDA, * ), X( * )								   |	      DOUBLE PRECISION   A( LDA, * ), X( * )
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dtpmv.f
      REAL(10)   AP( * ), X( * )								   |	      DOUBLE PRECISION   AP( * ), X( * )
*  AP     - REAL(10) array of DIMENSION at least						   |	*  AP     - DOUBLE PRECISION array of DIMENSION at least
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dtpsv.f
      REAL(10)   AP( * ), X( * )								   |	      DOUBLE PRECISION   AP( * ), X( * )
*  AP     - REAL(10) array of DIMENSION at least						   |	*  AP     - DOUBLE PRECISION array of DIMENSION at least
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dtrmm.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
      REAL(10)   A( LDA, * ), B( LDB, * )							   |	      DOUBLE PRECISION   A( LDA, * ), B( LDB, * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, k ), where k is m				   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, k ), where k is m
*  B      - REAL(10) array of DIMENSION ( LDB, n ).						   |	*  B      - DOUBLE PRECISION array of DIMENSION ( LDB, n ).
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
./blas/dtrmv.f
      REAL(10)   A( LDA, * ), X( * )								   |	      DOUBLE PRECISION   A( LDA, * ), X( * )
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dtrsm.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
      REAL(10)   A( LDA, * ), B( LDB, * )							   |	      DOUBLE PRECISION   A( LDA, * ), B( LDB, * )
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
*  A      - REAL(10) array of DIMENSION ( LDA, k ), where k is m				   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, k ), where k is m
*  B      - REAL(10) array of DIMENSION ( LDB, n ).						   |	*  B      - DOUBLE PRECISION array of DIMENSION ( LDB, n ).
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
      REAL(10)   ONE         , ZERO								   |	      DOUBLE PRECISION   ONE         , ZERO
./blas/dtrsv.f
      REAL(10)   A( LDA, * ), X( * )								   |	      DOUBLE PRECISION   A( LDA, * ), X( * )
*  A      - REAL(10) array of DIMENSION ( LDA, n ).						   |	*  A      - DOUBLE PRECISION array of DIMENSION ( LDA, n ).
*  X      - REAL(10) array of dimension at least						   |	*  X      - DOUBLE PRECISION array of dimension at least
      REAL(10)   ZERO										   |	      DOUBLE PRECISION   ZERO
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./blas/dzasum.f
      REAL(10) function dzasum(n,zx,incx)							   |	      double precision function dzasum(n,zx,incx)
      REAL(10) stemp,dcabs1									   |	      double precision stemp,dcabs1
./blas/dznrm2.f
      REAL(10) FUNCTION DZNRM2( N, X, INCX )							   |	      DOUBLE PRECISION FUNCTION DZNRM2( N, X, INCX )
      REAL(10)      ONE         , ZERO								   |	      DOUBLE PRECISION      ONE         , ZERO
      REAL(10)      NORM, SCALE, SSQ, TEMP							   |	      DOUBLE PRECISION      NORM, SCALE, SSQ, TEMP
./blas/icamax.f
./blas/idamax.f
      REAL(10) dx(*),dmax									   |	      double precision dx(*),dmax
      dmax = abs(dx(1))										   |	      dmax = dabs(dx(1))
         if(abs(dx(ix)).le.dmax) go to 5							   |	         if(dabs(dx(ix)).le.dmax) go to 5
         dmax = abs(dx(ix))									   |	         dmax = dabs(dx(ix))
   20 dmax = abs(dx(1))										   |	   20 dmax = dabs(dx(1))
         if(abs(dx(i)).le.dmax) go to 30							   |	         if(dabs(dx(i)).le.dmax) go to 30
         dmax = abs(dx(i))									   |	         dmax = dabs(dx(i))
./blas/isamax.f
./blas/izamax.f
      REAL(10) smax										   |	      double precision smax
      REAL(10) dcabs1										   |	      double precision dcabs1
./blas/lsame.f
./blas/sasum.f
./blas/saxpy.f
./blas/scasum.f
./blas/scnrm2.f
./blas/scopy.f
./blas/sdot.f
./blas/sgbmv.f
./blas/sgemm.f
./blas/sgemv.f
./blas/sger.f
./blas/snrm2.f
./blas/srot.f
./blas/srotg.f
./blas/ssbmv.f
./blas/sscal.f
./blas/sspmv.f
./blas/sspr2.f
./blas/sspr.f
./blas/sswap.f
./blas/ssymm.f
./blas/ssymv.f
./blas/ssyr2.f
./blas/ssyr2k.f
./blas/ssyr.f
./blas/ssyrk.f
./blas/stbmv.f
./blas/stbsv.f
./blas/stpmv.f
./blas/stpsv.f
./blas/strmm.f
./blas/strmv.f
./blas/strsm.f
./blas/strsv.f
./blas/xerbla.f
./blas/zaxpy.f
      REAL(10) dcabs1										   |	      double precision dcabs1
./blas/zcopy.f
./blas/zdotc.f
./blas/zdotu.f
./blas/zdscal.f
      REAL(10) da										   |	      double precision da
./blas/zgbmv.f
./blas/zgemm.f
./blas/zgemv.f
./blas/zgerc.f
./blas/zgeru.f
./blas/zhbmv.f
./blas/zhemm.f
./blas/zhemv.f
./blas/zher2.f
./blas/zher2k.f
      REAL(10)   BETA										   |	      DOUBLE PRECISION   BETA
*  BETA   - REAL(10)            .								   |	*  BETA   - DOUBLE PRECISION            .
      REAL(10)   ONE										   |	      DOUBLE PRECISION   ONE
./blas/zher.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
./blas/zherk.f
      REAL(10)   ALPHA, BETA									   |	      DOUBLE PRECISION   ALPHA, BETA
*  ALPHA  - REAL(10)            .								   |	*  ALPHA  - DOUBLE PRECISION            .
*  BETA   - REAL(10).										   |	*  BETA   - DOUBLE PRECISION.
      REAL(10)   RTEMP										   |	      DOUBLE PRECISION   RTEMP
      REAL(10)   ONE, ZERO									   |	      DOUBLE PRECISION   ONE, ZERO
./blas/zhpmv.f
./blas/zhpr2.f
./blas/zhpr.f
      REAL(10)   ALPHA										   |	      DOUBLE PRECISION   ALPHA
*  ALPHA  - REAL(10).										   |	*  ALPHA  - DOUBLE PRECISION.
./blas/zrotg.f
      REAL(10) c										   |	      double precision c
      REAL(10) norm,scale									   |	      double precision norm,scale
./blas/zscal.f
./blas/zswap.f
./blas/zsymm.f
./blas/zsyr2k.f
./blas/zsyrk.f
./blas/ztbmv.f
./blas/ztbsv.f
./blas/ztpmv.f
./blas/ztpsv.f
./blas/ztrmm.f
./blas/ztrmv.f
./blas/ztrsm.f
./blas/ztrsv.f
 
Comparing files in ./disp with those in  /home/hillier/wnode04/cmf_testing_real8//disp
 
./disp/Makefile
	$(F90) -c  $(FD) maingen.f 								   |		$(F90) -c  $(FD) -fbounds-check  maingen.f 
./disp/dispgen.f
	REAL(10) GF_CUT										   |		REAL*8 GF_CUT
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) RMDOT,RLUM									   |		REAL*8 RMDOT,RLUM
	REAL(10) SIG_GAU_KMS									   |		REAL*8 SIG_GAU_KMS
	REAL(10) FRAC_SIG_GAU									   |		REAL*8 FRAC_SIG_GAU
	REAL(10) CUT_ACCURACY									   |		REAL*8 CUT_ACCURACY
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	ALLOCATE (POPDUM(ND,NSPEC),STAT=IOS) 							   |		ALLOCATE (POPDUM(ND,NSPEC),STAT=IOS); POPDUM=0.0D0
./disp/maingen.f
	REAL(10) LUM,RMDOT									   |		REAL*8 LUM,RMDOT
	REAL(10) EINA										   |		REAL*8 EINA
	REAL(10) OSCIL										   |		REAL*8 OSCIL
	REAL(10) GUPDIE										   |		REAL*8 GUPDIE
	REAL(10) GLDGU										   |		REAL*8 GLDGU
	REAL(10) EDGEDIE									   |		REAL*8 EDGEDIE
	REAL(10) GLOW										   |		REAL*8 GLOW
	REAL(10) NUST(ND)									   |		REAL*8 NUST(ND)
	REAL(10) VEC_FREQ(N_LINE_MAX)								   |		REAL*8 VEC_FREQ(N_LINE_MAX)
	REAL(10) VEC_OSCIL(N_LINE_MAX)								   |		REAL*8 VEC_OSCIL(N_LINE_MAX)
	REAL(10) VEC_EINA(N_LINE_MAX)								   |		REAL*8 VEC_EINA(N_LINE_MAX)
	REAL(10) VEC_DP_WRK(N_LINE_MAX)								   |		REAL*8 VEC_DP_WRK(N_LINE_MAX)
	REAL(10) P(NP)				!Impact parameters				   |		REAL*8 P(NP)				!Impact parameters
	REAL(10) JQW(ND,NP),HMIDQW(ND,NP)							   |		REAL*8 JQW(ND,NP),HMIDQW(ND,NP)
	REAL(10) KQW(ND,NP),NMIDQW(ND,NP)							   |		REAL*8 KQW(ND,NP),NMIDQW(ND,NP)
	REAL(10) HQW(ND,NP)									   |		REAL*8 HQW(ND,NP)
	REAL(10) LINE_PRO(NLF_MAX),LFQW(NLF_MAX),PF(NLF_MAX)					   |		REAL*8 LINE_PRO(NLF_MAX),LFQW(NLF_MAX),PF(NLF_MAX)
	REAL(10) ERF(NLF_MAX),PFDOP(NLF_MAX)							   |		REAL*8 ERF(NLF_MAX),PFDOP(NLF_MAX)
	REAL(10) JNU(ND,NLF_MAX+1),HNU(ND,NLF_MAX+1)						   |		REAL*8 JNU(ND,NLF_MAX+1),HNU(ND,NLF_MAX+1)
	REAL(10) FEDD(ND,NLF_MAX+1),GEDD(ND,NLF_MAX+1)						   |		REAL*8 FEDD(ND,NLF_MAX+1),GEDD(ND,NLF_MAX+1)
	REAL(10) HBC_VEC(3,NLF_MAX+1),NBC_VEC(3,NLF_MAX+1)					   |		REAL*8 HBC_VEC(3,NLF_MAX+1),NBC_VEC(3,NLF_MAX+1)
	REAL(10) INBC_VEC(NLF_MAX+1)								   |		REAL*8 INBC_VEC(NLF_MAX+1)
	REAL(10) TDOP,VTURB									   |		REAL*8 TDOP,VTURB
	REAL(10) JBAR(ND),ZNET(ND)								   |		REAL*8 JBAR(ND),ZNET(ND)
	REAL(10) CHIROSS(ND),TAUROSS(ND)							   |		REAL*8 CHIROSS(ND),TAUROSS(ND)
	REAL(10) TA(MAX(NP_MAX,N_MAX))								   |		REAL*8 TA(MAX(NP_MAX,N_MAX))
	REAL(10) TB(MAX(NP_MAX,N_MAX))								   |		REAL*8 TB(MAX(NP_MAX,N_MAX))
	REAL(10) TC(MAX(NP_MAX,N_MAX))								   |		REAL*8 TC(MAX(NP_MAX,N_MAX))
	REAL(10) JQWEXT(NP_MAX,NP_MAX),KQWEXT(NP_MAX,NP_MAX),PEXT(NP_MAX)			   |		REAL*8 JQWEXT(NP_MAX,NP_MAX),KQWEXT(NP_MAX,NP_MAX),PEXT(NP_MAX)
	REAL(10) Z(NP_MAX),DTAU(NP_MAX),XM(NP_MAX),RJ(NP_MAX)					   |		REAL*8 Z(NP_MAX),DTAU(NP_MAX),XM(NP_MAX),RJ(NP_MAX)
	REAL(10) CHI(NP_MAX),REXT(NP_MAX),dCHIdr(NP_MAX)					   |		REAL*8 CHI(NP_MAX),REXT(NP_MAX),dCHIdr(NP_MAX)
	REAL(10) INBC,HBC,HBCNEW,NBC,FA(NP_MAX),GAM(NP_MAX),GAMH(NP_MAX)			   |		REAL*8 INBC,HBC,HBCNEW,NBC,FA(NP_MAX),GAM(NP_MAX),GAMH(NP_MAX)
	REAL(10) VEXT(NP_MAX),TEXT(NP_MAX),SIGMAEXT(NP_MAX)					   |		REAL*8 VEXT(NP_MAX),TEXT(NP_MAX),SIGMAEXT(NP_MAX)
	REAL(10) MASS_DENSITYEXT(NP_MAX),CLUMP_FACEXT(NP_MAX)					   |		REAL*8 MASS_DENSITYEXT(NP_MAX),CLUMP_FACEXT(NP_MAX)
	REAL(10) HBC_J,HBC_S									   |		REAL*8 HBC_J,HBC_S
!												   |	!
	REAL(10) RJEXT(NP_MAX),FEXT(NP_MAX),Q(NP_MAX),FOLD(NP_MAX)				   |		REAL*8 RJEXT(NP_MAX),FEXT(NP_MAX),Q(NP_MAX),FOLD(NP_MAX)
	REAL(10) CHIEXT(NP_MAX),ETAEXT(NP_MAX),ESECEXT(NP_MAX)					   |		REAL*8 CHIEXT(NP_MAX),ETAEXT(NP_MAX),ESECEXT(NP_MAX)
	REAL(10) CHILEXT(NP_MAX),ETALEXT(NP_MAX)						   |		REAL*8 CHILEXT(NP_MAX),ETALEXT(NP_MAX)
	REAL(10) SOURCEEXT(NP_MAX)								   |		REAL*8 SOURCEEXT(NP_MAX)
	REAL(10) ZETAEXT(NP_MAX),THETAEXT(NP_MAX)						   |		REAL*8 ZETAEXT(NP_MAX),THETAEXT(NP_MAX)
	REAL(10) COEF(0:3,NP_MAX)								   |		REAL*8 COEF(0:3,NP_MAX)
	REAL(10) TGREY(NP_MAX)									   |		REAL*8 TGREY(NP_MAX)
	REAL(10) XV(N_PLT_MAX),XV_SAV(N_PLT_MAX),XNU(N_PLT_MAX)					   |		REAL*8 XV(N_PLT_MAX),XV_SAV(N_PLT_MAX),XNU(N_PLT_MAX)
	REAL(10) YV(N_PLT_MAX),ZV(N_PLT_MAX),WV(N_PLT_MAX)					   |		REAL*8 YV(N_PLT_MAX),ZV(N_PLT_MAX),WV(N_PLT_MAX)
	REAL(10) OMEGA_F(N_MAX,N_MAX)								   |		REAL*8 OMEGA_F(N_MAX,N_MAX)
	REAL(10) dln_OMEGA_F_dlnT(N_MAX,N_MAX)							   |		REAL*8 dln_OMEGA_F_dlnT(N_MAX,N_MAX)
	REAL(10) OMEGA_S(N_MAX,N_MAX)								   |		REAL*8 OMEGA_S(N_MAX,N_MAX)
	REAL(10) dln_OMEGA_S_dlnT(N_MAX,N_MAX)							   |		REAL*8 dln_OMEGA_S_dlnT(N_MAX,N_MAX)
	REAL(10), ALLOCATABLE :: COL(:,:,:)							   |		REAL*8, ALLOCATABLE :: COL(:,:,:)
	REAL(10), ALLOCATABLE :: dCOL(:,:,:)							   |		REAL*8, ALLOCATABLE :: dCOL(:,:,:)
	REAL(10) UNIT_VEC(N_MAX)								   |		REAL*8 UNIT_VEC(N_MAX)
	REAL(10) ZERO_VEC(N_MAX)								   |		REAL*8 ZERO_VEC(N_MAX)
	REAL(10) DOP_PRO									   |		REAL*8 DOP_PRO
	REAL(10) S15ADF,XCROSS_V2								   |		REAL*8 S15ADF,XCROSS_V2
	REAL(10) KEV_TO_HZ,ANG_TO_HZ								   |		REAL*8 KEV_TO_HZ,ANG_TO_HZ
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10), ALLOCATABLE :: CHI_PAR(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_PAR(:,:)
	REAL(10), ALLOCATABLE :: ETA_PAR(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_PAR(:,:)
	REAL(10) YMAPV(MAX_ION)			!Defined so use instead of NUM_IONS		   |		REAL*8 YMAPV(MAX_ION)			!Defined so use instead of NUM_IONS
	REAL(10) XMAPV(ND)									   |		REAL*8 XMAPV(ND)
	REAL(10), ALLOCATABLE :: CHI_LAM(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_LAM(:,:)
	REAL(10), ALLOCATABLE :: ETA_LAM(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_LAM(:,:)
	REAL(10), ALLOCATABLE :: CHI_TOT_LAM(:)							   |		REAL*8, ALLOCATABLE :: CHI_TOT_LAM(:)
	REAL(10), ALLOCATABLE :: ETA_TOT_LAM(:)							   |		REAL*8, ALLOCATABLE :: ETA_TOT_LAM(:)
	REAL(10), ALLOCATABLE :: LAM_VEC(:)							   |		REAL*8, ALLOCATABLE :: LAM_VEC(:)
	REAL(10) FB(ND,ND),WM(ND,ND)								   |		REAL*8 FB(ND,ND),WM(ND,ND)
	REAL(10) GB(ND),U(ND),VB(ND),VC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 GB(ND),U(ND),VB(ND),VC(ND),CHIL(ND),ETAL(ND)
	REAL(10) SOURCE(ND),TCHI(ND),ZETA(ND),THETA(ND)						   |		REAL*8 SOURCE(ND),TCHI(ND),ZETA(ND),THETA(ND)
	REAL(10) ETA(ND),ETA_WITH_ES(ND)							   |		REAL*8 ETA(ND),ETA_WITH_ES(ND)
	REAL(10) ESEC(ND),EMHNUKT(ND),VT(ND)							   |		REAL*8 ESEC(ND),EMHNUKT(ND),VT(ND)
	REAL(10) CHI_SCAT(ND),CHI_RAY(ND)							   |		REAL*8 CHI_SCAT(ND),CHI_RAY(ND)
	REAL(10) AV(ND),CV(ND)									   |		REAL*8 AV(ND),CV(ND)
	REAL(10) FORCE_MULT(ND_MAX)								   |		REAL*8 FORCE_MULT(ND_MAX)
	REAL(10) DELTA_TAU									   |		REAL*8 DELTA_TAU
	REAL(10) TAU_BEG									   |		REAL*8 TAU_BEG
	REAL(10) TAU_MIN									   |		REAL*8 TAU_MIN
	REAL(10) TAU_CONSTANT									   |		REAL*8 TAU_CONSTANT
	REAL(10) DTDR,DBB,S1,IC									   |		REAL*8 DTDR,DBB,S1,IC
	REAL(10) HFLUX										   |		REAL*8 HFLUX
	REAL(10) EXC_EN,EDGE_FREQ								   |		REAL*8 EXC_EN,EDGE_FREQ
	REAL(10) RVAL,TAU_VAL,ED_VAL								   |		REAL*8 RVAL,TAU_VAL,ED_VAL
	REAL(10) XDIS,YDIS,DIS_CONST								   |		REAL*8 XDIS,YDIS,DIS_CONST
	REAL(10) LAM_ST,LAM_EN,DEL_NU								   |		REAL*8 LAM_ST,LAM_EN,DEL_NU
	REAL(10) FREQ_ST,FREQ_EN								   |		REAL*8 FREQ_ST,FREQ_EN
	REAL(10) NU_ST,NU_EN									   |		REAL*8 NU_ST,NU_EN
	REAL(10) FREQ_RES,FREQ_MAX								   |		REAL*8 FREQ_RES,FREQ_MAX
	REAL(10) T1,T2,T3,T4,T5									   |		REAL*8 T1,T2,T3,T4,T5
	REAL(10) FLUX_DEFICIT									   |		REAL*8 FLUX_DEFICIT
	REAL(10) VSHIFT,VDOP,DEL_V								   |		REAL*8 VSHIFT,VDOP,DEL_V
	REAL(10) EK_EJECTA									   |		REAL*8 EK_EJECTA
	REAL(10) TMP_ED										   |		REAL*8 TMP_ED
	REAL(10) TAU_LIM									   |		REAL*8 TAU_LIM
	REAL(10) DEPTH_LIM									   |		REAL*8 DEPTH_LIM
	REAL(10) TEMP,TSTAR,NEW_RSTAR,NEW_VSTAR							   |		REAL*8 TEMP,TSTAR,NEW_RSTAR,NEW_VSTAR
	REAL(10) VSM_DIE_KMS									   |		REAL*8 VSM_DIE_KMS
	REAL(10) DIST_KPC									   |		REAL*8 DIST_KPC
	REAL(10) FREQ,FL,FL_SAVE								   |		REAL*8 FREQ,FL,FL_SAVE
	REAL(10) TAU_SOB									   |		REAL*8 TAU_SOB
	REAL(10)  TMP_GION									   |		REAL*8  TMP_GION
	REAL(10) SCLHT,VCORE,VPHOT,VINF1,V_BETA1,V_EPS1						   |		REAL*8 SCLHT,VCORE,VPHOT,VINF1,V_BETA1,V_EPS1
	REAL(10) VINF2,V_BETA2,V_EPS2								   |		REAL*8 VINF2,V_BETA2,V_EPS2
	REAL(10) SCED,XED									   |		REAL*8 SCED,XED
	REAL(10) RED_EXT									   |		REAL*8 RED_EXT
	REAL(10) VDOP_FG_FRAC									   |		REAL*8 VDOP_FG_FRAC
	REAL(10) VDOP_MOM_FRAC									   |		REAL*8 VDOP_MOM_FRAC
	REAL(10) FILL_FAC_XRAYS,T_SHOCK,V_SHOCK							   |		REAL*8 FILL_FAC_XRAYS,T_SHOCK,V_SHOCK
	REAL(10) FILL_VEC_SQ(ND)								   |		REAL*8 FILL_VEC_SQ(ND)
	REAL(10) ERR(ND),EWACC									   |		REAL*8 ERR(ND),EWACC
	REAL(10) EW,EWOLD,MOMEW,CONT_INT,MOMCONT_INT						   |		REAL*8 EW,EWOLD,MOMEW,CONT_INT,MOMCONT_INT
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) GFF,GBF,LAMVACAIR,SPEED_OF_LIGHT,BOLTZMANN_CONSTANT				   |		REAL*8 GFF,GBF,LAMVACAIR,SPEED_OF_LIGHT,BOLTZMANN_CONSTANT
	REAL(10) FUN_PI,SECS_IN_YEAR,MASS_SUN,LUM_SUN,ATOMIC_MASS_UNIT				   |		REAL*8 FUN_PI,SECS_IN_YEAR,MASS_SUN,LUM_SUN,ATOMIC_MASS_UNIT
	REAL(10) ASTRONOMICAL_UNIT,RAD_SUN,TEFF_SUN,STEFAN_BOLTZ				   |		REAL*8 ASTRONOMICAL_UNIT,RAD_SUN,TEFF_SUN,STEFAN_BOLTZ
	REAL(10), PARAMETER :: RZERO=0.0D0							   |		REAL*8, PARAMETER :: RZERO=0.0D0
	REAL(10), PARAMETER :: RONE=1.0D0							   |		REAL*8, PARAMETER :: RONE=1.0D0
	REAL(10), PARAMETER :: RTWO=2.0D0							   |		REAL*8, PARAMETER :: RTWO=2.0D0
	REAL(10), PARAMETER :: RTHREE=3.0D0							   |		REAL*8, PARAMETER :: RTHREE=3.0D0
	  XV(I)=LOG10(R(I)/R(ND))								   |		  XV(I)=DLOG10(R(I)/R(ND))
	  CALL LOGVEC(V,XV,ND)									   |		  CALL DLOGVEC(V,XV,ND)
	    XV(I)=LOG10(TA(I))									   |		    XV(I)=DLOG10(TA(I))
	      XV(I)=LOG10(TA(I)/TA(ND))								   |		      XV(I)=DLOG10(TA(I)/TA(ND))
	    XV(I)=LOG10(TA(I))									   |		    XV(I)=DLOG10(TA(I))
!	    XV(I)=LOG10(6.65D-15*T1/T2)								   |	!	    XV(I)=DLOG10(6.65D-15*T1/T2)
	    XV(I)=LOG10(6.65D-15*ED(I)*CLUMP_FAC(I)*T1/T2)					   |		    XV(I)=DLOG10(6.65D-15*ED(I)*CLUMP_FAC(I)*T1/T2)
	1                  1.0D0,THK_LINE,THK_CONT,NLF,NC,NP,ND,METHOD)				   |		1                  RONE,THK_LINE,THK_CONT,NLF,NC,NP,ND,METHOD)
	1                  1.0D0,THK_LINE,THK_CONT,NLF,NC,NP,ND,METHOD)				   |		1                  RONE,THK_LINE,THK_CONT,NLF,NC,NP,ND,METHOD)
	        ZV(I)=LOG10(TA(I))								   |		        ZV(I)=DLOG10(TA(I))
	        ZV(I)=LOG10(TA(I))								   |		        ZV(I)=DLOG10(TA(I))
	          CHI(I)=CHI(I)+COEF(J,I)*LOG( CHIROSS(J+INDX(I)) )				   |		          CHI(I)=CHI(I)+COEF(J,I)*DLOG( CHIROSS(J+INDX(I)) )
	        CHI(I)=EXP(CHI(I))								   |		        CHI(I)=DEXP(CHI(I))
	        ZV(I)=LOG10(TA(I))								   |		        ZV(I)=DLOG10(TA(I))
	          YV(I)=LOG10(TA(I))								   |		          YV(I)=DLOG10(TA(I))
	    YV(I)=LOG10(R(I)/R(ND))								   |		    YV(I)=DLOG10(R(I)/R(ND))
	    YV(I)=LOG10(ED(I))									   |		    YV(I)=DLOG10(ED(I))
	    YV(I)=LOG10(MASS_DENSITY(I))							   |		    YV(I)=DLOG10(MASS_DENSITY(I))
	    YV(I)=LOG10(TA(I))									   |		    YV(I)=DLOG10(TA(I))
												   >		    WRITE(6,'(A,ES10.3,A)')' Mass of envelope (ejecta) is',TA(1),' Msun'
												   >		  ELSE
												   >		    WRITE(6,'(A,ES10.3,A)')' Mass of envelope (ejecta) is',TA(ND),' Msun'
	  WRITE(6,'(A,ES10.3,A)')'Mass of envelope (ejecta) is',TA(ND),' Msun'			   <
												   >		        WRITE(6,'( A,A4,A,ES9.2,A)',ADVANCE='NO')' Mass of ',TRIM(SPECIES(ISPEC)),' is',
												   >		      ELSE 
												   >		        WRITE(6,'( A,A4,A,ES9.2,A)',ADVANCE='NO')' Mass of ',TRIM(SPECIES(ISPEC)),' is',
	      WRITE(6,'( A,A4,A,ES9.2,A)',ADVANCE='NO')' Mass of ',TRIM(SPECIES(ISPEC)),' is',TA   <
	  CALL LOGVEC(T,YV,ND)									   |		  CALL DLOGVEC(T,YV,ND)
	  TA(1:ND)=LOG( TA(1:ND) )								   |		  TA(1:ND)=DLOG( TA(1:ND) )
	  TB(1:ND)=LOG( T(1:ND) )								   |		  TB(1:ND)=DLOG( T(1:ND) )
	    YV(1:ND)=LOG10(dE_RAD_DECAY(1:ND))							   |		    YV(1:ND)=DLOG10(dE_RAD_DECAY(1:ND))
	    YV(1:ND)=LOG10(YV(1:ND))								   |		    YV(1:ND)=DLOG10(YV(1:ND))
	    YV(1:ND-1)=LOG10(YV(1:ND-1))							   |		    YV(1:ND-1)=DLOG10(YV(1:ND-1))
	    YV(1:ND)=LOG10(YV(1:ND))								   |		    YV(1:ND)=DLOG10(YV(1:ND))
	    YV(1:ND)=LOG10(YV(1:ND))								   |		    YV(1:ND)=DLOG10(YV(1:ND))
	  YV(1:ND-1)=LOG10(YV(1:ND-1))								   |		  YV(1:ND-1)=DLOG10(YV(1:ND-1))
	  CALL LOGVEC(V,YV,ND)									   |		  CALL DLOGVEC(V,YV,ND)
	    Z(1:ND)=LOG10(Z(1:ND)/R(ND))							   |		    Z(1:ND)=DLOG10(Z(1:ND)/R(ND))
	    Z(1:ND-1)=LOG10(Z(1:ND-1)/R(ND)-1)							   |		    Z(1:ND-1)=DLOG10(Z(1:ND-1)/R(ND)-1)
	    CALL LOGVEC(DTAU,YV,ND)								   |		    CALL DLOGVEC(DTAU,YV,ND)
	    YV(1:ND)=LOG10(ZV(1:ND)+1.0D0)							   |		    YV(1:ND)=DLOG10(ZV(1:ND)+1.0D0)
	    YV(I)=LOG10(SIGMA(I)+1.0)								   |		    YV(I)=DLOG10(SIGMA(I)+1.0)
	    TC(I)=LOG10(LOG(V(I+1)/V(I-1))/LOG(R(I+1)/R(I-1)))					   |		    TC(I)=DLOG10(LOG(V(I+1)/V(I-1))/LOG(R(I+1)/R(I-1)))
	    YV(I)=LOG10(6.65D-15*ED(I)*CLUMP_FAC(I)*T1/T2)					   |		    YV(I)=DLOG10(6.65D-15*ED(I)*CLUMP_FAC(I)*T1/T2)
                    I=(LOG10(TAU_SOB)-TAU_BEG)/DELTA_TAU+1					   |	                    I=(DLOG10(TAU_SOB)-TAU_BEG)/DELTA_TAU+1
                    I=(LOG10(TAU_SOB)-TAU_BEG+0.5D0*DELTA_TAU)/DELTA_TAU+1			   |	                    I=(DLOG10(TAU_SOB)-TAU_BEG+0.5D0*DELTA_TAU)/DELTA_TAU+1
	            YV(2*CNT)=LOG10(T1)								   |		            YV(2*CNT)=DLOG10(T1)
	            YV(2*CNT)=-60.0D0-LOG10(-T1)						   |		            YV(2*CNT)=-60.0D0-DLOG10(-T1)
	            YV(2*CNT)=LOG10(TAU_SOB)							   |		            YV(2*CNT)=DLOG10(TAU_SOB)
	            YV(2*CNT)=-10.0D0-LOG10(-1.0D+10*TAU_SOB)					   |		            YV(2*CNT)=-10.0D0-DLOG10(-1.0D+10*TAU_SOB)
	              YV(I)=YV(I)+(1.0-EXP(-T1))						   |		              YV(I)=YV(I)+(1.0-DEXP(-T1))
	        YV(I)=LOG10(YV(I)/DELTA_TAU)							   |		        YV(I)=DLOG10(YV(I)/DELTA_TAU)
	       YV(2*I)=LOG10(T1)								   |		       YV(2*I)=DLOG10(T1)
	      YV(I)=LOG10( RJ(I)*CHI(I)/ETA_WITH_ES(I) )					   |		      YV(I)=DLOG10( RJ(I)*CHI(I)/ETA_WITH_ES(I) )
	      YV(I)=LOG10(RJ(I))								   |		      YV(I)=DLOG10(RJ(I))
	      YV(I)=LOG10(ETA_WITH_ES(I)/CHI(I))						   |		      YV(I)=DLOG10(ETA_WITH_ES(I)/CHI(I))
	      YV(I)=LOG10( RJ(I)*								   |		      YV(I)=DLOG10( RJ(I)*
	      ZV(I)=LOG10(TA(I))								   |		      ZV(I)=DLOG10(TA(I))
! TA is used for the line flux. Integral of TA log(r) is					   |	! TA is used for the line flux. Integral of TA dlog(r) is
	      YV(I)=LOG10(  ETAL(I)/CHIL(I)*							   |		      YV(I)=DLOG10(  ETAL(I)/CHIL(I)*
	      YV(I)=LOG10( ETAL(I)/CHIL(I)/RJ(I) )						   |		      YV(I)=DLOG10( ETAL(I)/CHIL(I)/RJ(I) )
	        YV(I)=LOG10( ETAL(I)/CHIL(I) )							   |		        YV(I)=DLOG10( ETAL(I)/CHIL(I) )
	      CALL LOGVEC(ATM(ID)%DXzV_F,YV,ND)							   |		      CALL DLOGVEC(ATM(ID)%DXzV_F,YV,ND)
	  IF(LOC_ION_ID .NE. ' ')THEN								   |		  IF(LOC_ION_ID .NE. '$$')THEN
												   >		    WRITE(6,*)'Allocated CHI_LAM and ETA_LAM'
												   >		    WRITE(6,*)'NLAM=',NLAM
												   >		    WRITE(6,*)'N_PLT_MAX=',N_PLT_MAX
	    WRITE(6,*)'ML=',ML									   |		    IF(MOD(ML-1,100) .EQ. 0)THEN
												   >		       IF(ML .NE. 1)WRITE(6,*)' '
												   >		       WRITE(6,'(A,I6)',ADVANCE='NO')'ML=',ML
												   >		    ELSE IF(MOD(ML-1,10) .EQ. 0)THEN
												   >		       WRITE(6,'(I6)',ADVANCE='NO')ML
												   >		    END IF
												   >		    IF(ML .EQ. NLAM)WRITE(6,*)' '
	        CALL DP_CURVE(NLAM,LAM_VEC,YV)							   |		        CALL DP_CURVE_LAB(NLAM,LAM_VEC,YV,SPECIES(ISPEC))
												   >		    XAXSAV=XAXIS; XAXIS='\gl(\A)' 
												   >		    DEALLOCATE (CHI_LAM,ETA_LAM,LAM_VEC)
												   >		    WRITE(6,*)'Deallocated CHI_LAM etc'
!												   |		    DEALLOCATE (CHI_LAM,ETA_LAM,LAM_VEC)
	    DEALLOCATE (CHI_LAM)								   <
	    DEALLOCATE (ETA_LAM)								   <
	    DEALLOCATE (LAM_VEC)								   <
	    TB(I)=LOG10(ED(I))									   |		    TB(I)=DLOG10(ED(I))
	      IF(XSPEC .EQ. ION_ID(ID))THEN							   |		      IF(XSPEC .EQ. UC(ION_ID(ID)))THEN
	    J=J+1										   <
												   >		    J=J+1
												   >		    IF(J .GT. 10)EXIT
	              YV(J)=YV(J)-LOG10(POP_ATOM(J))						   |		              YV(J)=YV(J)-DLOG10(POP_ATOM(J))
	      YV(I)=LOG10(R(I)*R(I)*R(I)*ETA(I)+1.0D-250)+20.0D0				   |		      YV(I)=DLOG10(R(I)*R(I)*R(I)*ETA(I)+1.0D-250)+20.0D0
	      YV(I)=LOG10(ETA(I)+1.0D-250)-10.0D0						   |		      YV(I)=DLOG10(ETA(I)+1.0D-250)-10.0D0
	      YV(I)=LOG10(TA(I))								   |		      YV(I)=DLOG10(TA(I))
	      YV(I)=LOG10(TA(I+1)-TA(I))							   |		      YV(I)=DLOG10(TA(I+1)-TA(I))
	      YV(I)=LOG10(CHI(I))-10.0								   |		      YV(I)=DLOG10(CHI(I))-10.0
	        YV(I)=LOG10(TA(I))								   |		        YV(I)=DLOG10(TA(I))
	    XNU(I)=LOG10( REXT(I)/REXT(NDX) )							   |		    XNU(I)=DLOG10( REXT(I)/REXT(NDX) )
	    TA(I)=LOG10(TA(I))									   |		    TA(I)=DLOG10(TA(I))
! TA is used for the line flux. Integral of TA log(r) is					   |	! TA is used for the line flux. Integral of TA dlog(r) is
	        ZV(I)=LOG10(R(I)/R(ND))								   |		        ZV(I)=DLOG10(R(I)/R(ND))
!	        YV(I)=ETA(I)*R(I)*R(I)*R(I)*ETAL(I)*EXP(-TA(I))					   |	!	        YV(I)=ETA(I)*R(I)*R(I)*R(I)*ETAL(I)*DEXP(-TA(I))
	      ZV(I)=LOG10(R(I)/R(ND))								   |		      ZV(I)=DLOG10(R(I)/R(ND))
	    ZV(I)=LOG10(R(I)/R(ND))								   |		    ZV(I)=DLOG10(R(I)/R(ND))
	      T1=LOG10(1.6914D-11/FREQ)								   |		      T1=DLOG10(1.6914D-11/FREQ)
	          YV(I)=T1+LOG10(TA(I))								   |		          YV(I)=T1+DLOG10(TA(I))
	          YV(I)=T1+LOG10(-TA(I))-20.0D0							   |		          YV(I)=T1+DLOG10(-TA(I))-20.0D0
	    T1=LOG10(1.6914D-11/FREQ)-10.0D0							   |		    T1=DLOG10(1.6914D-11/FREQ)-10.0D0
	        YV(I)=T1+LOG10(CHIL(I))								   |		        YV(I)=T1+DLOG10(CHIL(I))
	        ZV(I)=T1+LOG10(-CHIL(I))							   |		        ZV(I)=T1+DLOG10(-CHIL(I))
	    REXT(1:ND_TMP)=R; VEXT(1:ND_TMP)=V; SIGMAEXT(1:ND_TMP)=SIGMA;  TEXT(1:ND_TMP)=T 	   |		    REXT(1:ND)=R(1:ND); VEXT(1:ND)=V(1:ND); SIGMAEXT(1:ND)=SIGMA(1:ND);  TEXT(1:ND)=T(1:
	    ETAEXT(1:ND_TMP)=ETA; CHIEXT(1:ND_TMP)=CHI; ESECEXT(1:ND_TMP)=ESEC			   |		    ETAEXT(1:ND)=ETA(1:ND); CHIEXT(1:ND)=CHI(1:ND); ESECEXT(1:ND)=ESEC(1:ND)
	    ETALEXT(1:ND_TMP)=ETAL; CHILEXT(1:ND_TMP)=CHIL					   |		    ETALEXT(1:ND)=ETAL(1:ND); CHILEXT(1:ND)=CHIL(1:ND)
	    MASS_DENSITYEXT(1:ND_TMP)=MASS_DENSITY; CLUMP_FACEXT(1:ND_TMP)=CLUMP_FAC		   |		    MASS_DENSITYEXT(1:ND)=MASS_DENSITY(1:ND); CLUMP_FACEXT(1:ND)=CLUMP_FAC(1:ND)
./disp/mod_disp.f
	REAL(10) AT_MASS(NSPEC)									   |		REAL*8 AT_MASS(NSPEC)
	REAL(10) AT_NO(NSPEC)									   |		REAL*8 AT_NO(NSPEC)
        REAL(10) SOL_MASS_FRAC(NSPEC)       	!Solar mass fraction				   |	        REAL*8 SOL_MASS_FRAC(NSPEC)       	!Solar mass fraction
        REAL(10) SOL_ABUND_HSCL(NSPEC)      	!Solar abundance with H=12.0			   |	        REAL*8 SOL_ABUND_HSCL(NSPEC)      	!Solar abundance with H=12.0
	  REAL(10), ALLOCATABLE :: XzV_F(:,:)		!Level populations in FULL atom (NF.ND)	   |		  REAL*8, ALLOCATABLE :: XzV_F(:,:)		!Level populations in FULL atom (NF.ND)
	  REAL(10), ALLOCATABLE :: XzVLTE_F(:,:)		!LTE level populations in FULL a   |		  REAL*8, ALLOCATABLE :: XzVLTE_F(:,:)		!LTE level populations in FULL atom (NF.
	  REAL(10), ALLOCATABLE :: LOG_XzVLTE_F(:,:)	!Log LTE level populations in FULL atom    |		  REAL*8, ALLOCATABLE :: LOG_XzVLTE_F(:,:)	!Log LTE level populations in FULL atom 
	  REAL(10), ALLOCATABLE :: W_XzV_F(:,:)           !Level dissolution factors (NF.ND)	   |		  REAL*8, ALLOCATABLE :: W_XzV_F(:,:)           !Level dissolution factors (NF.ND)
	  REAL(10), ALLOCATABLE :: DXzV_F(:)		!Ion population for full atom (ND)	   |		  REAL*8, ALLOCATABLE :: DXzV_F(:)		!Ion population for full atom (ND)
	  REAL(10), ALLOCATABLE :: DXzV(:)		!Ion population SL atom (ND)		   |		  REAL*8, ALLOCATABLE :: DXzV(:)		!Ion population SL atom (ND)
	  REAL(10), ALLOCATABLE :: AXzV_F(:,:)		!Oscillator strength (A(I,j), i<j) (NF,N   |		  REAL*8, ALLOCATABLE :: AXzV_F(:,:)		!Oscillator strength (A(I,j), i<j) (NF,N
	  REAL(10), ALLOCATABLE :: EDGEXzV_F(:)           !Ionization energy to g.s. (10^15 Hz)    |		  REAL*8, ALLOCATABLE :: EDGEXzV_F(:)           !Ionization energy to g.s. (10^15 Hz) (N
	  REAL(10), ALLOCATABLE :: GXzV_F(:) 		!Level statistical weights in full atom    |		  REAL*8, ALLOCATABLE :: GXzV_F(:) 		!Level statistical weights in full atom 
	  REAL(10), ALLOCATABLE :: ARAD(:)                !Inverse radiative lifetime of level (   |		  REAL*8, ALLOCATABLE :: ARAD(:)                !Inverse radiative lifetime of level (NF
	  REAL(10), ALLOCATABLE :: GAM2(:)                !Collisional profile parameter (NF).	   |		  REAL*8, ALLOCATABLE :: GAM2(:)                !Collisional profile parameter (NF).
	  REAL(10), ALLOCATABLE :: GAM4(:)                !Collisional profile parameter (NF).	   |		  REAL*8, ALLOCATABLE :: GAM4(:)                !Collisional profile parameter (NF).
	  REAL(10) ZXzV					!Charge on ion (e.g. 1 for H)		   |		  REAL*8 ZXzV					!Charge on ion (e.g. 1 for H)
	  REAL(10) GIONXzV_F				!Statistical weight of gs. of ion	   |		  REAL*8 GIONXzV_F				!Statistical weight of gs. of ion
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: CMFGEN_TGREY(:)						   |		REAL*8, ALLOCATABLE :: CMFGEN_TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
!												   |	!
	REAL(10) ABUND(NSPEC)									   |		REAL*8 ABUND(NSPEC)
!												   |	!
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: ABS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ABS_MEAN(:)
!												   |	!
	REAL(10), ALLOCATABLE :: J_INT(:)							   |		REAL*8, ALLOCATABLE :: J_INT(:)
	REAL(10), ALLOCATABLE :: H_INT(:)							   |		REAL*8, ALLOCATABLE :: H_INT(:)
	REAL(10), ALLOCATABLE :: K_INT(:)							   |		REAL*8, ALLOCATABLE :: K_INT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: POPDUM(:,:)							   |		REAL*8, ALLOCATABLE :: POPDUM(:,:)
./disp/pltphot_sub.f
	REAL(10) XV(NF_MAX)									   |		REAL*8 XV(NF_MAX)
	REAL(10) YV(NMAX)									   |		REAL*8 YV(NMAX)
	REAL(10) WV(NMAX)									   |		REAL*8 WV(NMAX)
	REAL(10) ZV(NMAX)									   |		REAL*8 ZV(NMAX)
	REAL(10) CROSS(NMAX)									   |		REAL*8 CROSS(NMAX)
	REAL(10) VSM_DIE_KMS									   |		REAL*8 VSM_DIE_KMS
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) FREQ_MAX									   |		REAL*8 FREQ_MAX
	REAL(10) FREQ_RES									   |		REAL*8 FREQ_RES
	REAL(10) EDGE_FREQ									   |		REAL*8 EDGE_FREQ
	REAL(10) ED_VAL										   |		REAL*8 ED_VAL
	REAL(10) MIN_ED,MAX_ED									   |		REAL*8 MIN_ED,MAX_ED
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) EXC_EN										   |		REAL*8 EXC_EN
	REAL(10) DIS_CONST									   |		REAL*8 DIS_CONST
	REAL(10) XDIS,YDIS									   |		REAL*8 XDIS,YDIS
        REAL(10) EV_TO_HZ,ANG_TO_HZ								   |	        REAL*8 EV_TO_HZ,ANG_TO_HZ
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) TMP_GION									   |		REAL*8 TMP_GION
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./disp/EVAL_LTE_FULL.INC
./disp/OPACITIES.INC
./disp/PAR_OPACITIES.INC
	    CHI_PAR(:,ID)=CHI(:)								   |		    CHI_PAR(1:ND,ID)=CHI(1:ND)
	    ETA_PAR(:,ID)=ETA(:)								   |		    ETA_PAR(1:ND,ID)=ETA(1:ND)
./disp/PAR_XOPAC.INC
./disp/XOPAC.INC
 
Comparing files in ./disp/subs with those in  /home/hillier/wnode04/cmf_testing_real8//disp/subs
 
./disp/subs/Makefile
./disp/subs/betanew.f
	REAL(10) CHI(ND),CHIL(ND),BETA(ND),R(ND),Z(ND)						   |		REAL*8 CHI(ND),CHIL(ND),BETA(ND),R(ND),Z(ND)
	REAL(10) V(ND),SIGMA(ND)								   |		REAL*8 V(ND),SIGMA(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10), PARAMETER :: H=0.05								   |		REAL*8, PARAMETER :: H=0.05
	REAL(10) Y(MAX)										   |		REAL*8 Y(MAX)
	REAL(10) TAU,RMU,P									   |		REAL*8 TAU,RMU,P
	REAL(10) X1,X2,Y1,Y2									   |		REAL*8 X1,X2,Y1,Y2
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./disp/subs/branch_rat.f
	REAL(10) BETA(NMAX,NMAX)								   |		REAL*8 BETA(NMAX,NMAX)
	REAL(10) XV(NV),YV(NV)									   |		REAL*8 XV(NV),YV(NV)
	REAL(10) ASUM(2000)									   |		REAL*8 ASUM(2000)
	REAL(10) GLDGU										   |		REAL*8 GLDGU
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) TAU_CONSTANT									   |		REAL*8 TAU_CONSTANT
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) RANGE_START(NB),RANGE_END(NB)							   |		REAL*8 RANGE_START(NB),RANGE_END(NB)
./disp/subs/compion.f
C Altered 20-Mar-1997: NB: YV is now REAL(10)							   |	C Altered 20-Mar-1997: NB: YV is now REAL*8
	  REAL(10) HYD(NHYD,ND),DHYD(NION,ND),T1						   |		  REAL*8 HYD(NHYD,ND),DHYD(NION,ND),T1
	  REAL(10) YV(ND)									   |		  REAL*8 YV(ND)
./disp/subs/comp_jbar.f
	REAL(10) ETA_CONT(ND)									   |		REAL*8 ETA_CONT(ND)
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) JBAR(ND)									   |		REAL*8 JBAR(ND)
!												   |	!
	REAL(10) AQW(ND,NP)									   |		REAL*8 AQW(ND,NP)
	REAL(10) HMIDQW(ND,NP)									   |		REAL*8 HMIDQW(ND,NP)
	REAL(10) KQW(ND,NP)									   |		REAL*8 KQW(ND,NP)
	REAL(10) NMIDQW(ND,NP)									   |		REAL*8 NMIDQW(ND,NP)
!												   |	!
	REAL(10) DTDR										   |		REAL*8 DTDR
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) LUM										   |		REAL*8 LUM
	REAL(10) RED_EXT									   |		REAL*8 RED_EXT
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) VTURB										   |		REAL*8 VTURB
	REAL(10) VDOP_FG_FRAC									   |		REAL*8 VDOP_FG_FRAC
	REAL(10) VDOP_MOM_FRAC									   |		REAL*8 VDOP_MOM_FRAC
	REAL(10) LINE_FREQ									   |		REAL*8 LINE_FREQ
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) RJ_ES(ND)									   |		REAL*8 RJ_ES(ND)
	REAL(10) RJ_STORE(ND,NLF)								   |		REAL*8 RJ_STORE(ND,NLF)
	REAL(10) RJ_ES_STORE(ND,NLF)								   |		REAL*8 RJ_ES_STORE(ND,NLF)
!												   |	!
	REAL(10) LAM(NLF)									   |		REAL*8 LAM(NLF)
	REAL(10) RSQ_LF_STORE(NLF,ND)								   |		REAL*8 RSQ_LF_STORE(NLF,ND)
	REAL(10) RSQH_STORE(NLF,ND)								   |		REAL*8 RSQH_STORE(NLF,ND)
	REAL(10) RSQJ_STORE(NLF,ND)								   |		REAL*8 RSQJ_STORE(NLF,ND)
!												   |	!
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) RH(ND)										   |		REAL*8 RH(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) GEDD(ND)									   |		REAL*8 GEDD(ND)
	REAL(10) N_ON_J(ND)									   |		REAL*8 N_ON_J(ND)
	REAL(10) SOB(ND)									   |		REAL*8 SOB(ND)
	REAL(10) FORCE_MULT(ND)									   |		REAL*8 FORCE_MULT(ND)
	REAL(10) FORCE_MULT_FG(ND)								   |		REAL*8 FORCE_MULT_FG(ND)
!												   |	!
	REAL(10) CHI_PREV(ND)									   |		REAL*8 CHI_PREV(ND)
	REAL(10) ETA_PREV(ND)									   |		REAL*8 ETA_PREV(ND)
	REAL(10) FEDD_PREV(ND)									   |		REAL*8 FEDD_PREV(ND)
	REAL(10) GEDD_PREV(ND)									   |		REAL*8 GEDD_PREV(ND)
	REAL(10) JNU_PREV(ND)									   |		REAL*8 JNU_PREV(ND)
	REAL(10) RSQHNU_PREV(ND)								   |		REAL*8 RSQHNU_PREV(ND)
	REAL(10) N_ON_J_PREV(ND)								   |		REAL*8 N_ON_J_PREV(ND)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) FQW(ND)									   |		REAL*8 FQW(ND)
	REAL(10) LINE_QW(ND)									   |		REAL*8 LINE_QW(ND)
	REAL(10) NORM_CHK(ND)									   |		REAL*8 NORM_CHK(ND)
	REAL(10) FOLD(ND)									   |		REAL*8 FOLD(ND)
	REAL(10) DOP_NU_VEC(ND)									   |		REAL*8 DOP_NU_VEC(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
!												   |	!
	REAL(10) IPLUS(NP)									   |		REAL*8 IPLUS(NP)
!												   |	!
	REAL(10) HBC_CMF(3)									   |		REAL*8 HBC_CMF(3)
	REAL(10) INBC(3)									   |		REAL*8 INBC(3)
	REAL(10) NBC_CMF(3)									   |		REAL*8 NBC_CMF(3)
!												   |	!
	REAL(10) HBC_PREV(3)									   |		REAL*8 HBC_PREV(3)
	REAL(10) INBC_PREV(3)									   |		REAL*8 INBC_PREV(3)
	REAL(10) NBC_PREV(3)									   |		REAL*8 NBC_PREV(3)
!												   |	!
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) FL_OLD										   |		REAL*8 FL_OLD
	REAL(10) VDOP_MAX									   |		REAL*8 VDOP_MAX
	REAL(10) VDOP_MIN									   |		REAL*8 VDOP_MIN
	REAL(10) VDOP										   |		REAL*8 VDOP
	REAL(10) DOP_NU										   |		REAL*8 DOP_NU
	REAL(10) DEL_NU										   |		REAL*8 DEL_NU
	REAL(10) NU_ST										   |		REAL*8 NU_ST
	REAL(10) EMHNUKT									   |		REAL*8 EMHNUKT
	REAL(10) DBB 										   |		REAL*8 DBB 
	REAL(10) dLOG_NU									   |		REAL*8 dLOG_NU
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) T2										   |		REAL*8 T2
	REAL(10) H_IN										   |		REAL*8 H_IN
	REAL(10) H_OUT										   |		REAL*8 H_OUT
!												   |	!
	REAL(10) AMASS_LOC									   |		REAL*8 AMASS_LOC
	REAL(10) VTURB_MIN									   |		REAL*8 VTURB_MIN
	REAL(10) VTURB_IM									   |		REAL*8 VTURB_IM
	REAL(10) VTURB_MAX									   |		REAL*8 VTURB_MAX
	    dLOG_NU=LOG(FL_OLD/FL)								   |		    dLOG_NU=dLOG(FL_OLD/FL)
./disp/subs/determ_clump_pos.f
	REAL(10) DENSITY(ND)									   |		REAL*8 DENSITY(ND)
	REAL(10) XVALS(ND)									   |		REAL*8 XVALS(ND)
	REAL(10) CLUMP_POS(ND)									   |		REAL*8 CLUMP_POS(ND)
./disp/subs/disp_bethe_approx_v5.f
	REAL(10) Q(NKT)										   |		REAL*8 Q(NKT)
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT_ON_XKT(NKT)								   |		REAL*8 dXKT_ON_XKT(NKT)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10), PARAMETER :: CONNECT_POINT_SQ=CONNECT_POINT*CONNECT_POINT			   |		REAL*8, PARAMETER :: CONNECT_POINT_SQ=CONNECT_POINT*CONNECT_POINT
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X,XSQ										   |		REAL*8 X,XSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./disp/subs/dlogvec.f
	SUBROUTINE LOGVEC(X,YV,ND)								   |		SUBROUTINE DLOGVEC(X,YV,ND)
C Altered 20-Mar-1998: YV now passed as REAL(10)						   |	C Altered 20-Mar-1998: YV now passed as REAL*8
	REAL(10) X(ND)										   |		REAL*8 X(ND)
	REAL(10) YV(ND)										   |		REAL*8 YV(ND)
	  YV(I)=LOG10(X(I))									   |		  YV(I)=DLOG10(X(I))
./disp/subs/edgewr.f
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
./disp/subs/fg_ham.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),JCONT(ND),CHIL(ND),ETAL(ND)				   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),JCONT(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)					   |		REAL*8 JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)
	REAL(10) JNU(ND,NLF+1),HNU(ND,NLF+1),KNU(ND,NLF+1),NNU(ND,NLF+1)			   |		REAL*8 JNU(ND,NLF+1),HNU(ND,NLF+1),KNU(ND,NLF+1),NNU(ND,NLF+1)
	REAL(10) IN_HBC(NLF+1),HBC(NLF+1),NBC(NLF+1)						   |		REAL*8 IN_HBC(NLF+1),HBC(NLF+1),NBC(NLF+1)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,FL,EW,CONT_INT								   |		REAL*8 DBB,IC,FL,EW,CONT_INT
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC
	REAL(10) TA(NV),TB(NV),TC(NV),AV(NV),CV(NV),DTAU(NV),Z(NV)				   |		REAL*8 TA(NV),TB(NV),TC(NV),AV(NV),CV(NV),DTAU(NV),Z(NV)
	REAL(10) TCHI(NV),XM(NV),SOURCE(NV)							   |		REAL*8 TCHI(NV),XM(NV),SOURCE(NV)
	REAL(10) UA(NV),UB(NV),UC(NV),VB(NV),VC(NV)						   |		REAL*8 UA(NV),UB(NV),UC(NV),VB(NV),VC(NV)
	REAL(10) GB(NV),H(NV),GAM(NV),GAMH(NV),Q(NV),QH(NV)					   |		REAL*8 GB(NV),H(NV),GAM(NV),GAMH(NV),Q(NV),QH(NV)
	REAL(10) AVM1(NV),CVM1(NV),JPREV(NV)							   |		REAL*8 AVM1(NV),CVM1(NV),JPREV(NV)
	REAL(10) AVCONT(NV),CVCONT(NV),dCHIdR(NV)						   |		REAL*8 AVCONT(NV),CVCONT(NV),dCHIdR(NV)
	REAL(10) OLDCHI,T1,DBC,DNU,TOR,MID_PRO,SCALE,HBLANK					   |		REAL*8 OLDCHI,T1,DBC,DNU,TOR,MID_PRO,SCALE,HBLANK
	REAL(10) WERF_EXP,IBOUND,IMIN								   |		REAL*8 WERF_EXP,IBOUND,IMIN
	      TOR=CHI(1)*R(1)*R(1)*(1.570796-COS(P(LS)/R(1)))/P(LS)				   |		      TOR=CHI(1)*R(1)*R(1)*(1.570796-DACOS(P(LS)/R(1)))/P(LS)
	    IBOUND=ETA(1)*(1.0D0-EXP(-TOR))/CHI(1)						   |		    IBOUND=ETA(1)*(1.0D0-DEXP(-TOR))/CHI(1)
	      DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		      DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
	      WERF_EXP=EXP( 1.0D-15*CHIL(1)/FL/GAM(1)*						   |		      WERF_EXP=DEXP( 1.0D-15*CHIL(1)/FL/GAM(1)*
	      DBC=DBB*DNU*SQRT(R(ND)*R(ND)-P(LS)*P(LS))						   |		      DBC=DBB*DNU*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))
	      WERF_EXP=EXP( 1.0D-15*CHIL(1)/FL/GAM(1)*WERFC(NLF) )				   |		      WERF_EXP=DEXP( 1.0D-15*CHIL(1)/FL/GAM(1)*WERFC(NLF) )
./disp/subs/fqcomp.f
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)
	REAL(10) NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)					   |		REAL*8 NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)
	REAL(10) SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)				   |		REAL*8 SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)
	REAL(10) S1,DBB,DBC,IBOUND,TOR,HBCNEW,INBCNEW,IC,E1,E2,E3				   |		REAL*8 S1,DBB,DBC,IBOUND,TOR,HBCNEW,INBCNEW,IC,E1,E2,E3
	    DBC=DBB*SQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )						   |		    DBC=DBB*DSQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )
	      TOR=CHI(1)*R(1)*R(1)*(1.570796-COS(P(LS)/R(1)))/P(LS)				   |		      TOR=CHI(1)*R(1)*R(1)*(1.570796-DACOS(P(LS)/R(1)))/P(LS)
	    IBOUND=S1*(1.0D0-EXP(-TOR))								   |		    IBOUND=S1*(1.0D0-DEXP(-TOR))
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./disp/subs/fqcomp_v2.f
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)
	REAL(10) NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)					   |		REAL*8 NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)
	REAL(10) SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)				   |		REAL*8 SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)
	REAL(10) S1,DBB,DBC,IBOUND,TOR,HBCNEW,INBCNEW,IC,E1,E2,E3				   |		REAL*8 S1,DBB,DBC,IBOUND,TOR,HBCNEW,INBCNEW,IC,E1,E2,E3
	    DBC=DBB*SQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )/R(ND)/CHI(ND)				   |		    DBC=DBB*DSQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )/R(ND)/CHI(ND)
	      TOR=CHI(1)*R(1)*R(1)*(1.570796-COS(P(LS)/R(1)))/P(LS)				   |		      TOR=CHI(1)*R(1)*R(1)*(1.570796-DACOS(P(LS)/R(1)))/P(LS)
	    IBOUND=S1*(1.0D0-EXP(-TOR))								   |		    IBOUND=S1*(1.0D0-DEXP(-TOR))
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./disp/subs/gam_abs.f
	REAL(10) SM_R(SM_ND)									   |		REAL*8 SM_R(SM_ND)
	REAL(10) SM_V(SM_ND)									   |		REAL*8 SM_V(SM_ND)
	REAL(10) SM_CHI(SM_ND)									   |		REAL*8 SM_CHI(SM_ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) Z(ND),RJ(ND),Q(ND),F(ND)							   |		REAL*8 Z(ND),RJ(ND),Q(ND),F(ND)
	REAL(10) DTAU(ND),XM(ND),ETA(ND)							   |		REAL*8 DTAU(ND),XM(ND),ETA(ND)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) SOURCE(ND),CHI(ND),DCHIDR(ND),THETA(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),DCHIDR(ND),THETA(ND)
	REAL(10) JQW(ND,NP),KQW(ND,NP)								   |		REAL*8 JQW(ND,NP),KQW(ND,NP)
	REAL(10) WM(ND,ND),FB(ND,ND)								   |		REAL*8 WM(ND,ND),FB(ND,ND)
	REAL(10) IC,T1,DBB,HBC_J,HBC_S,INBC							   |		REAL*8 IC,T1,DBB,HBC_J,HBC_S,INBC
./disp/subs/get_col_summary_v1.f
	REAL(10) OMEGA(NLEV,NLEV)								   |		REAL*8 OMEGA(NLEV,NLEV)
	REAL(10) EIN_A(NLEV,NLEV)		!Einstein A coefficient				   |		REAL*8 EIN_A(NLEV,NLEV)		!Einstein A coefficient
	REAL(10) EDGE(NLEV)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE(NLEV)		!Ionization frequency (10^15 Hz)
	REAL(10) STAT_WT(NLEV)		!Statistical weight.					   |		REAL*8 STAT_WT(NLEV)		!Statistical weight.
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) TEMP	       		!Temperature (10^4 K)					   |		REAL*8 TEMP	       		!Temperature (10^4 K)
	REAL(10), PARAMETER :: THREE=3.0D0							   |		REAL*8, PARAMETER :: THREE=3.0D0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), SAVE :: T_TABLE(MAX_TVALS)							   |		REAL*8, SAVE :: T_TABLE(MAX_TVALS)
	REAL(10), SAVE :: OMEGA_TABLE(MAX_TAB_SIZE)						   |		REAL*8, SAVE :: OMEGA_TABLE(MAX_TAB_SIZE)
	REAL(10), SAVE :: OMEGA_SET,OMEGA_SCALE							   |		REAL*8, SAVE :: OMEGA_SET,OMEGA_SCALE
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), PARAMETER :: ZERO=0.0D0							   |		REAL*8, PARAMETER :: ZERO=0.0D0
	  T1=LOG(T_TABLE(L)/T_TABLE(L-1))							   |		  T1=DLOG(T_TABLE(L)/T_TABLE(L-1))
	    ALPHA=LOG(ALPHA)/T1									   |		    ALPHA=DLOG(ALPHA)/T1
./disp/subs/get_dtaulam.f
	REAL(10) WA(NI),WB(NI),Z(NI),R(NI)							   |		REAL*8 WA(NI),WB(NI),Z(NI),R(NI)
	REAL(10) ALPHA										   |		REAL*8 ALPHA
./disp/subs/get_filename.f
./disp/subs/get_flux_deficit.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) CHI_RAY(ND)									   |		REAL*8 CHI_RAY(ND)
	REAL(10) CHI_SCAT(ND)									   |		REAL*8 CHI_SCAT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DEFICIT									   |		REAL*8 DEFICIT
	REAL(10), SAVE :: INBC									   |		REAL*8, SAVE :: INBC
	REAL(10), SAVE ::  HBC_J								   |		REAL*8, SAVE ::  HBC_J
	REAL(10), SAVE ::  HBC_S								   |		REAL*8, SAVE ::  HBC_S
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) CONT_FLUX									   |		REAL*8 CONT_FLUX
	REAL(10) LINE_FLUX									   |		REAL*8 LINE_FLUX
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), SAVE :: IPLUS(NANG)								   |		REAL*8, SAVE :: IPLUS(NANG)
	REAL(10), SAVE, ALLOCATABLE :: TA(:)							   |		REAL*8, SAVE, ALLOCATABLE :: TA(:)
	REAL(10), SAVE, ALLOCATABLE :: F(:)							   |		REAL*8, SAVE, ALLOCATABLE :: F(:)
	REAL(10), SAVE, ALLOCATABLE :: FOLD(:)							   |		REAL*8, SAVE, ALLOCATABLE :: FOLD(:)
	REAL(10), SAVE, ALLOCATABLE :: RJ(:)							   |		REAL*8, SAVE, ALLOCATABLE :: RJ(:)
	REAL(10), SAVE, ALLOCATABLE :: HNU(:)							   |		REAL*8, SAVE, ALLOCATABLE :: HNU(:)
	REAL(10), SAVE, ALLOCATABLE :: NEWRJ(:)							   |		REAL*8, SAVE, ALLOCATABLE :: NEWRJ(:)
	REAL(10), SAVE, ALLOCATABLE :: SOURCE(:)						   |		REAL*8, SAVE, ALLOCATABLE :: SOURCE(:)
	REAL(10), SAVE, ALLOCATABLE :: ZETA(:)							   |		REAL*8, SAVE, ALLOCATABLE :: ZETA(:)
	REAL(10), SAVE, ALLOCATABLE :: THETA(:)							   |		REAL*8, SAVE, ALLOCATABLE :: THETA(:)
./disp/subs/get_line_indices.f
	REAL(10) VEC_FREQ(NLINE_FREQ)								   |		REAL*8 VEC_FREQ(NLINE_FREQ)
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LAMBDA										   |		REAL*8 LAMBDA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) dLAM										   |		REAL*8 dLAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./disp/subs/ham_formsol.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP),HQW(ND,NP)								   |		REAL*8 JQW(ND,NP),HQW(ND,NP)
	REAL(10) JBAR(ND),ZNET(ND)								   |		REAL*8 JBAR(ND),ZNET(ND)
	REAL(10) JCONT(ND),JBLANK(ND),HBLANK(ND),JINT(ND)					   |		REAL*8 JCONT(ND),JBLANK(ND),HBLANK(ND),JINT(ND)
	REAL(10) LAMLINE(ND),dZdCHIL(ND),dZdETAL(ND)						   |		REAL*8 LAMLINE(ND),dZdCHIL(ND),dZdETAL(ND)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,AMASS,FL,EW,CONT_INT							   |		REAL*8 DBB,IC,AMASS,FL,EW,CONT_INT
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC
	REAL(10) TA(NV),TB(NV),TC(NV),AV(NV),CV(NV),DTAU(NV),Z(NV)				   |		REAL*8 TA(NV),TB(NV),TC(NV),AV(NV),CV(NV),DTAU(NV),Z(NV)
	REAL(10) UA(NV),UB(NV),UC(NV)								   |		REAL*8 UA(NV),UB(NV),UC(NV)
	REAL(10) TCHI(NV),XM(NV),SOURCE(NV),VB(NV),VC(NV)					   |		REAL*8 TCHI(NV),XM(NV),SOURCE(NV),VB(NV),VC(NV)
	REAL(10) GB(NV),H(NV),GAM(NV),GAMH(NV),Q(NV),QH(NV)					   |		REAL*8 GB(NV),H(NV),GAM(NV),GAMH(NV),Q(NV),QH(NV)
	REAL(10) JEX_SCAT(NV),BAR_WTS(NV),DEPTH_PRO(NV)						   |		REAL*8 JEX_SCAT(NV),BAR_WTS(NV),DEPTH_PRO(NV)
	REAL(10) AVM1(NV),CVM1(NV),dJBARdKI(NV),DIAG(NV)					   |		REAL*8 AVM1(NV),CVM1(NV),dJBARdKI(NV),DIAG(NV)
	REAL(10) dJINTdS(NV),HCONT(NV),JINT_PREV(NV),HINT(NV)					   |		REAL*8 dJINTdS(NV),HCONT(NV),JINT_PREV(NV),HINT(NV)
	REAL(10) AVCONT(NV),CVCONT(NV),dCHIdR							   |		REAL*8 AVCONT(NV),CVCONT(NV),dCHIdR
	REAL(10) VSRCE(NV),dUdS(NV),dVdS_UP(NV),dVdS_LOW(NV)					   |		REAL*8 VSRCE(NV),dUdS(NV),dVdS_UP(NV),dVdS_LOW(NV)
	REAL(10) VKI(NV),RKB(NV),dUdKI(NV),dVdKI_UP(NV),dVdKI_LOW(NV)				   |		REAL*8 VKI(NV),RKB(NV),dUdKI(NV),dVdKI_UP(NV),dVdKI_LOW(NV)
	REAL(10) OLDCHI,T1,T2,DBC,VDBC,DNU,TOR,IBOUND,MID_PRO,SCALE				   |		REAL*8 OLDCHI,T1,T2,DBC,VDBC,DNU,TOR,IBOUND,MID_PRO,SCALE
	REAL(10) WERF_EXP									   |		REAL*8 WERF_EXP
	      TOR=CHI(1)*R(1)*R(1)*(1.570796-COS(P(LS)/R(1)))/P(LS)				   |		      TOR=CHI(1)*R(1)*R(1)*(1.570796-DACOS(P(LS)/R(1)))/P(LS)
	    IBOUND=ETA(1)*(1.0D0-EXP(-TOR))/CHI(1)						   |		    IBOUND=ETA(1)*(1.0D0-DEXP(-TOR))/CHI(1)
	      DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		      DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
	1            *SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)					   |		1            *DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      WERF_EXP=EXP( 1.0D-15*CHIL(1)/FL/GAM(1)*						   |		      WERF_EXP=DEXP( 1.0D-15*CHIL(1)/FL/GAM(1)*
	      DBC=DBB*DNU*SQRT(R(ND)*R(ND)-P(LS)*P(LS))						   |		      DBC=DBB*DNU*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))
	      WERF_EXP=EXP( 1.0D-15*CHIL(1)/FL/GAM(1)*WERFC(NLF) )				   |		      WERF_EXP=DEXP( 1.0D-15*CHIL(1)/FL/GAM(1)*WERFC(NLF) )
./disp/subs/hamtuvgh.f
	REAL(10) TA(NI),TB(NI),TC(NI),VB(NI),VC(NI),GB(NI),H(NI)				   |		REAL*8 TA(NI),TB(NI),TC(NI),VB(NI),VC(NI),GB(NI),H(NI)
	REAL(10) UA(NI),UB(NI),UC(NI),XM(NI)							   |		REAL*8 UA(NI),UB(NI),UC(NI),XM(NI)
	REAL(10) Q(NI),QH(NI),SRCE(NI),DTAU(NI),DBC,IC						   |		REAL*8 Q(NI),QH(NI),SRCE(NI),DTAU(NI),DBC,IC
	REAL(10) T1										   |		REAL*8 T1
./disp/subs/ham_varlam.f
	REAL(10) TERF,IBOUND,DBC								   |		REAL*8 TERF,IBOUND,DBC
	REAL(10) KI(NI),VSRCE(NI),RKB(NI),LINE_PRO(NI)						   |		REAL*8 KI(NI),VSRCE(NI),RKB(NI),LINE_PRO(NI)
	REAL(10) DTAU(NI),R(NI),Z(NI)								   |		REAL*8 DTAU(NI),R(NI),Z(NI)
	REAL(10) GB(NI),Q(NI),QH(NI),UK(NI),UKM1(NI)						   |		REAL*8 GB(NI),Q(NI),QH(NI),UK(NI),UKM1(NI)
	REAL(10) VKM1(NI),TCHI(NI),SOURCE(NI),CHI(NI),CHIL(NI),ETAL(NI)				   |		REAL*8 VKM1(NI),TCHI(NI),SOURCE(NI),CHI(NI),CHIL(NI),ETAL(NI)
	REAL(10) T1,dTAdCHI,dTBdCHI,dTCdCHI,dVBdCHI,dVCdCHI					   |		REAL*8 T1,dTAdCHI,dTBdCHI,dTCdCHI,dVBdCHI,dVCdCHI
	REAL(10) WA(NV),WB(NV),dGBdTAU(NV),dGBdCHI(NV),dHdCHI(NV)				   |		REAL*8 WA(NV),WB(NV),dGBdTAU(NV),dGBdCHI(NV),dHdCHI(NV)
	  T1=EXP(TERF*CHIL(1))*CHI(1)/TCHI(1)*(ETAL(1)/CHIL(1)-IBOUND)				   |		  T1=DEXP(TERF*CHIL(1))*CHI(1)/TCHI(1)*(ETAL(1)/CHIL(1)-IBOUND)
	  VSRCE(1)=VSRCE(1)+( CHI(1)/TCHI(1)*EXP(TERF*CHIL(1))-1.0D0 )				   |		  VSRCE(1)=VSRCE(1)+( CHI(1)/TCHI(1)*DEXP(TERF*CHIL(1))-1.0D0 )
./disp/subs/jfeaunew.f
	REAL(10) TA(ND),TB(ND),TC(ND),R(ND),ZETA(ND)						   |		REAL*8 TA(ND),TB(ND),TC(ND),R(ND),ZETA(ND)
	REAL(10) RJ(ND),DTAU(ND),Q(ND),F(ND)							   |		REAL*8 RJ(ND),DTAU(ND),Q(ND),F(ND)
	REAL(10) THETA(ND),CHI(ND)								   |		REAL*8 THETA(ND),CHI(ND)
	REAL(10) DBB,HBC,INBC,IC								   |		REAL*8 DBB,HBC,INBC,IC
./disp/subs/log_mon_interp.f
	REAL(10) QZRIN(NX)									   |		REAL*8 QZRIN(NX)
	REAL(10) VIN(NV,LIN_END),RIN(ND)							   |		REAL*8 VIN(NV,LIN_END),RIN(ND)
	REAL(10) QZ(NQ,LIN_END),QZR(NX)								   |		REAL*8 QZ(NQ,LIN_END),QZR(NX)
	REAL(10) VARRAY(NV,LIN_END),R(ND)							   |		REAL*8 VARRAY(NV,LIN_END),R(ND)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) HI,HIM1,HIP1									   |		REAL*8 HI,HIM1,HIP1
	REAL(10) SI,SIM1,SIP1									   |		REAL*8 SI,SIM1,SIP1
	REAL(10) A,B,C,D,DYI,DYIP1,SGN								   |		REAL*8 A,B,C,D,DYI,DYIP1,SGN
./disp/subs/map_plot.f
	REAL(10) DP_MAP(XDIM,YDIM)								   |		REAL*8 DP_MAP(XDIM,YDIM)
	REAL(10) DP_THETA(XDIM,YDIM)								   |		REAL*8 DP_THETA(XDIM,YDIM)
	REAL(10) DP_XVEC(XDIM)									   |		REAL*8 DP_XVEC(XDIM)
	REAL(10) DP_YVEC(YDIM)									   |		REAL*8 DP_YVEC(YDIM)
	REAL(10) SM_ARRAY(-10:10,-10:10)			!Array for smoothing		   |		REAL*8 SM_ARRAY(-10:10,-10:10)			!Array for smoothing
	REAL(10) FAC										   |		REAL*8 FAC
	REAL(10) MAXSIZEY									   |		REAL*8 MAXSIZEY
	REAL(10) MAXSIZEX									   |		REAL*8 MAXSIZEX
	REAL(10) LCI(256)									   |		REAL*8 LCI(256)
	REAL(10) RCI(256)									   |		REAL*8 RCI(256)
	REAL(10) BCI(256)									   |		REAL*8 BCI(256)
	REAL(10) GCI(256)									   |		REAL*8 GCI(256)
./disp/subs/modify_density.f
	REAL(10) MASS_DENSITY(ND)								   |		REAL*8 MASS_DENSITY(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) TA(ND),TB(ND),TC(ND)       !Temporary vectors					   |		REAL*8 TA(ND),TB(ND),TC(ND)       !Temporary vectors
	REAL(10) NEW_DENSITY(ND)								   |		REAL*8 NEW_DENSITY(ND)
	REAL(10) MASS(ND)									   |		REAL*8 MASS(ND)
	REAL(10) TIME(ND)									   |		REAL*8 TIME(ND)
	REAL(10) XV(ND)										   |		REAL*8 XV(ND)
	REAL(10) YV(ND)										   |		REAL*8 YV(ND)
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) SM_LEN										   |		REAL*8 SM_LEN
./disp/subs/momham.f
	REAL(10) ETA(ND),CHI(ND),THETA(ND),ESEC(ND)						   |		REAL*8 ETA(ND),CHI(ND),THETA(ND),ESEC(ND)
	REAL(10) CHIL(ND),ETAL(ND),JCONT(ND)							   |		REAL*8 CHIL(ND),ETAL(ND),JCONT(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) JNU(ND,NLF+1),RSQHNU(ND,NLF+1)							   |		REAL*8 JNU(ND,NLF+1),RSQHNU(ND,NLF+1)
	REAL(10) F(ND,NLF+1),G(ND,NLF+1)							   |		REAL*8 F(ND,NLF+1),G(ND,NLF+1)
	REAL(10) HBC(NLF+1),NBC(NLF+1),IN_HBC(NLF+1)						   |		REAL*8 HBC(NLF+1),NBC(NLF+1),IN_HBC(NLF+1)
	REAL(10) JBAR(ND),ZNET(ND),HBLANK(ND),JBLANK(ND)					   |		REAL*8 JBAR(ND),ZNET(ND),HBLANK(ND),JBLANK(ND)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF)							   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF)
	REAL(10) DBB,IC,FL,EW,CONT_INT								   |		REAL*8 DBB,IC,FL,EW,CONT_INT
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),TCHI(NV),TCHIPREV(NV)				   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),TCHI(NV),TCHIPREV(NV)
	REAL(10) XM(NV),SOURCE(NV),MIDF(NV),Q(NV),JEX_SCAT(NV)					   |		REAL*8 XM(NV),SOURCE(NV),MIDF(NV),Q(NV),JEX_SCAT(NV)
	REAL(10) UA(NV),UB(NV),UC(NV)								   |		REAL*8 UA(NV),UB(NV),UC(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)						   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV(NV)								   |		REAL*8 PSI(NV),PSIPREV(NV)
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
	REAL(10) T1,T2,T3,DNU,SCALE,MID_PRO							   |		REAL*8 T1,T2,T3,DNU,SCALE,MID_PRO
./disp/subs/new_writedc_v3.f
	REAL(10) HYD(NHYD,ND),HYDLTE(NHYD,ND),WHYD(NHYD,ND)					   |		REAL*8 HYD(NHYD,ND),HYDLTE(NHYD,ND),WHYD(NHYD,ND)
	REAL(10) EDGEHYD(NHYD),GHYD(NHYD)							   |		REAL*8 EDGEHYD(NHYD),GHYD(NHYD)
	REAL(10) DHYD(NION,ND),R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)				   |		REAL*8 DHYD(NION,ND),R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)
	REAL(10) LUM,T1,T2									   |		REAL*8 LUM,T1,T2
	REAL(10) DELTA_T,GION									   |		REAL*8 DELTA_T,GION
	REAL(10) TEXCITE(NHYD)									   |		REAL*8 TEXCITE(NHYD)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./disp/subs/new_writedc_v4.f
	REAL(10) HYD(NHYD,ND),HYDLTE(NHYD,ND),WHYD(NHYD,ND)					   |		REAL*8 HYD(NHYD,ND),HYDLTE(NHYD,ND),WHYD(NHYD,ND)
	REAL(10) EDGEHYD(NHYD),GHYD(NHYD)							   |		REAL*8 EDGEHYD(NHYD),GHYD(NHYD)
	REAL(10) DHYD(NION,ND),R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)				   |		REAL*8 DHYD(NION,ND),R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)
	REAL(10) LUM										   |		REAL*8 LUM
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) RCORE										   |		REAL*8 RCORE
	REAL(10) T1,T2,T3,CONST,DELTA_T								   |		REAL*8 T1,T2,T3,CONST,DELTA_T
	REAL(10) TEXCITE(NHYD)									   |		REAL*8 TEXCITE(NHYD)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./disp/subs/new_writedc_v5.f
	REAL(10) HYD(NHYD,ND),LOG_HYDLTE(NHYD,ND),WHYD(NHYD,ND)					   |		REAL*8 HYD(NHYD,ND),LOG_HYDLTE(NHYD,ND),WHYD(NHYD,ND)
	REAL(10) EDGEHYD(NHYD),GHYD(NHYD)							   |		REAL*8 EDGEHYD(NHYD),GHYD(NHYD)
	REAL(10) DHYD(NION,ND),R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)				   |		REAL*8 DHYD(NION,ND),R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)
	REAL(10) LUM										   |		REAL*8 LUM
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) LOG_TEN									   |		REAL*8 LOG_TEN
	REAL(10) RCORE										   |		REAL*8 RCORE
	REAL(10) T1,T2,T3,CONST,DELTA_T								   |		REAL*8 T1,T2,T3,CONST,DELTA_T
	REAL(10) TEXCITE(NHYD)									   |		REAL*8 TEXCITE(NHYD)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./disp/subs/op_spec_file_v2.f
	REAL(10) ABUND_SPEC									   |		REAL*8 ABUND_SPEC
	REAL(10) POP_VEC(ND)									   |		REAL*8 POP_VEC(ND)
./disp/subs/pallet.f
./disp/subs/plt_profs.f
	REAL(10) ED_IN(ND_MAX)									   |		REAL*8 ED_IN(ND_MAX)
	REAL(10) TEMP_IN(ND_MAX)								   |		REAL*8 TEMP_IN(ND_MAX)
	REAL(10) CHIL(ND_MAX)									   |		REAL*8 CHIL(ND_MAX)
	REAL(10) VTURB_IN(ND_MAX)								   |		REAL*8 VTURB_IN(ND_MAX)
	REAL(10) ZERO_VEC(ND_MAX)								   |		REAL*8 ZERO_VEC(ND_MAX)
	REAL(10) PROF(NFREQ,ND_MAX)								   |		REAL*8 PROF(NFREQ,ND_MAX)
	REAL(10) PRO_VEC(ND_MAX)								   |		REAL*8 PRO_VEC(ND_MAX)
	REAL(10) NU(NFREQ),LAM(NFREQ)								   |		REAL*8 NU(NFREQ),LAM(NFREQ)
	REAL(10) VEL_KMS(NFREQ),LOGLAM(NFREQ)							   |		REAL*8 VEL_KMS(NFREQ),LOGLAM(NFREQ)
	REAL(10) NORM(ND_MAX)									   |		REAL*8 NORM(ND_MAX)
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VTURB										   |		REAL*8 VTURB
	REAL(10) VTURB_FIX									   |		REAL*8 VTURB_FIX
	REAL(10) GAM_NAT									   |		REAL*8 GAM_NAT
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) DOP_PROF_LIMIT									   |		REAL*8 DOP_PROF_LIMIT
	REAL(10) VOIGT_PROF_LIMIT								   |		REAL*8 VOIGT_PROF_LIMIT
	REAL(10) VEC_DOP_VMIN									   |		REAL*8 VEC_DOP_VMIN
	REAL(10) MAX_PROF_ED									   |		REAL*8 MAX_PROF_ED
	REAL(10) V_PROF_LIM									   |		REAL*8 V_PROF_LIM
	REAL(10) LOC_C4										   |		REAL*8 LOC_C4
	REAL(10) LOC_ARAD									   |		REAL*8 LOC_ARAD
	REAL(10) LAM_VAC,LAMVACAIR,SPEED_OF_LIGHT						   |		REAL*8 LAM_VAC,LAMVACAIR,SPEED_OF_LIGHT
	REAL(10) START_FREQ									   |		REAL*8 START_FREQ
	REAL(10) DEL_NU										   |		REAL*8 DEL_NU
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) LAMBDA										   |		REAL*8 LAMBDA
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TWO_PI										   |		REAL*8 TWO_PI
	REAL(10) WAVE										   |		REAL*8 WAVE
./disp/subs/rd_ion_pop_v3.f
	REAL(10) CIII(NCIII*ND)									   |		REAL*8 CIII(NCIII*ND)
	REAL(10) DCIII(ND)									   |		REAL*8 DCIII(ND)
./disp/subs/rd_non_therm_spec.f
	REAL(10) FELEC(ND)									   |		REAL*8 FELEC(ND)
	REAL(10) FION(ND)									   |		REAL*8 FION(ND)
	REAL(10) FEXC(ND)									   |		REAL*8 FEXC(ND)
	REAL(10) T1										   |		REAL*8 T1
./disp/subs/rd_pop_dim.f
./disp/subs/recom_chk.f
	REAL(10) RECOM(NC2)									   |		REAL*8 RECOM(NC2)
	REAL(10) EDGE_GS(NC2)									   |		REAL*8 EDGE_GS(NC2)
	REAL(10) GC2(NC2)									   |		REAL*8 GC2(NC2)
	REAL(10) GIONC2										   |		REAL*8 GIONC2
	REAL(10) EXC_EN										   |		REAL*8 EXC_EN
	REAL(10) T										   |		REAL*8 T
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) LOW_CROSS(NC2)									   |		REAL*8 LOW_CROSS(NC2)
	REAL(10) HIGH_CROSS(NC2)								   |		REAL*8 HIGH_CROSS(NC2)
	REAL(10) LTE_POP(NC2)									   |		REAL*8 LTE_POP(NC2)
C												   |	C
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) RGU										   |		REAL*8 RGU
	REAL(10) DEL_NU										   |		REAL*8 DEL_NU
	REAL(10) MAX_dNU									   |		REAL*8 MAX_dNU
	REAL(10) LOW_NU,HIGH_NU									   |		REAL*8 LOW_NU,HIGH_NU
	REAL(10) FOUR_PI_ON_H									   |		REAL*8 FOUR_PI_ON_H
	RGU=LOG(2.07078D-22)									   |		RGU=DLOG(2.07078D-22)
./disp/subs/recom_chk_v2.f
	REAL(10) RECOM(NC2)									   |		REAL*8 RECOM(NC2)
	REAL(10) EDGE_GS(NC2)									   |		REAL*8 EDGE_GS(NC2)
	REAL(10) GC2(NC2)									   |		REAL*8 GC2(NC2)
	REAL(10) GIONC2										   |		REAL*8 GIONC2
	REAL(10) EXC_EN										   |		REAL*8 EXC_EN
	REAL(10) T										   |		REAL*8 T
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) LOW_CROSS(NC2)									   |		REAL*8 LOW_CROSS(NC2)
	REAL(10) HIGH_CROSS(NC2)								   |		REAL*8 HIGH_CROSS(NC2)
	REAL(10) LTE_POP(NC2)									   |		REAL*8 LTE_POP(NC2)
C												   |	C
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) RGU										   |		REAL*8 RGU
	REAL(10) DEL_NU										   |		REAL*8 DEL_NU
	REAL(10) MAX_dNU									   |		REAL*8 MAX_dNU
	REAL(10) LOW_NU,HIGH_NU									   |		REAL*8 LOW_NU,HIGH_NU
	REAL(10) FOUR_PI_ON_H									   |		REAL*8 FOUR_PI_ON_H
	RGU=LOG(2.07078D-22)									   |		RGU=DLOG(2.07078D-22)
./disp/subs/setdc_or_pop.f
C Aletered 20-Mar-1997 : YV is now REAL(10)							   |	C Aletered 20-Mar-1997 : YV is now REAL*8
	REAL(10) YV(ND)										   |		REAL*8 YV(ND)
	REAL(10) HE2(NHE2,ND),HE2LTE(NHE2,ND),T1						   |		REAL*8 HE2(NHE2,ND),HE2LTE(NHE2,ND),T1
./disp/subs/set_dc_or_pop_or_tx.f
! Altered 20-Mar-1997 : YV is now REAL(10)							   |	! Altered 20-Mar-1997 : YV is now REAL*8
	REAL(10) YV(ND)										   |		REAL*8 YV(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) EDGEHE2(NHE2)									   |		REAL*8 EDGEHE2(NHE2)
	REAL(10) HE2(NHE2,ND),HE2LTE(NHE2,ND)							   |		REAL*8 HE2(NHE2,ND),HE2LTE(NHE2,ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) T_EXCITE									   |		REAL*8 T_EXCITE
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./disp/subs/set_dc_or_pop_or_tx_v2.f
! Altered 20-Mar-1997 : YV is now REAL(10)							   |	! Altered 20-Mar-1997 : YV is now REAL*8
	REAL(10) YV(ND)										   |		REAL*8 YV(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) EDGEHE2(NHE2)									   |		REAL*8 EDGEHE2(NHE2)
	REAL(10) HE2(NHE2,ND)									   |		REAL*8 HE2(NHE2,ND)
	REAL(10) LOG_HE2LTE(NHE2,ND)								   |		REAL*8 LOG_HE2LTE(NHE2,ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) T_EXCITE									   |		REAL*8 T_EXCITE
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./disp/subs/set_fine_ray_grid.f
	REAL(10), ALLOCATABLE :: R_RAY(:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:)
	REAL(10), ALLOCATABLE :: V_RAY(:)							   |		REAL*8, ALLOCATABLE :: V_RAY(:)
	REAL(10), ALLOCATABLE :: MUV_RAY(:)							   |		REAL*8, ALLOCATABLE :: MUV_RAY(:)
	REAL(10), ALLOCATABLE :: Z_RAY(:)							   |		REAL*8, ALLOCATABLE :: Z_RAY(:)
	REAL(10), ALLOCATABLE :: DEN_RAY(:)							   |		REAL*8, ALLOCATABLE :: DEN_RAY(:)
	REAL(10), ALLOCATABLE :: ETAL_RAY(:)							   |		REAL*8, ALLOCATABLE :: ETAL_RAY(:)
	REAL(10), ALLOCATABLE :: CHIL_RAY(:)							   |		REAL*8, ALLOCATABLE :: CHIL_RAY(:)
	REAL(10), ALLOCATABLE :: TAUL(:)							   |		REAL*8, ALLOCATABLE :: TAUL(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: INDX_RAY(:)							   |		REAL*8, ALLOCATABLE :: INDX_RAY(:)
	REAL(10), ALLOCATABLE :: ABS_PROF(:)							   |		REAL*8, ALLOCATABLE :: ABS_PROF(:)
	REAL(10) :: RSTAR									   |		REAL*8 :: RSTAR
	REAL(10) ::  STORED_DEL_V=5000.0							   |		REAL*8 ::  STORED_DEL_V=5000.0
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) DEN(ND)									   |		REAL*8 DEN(ND)
	REAL(10) P_VAL										   |		REAL*8 P_VAL
	REAL(10) DEL_V										   |		REAL*8 DEL_V
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) Z1,Z2,CUR_Z,dZ									   |		REAL*8 Z1,Z2,CUR_Z,dZ
	REAL(10) VSHIFT		!In km/s							   |		REAL*8 VSHIFT		!In km/s
	REAL(10) VDOP		!In km/s							   |		REAL*8 VDOP		!In km/s
	REAL(10) LINE_FREQ	!In units of 10^15 Hz						   |		REAL*8 LINE_FREQ	!In units of 10^15 Hz
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) V_DOP										   |		REAL*8 V_DOP
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) C_KMS,SPEED_OF_LIGHT								   |		REAL*8 C_KMS,SPEED_OF_LIGHT
	REAL(10) MAX_VAL									   |		REAL*8 MAX_VAL
	REAL(10) VSHIFT		!In km/s							   |		REAL*8 VSHIFT		!In km/s
	REAL(10) VDOP		!In km/s							   |		REAL*8 VDOP		!In km/s
	REAL(10) LINE_FREQ	!In units of 10^15 Hz						   |		REAL*8 LINE_FREQ	!In units of 10^15 Hz
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) V_DOP										   |		REAL*8 V_DOP
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) C_KMS,SPEED_OF_LIGHT								   |		REAL*8 C_KMS,SPEED_OF_LIGHT
./disp/subs/setforng.f
	REAL(10) RJ(ND),PREVRJ(4,ND)								   |		REAL*8 RJ(ND),PREVRJ(4,ND)
./disp/subs/setrec.f
	REAL(10) X(ND),Y(ND),POP(N,ND)								   |		REAL*8 X(ND),Y(ND),POP(N,ND)
./disp/subs/set_two_phot_disp_v3.f
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./disp/subs/setvec.f
	REAL(10) X(ND),Y(ND)									   |		REAL*8 X(ND),Y(ND)
./disp/subs/smooth.f
	REAL(10) SPEC(N,ND),LTE(N,ND),VAL							   |		REAL*8 SPEC(N,ND),LTE(N,ND),VAL
./disp/subs/smooth_v2.f
	REAL(10) SPEC(N,ND),LTE(N,ND),VAL							   |		REAL*8 SPEC(N,ND),LTE(N,ND),VAL
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./disp/subs/sobjbar.f
	REAL(10) SOURCE(ND),CHI(ND),CHIL(ND),ETAL(ND)						   |		REAL*8 SOURCE(ND),CHI(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP)						   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP)
	REAL(10) JBAR(ND),ZNET(ND),VB(ND),VC(ND),BETA(ND),BETAC(ND)				   |		REAL*8 JBAR(ND),ZNET(ND),VB(ND),VC(ND),BETA(ND),BETAC(ND)
	REAL(10) DBB,IC,FL									   |		REAL*8 DBB,IC,FL
	REAL(10) TA(NV),TB(NV),TC(NV),AV(NV),DTAU(NV),Z(NV)					   |		REAL*8 TA(NV),TB(NV),TC(NV),AV(NV),DTAU(NV),Z(NV)
	REAL(10) GAM(NV),GAMH(NV),dCHIdR(NV)							   |		REAL*8 GAM(NV),GAMH(NV),dCHIdR(NV)
	REAL(10) T1,T2,DBC,TOR									   |		REAL*8 T1,T2,DBC,TOR
	   DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)					   |		   DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)
	      TOR=CHI(1)*R(1)*R(1)*(1.570796-COS(P(LS)/R(1)))/P(LS)				   |		      TOR=CHI(1)*R(1)*R(1)*(1.570796-DACOS(P(LS)/R(1)))/P(LS)
	    AV(1)=-SOURCE(1)*(1.0D0-EXP(-TOR))							   |		    AV(1)=-SOURCE(1)*(1.0D0-DEXP(-TOR))
./disp/subs/starpcyg_tst.f
	REAL(10) R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)					   |		REAL*8 R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)
	REAL(10) RMAX,RP									   |		REAL*8 RMAX,RP
	REAL(10) SCLHT										   |		REAL*8 SCLHT
	REAL(10) VCORE										   |		REAL*8 VCORE
	REAL(10) VPHOT										   |		REAL*8 VPHOT
	REAL(10) VINF1										   |		REAL*8 VINF1
	REAL(10) BETA1										   |		REAL*8 BETA1
	REAL(10) EPS1										   |		REAL*8 EPS1
	REAL(10) VINF2										   |		REAL*8 VINF2
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) EPS2										   |		REAL*8 EPS2
	REAL(10) RP1,RP2,VEXT									   |		REAL*8 RP1,RP2,VEXT
	REAL(10) V_RAT										   |		REAL*8 V_RAT
	REAL(10) RPHOT										   |		REAL*8 RPHOT
	REAL(10) AV,dAdlnR									   |		REAL*8 AV,dAdlnR
	REAL(10) BV,dBdlnR									   |		REAL*8 BV,dBdlnR
	REAL(10) T1,DLNR,DLT									   |		REAL*8 T1,DLNR,DLT
./disp/subs/terminal_lu.f
./disp/subs/tst_clump_law.f
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10), ALLOCATABLE :: VNODE(:), FVAL(:)						   |		REAL*8, ALLOCATABLE :: VNODE(:), FVAL(:)
	REAL(10) CLUMP_PAR(NPAR_MAX)								   |		REAL*8 CLUMP_PAR(NPAR_MAX)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./disp/subs/tst_wr_col.f
	REAL(10) OMEGA(N,N)									   |		REAL*8 OMEGA(N,N)
./disp/subs/two_phot_opac_disp_v3.f
	REAL(10) ETA(ND)		!Emisivity 						   |		REAL*8 ETA(ND)		!Emisivity 
	REAL(10) CHI(ND)		!Opacity [in (10^10 cm)^-1]				   |		REAL*8 CHI(ND)		!Opacity [in (10^10 cm)^-1]
	REAL(10) POPS(NT,ND)	!Atomic populations						   |		REAL*8 POPS(NT,ND)	!Atomic populations
	REAL(10) T(ND)		!in 10^4 K							   |		REAL*8 T(ND)		!in 10^4 K
	REAL(10) FREQ		!Current frequency (10^15 Hz)					   |		REAL*8 FREQ		!Current frequency (10^15 Hz)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) PLANKS_CONSTANT	!cgs units						   |		REAL*8 PLANKS_CONSTANT	!cgs units
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) CONST										   |		REAL*8 CONST
	REAL(10) ETA_CONST	!Used to evaluate ETA						   |		REAL*8 ETA_CONST	!Used to evaluate ETA
	REAL(10) CHI_CONST	!Used to evaluate CHI						   |		REAL*8 CHI_CONST	!Used to evaluate CHI
	REAL(10) FREQ_B		!Frequency of other photon					   |		REAL*8 FREQ_B		!Frequency of other photon
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
./disp/subs/update_pops.f
	REAL(10) HE2(N,ND),HE2LTE(N,ND),EDGE(N)							   |		REAL*8 HE2(N,ND),HE2LTE(N,ND),EDGE(N)
	REAL(10) TOLD(ND),TNEW(ND)								   |		REAL*8 TOLD(ND),TNEW(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./disp/subs/wr_atom_sum.f
./disp/subs/wrbeta.f
	Y(K)=(1.0-EXP(-TAU/X))*X/TAU								   |		Y(K)=(1.0-DEXP(-TAU/X))*X/TAU
	S=SQRT(ABS(SIGMA(I)))									   |		S=DSQRT(DABS(SIGMA(I)))
			VV=0.5*LOG((1.0+S)/(1.0-S))/S						   |				VV=0.5*DLOG((1.0+S)/(1.0-S))/S
./disp/subs/wr_col.f
	REAL(10) OMEGA(N,N)									   |		REAL*8 OMEGA(N,N)
./disp/subs/wr_col_lines.f
	REAL(10) XzV(N)										   |		REAL*8 XzV(N)
	REAL(10) XzVLTE(N)									   |		REAL*8 XzVLTE(N)
	REAL(10) W_XzV(N)									   |		REAL*8 W_XzV(N)
	REAL(10) GXzV(N)									   |		REAL*8 GXzV(N)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) OMEGA(N,N)									   |		REAL*8 OMEGA(N,N)
	REAL(10) AXzV(N,N)									   |		REAL*8 AXzV(N,N)
	REAL(10) R										   |		REAL*8 R
	REAL(10) V										   |		REAL*8 V
	REAL(10) SIGMA										   |		REAL*8 SIGMA
	REAL(10), PARAMETER :: OPLIN=2.6540081D+08						   |		REAL*8, PARAMETER :: OPLIN=2.6540081D+08
	REAL(10) FRACTION(N)									   |		REAL*8 FRACTION(N)
	REAL(10) COOL(N,N)									   |		REAL*8 COOL(N,N)
	REAL(10) NET(N)										   |		REAL*8 NET(N)
!												   |	!
	REAL(10) COOLING_CONSTANT								   |		REAL*8 COOLING_CONSTANT
	REAL(10) COLLISION_COOLING								   |		REAL*8 COLLISION_COOLING
	REAL(10) TOTAL_COOLING									   |		REAL*8 TOTAL_COOLING
!												   |	!
	REAL(10) ESCAPE_PROB									   |		REAL*8 ESCAPE_PROB
	REAL(10) TOTAL										   |		REAL*8 TOTAL
	REAL(10) TAUL										   |		REAL*8 TAUL
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) CHIL										   |		REAL*8 CHIL
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) GLDGU										   |		REAL*8 GLDGU
./disp/subs/wr_col_rates.f
	REAL(10) XzV(N)										   |		REAL*8 XzV(N)
	REAL(10) XzVLTE(N)									   |		REAL*8 XzVLTE(N)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) OMEGA(N,N)									   |		REAL*8 OMEGA(N,N)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SUM										   |		REAL*8 SUM
./disp/subs/wr_col_sl.f
	REAL(10) XzV(N)										   |		REAL*8 XzV(N)
	REAL(10) XzVLTE(N)									   |		REAL*8 XzVLTE(N)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) OMEGA(N,N)									   |		REAL*8 OMEGA(N,N)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SUM										   |		REAL*8 SUM
	REAL(10) RATE_IN,RATE_OUT								   |		REAL*8 RATE_IN,RATE_OUT
	REAL(10) TOT_IN,TOT_OUT									   |		REAL*8 TOT_IN,TOT_OUT
	REAL(10) NET_IN										   |		REAL*8 NET_IN
!	  WRITE(LU,'(ES14.4,F8.3,2ES14.4,T60,A)')NET_IN,NET_IN/T1,RATE_IN,RATE_OUT,TRIM(LEV_NAME   |		  WRITE(LU,'(ES14.4,F8.3,2ES14.4,T60,A)')NET_IN,NET_IN/T1,RATE_IN,RATE_OUT,TRIM(LEV_NAME
	  WRITE(LU,'(ES14.4,F8.3,2ES14.4,T60,A)')NET_IN,T1,RATE_IN,RATE_OUT,TRIM(LEV_NAME(I))	   <
	FLUSH(LU)										   <
./disp/subs/wr_crit.f
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) AXzV(NXzV,NXzV)								   |		REAL*8 AXzV(NXzV,NXzV)
	REAL(10) OMEGA(NXzV,NXzV)								   |		REAL*8 OMEGA(NXzV,NXzV)
	REAL(10) EDGEXzV(NXzV)									   |		REAL*8 EDGEXzV(NXzV)
	REAL(10) GXzV(NXzV)									   |		REAL*8 GXzV(NXzV)
	REAL(10) ASUM(NXzV)									   |		REAL*8 ASUM(NXzV)
	REAL(10) COL_SUM(NXzV)									   |		REAL*8 COL_SUM(NXzV)
	REAL(10) T1										   |		REAL*8 T1
./disp/subs/write_line_12may98.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
        REAL(10) VAC_LAM									   |	        REAL*8 VAC_LAM
        REAL(10) SPEED_OF_LIGHT									   |	        REAL*8 SPEED_OF_LIGHT
./disp/subs/write_line.f
	REAL(10) FREQ,LAMVACAIR,WAVE								   |		REAL*8 FREQ,LAMVACAIR,WAVE
./disp/subs/write_line_multi.f
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) MASS_DENSITY(ND)								   |		REAL*8 MASS_DENSITY(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) VAC_LAM									   |		REAL*8 VAC_LAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./disp/subs/write_line_old.f
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) MASS_DENSITY(ND)								   |		REAL*8 MASS_DENSITY(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) TA(ND)			!Work array						   |		REAL*8 TA(ND)			!Work array
	REAL(10) VAC_LAM									   |		REAL*8 VAC_LAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./disp/subs/writscrat.f
	REAL(10) NV(NNV,ND),DNV(ND)								   |		REAL*8 NV(NNV,ND),DNV(ND)
./disp/subs/wr_spec_sum.f
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) VALUE(NSPEC)									   |		REAL*8 VALUE(NSPEC)
./disp/subs/wr_spec_sum_v2.f
	REAL(10) XV(ND)										   |		REAL*8 XV(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) VALUE(NSPEC)									   |		REAL*8 VALUE(NSPEC)
./disp/subs/xvecfeau.f
	REAL(10) X(ND),R(ND),Q(ND),SOURCE(ND),DBB,CHI,INBC,IC					   |		REAL*8 X(ND),R(ND),Q(ND),SOURCE(ND),DBB,CHI,INBC,IC
./disp/subs/arnaud_cross_v3_disp.f90
!	REAL(10) XKT(NKT)									   |	!	REAL*8 XKT(NKT)
	REAL(10) U1										   |		REAL*8 U1
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	          T2=LOG(U1)									   |		          T2=DLOG(U1)
	        T1=LOG(XKT(IKT)/THD(IT)%XTAB(J))/LOG(THD(IT)%XTAB(J+1)/THD(IT)%XTAB(J))		   |		        T1=DLOG(XKT(IKT)/THD(IT)%XTAB(J))/DLOG(THD(IT)%XTAB(J+1)/THD(IT)%XTAB(J))
	        THD(IT)%CROSS_SEC(IKT)=EXP( T1*LOG(THD(IT)%YTAB(J+1)) + (1.0D0-T1)*LOG(THD(IT)%Y   |		        THD(IT)%CROSS_SEC(IKT)=EXP( T1*DLOG(THD(IT)%YTAB(J+1)) + (1.0D0-T1)*DLOG(THD(IT)
	      T1=LOG(THD(IT)%YTAB(I)/THD(IT)%YTAB(I-1))/LOG(THD(IT)%XTAB(I)/THD(IT)%XTAB(I-1))	   |		      T1=DLOG(THD(IT)%YTAB(I)/THD(IT)%YTAB(I-1))/DLOG(THD(IT)%XTAB(I)/THD(IT)%XTAB(I-1))
./disp/subs/plt_arn.f90
	REAL(10) XV(NYV)									   |		REAL*8 XV(NYV)
	REAL(10) YV(NYV)									   |		REAL*8 YV(NYV)
	REAL(10), SAVE :: XKT_MIN=1.0D0								   |		REAL*8, SAVE :: XKT_MIN=1.0D0
	REAL(10), SAVE :: XKT_MAX=1000.0D0							   |		REAL*8, SAVE :: XKT_MAX=1000.0D0
./disp/subs/read_arnaud_ion_data_disp.f90
	REAL(10), PARAMETER :: Hz_TO_eV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_eV=4.1356691D0
	REAL(10) T1,T2										   |		REAL*8 T1,T2
 
Comparing files in ./lpack with those in  /home/hillier/wnode04/cmf_testing_real8//lpack
 
./lpack/Makefile
./lpack/dgeequ.f
      REAL(10)   AMAX, COLCND, ROWCND								   |	      DOUBLE PRECISION   AMAX, COLCND, ROWCND
      REAL(10)   A( LDA, * ), C( * ), R( * )							   |	      DOUBLE PRECISION   A( LDA, * ), C( * ), R( * )
*  A       (input) REAL(10) array, dimension (LDA,N)						   |	*  A       (input) DOUBLE PRECISION array, dimension (LDA,N)
*  R       (output) REAL(10) array, dimension (M)						   |	*  R       (output) DOUBLE PRECISION array, dimension (M)
*  C       (output) REAL(10) array, dimension (N)						   |	*  C       (output) DOUBLE PRECISION array, dimension (N)
*  ROWCND  (output) REAL(10)									   |	*  ROWCND  (output) DOUBLE PRECISION
*  COLCND  (output) REAL(10)									   |	*  COLCND  (output) DOUBLE PRECISION
*  AMAX    (output) REAL(10)									   |	*  AMAX    (output) DOUBLE PRECISION
      REAL(10)   ONE, ZERO									   |	      DOUBLE PRECISION   ONE, ZERO
      REAL(10)   BIGNUM, RCMAX, RCMIN, SMLNUM							   |	      DOUBLE PRECISION   BIGNUM, RCMAX, RCMIN, SMLNUM
      REAL(10)   DLAMCH										   |	      DOUBLE PRECISION   DLAMCH
./lpack/dgetf2.f
      REAL(10)   A( LDA, * )									   |	      DOUBLE PRECISION   A( LDA, * )
*  A       (input/output) REAL(10) array, dimension (LDA,N)					   |	*  A       (input/output) DOUBLE PRECISION array, dimension (LDA,N)
      REAL(10)   ONE, ZERO									   |	      DOUBLE PRECISION   ONE, ZERO
./lpack/dgetrf.f
      REAL(10)   A( LDA, * )									   |	      DOUBLE PRECISION   A( LDA, * )
*  A       (input/output) REAL(10) array, dimension (LDA,N)					   |	*  A       (input/output) DOUBLE PRECISION array, dimension (LDA,N)
      REAL(10)   ONE										   |	      DOUBLE PRECISION   ONE
./lpack/dgetrs.f
      REAL(10)   A( LDA, * ), B( LDB, * )							   |	      DOUBLE PRECISION   A( LDA, * ), B( LDB, * )
*  A       (input) REAL(10) array, dimension (LDA,N)						   |	*  A       (input) DOUBLE PRECISION array, dimension (LDA,N)
*  B       (input/output) REAL(10) array, dimension (LDB,NRHS)					   |	*  B       (input/output) DOUBLE PRECISION array, dimension (LDB,NRHS)
      REAL(10)   ONE										   |	      DOUBLE PRECISION   ONE
./lpack/dlamch.f
      REAL(10) FUNCTION DLAMCH( CMACH )								   |	      DOUBLE PRECISION FUNCTION DLAMCH( CMACH )
      REAL(10)   ONE, ZERO									   |	      DOUBLE PRECISION   ONE, ZERO
      REAL(10)   BASE, EMAX, EMIN, EPS, PREC, RMACH, RMAX, RMIN,				   |	      DOUBLE PRECISION   BASE, EMAX, EMIN, EPS, PREC, RMACH, RMAX, RMIN,
      REAL(10)   A, B, C, F, ONE, QTR, SAVEC, T1, T2						   |	      DOUBLE PRECISION   A, B, C, F, ONE, QTR, SAVEC, T1, T2
      REAL(10)   DLAMC3										   |	      DOUBLE PRECISION   DLAMC3
      REAL(10)   EPS, RMAX, RMIN								   |	      DOUBLE PRECISION   EPS, RMAX, RMIN
*  EPS     (output) REAL(10)									   |	*  EPS     (output) DOUBLE PRECISION
*  RMIN    (output) REAL(10)									   |	*  RMIN    (output) DOUBLE PRECISION
*  RMAX    (output) REAL(10)									   |	*  RMAX    (output) DOUBLE PRECISION
      REAL(10)   A, B, C, HALF, LEPS, LRMAX, LRMIN, ONE, RBASE,					   |	      DOUBLE PRECISION   A, B, C, HALF, LEPS, LRMAX, LRMIN, ONE, RBASE,
      REAL(10)   DLAMC3										   |	      DOUBLE PRECISION   DLAMC3
      REAL(10) FUNCTION DLAMC3( A, B )								   |	      DOUBLE PRECISION FUNCTION DLAMC3( A, B )
      REAL(10)   A, B										   |	      DOUBLE PRECISION   A, B
*  A, B    (input) REAL(10)									   |	*  A, B    (input) DOUBLE PRECISION
      REAL(10)   START										   |	      DOUBLE PRECISION   START
*  START   (input) REAL(10)									   |	*  START   (input) DOUBLE PRECISION
      REAL(10)   A, B1, B2, C1, C2, D1, D2, ONE, RBASE, ZERO					   |	      DOUBLE PRECISION   A, B1, B2, C1, C2, D1, D2, ONE, RBASE, ZERO
      REAL(10)   DLAMC3										   |	      DOUBLE PRECISION   DLAMC3
      REAL(10)   RMAX										   |	      DOUBLE PRECISION   RMAX
*  RMAX    (output) REAL(10)									   |	*  RMAX    (output) DOUBLE PRECISION
      REAL(10)   ZERO, ONE									   |	      DOUBLE PRECISION   ZERO, ONE
      REAL(10)   OLDY, RECBAS, Y, Z								   |	      DOUBLE PRECISION   OLDY, RECBAS, Y, Z
      REAL(10)   DLAMC3										   |	      DOUBLE PRECISION   DLAMC3
./lpack/dlaswp.f
      REAL(10)   A( LDA, * )									   |	      DOUBLE PRECISION   A( LDA, * )
*  A       (input/output) REAL(10) array, dimension (LDA,N)					   |	*  A       (input/output) DOUBLE PRECISION array, dimension (LDA,N)
      REAL(10)   TEMP										   |	      DOUBLE PRECISION   TEMP
./lpack/ieeeck.f
./lpack/ilaenv.f
./lpack/lsame.f
 
Comparing files in ./lte_hydro with those in  /home/hillier/wnode04/cmf_testing_real8//lte_hydro
 
./lte_hydro/Makefile
./lte_hydro/det_ed.f
	REAL(10) ABUND_SUM									   |		REAL*8 ABUND_SUM
	REAL(10) ION_POPS(ND,NUM_IONS)								   |		REAL*8 ION_POPS(ND,NUM_IONS)
	REAL(10) FSAHA(NUM_IONS)								   |		REAL*8 FSAHA(NUM_IONS)
	REAL(10) XZ(NUM_IONS)									   |		REAL*8 XZ(NUM_IONS)
	REAL(10) XZW(NUM_IONS)									   |		REAL*8 XZW(NUM_IONS)
	REAL(10) ED_OLD(ND)									   |		REAL*8 ED_OLD(ND)
	REAL(10) POPION_OLD(ND)									   |		REAL*8 POPION_OLD(ND)
!												   |	!
	REAL(10) XEDW										   |		REAL*8 XEDW
	REAL(10) XED_OLD									   |		REAL*8 XED_OLD
	REAL(10) XERR										   |		REAL*8 XERR
	REAL(10) XKBT										   |		REAL*8 XKBT
	REAL(10) XG0										   |		REAL*8 XG0
	REAL(10) XG1										   |		REAL*8 XG1
	REAL(10) XGE										   |		REAL*8 XGE
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) HSQR										   |		REAL*8 HSQR
	REAL(10), PARAMETER :: HDKT=4.7994145D0							   |		REAL*8, PARAMETER :: HDKT=4.7994145D0
	REAL(10), PARAMETER :: EPS=1.0D-05							   |		REAL*8, PARAMETER :: EPS=1.0D-05
!												   |	!
	REAL(10) PLANCKS_CONSTANT								   |		REAL*8 PLANCKS_CONSTANT
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) ELECTRON_MASS									   |		REAL*8 ELECTRON_MASS
	          FSAHA(ID) = (XG1*XGE/XG0) * T1 * EXP(-ATM(ID)%EDGEXzV_F(1)*T2)  		   |		          FSAHA(ID) = (XG1*XGE/XG0) * T1 * DEXP(-ATM(ID)%EDGEXzV_F(1)*T2)  
                XERR = ABS(1.0D0-XED_OLD/XEDW)							   |	                XERR = DABS(1.0D0-XED_OLD/XEDW)
./lte_hydro/det_r_grid_v1.f
	REAL(10) REV_TAU_GRID(NEW_ND)								   |		REAL*8 REV_TAU_GRID(NEW_ND)
	REAL(10) TAU_MAX		!Maximum optical depth for new grid.			   |		REAL*8 TAU_MAX		!Maximum optical depth for new grid.
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) REV_R(ND_MAX)									   |		REAL*8 REV_R(ND_MAX)
	REAL(10) REV_V(ND_MAX)									   |		REAL*8 REV_V(ND_MAX)
	REAL(10) REV_TAU(ND_MAX)								   |		REAL*8 REV_TAU(ND_MAX)
	REAL(10) OLD_R(ND_MAX)									   |		REAL*8 OLD_R(ND_MAX)
	REAL(10) OLD_TAU(ND_MAX)								   |		REAL*8 OLD_TAU(ND_MAX)
	REAL(10) LOG_TAU(ND)									   |		REAL*8 LOG_TAU(ND)
	REAL(10), PARAMETER :: V_SCL_FAC=0.67D0							   |		REAL*8, PARAMETER :: V_SCL_FAC=0.67D0
	REAL(10), PARAMETER :: dLOG_TAU=0.25D0							   |		REAL*8, PARAMETER :: dLOG_TAU=0.25D0
	REAL(10) LOG_TAU_MAX									   |		REAL*8 LOG_TAU_MAX
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./lte_hydro/det_r_grid_v2.f
	REAL(10) REV_TAU_GRID(NEW_ND)								   |		REAL*8 REV_TAU_GRID(NEW_ND)
	REAL(10) OBND_PARS(NUM_OBND_PARAMS)							   |		REAL*8 OBND_PARS(NUM_OBND_PARAMS)
	REAL(10) TAU_MAX				!Maximum optical depth for new grid.	   |		REAL*8 TAU_MAX				!Maximum optical depth for new grid.
	REAL(10) V_SCL_FAC			!Maxium values fo V(I+1)/V(I)			   |		REAL*8 V_SCL_FAC			!Maxium values fo V(I+1)/V(I)
	REAL(10) dLOG_TAU				!Maximu value for /\Tau			   |		REAL*8 dLOG_TAU				!Maximu value for /\Tau
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) REV_R(ND_MAX)									   |		REAL*8 REV_R(ND_MAX)
	REAL(10) REV_V(ND_MAX)									   |		REAL*8 REV_V(ND_MAX)
	REAL(10) REV_TAU(ND_MAX)								   |		REAL*8 REV_TAU(ND_MAX)
	REAL(10) OLD_R(ND_MAX)									   |		REAL*8 OLD_R(ND_MAX)
	REAL(10) OLD_TAU(ND_MAX)								   |		REAL*8 OLD_TAU(ND_MAX)
	REAL(10) LOG_TAU(ND)									   |		REAL*8 LOG_TAU(ND)
	REAL(10) LOG_TAU_MAX									   |		REAL*8 LOG_TAU_MAX
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./lte_hydro/det_r_grid_v3.f
	REAL(10) REV_TAU_GRID(NEW_ND)								   |		REAL*8 REV_TAU_GRID(NEW_ND)
	REAL(10) OBND_PARS(NUM_OBND_PARAMS)							   |		REAL*8 OBND_PARS(NUM_OBND_PARAMS)
	REAL(10) TAU_MAX				!Maximum optical depth for new grid.	   |		REAL*8 TAU_MAX				!Maximum optical depth for new grid.
	REAL(10) R_SCL_FAC			!Maxium values for R(I+1)/V(I)			   |		REAL*8 R_SCL_FAC			!Maxium values for R(I+1)/V(I)
	REAL(10) V_SCL_FAC			!Maxium values for V(I+1)/V(I)			   |		REAL*8 V_SCL_FAC			!Maxium values for V(I+1)/V(I)
	REAL(10) dLOG_TAU				!Maximu value for /\Tau			   |		REAL*8 dLOG_TAU				!Maximu value for /\Tau
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) REV_R(ND_MAX)									   |		REAL*8 REV_R(ND_MAX)
	REAL(10) REV_V(ND_MAX)									   |		REAL*8 REV_V(ND_MAX)
	REAL(10) REV_TAU(ND_MAX)								   |		REAL*8 REV_TAU(ND_MAX)
	REAL(10) OLD_R(ND_MAX)									   |		REAL*8 OLD_R(ND_MAX)
	REAL(10) OLD_TAU(ND_MAX)								   |		REAL*8 OLD_TAU(ND_MAX)
	REAL(10) LOG_TAU(ND)									   |		REAL*8 LOG_TAU(ND)
	REAL(10) LOG_TAU_MAX									   |		REAL*8 LOG_TAU_MAX
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./lte_hydro/genopaeta_v8.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) ETA(ND)			!Emissivity					   |		REAL*8 ETA(ND)			!Emissivity
	REAL(10) HN(N,ND),HNST(N,ND)								   |		REAL*8 HN(N,ND),HNST(N,ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) T(ND)			!Temperature (K)					   |		REAL*8 T(ND)			!Temperature (K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) ZION			!Charge on resultiong ion.				   |		REAL*8 ZION			!Charge on resultiong ion.
	REAL(10) GION			!Charge on resultiong ion.				   |		REAL*8 GION			!Charge on resultiong ion.
	REAL(10) GFF_VAL(ND)		!g(ff) as a function of depth				   |		REAL*8 GFF_VAL(ND)		!g(ff) as a function of depth
	REAL(10) COR_FAC(ND)		!Factor to convert HNST for ION_LEV			   |		REAL*8 COR_FAC(ND)		!Factor to convert HNST for ION_LEV
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N)		!Photionization cross-section
	REAL(10) TMP_CHI(N)		!Photionization cross-section				   |		REAL*8 TMP_CHI(N)		!Photionization cross-section
	REAL(10) TMP_ETA(N)		!Photionization cross-section				   |		REAL*8 TMP_ETA(N)		!Photionization cross-section
	REAL(10) ALPHA,TCHI1,TETA1,TETA2							   |		REAL*8 ALPHA,TCHI1,TETA1,TETA2
	REAL(10) T1,T2,ZION_CUBED,NEFF								   |		REAL*8 T1,T2,ZION_CUBED,NEFF
./lte_hydro/get_lte_ross_v2.f
	REAL(10), ALLOCATABLE :: CHI(:,:)							   |		REAL*8, ALLOCATABLE :: CHI(:,:)
	REAL(10), ALLOCATABLE :: ESEC(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC(:,:)
	REAL(10), ALLOCATABLE :: KAP(:,:)							   |		REAL*8, ALLOCATABLE :: KAP(:,:)
	REAL(10), ALLOCATABLE :: KES(:,:)							   |		REAL*8, ALLOCATABLE :: KES(:,:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:,:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:,:)
	REAL(10), ALLOCATABLE :: ED(:,:)							   |		REAL*8, ALLOCATABLE :: ED(:,:)
	REAL(10), ALLOCATABLE :: RHO(:)								   |		REAL*8, ALLOCATABLE :: RHO(:)
	REAL(10), ALLOCATABLE :: TEMP(:)							   |		REAL*8, ALLOCATABLE :: TEMP(:)
	REAL(10) ATOM_DEN									   |		REAL*8 ATOM_DEN
	REAL(10) KAP_VAL									   |		REAL*8 KAP_VAL
	REAL(10) KAP_ES										   |		REAL*8 KAP_ES
	REAL(10) LTE_ED										   |		REAL*8 LTE_ED
	REAL(10) TVAL										   |		REAL*8 TVAL
	REAL(10) DENSITY									   |		REAL*8 DENSITY
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) D1,D2										   |		REAL*8 D1,D2
./lte_hydro/lte.f
	REAL(10) T1		!Temporary variable						   |		REAL*8 T1		!Temporary variable
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./lte_hydro/lte_pop_sl.f
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./lte_hydro/ltepop_wld_v1.f
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature 10^4K					   |		REAL*8 T(ND)			!Temperature 10^4K
	REAL(10) DIC2(ND)			!Ion density (Full model atom)			   |		REAL*8 DIC2(ND)			!Ion density (Full model atom)
	REAL(10) C2LTE(NC2,ND)									   |		REAL*8 C2LTE(NC2,ND)
	REAL(10) W_C2(NC2,ND)									   |		REAL*8 W_C2(NC2,ND)
	REAL(10) EDGEC2(NC2)									   |		REAL*8 EDGEC2(NC2)
	REAL(10) GC2(NC2)									   |		REAL*8 GC2(NC2)
	REAL(10) GION_C2			!Statistical weight of ion groun state.		   |		REAL*8 GION_C2			!Statistical weight of ion groun state.
	REAL(10) ZC2			!Ion charge						   |		REAL*8 ZC2			!Ion charge
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X,Y,RGU									   |		REAL*8 X,Y,RGU
	RGU=LOG(2.07078D-22)									   |		RGU=DLOG(2.07078D-22)
./lte_hydro/lte_sub.f
	REAL(10) SOL(NT,ND)		!Temp. stor. area for ST. EQ.				   |		REAL*8 SOL(NT,ND)		!Temp. stor. area for ST. EQ.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) S1,REPA									   |		REAL*8 S1,REPA
	REAL(10) MAXCH,MAXCH_SUM								   |		REAL*8 MAXCH,MAXCH_SUM
	REAL(10) T1,T2,T3,T4,SRAT								   |		REAL*8 T1,T2,T3,T4,SRAT
	REAL(10) FL,AMASS,FL_OLD								   |		REAL*8 FL,AMASS,FL_OLD
	REAL(10) FG_COUNT									   |		REAL*8 FG_COUNT
	REAL(10) DOP_PRO									   |		REAL*8 DOP_PRO
	REAL(10) S15ADF										   |		REAL*8 S15ADF
	REAL(10) LAMVACAIR									   |		REAL*8 LAMVACAIR
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) RAD_SUN									   |		REAL*8 RAD_SUN
	REAL(10) TEFF_SUN									   |		REAL*8 TEFF_SUN
	REAL(10) POPS(NT,ND)		!Population for all species.				   |		REAL*8 POPS(NT,ND)		!Population for all species.
	REAL(10) MEAN_ATOMIC_WEIGHT	!Mean atomic weight of atoms  (neutrals			   |		REAL*8 MEAN_ATOMIC_WEIGHT	!Mean atomic weight of atoms  (neutrals
	REAL(10) ABUND_SUM									   |		REAL*8 ABUND_SUM
	REAL(10), ALLOCATABLE :: U_PAR_FN(:,:)							   |		REAL*8, ALLOCATABLE :: U_PAR_FN(:,:)
	REAL(10), ALLOCATABLE :: PHI_PAR_FN(:,:)						   |		REAL*8, ALLOCATABLE :: PHI_PAR_FN(:,:)
	REAL(10), ALLOCATABLE :: Z_PAR_FN(:)							   |		REAL*8, ALLOCATABLE :: Z_PAR_FN(:)
	REAL(10) TGREY(ND)									   |		REAL*8 TGREY(ND)
	REAL(10) T_SAVE(ND)									   |		REAL*8 T_SAVE(ND)
!	REAL(10) AVE_ENERGY(NT)		!Average energy of each super level			   |	!	REAL*8 AVE_ENERGY(NT)		!Average energy of each super level
	REAL(10) STEQ_T_SCL(ND)									   |		REAL*8 STEQ_T_SCL(ND)
	REAL(10) STEQ_T_NO_SCL(ND)								   |		REAL*8 STEQ_T_NO_SCL(ND)
	REAL(10) EDGEDIE(NMAXDIE)		!Ionization frequency (negative)		   |		REAL*8 EDGEDIE(NMAXDIE)		!Ionization frequency (negative)
	REAL(10) EINADIE(NMAXDIE)		!Einstein A coefficient				   |		REAL*8 EINADIE(NMAXDIE)		!Einstein A coefficient
	REAL(10) GUPDIE(NMAXDIE)		!Stat. weight of autoionizing level.		   |		REAL*8 GUPDIE(NMAXDIE)		!Stat. weight of autoionizing level.
	REAL(10) GLOW,GION									   |		REAL*8 GLOW,GION
	REAL(10) NUST(ND)			!LTE autoionizing population.			   |		REAL*8 NUST(ND)			!LTE autoionizing population.
	REAL(10) DION(ND)			!Ion population					   |		REAL*8 DION(ND)			!Ion population
	REAL(10), ALLOCATABLE :: DIERECOM(:,:)   !Chk for all species.				   |		REAL*8, ALLOCATABLE :: DIERECOM(:,:)   !Chk for all species.
	REAL(10), ALLOCATABLE :: DIECOOL(:,:)    !Dielec. cooling check for all spec.		   |		REAL*8, ALLOCATABLE :: DIECOOL(:,:)    !Dielec. cooling check for all spec.
	REAL(10), ALLOCATABLE :: ADDRECOM(:,:)     						   |		REAL*8, ALLOCATABLE :: ADDRECOM(:,:)     
	REAL(10) CHIL(ND)                 !Line opacity (without prof.)				   |		REAL*8 CHIL(ND)                 !Line opacity (without prof.)
	REAL(10) ETAL(ND)                 !Line emissivity (without prof.)			   |		REAL*8 ETAL(ND)                 !Line emissivity (without prof.)
	REAL(10) FQW(NCF_MAX)		!Frequency weights					   |		REAL*8 FQW(NCF_MAX)		!Frequency weights
	REAL(10) R_OLD(NDMAX)		!Used to store previous R grid in SN models.		   |		REAL*8 R_OLD(NDMAX)		!Used to store previous R grid in SN models.
	REAL(10) AV(ND)										   |		REAL*8 AV(ND)
	REAL(10) VB(NDMAX)		!Used for error calculations				   |		REAL*8 VB(NDMAX)		!Used for error calculations
	REAL(10) VC(NDMAX)		!Used for error calculations				   |		REAL*8 VC(NDMAX)		!Used for error calculations
	REAL(10) H(ND)										   |		REAL*8 H(ND)
	REAL(10) Q(ND)			!FREQ DEPENDENT.					   |		REAL*8 Q(ND)			!FREQ DEPENDENT.
	REAL(10) QH(ND)			!  "      "						   |		REAL*8 QH(ND)			!  "      "
	REAL(10) GAM(ND)			!FREQ INDEPENDENT				   |		REAL*8 GAM(ND)			!FREQ INDEPENDENT
	REAL(10) GAMH(ND)			!  "      "					   |		REAL*8 GAMH(ND)			!  "      "
	REAL(10) CONT_INT,EW									   |		REAL*8 CONT_INT,EW
	REAL(10) CNM(NDMAX,NDMAX)		!For collisions cross-section in		   |		REAL*8 CNM(NDMAX,NDMAX)		!For collisions cross-section in
	REAL(10) DCNM(NDMAX,NDMAX)	!STEQGEN						   |		REAL*8 DCNM(NDMAX,NDMAX)	!STEQGEN
	REAL(10)     LAM_FLUX_MEAN_BAND_END(N_FLUX_MEAN_BANDS)					   |		REAL*8     LAM_FLUX_MEAN_BAND_END(N_FLUX_MEAN_BANDS)
	REAL(10)     BAND_FLUX_MEAN(ND,N_FLUX_MEAN_BANDS)					   |		REAL*8     BAND_FLUX_MEAN(ND,N_FLUX_MEAN_BANDS)
	REAL(10)     BAND_FLUX(ND,N_FLUX_MEAN_BANDS)						   |		REAL*8     BAND_FLUX(ND,N_FLUX_MEAN_BANDS)
	REAL(10) NU(NCF_MAX)		!Continuum and line frequencies				   |		REAL*8 NU(NCF_MAX)		!Continuum and line frequencies
	REAL(10) NU_EVAL_CONT(NCF_MAX)	!Frequencies to evaluate continuum			   |		REAL*8 NU_EVAL_CONT(NCF_MAX)	!Frequencies to evaluate continuum
	REAL(10) OBS(NCF_MAX)		!Observers spectrum					   |		REAL*8 OBS(NCF_MAX)		!Observers spectrum
	REAL(10) OBS_FREQ(NCF_MAX)		!Since N_OBS < NCF =< NCF_MAX			   |		REAL*8 OBS_FREQ(NCF_MAX)		!Since N_OBS < NCF =< NCF_MAX
	REAL(10) OBS_FLUX(NCF_MAX)								   |		REAL*8 OBS_FLUX(NCF_MAX)
	REAL(10) AMASS_ALL(NT)									   |		REAL*8 AMASS_ALL(NT)
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) NU_MAX_OBS									   |		REAL*8 NU_MAX_OBS
	REAL(10) NU_MIN_OBS									   |		REAL*8 NU_MIN_OBS
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) Z_POP(NT)		!Ionic charge for each species				   |		REAL*8 Z_POP(NT)		!Ionic charge for each species
	REAL(10) X_RECOM(ND,0:NION)			!Next X-ray recombination rate		   |		REAL*8 X_RECOM(ND,0:NION)			!Next X-ray recombination rate
	REAL(10) X_COOL(ND,0:NION)			!Next X-ray cooling			   |		REAL*8 X_COOL(ND,0:NION)			!Next X-ray cooling
	REAL(10) OBS_XRAY_LUM_0P1								   |		REAL*8 OBS_XRAY_LUM_0P1
	REAL(10) OBS_XRAY_LUM_1KEV								   |		REAL*8 OBS_XRAY_LUM_1KEV
	REAL(10) GFF,XCROSS_V2									   |		REAL*8 GFF,XCROSS_V2
	REAL(10) SPEC_DEN(ND,NUM_SPECIES)		!Used by ELEC_PREP			   |		REAL*8 SPEC_DEN(ND,NUM_SPECIES)		!Used by ELEC_PREP
	REAL(10) AT_NO_VEC(ND,NUM_SPECIES)							   |		REAL*8 AT_NO_VEC(ND,NUM_SPECIES)
	REAL(10) AD_COOL_V(ND)									   |		REAL*8 AD_COOL_V(ND)
	REAL(10) AD_COOL_DT(ND)									   |		REAL*8 AD_COOL_DT(ND)
	REAL(10) ARTIFICIAL_HEAT_TERM(ND)							   |		REAL*8 ARTIFICIAL_HEAT_TERM(ND)
	REAL(10) TAU_EDGE(N_TAU_EDGE)								   |		REAL*8 TAU_EDGE(N_TAU_EDGE)
./lte_hydro/set_line_opac.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) TA(ND),TB(ND),TC(ND),ED_MOD(ND)		!Work vectors			   |		REAL*8 TA(ND),TB(ND),TC(ND),ED_MOD(ND)		!Work vectors
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
        REAL(10) OPLIN,EMLIN									   |	        REAL*8 OPLIN,EMLIN
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) FL										   |		REAL*8 FL
./lte_hydro/set_lte_est.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) Z_POP(NT)			!Vector containing Z of atom/ion (not core)	   |		REAL*8 Z_POP(NT)			!Vector containing Z of atom/ion (not core)
	REAL(10) MEAN_ATOMIC_WEIGHT								   |		REAL*8 MEAN_ATOMIC_WEIGHT
	REAL(10) ABUND_SUM									   |		REAL*8 ABUND_SUM
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) DELTA_ED									   |		REAL*8 DELTA_ED
	REAL(10) ATOM_MIN_VAL,ATOM_MAX_VAL							   |		REAL*8 ATOM_MIN_VAL,ATOM_MAX_VAL
	REAL(10) T_MIN_VAL,T_MAX_VAL								   |		REAL*8 T_MIN_VAL,T_MAX_VAL
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
./lte_hydro/wind_hyd.f
	  REAL(10) GAM_EDD									   |		  REAL*8 GAM_EDD
	  REAL(10) GAM_LIM									   |		  REAL*8 GAM_LIM
	  REAL(10) GAM_FULL									   |		  REAL*8 GAM_FULL
	  REAL(10) AMU			!Atomic mass unit					   |		  REAL*8 AMU			!Atomic mass unit
	  REAL(10) MU_ATOM		!Mean atomic mass in amu				   |		  REAL*8 MU_ATOM		!Mean atomic mass in amu
	  REAL(10) BC			!Boltzmann constant					   |		  REAL*8 BC			!Boltzmann constant
	  REAL(10) C_CMS									   |		  REAL*8 C_CMS
	  REAL(10) SIGMA_TH		!Thompson cross-section					   |		  REAL*8 SIGMA_TH		!Thompson cross-section
	  REAL(10) STEFAN_BC		!Stephan-Boltzmann constant				   |		  REAL*8 STEFAN_BC		!Stephan-Boltzmann constant
	  REAL(10) LOGG			!Log (surface gravity) (cgs units)			   |		  REAL*8 LOGG			!Log (surface gravity) (cgs units)
	  REAL(10) GRAV_CON									   |		  REAL*8 GRAV_CON
	  REAL(10) REFERENCE_RADIUS								   |		  REAL*8 REFERENCE_RADIUS
	  REAL(10) PREV_REF_RADIUS								   |		  REAL*8 PREV_REF_RADIUS
	  REAL(10) RADIUS_AT_TAU_23								   |		  REAL*8 RADIUS_AT_TAU_23
	  REAL(10) R_EST									   |		  REAL*8 R_EST
	  REAL(10) T_EST									   |		  REAL*8 T_EST
	  REAL(10) P_EST									   |		  REAL*8 P_EST
	  REAL(10) TAU_EST									   |		  REAL*8 TAU_EST
	  REAL(10) ED_ON_NA_EST 								   |		  REAL*8 ED_ON_NA_EST 
	  REAL(10) ATOM_EST									   |		  REAL*8 ATOM_EST
	  REAL(10) TEFF										   |		  REAL*8 TEFF
	  REAL(10) ROSS_ON_ES									   |		  REAL*8 ROSS_ON_ES
	  REAL(10) KAP_ROSS									   |		  REAL*8 KAP_ROSS
	  REAL(10) KAP_ES									   |		  REAL*8 KAP_ES
	  REAL(10) SOUND_SPEED									   |		  REAL*8 SOUND_SPEED
	  REAL(10) MDOT										   |		  REAL*8 MDOT
	  REAL(10) dPdR										   |		  REAL*8 dPdR
	  REAL(10) dTAUdR									   |		  REAL*8 dTAUdR
          REAL(10), ALLOCATABLE :: OLD_R(:)							   |	          REAL*8, ALLOCATABLE :: OLD_R(:)
          REAL(10), ALLOCATABLE :: OLD_T(:)							   |	          REAL*8, ALLOCATABLE :: OLD_T(:)
          REAL(10), ALLOCATABLE :: OLD_V(:)							   |	          REAL*8, ALLOCATABLE :: OLD_V(:)
          REAL(10), ALLOCATABLE :: OLD_SIGMA(:)							   |	          REAL*8, ALLOCATABLE :: OLD_SIGMA(:)
          REAL(10), ALLOCATABLE :: OLD_ED(:)							   |	          REAL*8, ALLOCATABLE :: OLD_ED(:)
          REAL(10), ALLOCATABLE :: OLD_TGREY(:)							   |	          REAL*8, ALLOCATABLE :: OLD_TGREY(:)
          REAL(10), ALLOCATABLE :: OLD_dE_RAD_DECAY(:)						   |	          REAL*8, ALLOCATABLE :: OLD_dE_RAD_DECAY(:)
          REAL(10), ALLOCATABLE :: OLD_POP_ATOM(:)						   |	          REAL*8, ALLOCATABLE :: OLD_POP_ATOM(:)
          REAL(10), ALLOCATABLE :: OLD_POPION(:)						   |	          REAL*8, ALLOCATABLE :: OLD_POPION(:)
          REAL(10), ALLOCATABLE :: OLD_MASS_DENSITY(:)						   |	          REAL*8, ALLOCATABLE :: OLD_MASS_DENSITY(:)
          REAL(10), ALLOCATABLE :: OLD_CLUMP_FAC(:)						   |	          REAL*8, ALLOCATABLE :: OLD_CLUMP_FAC(:)
	  REAL(10), ALLOCATABLE :: OLD_SF(:)							   |		  REAL*8, ALLOCATABLE :: OLD_SF(:)
          REAL(10), ALLOCATABLE :: OLD_TAU(:)							   |	          REAL*8, ALLOCATABLE :: OLD_TAU(:)
          REAL(10), ALLOCATABLE :: OLD_ESEC(:)							   |	          REAL*8, ALLOCATABLE :: OLD_ESEC(:)
          REAL(10), ALLOCATABLE :: OLD_ROSS_MEAN(:)						   |	          REAL*8, ALLOCATABLE :: OLD_ROSS_MEAN(:)
          REAL(10), ALLOCATABLE :: OLD_FLUX_MEAN(:)						   |	          REAL*8, ALLOCATABLE :: OLD_FLUX_MEAN(:)
          REAL(10), ALLOCATABLE :: OLD_PLANCK_MEAN(:)						   |	          REAL*8, ALLOCATABLE :: OLD_PLANCK_MEAN(:)
          REAL(10), ALLOCATABLE :: OLD_KAP_ROSS(:)						   |	          REAL*8, ALLOCATABLE :: OLD_KAP_ROSS(:)
          REAL(10), ALLOCATABLE :: OLD_KAP_FLUX(:)						   |	          REAL*8, ALLOCATABLE :: OLD_KAP_FLUX(:)
          REAL(10), ALLOCATABLE :: OLD_KAP_ESEC(:)						   |	          REAL*8, ALLOCATABLE :: OLD_KAP_ESEC(:)
	  REAL(10) OLD_TEFF									   |		  REAL*8 OLD_TEFF
	  REAL(10) OLD_REF_RADIUS								   |		  REAL*8 OLD_REF_RADIUS
        REAL(10) R(ND_MAX)									   |	        REAL*8 R(ND_MAX)
        REAL(10) V(ND_MAX)									   |	        REAL*8 V(ND_MAX)
        REAL(10) SIGMA(ND_MAX)									   |	        REAL*8 SIGMA(ND_MAX)
        REAL(10) T(ND_MAX)									   |	        REAL*8 T(ND_MAX)
        REAL(10) ED(ND_MAX)									   |	        REAL*8 ED(ND_MAX)
        REAL(10) TAU(ND_MAX)									   |	        REAL*8 TAU(ND_MAX)
        REAL(10) P(ND_MAX)									   |	        REAL*8 P(ND_MAX)
        REAL(10) ED_ON_NA(ND_MAX)								   |	        REAL*8 ED_ON_NA(ND_MAX)
	REAL(10) dPdR_VEC(ND_MAX)								   |		REAL*8 dPdR_VEC(ND_MAX)
!												   |	!
        REAL(10) ROSS_MEAN(ND_MAX)								   |	        REAL*8 ROSS_MEAN(ND_MAX)
        REAL(10) FLUX_MEAN(ND_MAX)								   |	        REAL*8 FLUX_MEAN(ND_MAX)
        REAL(10) POP_ATOM(ND_MAX)								   |	        REAL*8 POP_ATOM(ND_MAX)
        REAL(10) MASS_DENSITY(ND_MAX)								   |	        REAL*8 MASS_DENSITY(ND_MAX)
        REAL(10) CLUMP_FAC(ND_MAX)								   |	        REAL*8 CLUMP_FAC(ND_MAX)
        REAL(10) POPION(ND_MAX)									   |	        REAL*8 POPION(ND_MAX)
        REAL(10) CHI_ROSS(ND_MAX)								   |	        REAL*8 CHI_ROSS(ND_MAX)
        REAL(10) GAMMA_FULL(ND_MAX)								   |	        REAL*8 GAMMA_FULL(ND_MAX)
!												   |	!
	REAL(10) TA(ND_MAX)									   |		REAL*8 TA(ND_MAX)
	REAL(10) TB(ND_MAX)									   |		REAL*8 TB(ND_MAX)
	REAL(10) TC(ND_MAX)									   |		REAL*8 TC(ND_MAX)
	REAL(10), ALLOCATABLE :: REV_TAU(:)							   |		REAL*8, ALLOCATABLE :: REV_TAU(:)
        REAL(10), ALLOCATABLE :: REV_R(:)							   |	        REAL*8, ALLOCATABLE :: REV_R(:)
        REAL(10), ALLOCATABLE :: REV_V(:)							   |	        REAL*8, ALLOCATABLE :: REV_V(:)
        REAL(10), ALLOCATABLE :: REV_SIGMA(:)							   |	        REAL*8, ALLOCATABLE :: REV_SIGMA(:)
        REAL(10), ALLOCATABLE :: REV_POP_ATOM(:)						   |	        REAL*8, ALLOCATABLE :: REV_POP_ATOM(:)
        REAL(10), ALLOCATABLE :: REV_ED(:)							   |	        REAL*8, ALLOCATABLE :: REV_ED(:)
        REAL(10), ALLOCATABLE :: REV_T(:)							   |	        REAL*8, ALLOCATABLE :: REV_T(:)
        REAL(10), ALLOCATABLE :: REV_CHI_ROSS(:)						   |	        REAL*8, ALLOCATABLE :: REV_CHI_ROSS(:)
        REAL(10), ALLOCATABLE :: REV_GAMMA_FULL(:)						   |	        REAL*8, ALLOCATABLE :: REV_GAMMA_FULL(:)
        REAL(10), ALLOCATABLE :: COEF(:,:)							   |	        REAL*8, ALLOCATABLE :: COEF(:,:)
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) CONNECTION_RADIUS								   |		REAL*8 CONNECTION_RADIUS
	REAL(10) CONNECTION_VEL									   |		REAL*8 CONNECTION_VEL
	REAL(10) dLOG_TAU									   |		REAL*8 dLOG_TAU
	REAL(10) V_SCL_FAC									   |		REAL*8 V_SCL_FAC
	REAL(10) OBND_PARS(20)									   |		REAL*8 OBND_PARS(20)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) NI_ZERO									   |		REAL*8 NI_ZERO
	REAL(10) OLD_TAU_MAX									   |		REAL*8 OLD_TAU_MAX
	REAL(10) SCL_HT										   |		REAL*8 SCL_HT
	REAL(10) H										   |		REAL*8 H
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) OLD_MDOT									   |		REAL*8 OLD_MDOT
	REAL(10) RBOUND										   |		REAL*8 RBOUND
	REAL(10) MASS_LOSS_SCALE_FACTOR								   |		REAL*8 MASS_LOSS_SCALE_FACTOR
	REAL(10) dP1,dTAU1									   |		REAL*8 dP1,dTAU1
	REAL(10) dP2,dTAU2									   |		REAL*8 dP2,dTAU2
	REAL(10) dP3,dTAU3									   |		REAL*8 dP3,dTAU3
	REAL(10) dP4,dTAU4									   |		REAL*8 dP4,dTAU4
	REAL(10) ATOMIC_MASS_UNIT,BOLTZMANN_CONSTANT,STEFAN_BOLTZ				   |		REAL*8 ATOMIC_MASS_UNIT,BOLTZMANN_CONSTANT,STEFAN_BOLTZ
	REAL(10) GRAVITATIONAL_CONSTANT,MASS_SUN,SPEED_OF_LIGHT					   |		REAL*8 GRAVITATIONAL_CONSTANT,MASS_SUN,SPEED_OF_LIGHT
	REAL(10) P										   |		REAL*8 P
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) ED_ON_NA									   |		REAL*8 ED_ON_NA
	REAL(10) POP_ATOM									   |		REAL*8 POP_ATOM
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SF										   |		REAL*8 SF
	REAL(10) FM										   |		REAL*8 FM
	REAL(10) ES										   |		REAL*8 ES
	REAL(10) RM										   |		REAL*8 RM
	REAL(10) LTE_ED										   |		REAL*8 LTE_ED
!												   |	!
	REAL(10) ED_EST										   |		REAL*8 ED_EST
	REAL(10) OLD_ATOM									   |		REAL*8 OLD_ATOM
	REAL(10) OLD_TEMP									   |		REAL*8 OLD_TEMP
	REAL(10) KAP_ROSS_OLD									   |		REAL*8 KAP_ROSS_OLD
	REAL(10) KAP_ES_OLD									   |		REAL*8 KAP_ES_OLD
./lte_hydro/wind_vel_law_v1.f
	REAL(10) R(ND_MAX)									   |		REAL*8 R(ND_MAX)
	REAL(10) V(ND_MAX)									   |		REAL*8 V(ND_MAX)
	REAL(10) SIGMA(ND_MAX)									   |		REAL*8 SIGMA(ND_MAX)
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) R_TRANS									   |		REAL*8 R_TRANS
	REAL(10) V_TRANS									   |		REAL*8 V_TRANS
	REAL(10) dVdR_TRANS									   |		REAL*8 dVdR_TRANS
	REAL(10) RO										   |		REAL*8 RO
	REAL(10) dR										   |		REAL*8 dR
	REAL(10) SCALE_HEIGHT									   |		REAL*8 SCALE_HEIGHT
	REAL(10) TOP		!Numerator of velocity expression 				   |		REAL*8 TOP		!Numerator of velocity expression 
	REAL(10) BOT		!Denominator of velocity expression.				   |		REAL*8 BOT		!Denominator of velocity expression.
	REAL(10) dTOPdR,dBOTdR									   |		REAL*8 dTOPdR,dBOTdR
	REAL(10) dVdR		!Velocoty gradient						   |		REAL*8 dVdR		!Velocoty gradient
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./lte_hydro/wind_vel_law_v2.f
	REAL(10) R(ND_MAX)									   |		REAL*8 R(ND_MAX)
	REAL(10) V(ND_MAX)									   |		REAL*8 V(ND_MAX)
	REAL(10) SIGMA(ND_MAX)									   |		REAL*8 SIGMA(ND_MAX)
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) R_TRANS									   |		REAL*8 R_TRANS
	REAL(10) V_TRANS									   |		REAL*8 V_TRANS
	REAL(10) dVdR_TRANS									   |		REAL*8 dVdR_TRANS
	REAL(10) RO										   |		REAL*8 RO
	REAL(10) dR										   |		REAL*8 dR
	REAL(10) SCALE_HEIGHT									   |		REAL*8 SCALE_HEIGHT
	REAL(10) TOP		!Numerator of velocity expression 				   |		REAL*8 TOP		!Numerator of velocity expression 
	REAL(10) BOT		!Denominator of velocity expression.				   |		REAL*8 BOT		!Denominator of velocity expression.
	REAL(10) dTOPdR,dBOTdR									   |		REAL*8 dTOPdR,dBOTdR
	REAL(10) dVdR		!Velocoty gradient						   |		REAL*8 dVdR		!Velocoty gradient
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./lte_hydro/wind_vel_law_v3.f
	REAL(10) R(ND_MAX)									   |		REAL*8 R(ND_MAX)
	REAL(10) V(ND_MAX)									   |		REAL*8 V(ND_MAX)
	REAL(10) SIGMA(ND_MAX)									   |		REAL*8 SIGMA(ND_MAX)
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) R_TRANS									   |		REAL*8 R_TRANS
	REAL(10) V_TRANS									   |		REAL*8 V_TRANS
	REAL(10) dVdR_TRANS									   |		REAL*8 dVdR_TRANS
	REAL(10) R2_ON_RTRANS									   |		REAL*8 R2_ON_RTRANS
	REAL(10) VEXT										   |		REAL*8 VEXT
	REAL(10) RO										   |		REAL*8 RO
	REAL(10) RP2										   |		REAL*8 RP2
	REAL(10) dR										   |		REAL*8 dR
	REAL(10) SCALE_HEIGHT									   |		REAL*8 SCALE_HEIGHT
	REAL(10) TOP		!Numerator of velocity expression 				   |		REAL*8 TOP		!Numerator of velocity expression 
	REAL(10) BOT		!Denominator of velocity expression.				   |		REAL*8 BOT		!Denominator of velocity expression.
	REAL(10) dTOPdR,dBOTdR									   |		REAL*8 dTOPdR,dBOTdR
	REAL(10) dVdR		!Velocity gradient						   |		REAL*8 dVdR		!Velocity gradient
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) SM_VINF									   |		REAL*8 SM_VINF
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./lte_hydro/writedc_v2.f
	REAL(10) HYD(NHYD,ND),HYDLTE(NHYD,ND),DHYD(NION,ND)					   |		REAL*8 HYD(NHYD,ND),HYDLTE(NHYD,ND),DHYD(NION,ND)
	REAL(10) R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)						   |		REAL*8 R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)
	REAL(10) LUM,T1,T2,T3									   |		REAL*8 LUM,T1,T2,T3
 
Comparing files in ./main with those in  /home/hillier/wnode04/cmf_testing_real8//main
 
 
Comparing files in ./misc with those in  /home/hillier/wnode04/cmf_testing_real8//misc
 
./misc/Makefile
./misc/adjust_atm_r_grid.f
	REAL(10) R(ND)			!Returned						   |		REAL*8 R(ND)			!Returned
	REAL(10) OLD_R(NS)		!Input							   |		REAL*8 OLD_R(NS)		!Input
	REAL(10) OLD_V(NS)		!Input							   |		REAL*8 OLD_V(NS)		!Input
	REAL(10) OLD_TAU(NS)		!Input							   |		REAL*8 OLD_TAU(NS)		!Input
!												   |	!
	REAL(10) LOG_OLD_R(NS)									   |		REAL*8 LOG_OLD_R(NS)
	REAL(10) LOG_OLD_V(NS)									   |		REAL*8 LOG_OLD_V(NS)
	REAL(10) LOG_OLD_TAU(NS)								   |		REAL*8 LOG_OLD_TAU(NS)
!												   |	!
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) LOG_TAU(ND)									   |		REAL*8 LOG_TAU(ND)
!												   |	!
	REAL(10) V_CON										   |		REAL*8 V_CON
	REAL(10) V_RAT_MAX									   |		REAL*8 V_RAT_MAX
	REAL(10) IB_RAT			!dTAU(I+1)/dTAU(I) near inner boudary.			   |		REAL*8 IB_RAT			!dTAU(I+1)/dTAU(I) near inner boudary.
	REAL(10) OB_RAT			!dTAU(I+1)/dRAU(I) near outer bunary			   |		REAL*8 OB_RAT			!dTAU(I+1)/dRAU(I) near outer bunary
	REAL(10) DTAU2_ON_DTAU1		!DTAU(2)/DTAU(1) at outer boundary.			   |		REAL*8 DTAU2_ON_DTAU1		!DTAU(2)/DTAU(1) at outer boundary.
	REAL(10) LOG_V_CON									   |		REAL*8 LOG_V_CON
	REAL(10) R_CON, LOG_R_CON								   |		REAL*8 R_CON, LOG_R_CON
	REAL(10) TAU_CON, LOG_TAU_CON								   |		REAL*8 TAU_CON, LOG_TAU_CON
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) dLOG_TAU			!d(LOG(TAU))					   |		REAL*8 dLOG_TAU			!d(LOG(TAU))
	REAL(10) dLOG_TAU_SAVE									   |		REAL*8 dLOG_TAU_SAVE
	REAL(10) dLOG_TAU1									   |		REAL*8 dLOG_TAU1
	REAL(10) dLOG_TAU2									   |		REAL*8 dLOG_TAU2
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./misc/adjust_sn_r_grid.f
	REAL(10) R(ND)			!Returned						   |		REAL*8 R(ND)			!Returned
	REAL(10) OLD_R(NS)		!Input							   |		REAL*8 OLD_R(NS)		!Input
	REAL(10) OLD_T(NS)		!Input							   |		REAL*8 OLD_T(NS)		!Input
	REAL(10) OLD_TAU(NS)		!Input							   |		REAL*8 OLD_TAU(NS)		!Input
	REAL(10) LOG_OLD_R(NS)									   |		REAL*8 LOG_OLD_R(NS)
	REAL(10) LOG_OLD_T(NS)									   |		REAL*8 LOG_OLD_T(NS)
	REAL(10) LOG_OLD_TAU(NS)								   |		REAL*8 LOG_OLD_TAU(NS)
	REAL(10) XN(ND)                   !Used as integer grid					   |		REAL*8 XN(ND)                   !Used as integer grid
	REAL(10) ZN(IND*ND)		!Used as integer grid.					   |		REAL*8 ZN(IND*ND)		!Used as integer grid.
	REAL(10) LOG_R(IND*ND)									   |		REAL*8 LOG_R(IND*ND)
	REAL(10) TAU(IND*ND)									   |		REAL*8 TAU(IND*ND)
	REAL(10) LOG_T(IND*ND)									   |		REAL*8 LOG_T(IND*ND)
	REAL(10) LOG_TAU(IND*ND)								   |		REAL*8 LOG_TAU(IND*ND)
	REAL(10) IB_RAT			!dTAU(I+1)/dTAU(I) near inner boudary.			   |		REAL*8 IB_RAT			!dTAU(I+1)/dTAU(I) near inner boudary.
	REAL(10) OB_RAT			!dTAU(I+1)/dRAU(I) near outer bunary			   |		REAL*8 OB_RAT			!dTAU(I+1)/dRAU(I) near outer bunary
	REAL(10) R_SCALE_FAC		!Factor to increase dLOGR by so that TAU scale has highe   |		REAL*8 R_SCALE_FAC		!Factor to increase dLOGR by so that TAU scale has highe
	REAL(10) DTAU2_ON_DTAU1		!DTAU(2)/DTAU(1) at outer boundary.			   |		REAL*8 DTAU2_ON_DTAU1		!DTAU(2)/DTAU(1) at outer boundary.
	REAL(10) dLOGT_MAX									   |		REAL*8 dLOGT_MAX
	REAL(10) dTAU			!d(LOG(TAU))						   |		REAL*8 dTAU			!d(LOG(TAU))
	REAL(10) dTAU_OLD									   |		REAL*8 dTAU_OLD
	REAL(10) dLOGR										   |		REAL*8 dLOGR
	REAL(10) dLOGT										   |		REAL*8 dLOGT
	REAL(10) LOG_TAU_MIN									   |		REAL*8 LOG_TAU_MIN
	REAL(10) LOG_R_MAX									   |		REAL*8 LOG_R_MAX
	REAL(10) TAU_BEG,TAU_END								   |		REAL*8 TAU_BEG,TAU_END
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) NEXT_R										   |		REAL*8 NEXT_R
	REAL(10) OB_RAT_LOC									   |		REAL*8 OB_RAT_LOC
./misc/append_dc.f
	REAL(10), ALLOCATABLE :: R_N(:)								   |		REAL*8, ALLOCATABLE :: R_N(:)
	REAL(10), ALLOCATABLE :: DI_N(:)							   |		REAL*8, ALLOCATABLE :: DI_N(:)
	REAL(10), ALLOCATABLE :: ED_N(:)							   |		REAL*8, ALLOCATABLE :: ED_N(:)
	REAL(10), ALLOCATABLE :: DC_N(:,:)							   |		REAL*8, ALLOCATABLE :: DC_N(:,:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: R_O(:)								   |		REAL*8, ALLOCATABLE :: R_O(:)
	REAL(10), ALLOCATABLE :: DI_O(:)							   |		REAL*8, ALLOCATABLE :: DI_O(:)
	REAL(10), ALLOCATABLE :: ED_O(:)							   |		REAL*8, ALLOCATABLE :: ED_O(:)
	REAL(10), ALLOCATABLE :: DC_O(:,:)							   |		REAL*8, ALLOCATABLE :: DC_O(:,:)
	REAL(10) LSTAR_N									   |		REAL*8 LSTAR_N
	REAL(10) RSTAR_N									   |		REAL*8 RSTAR_N
	REAL(10) LSTAR_O									   |		REAL*8 LSTAR_O
	REAL(10) RSTAR_O									   |		REAL*8 RSTAR_O
	REAL(10) T1										   |		REAL*8 T1
./misc/append_r_dc.f
	REAL(10), ALLOCATABLE :: R_N(:)								   |		REAL*8, ALLOCATABLE :: R_N(:)
	REAL(10), ALLOCATABLE :: DI_N(:)							   |		REAL*8, ALLOCATABLE :: DI_N(:)
	REAL(10), ALLOCATABLE :: ED_N(:)							   |		REAL*8, ALLOCATABLE :: ED_N(:)
	REAL(10), ALLOCATABLE :: DC_N(:,:)							   |		REAL*8, ALLOCATABLE :: DC_N(:,:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: R_O(:)								   |		REAL*8, ALLOCATABLE :: R_O(:)
	REAL(10), ALLOCATABLE :: DI_O(:)							   |		REAL*8, ALLOCATABLE :: DI_O(:)
	REAL(10), ALLOCATABLE :: ED_O(:)							   |		REAL*8, ALLOCATABLE :: ED_O(:)
	REAL(10), ALLOCATABLE :: DC_O(:,:)							   |		REAL*8, ALLOCATABLE :: DC_O(:,:)
	REAL(10) LSTAR_N									   |		REAL*8 LSTAR_N
	REAL(10) RSTAR_N									   |		REAL*8 RSTAR_N
	REAL(10) LSTAR_O									   |		REAL*8 LSTAR_O
	REAL(10) RSTAR_O									   |		REAL*8 RSTAR_O
	REAL(10) T1										   |		REAL*8 T1
./misc/ave_dc.f
	REAL(10), ALLOCATABLE :: R_NEW(:)							   |		REAL*8, ALLOCATABLE :: R_NEW(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: DION(:)							   |		REAL*8, ALLOCATABLE :: DION(:)
	REAL(10), ALLOCATABLE :: DC(:,:)							   |		REAL*8, ALLOCATABLE :: DC(:,:)
	REAL(10), ALLOCATABLE :: R1(:)								   |		REAL*8, ALLOCATABLE :: R1(:)
	REAL(10), ALLOCATABLE :: V1(:)								   |		REAL*8, ALLOCATABLE :: V1(:)
	REAL(10), ALLOCATABLE :: ED1(:)								   |		REAL*8, ALLOCATABLE :: ED1(:)
	REAL(10), ALLOCATABLE :: T1(:)								   |		REAL*8, ALLOCATABLE :: T1(:)
	REAL(10), ALLOCATABLE :: DION1(:)							   |		REAL*8, ALLOCATABLE :: DION1(:)
	REAL(10), ALLOCATABLE :: DC1(:,:)							   |		REAL*8, ALLOCATABLE :: DC1(:,:)
	REAL(10), ALLOCATABLE :: R2(:)								   |		REAL*8, ALLOCATABLE :: R2(:)
	REAL(10), ALLOCATABLE :: V2(:)								   |		REAL*8, ALLOCATABLE :: V2(:)
	REAL(10), ALLOCATABLE :: ED2(:)								   |		REAL*8, ALLOCATABLE :: ED2(:)
	REAL(10), ALLOCATABLE :: T2(:)								   |		REAL*8, ALLOCATABLE :: T2(:)
	REAL(10), ALLOCATABLE :: DION2(:)							   |		REAL*8, ALLOCATABLE :: DION2(:)
	REAL(10), ALLOCATABLE :: DC2(:,:)							   |		REAL*8, ALLOCATABLE :: DC2(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
!												   |	!
	REAL(10), ALLOCATABLE :: XV1(:)								   |		REAL*8, ALLOCATABLE :: XV1(:)
	REAL(10), ALLOCATABLE :: XV2(:)								   |		REAL*8, ALLOCATABLE :: XV2(:)
	REAL(10), ALLOCATABLE :: XNEW(:)							   |		REAL*8, ALLOCATABLE :: XNEW(:)
	REAL(10) EINA(NMAX,NMAX)								   |		REAL*8 EINA(NMAX,NMAX)
	REAL(10) EDGE(NMAX)									   |		REAL*8 EDGE(NMAX)
	REAL(10) STAT_WT(NMAX)									   |		REAL*8 STAT_WT(NMAX)
	REAL(10) ARAD(NMAX)									   |		REAL*8 ARAD(NMAX)
	REAL(10) GAM2(NMAX)									   |		REAL*8 GAM2(NMAX)
	REAL(10) GAM4(NMAX)									   |		REAL*8 GAM4(NMAX)
        REAL(10) IONIZATION_ENERGY        !Ionization energy of ion (cm^-1}			   |	        REAL*8 IONIZATION_ENERGY        !Ionization energy of ion (cm^-1}
        REAL(10) ZION                     !Charge on core (i.e. ion charge +1)			   |	        REAL*8 ZION                     !Charge on core (i.e. ion charge +1)
	REAL(10)  GF_CUT									   |		REAL*8  GF_CUT
	REAL(10) LSTAR										   |		REAL*8 LSTAR
	REAL(10) RSTAR										   |		REAL*8 RSTAR
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) X1										   |		REAL*8 X1
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) JNK										   |		REAL*8 JNK
	REAL(10) FX										   |		REAL*8 FX
	REAL(10) T_EXCITE									   |		REAL*8 T_EXCITE
	REAL(10), PARAMETER :: HDKT=4.7994145D0							   |		REAL*8, PARAMETER :: HDKT=4.7994145D0
./misc/check_ba_estimates.f
	REAL(10), ALLOCATABLE :: POPS_A(:)							   |		REAL*8, ALLOCATABLE :: POPS_A(:)
	REAL(10), ALLOCATABLE :: STEQ_A(:)							   |		REAL*8, ALLOCATABLE :: STEQ_A(:)
	REAL(10), ALLOCATABLE :: CMAT_A(:,:)							   |		REAL*8, ALLOCATABLE :: CMAT_A(:,:)
	REAL(10), ALLOCATABLE :: POPS_B(:)							   |		REAL*8, ALLOCATABLE :: POPS_B(:)
	REAL(10), ALLOCATABLE :: STEQ_B(:)							   |		REAL*8, ALLOCATABLE :: STEQ_B(:)
	REAL(10), ALLOCATABLE :: CMAT_B(:,:)							   |		REAL*8, ALLOCATABLE :: CMAT_B(:,:)
	REAL(10), ALLOCATABLE :: PRED_CHNG(:)							   |		REAL*8, ALLOCATABLE :: PRED_CHNG(:)
	REAL(10), ALLOCATABLE :: ACT_CHNG(:)							   |		REAL*8, ALLOCATABLE :: ACT_CHNG(:)
	REAL(10), ALLOCATABLE :: RATIO(:)							   |		REAL*8, ALLOCATABLE :: RATIO(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10) T1										   |		REAL*8 T1
./misc/check_energy_cons.f
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: R_RVTJ(:)							   |		REAL*8, ALLOCATABLE :: R_RVTJ(:)
	REAL(10), ALLOCATABLE :: RJ(:,:)							   |		REAL*8, ALLOCATABLE :: RJ(:,:)
	REAL(10), ALLOCATABLE :: HFLUX(:,:)							   |		REAL*8, ALLOCATABLE :: HFLUX(:,:)
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: OBS_FREQ(:)							   |		REAL*8, ALLOCATABLE :: OBS_FREQ(:)
	REAL(10), ALLOCATABLE :: OBS_FLUX(:)							   |		REAL*8, ALLOCATABLE :: OBS_FLUX(:)
	REAL(10) SN_AGE(NMAX)									   |		REAL*8 SN_AGE(NMAX)
	REAL(10) VINF(NMAX)									   |		REAL*8 VINF(NMAX)
	REAL(10) CMF_LUM(ND_MAX)								   |		REAL*8 CMF_LUM(ND_MAX)
	REAL(10) MECH_LUM(ND_MAX)								   |		REAL*8 MECH_LUM(ND_MAX)
	REAL(10) DECAY_LUM(ND_MAX)								   |		REAL*8 DECAY_LUM(ND_MAX)
	REAL(10) DR4J_LUM(ND_MAX)								   |		REAL*8 DR4J_LUM(ND_MAX)
	REAL(10) INTERN_LUM(ND_MAX)								   |		REAL*8 INTERN_LUM(ND_MAX)
!												   |	!
	REAL(10) E_RAD(NMAX)									   |		REAL*8 E_RAD(NMAX)
	REAL(10) L_OBS(NMAX)									   |		REAL*8 L_OBS(NMAX)
	REAL(10) L_CMF(NMAX)									   |		REAL*8 L_CMF(NMAX)
	REAL(10) L_MECH(NMAX)									   |		REAL*8 L_MECH(NMAX)
	REAL(10) L_DECAY(NMAX)									   |		REAL*8 L_DECAY(NMAX)
	REAL(10) L_DR4J(NMAX)									   |		REAL*8 L_DR4J(NMAX)
	REAL(10) L_INTERN(NMAX)									   |		REAL*8 L_INTERN(NMAX)
	REAL(10) E_CONS(NMAX)									   |		REAL*8 E_CONS(NMAX)
!												   |	!
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1,T2,T3,T4,T5									   |		REAL*8 T1,T2,T3,T4,T5
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) LUM_CONV_FACTOR								   |		REAL*8 LUM_CONV_FACTOR
	REAL(10) C_Mms										   |		REAL*8 C_Mms
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) XV(NCF_MAX)									   |		REAL*8 XV(NCF_MAX)
	REAL(10) YV(NCF_MAX)									   |		REAL*8 YV(NCF_MAX)
./misc/chk_ba_est.f
	REAL(10), ALLOCATABLE :: CMAT_A(:,:)							   |		REAL*8, ALLOCATABLE :: CMAT_A(:,:)
	REAL(10), ALLOCATABLE :: POPS_A(:)							   |		REAL*8, ALLOCATABLE :: POPS_A(:)
	REAL(10), ALLOCATABLE :: STEQ_A(:)							   |		REAL*8, ALLOCATABLE :: STEQ_A(:)
	REAL(10), ALLOCATABLE :: CMAT_B(:,:)							   |		REAL*8, ALLOCATABLE :: CMAT_B(:,:)
	REAL(10), ALLOCATABLE :: POPS_B(:)							   |		REAL*8, ALLOCATABLE :: POPS_B(:)
	REAL(10), ALLOCATABLE :: STEQ_B(:)							   |		REAL*8, ALLOCATABLE :: STEQ_B(:)
	REAL(10), ALLOCATABLE :: dSTEQ(:)							   |		REAL*8, ALLOCATABLE :: dSTEQ(:)
	REAL(10) T1										   |		REAL*8 T1
./misc/chk_phot.f
	REAL(10) FEDGE(N_MAX)									   |		REAL*8 FEDGE(N_MAX)
	REAL(10) ENERGY(N_MAX)									   |		REAL*8 ENERGY(N_MAX)
	REAL(10) G(N_MAX)									   |		REAL*8 G(N_MAX)
	REAL(10) LAM_EDGE(N_MAX)								   |		REAL*8 LAM_EDGE(N_MAX)
	REAL(10) E_STRT(N_MAX)									   |		REAL*8 E_STRT(N_MAX)
	REAL(10) EDGE_SUM(N_MAX)								   |		REAL*8 EDGE_SUM(N_MAX)
	REAL(10) G_SUM(N_MAX)									   |		REAL*8 G_SUM(N_MAX)
	REAL(10), ALLOCATABLE :: FOSC(:,:)							   |		REAL*8, ALLOCATABLE :: FOSC(:,:)
	REAL(10) GF_CUT										   |		REAL*8 GF_CUT
	REAL(10) AT_NO										   |		REAL*8 AT_NO
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) ZION_RD									   |		REAL*8 ZION_RD
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) PHOT_GION									   |		REAL*8 PHOT_GION
	REAL(10) EXC_EN										   |		REAL*8 EXC_EN
	REAL(10) ION_EN										   |		REAL*8 ION_EN
	REAL(10) EDGEXzSIX(1)									   |		REAL*8 EDGEXzSIX(1)
	REAL(10) GXzSIX(1)									   |		REAL*8 GXzSIX(1)
	REAL(10) F_TO_S_XzSIX(1)								   |		REAL*8 F_TO_S_XzSIX(1)
	REAL(10) TEMP(N_TEMP)									   |		REAL*8 TEMP(N_TEMP)
	REAL(10) RECOM(N_MAX,N_TEMP)								   |		REAL*8 RECOM(N_MAX,N_TEMP)
	REAL(10) VSM_DIE_KMS									   |		REAL*8 VSM_DIE_KMS
	REAL(10) SIG_GAU_KMS									   |		REAL*8 SIG_GAU_KMS
	REAL(10) FRAC_SIG_GAU									   |		REAL*8 FRAC_SIG_GAU
	REAL(10) CUT_ACCURACY									   |		REAL*8 CUT_ACCURACY
	REAL(10), ALLOCATABLE :: EDGE_PACK(:)							   |		REAL*8, ALLOCATABLE :: EDGE_PACK(:)
	REAL(10), ALLOCATABLE :: FOSC_PACK(:,:)							   |		REAL*8, ALLOCATABLE :: FOSC_PACK(:,:)
	REAL(10), ALLOCATABLE :: G_PACK(:)							   |		REAL*8, ALLOCATABLE :: G_PACK(:)
	REAL(10), ALLOCATABLE :: RECOM_PACK(:,:)						   |		REAL*8, ALLOCATABLE :: RECOM_PACK(:,:)
	REAL(10), ALLOCATABLE :: ARAD(:)							   |		REAL*8, ALLOCATABLE :: ARAD(:)
	REAL(10), ALLOCATABLE :: GAM2(:)							   |		REAL*8, ALLOCATABLE :: GAM2(:)
	REAL(10), ALLOCATABLE :: GAM4(:)							   |		REAL*8, ALLOCATABLE :: GAM4(:)
	REAL(10), ALLOCATABLE :: FLOW_SUM(:)							   |		REAL*8, ALLOCATABLE :: FLOW_SUM(:)
	REAL(10), ALLOCATABLE :: FHIGH_SUM(:)							   |		REAL*8, ALLOCATABLE :: FHIGH_SUM(:)
	REAL(10), ALLOCATABLE :: ALOW_SUM(:)							   |		REAL*8, ALLOCATABLE :: ALOW_SUM(:)
	REAL(10), ALLOCATABLE :: AHIGH_SUM(:)							   |		REAL*8, ALLOCATABLE :: AHIGH_SUM(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		DOUBLE PRECISION CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./misc/comp_ba_mat_sol.f
	REAL(10) POPS_RD(NT)									   |		REAL*8 POPS_RD(NT)
	REAL(10) STEQ_RD(NT)									   |		REAL*8 STEQ_RD(NT)
	REAL(10) CMAT_RD(NT,NT)									   |		REAL*8 CMAT_RD(NT,NT)
!												   |	!
	REAL(10) POPS_B(NT)									   |		REAL*8 POPS_B(NT)
	REAL(10) STEQ_B(NT)									   |		REAL*8 STEQ_B(NT)
	REAL(10) CMAT_B(NT,NT)									   |		REAL*8 CMAT_B(NT,NT)
	REAL(10) POPS(N)									   |		REAL*8 POPS(N)
	REAL(10) PLTE(N)									   |		REAL*8 PLTE(N)
	REAL(10) STEQ(N)									   |		REAL*8 STEQ(N)
	REAL(10) CMAT(N,N)									   |		REAL*8 CMAT(N,N)
	REAL(10) STAT_WT(N)									   |		REAL*8 STAT_WT(N)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
!												   |	!
	REAL(10) SAV_CMAT(N,N)									   |		REAL*8 SAV_CMAT(N,N)
	REAL(10) SAV_STEQ(N)									   |		REAL*8 SAV_STEQ(N)
	REAL(10) RHS(N)										   |		REAL*8 RHS(N)
	REAL(10) LARGEST_VAL(N)									   |		REAL*8 LARGEST_VAL(N)
	REAL(10) OLD_SOL(N)									   |		REAL*8 OLD_SOL(N)
!												   |	!
	REAL(10) NEW_POPS(N)									   |		REAL*8 NEW_POPS(N)
	REAL(10) NEW_LTE(N)									   |		REAL*8 NEW_LTE(N)
	REAL(10) ED_NEW,DI_NEW,T_NEW								   |		REAL*8 ED_NEW,DI_NEW,T_NEW
!												   |	!
	REAL(10) ROW_SF(N)									   |		REAL*8 ROW_SF(N)
	REAL(10) COL_SF(N)									   |		REAL*8 COL_SF(N)
!												   |	!
	REAL(10) ROW_CND									   |		REAL*8 ROW_CND
	REAL(10) COL_CND									   |		REAL*8 COL_CND
	REAL(10) MAX_VAL									   |		REAL*8 MAX_VAL
	REAL(10) T1,T2										   |		REAL*8 T1,T2
!												   |	!
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) GION,RGU,X,Y									   |		REAL*8 GION,RGU,X,Y
	REAL(10) IONIZATION_ENERGY								   |		REAL*8 IONIZATION_ENERGY
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  RGU=LOG(2.07078D-22)									   |		  RGU=DLOG(2.07078D-22)
	  RGU=LOG(2.07078D-22)									   |		  RGU=DLOG(2.07078D-22)
./misc/count_phot_data.f
	REAL(10) FREQ,  OLD_FREQ								   |		REAL*8 FREQ,  OLD_FREQ
	REAL(10) CROSS, OLD_CROSS								   |		REAL*8 CROSS, OLD_CROSS
./misc/create_batch_ins.f
./misc/create_batobs_ins.f
./misc/create_if_file.f
	  REAL(10), ALLOCATABLE :: XzV(:,:)							   |		  REAL*8, ALLOCATABLE :: XzV(:,:)
	  REAL(10), ALLOCATABLE :: DXzV(:)							   |		  REAL*8, ALLOCATABLE :: DXzV(:)
	  REAL(10), ALLOCATABLE :: ION_POP(:)							   |		  REAL*8, ALLOCATABLE :: ION_POP(:)
	  REAL(10) ZXzV										   |		  REAL*8 ZXzV
	  REAL(10) SN_AGE									   |		  REAL*8 SN_AGE
	  REAL(10), ALLOCATABLE :: INT_POP_SPEC(:)						   |		  REAL*8, ALLOCATABLE :: INT_POP_SPEC(:)
	  REAL(10), ALLOCATABLE :: POP_SPEC(:)							   |		  REAL*8, ALLOCATABLE :: POP_SPEC(:)
	  REAL(10), ALLOCATABLE :: FRAC(:)							   |		  REAL*8, ALLOCATABLE :: FRAC(:)
	  REAL(10), ALLOCATABLE :: V(:)								   |		  REAL*8, ALLOCATABLE :: V(:)
	  REAL(10), ALLOCATABLE :: R(:)								   |		  REAL*8, ALLOCATABLE :: R(:)
	  REAL(10), ALLOCATABLE :: T(:)								   |		  REAL*8, ALLOCATABLE :: T(:)
	  REAL(10), ALLOCATABLE :: ED(:)							   |		  REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: VGRID(:)							   |		REAL*8, ALLOCATABLE :: VGRID(:)
	REAL(10), ALLOCATABLE :: YOUT(:)							   |		REAL*8, ALLOCATABLE :: YOUT(:)
	REAL(10), ALLOCATABLE :: XVEC(:)							   |		REAL*8, ALLOCATABLE :: XVEC(:)
	REAL(10), ALLOCATABLE :: YVEC(:)							   |		REAL*8, ALLOCATABLE :: YVEC(:)
	REAL(10) ABUND										   |		REAL*8 ABUND
./misc/create_kappa_file.f
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: HTMP(:)							   |		REAL*8, ALLOCATABLE :: HTMP(:)
	REAL(10), ALLOCATABLE :: JNU(:,:)							   |		REAL*8, ALLOCATABLE :: JNU(:,:)
	REAL(10), ALLOCATABLE :: HNU(:,:)							   |		REAL*8, ALLOCATABLE :: HNU(:,:)
	REAL(10), ALLOCATABLE :: RMID(:)							   |		REAL*8, ALLOCATABLE :: RMID(:)
	  REAL(10) SN_AGE									   |		  REAL*8 SN_AGE
	  REAL(10), ALLOCATABLE :: V(:)								   |		  REAL*8, ALLOCATABLE :: V(:)
	  REAL(10), ALLOCATABLE :: R(:)								   |		  REAL*8, ALLOCATABLE :: R(:)
	  REAL(10), ALLOCATABLE :: T(:)								   |		  REAL*8, ALLOCATABLE :: T(:)
	  REAL(10), ALLOCATABLE :: ED(:)							   |		  REAL*8, ALLOCATABLE :: ED(:)
	  REAL(10), ALLOCATABLE :: DENSITY(:)		!Mass density				   |		  REAL*8, ALLOCATABLE :: DENSITY(:)		!Mass density
	  REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)						   |		  REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	  REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		  REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	  REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		  REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	  REAL(10), ALLOCATABLE :: JCMF(:)							   |		  REAL*8, ALLOCATABLE :: JCMF(:)
	  REAL(10), ALLOCATABLE :: HCMF(:)							   |		  REAL*8, ALLOCATABLE :: HCMF(:)
	REAL(10), ALLOCATABLE :: VGRID(:)							   |		REAL*8, ALLOCATABLE :: VGRID(:)
	REAL(10), ALLOCATABLE :: YOUT(:)							   |		REAL*8, ALLOCATABLE :: YOUT(:)
	REAL(10), ALLOCATABLE :: XVEC(:)							   |		REAL*8, ALLOCATABLE :: XVEC(:)
	REAL(10), ALLOCATABLE :: YVEC(:)							   |		REAL*8, ALLOCATABLE :: YVEC(:)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) CHI_ROSS									   |		REAL*8 CHI_ROSS
	REAL(10) CHI_FLUX									   |		REAL*8 CHI_FLUX
./misc/create_mod_sum.f
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./misc/create_pp_mod_sum.f
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./misc/do_ng_v2.f
	REAL(10), ALLOCATABLE :: RDPOPS(:,:,:)		!NT+3,ND				   |		REAL*8, ALLOCATABLE :: RDPOPS(:,:,:)		!NT+3,ND
	REAL(10), ALLOCATABLE :: BIG_POPS(:,:)		!NT+3,ND				   |		REAL*8, ALLOCATABLE :: BIG_POPS(:,:)		!NT+3,ND
	REAL(10), ALLOCATABLE :: POPS(:,:)		!NT,ND					   |		REAL*8, ALLOCATABLE :: POPS(:,:)		!NT,ND
	REAL(10), ALLOCATABLE :: R(:)			!ND					   |		REAL*8, ALLOCATABLE :: R(:)			!ND
	REAL(10), ALLOCATABLE :: V(:)			!ND					   |		REAL*8, ALLOCATABLE :: V(:)			!ND
	REAL(10), ALLOCATABLE :: SIGMA(:)			!ND				   |		REAL*8, ALLOCATABLE :: SIGMA(:)			!ND
	REAL(10) TA(2000)									   |		REAL*8 TA(2000)
	REAL(10) TB(2000)									   |		REAL*8 TB(2000)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) BIG_FAC									   |		REAL*8 BIG_FAC
	REAL(10) SF1,SF2									   |		REAL*8 SF1,SF2
	REAL(10) REAL_LIMIT									   |		REAL*8 REAL_LIMIT
	REAL(10) NEWPOP(NS)									   |		REAL*8 NEWPOP(NS)
	REAL(10) RDPOPS(NT,ND,ITS_PER_NG)							   |		REAL*8 RDPOPS(NT,ND,ITS_PER_NG)
	REAL(10) TEMP(ITS_PER_NG,NS)								   |		REAL*8 TEMP(ITS_PER_NG,NS)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) RDPOPS(NT,ND,ITS_PER_NG)							   |		REAL*8 RDPOPS(NT,ND,ITS_PER_NG)
	REAL(10) NEWPOP(NT,ND)									   |		REAL*8 NEWPOP(NT,ND)
	REAL(10) VEC_INC(ND)									   |		REAL*8 VEC_INC(ND)
	REAL(10) VEC_DEC(ND)									   |		REAL*8 VEC_DEC(ND)
	REAL(10) INT_ARRAY(ND)									   |		REAL*8 INT_ARRAY(ND)
!												   |	!
	REAL(10) RINDX(NT)									   |		REAL*8 RINDX(NT)
	REAL(10) RAT(NT)									   |		REAL*8 RAT(NT)
	REAL(10) TA(MAX(NT,ND))									   |		REAL*8 TA(MAX(NT,ND))
	REAL(10) TB(MAX(NT,ND))									   |		REAL*8 TB(MAX(NT,ND))
	REAL(10) TC(MAX(NT,ND))									   |		REAL*8 TC(MAX(NT,ND))
!												   |	!
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LOCINC,LOCDEC									   |		REAL*8 LOCINC,LOCDEC
	REAL(10) MAXINC,MAXDEC									   |		REAL*8 MAXINC,MAXDEC
./misc/do_recom_sum.f
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: RECOM_RATE(:)							   |		REAL*8, ALLOCATABLE :: RECOM_RATE(:)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) TMIN,TMAX									   |		REAL*8 TMIN,TMAX
	REAL(10) T_REC_CHK(NCHK)								   |		REAL*8 T_REC_CHK(NCHK)
	REAL(10) RECOM_CHK(NCHK)								   |		REAL*8 RECOM_CHK(NCHK)
./misc/ed_vadat.f
	REAL(10) RSTAR_MIN,RSTAR_MAX								   |		REAL*8 RSTAR_MIN,RSTAR_MAX
	REAL(10) LSTAR_MIN,LSTAR_MAX								   |		REAL*8 LSTAR_MIN,LSTAR_MAX
	REAL(10) RSTAR										   |		REAL*8 RSTAR
	REAL(10) LSTAR										   |		REAL*8 LSTAR
	REAL(10) TIME_SEQ_NO									   |		REAL*8 TIME_SEQ_NO
	REAL(10) R_SCALE_FACTOR									   |		REAL*8 R_SCALE_FACTOR
	REAL(10) L_SCALE_FACTOR									   |		REAL*8 L_SCALE_FACTOR
./misc/extrap_scr.f
	  REAL(10), ALLOCATABLE :: WRK_POPS(:,:)		!NT,ND				   |		  REAL*8, ALLOCATABLE :: WRK_POPS(:,:)		!NT,ND
	  REAL(10), ALLOCATABLE :: POPS(:,:)		!NT,ND					   |		  REAL*8, ALLOCATABLE :: POPS(:,:)		!NT,ND
	  REAL(10), ALLOCATABLE :: R(:)			!ND					   |		  REAL*8, ALLOCATABLE :: R(:)			!ND
	  REAL(10), ALLOCATABLE :: V(:)			!ND					   |		  REAL*8, ALLOCATABLE :: V(:)			!ND
	  REAL(10), ALLOCATABLE :: SIGMA(:)		!ND					   |		  REAL*8, ALLOCATABLE :: SIGMA(:)		!ND
	  REAL(10) SN_AGE									   |		  REAL*8 SN_AGE
	REAL(10), ALLOCATABLE :: X1(:),X2(:)							   |		REAL*8, ALLOCATABLE :: X1(:),X2(:)
	REAL(10), ALLOCATABLE :: Y1(:),Y2(:)							   |		REAL*8, ALLOCATABLE :: Y1(:),Y2(:)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	  X1=LOG(SCR(1)%V)									   |		  X1=DLOG(SCR(1)%V)
	  X2=LOG(SCR(2)%V); X1(1)=X2(1); X1(SCR(1)%ND)=X2(SCR(2)%ND)				   |		  X2=DLOG(SCR(2)%V); X1(1)=X2(1); X1(SCR(1)%ND)=X2(SCR(2)%ND)
	    Y1=LOG(SCR(1)%POPS(I,:))								   |		    Y1=DLOG(SCR(1)%POPS(I,:))
./misc/get_exc_freq.f
	REAL(10) EXC_EN										   |		REAL*8 EXC_EN
	REAL(10) PHOT_GION									   |		REAL*8 PHOT_GION
./misc/guess_dc.f
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TAU_ROSS(:)							   |		REAL*8, ALLOCATABLE :: TAU_ROSS(:)
	REAL(10), ALLOCATABLE :: TAU_ES(:)							   |		REAL*8, ALLOCATABLE :: TAU_ES(:)
!												   |	!
	REAL(10), ALLOCATABLE :: PHOT_SUM(:)							   |		REAL*8, ALLOCATABLE :: PHOT_SUM(:)
	REAL(10), ALLOCATABLE :: RECOM_SUM(:)							   |		REAL*8, ALLOCATABLE :: RECOM_SUM(:)
	REAL(10), ALLOCATABLE :: GS_DC(:)							   |		REAL*8, ALLOCATABLE :: GS_DC(:)
	REAL(10), ALLOCATABLE :: DC(:,:)							   |		REAL*8, ALLOCATABLE :: DC(:,:)
	REAL(10), ALLOCATABLE :: T_EXC(:)							   |		REAL*8, ALLOCATABLE :: T_EXC(:)
	REAL(10), ALLOCATABLE :: GS_ION_POP(:)							   |		REAL*8, ALLOCATABLE :: GS_ION_POP(:)
	REAL(10), ALLOCATABLE :: DC_RUB(:)							   |		REAL*8, ALLOCATABLE :: DC_RUB(:)
	REAL(10), POINTER :: RJ(:,:)								   |		REAL*8, POINTER :: RJ(:,:)
	REAL(10), POINTER :: NU(:)								   |		REAL*8, POINTER :: NU(:)
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ION_POP(:)							   |		REAL*8, ALLOCATABLE :: ION_POP(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: WORK(:)							   |		REAL*8, ALLOCATABLE :: WORK(:)
	REAL(10) FEDGE(N_MAX)									   |		REAL*8 FEDGE(N_MAX)
	REAL(10) ENERGY(N_MAX)									   |		REAL*8 ENERGY(N_MAX)
	REAL(10) G(N_MAX)									   |		REAL*8 G(N_MAX)
	REAL(10) ION_EN										   |		REAL*8 ION_EN
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) NU1,NU2									   |		REAL*8 NU1,NU2
	REAL(10) RJ1,RJ2									   |		REAL*8 RJ1,RJ2
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    T1=LOG(2.07078D-22*ED(I)*DC(1,I))							   |		    T1=DLOG(2.07078D-22*ED(I)*DC(1,I))
./misc/land_col_merge.f
./misc/land_multi_merge.f
./misc/mass_sc.f
	REAL(10) AT_NO(MAX_EL)			!Atomic number					   |		REAL*8 AT_NO(MAX_EL)			!Atomic number
	REAL(10) AT_MASS(MAX_EL)			!Atomic mass(amu)			   |		REAL*8 AT_MASS(MAX_EL)			!Atomic mass(amu)
	REAL(10) ABUND(MAX_EL,MAX_ABUND)		!Fractional abundace (relative)		   |		REAL*8 ABUND(MAX_EL,MAX_ABUND)		!Fractional abundace (relative)
	REAL(10) MASS_FRAC(MAX_EL,MAX_ABUND)	!Mass fractional abundace.			   |		REAL*8 MASS_FRAC(MAX_EL,MAX_ABUND)	!Mass fractional abundace.
	REAL(10) NEW_ABUND(MAX_EL,MAX_ABUND)							   |		REAL*8 NEW_ABUND(MAX_EL,MAX_ABUND)
	REAL(10) NEW_MASS_FRAC(MAX_EL,MAX_ABUND)						   |		REAL*8 NEW_MASS_FRAC(MAX_EL,MAX_ABUND)
	REAL(10) MASS										   |		REAL*8 MASS
	REAL(10) OLD_MASS_SUM									   |		REAL*8 OLD_MASS_SUM
	REAL(10) NEW_MASS_SUM									   |		REAL*8 NEW_MASS_SUM
	REAL(10) NHE										   |		REAL*8 NHE
./misc/merge_scr.f
	  REAL(10), ALLOCATABLE :: WRK_POPS(:,:)		!NT,ND				   |		  REAL*8, ALLOCATABLE :: WRK_POPS(:,:)		!NT,ND
	  REAL(10), ALLOCATABLE :: POPS(:,:)		!NT,ND					   |		  REAL*8, ALLOCATABLE :: POPS(:,:)		!NT,ND
	  REAL(10), ALLOCATABLE :: R(:)			!ND					   |		  REAL*8, ALLOCATABLE :: R(:)			!ND
	  REAL(10), ALLOCATABLE :: V(:)			!ND					   |		  REAL*8, ALLOCATABLE :: V(:)			!ND
	  REAL(10), ALLOCATABLE :: SIGMA(:)		!ND					   |		  REAL*8, ALLOCATABLE :: SIGMA(:)		!ND
	  REAL(10) SN_AGE									   |		  REAL*8 SN_AGE
	REAL(10), ALLOCATABLE :: X1(:),X2(:)							   |		REAL*8, ALLOCATABLE :: X1(:),X2(:)
	REAL(10), ALLOCATABLE :: Y1(:),Y2(:)							   |		REAL*8, ALLOCATABLE :: Y1(:),Y2(:)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	  X1=LOG(SCR(1)%V)									   |		  X1=DLOG(SCR(1)%V)
	  X2=LOG(SCR(2)%V); X1(1)=X2(1); X1(SCR(1)%ND)=X2(SCR(2)%ND)				   |		  X2=DLOG(SCR(2)%V); X1(1)=X2(1); X1(SCR(1)%ND)=X2(SCR(2)%ND)
	    Y1=LOG(SCR(1)%POPS(I,:))								   |		    Y1=DLOG(SCR(1)%POPS(I,:))
./misc/mod_cool.f
												   >	! Altered: 24-Sep-2023  Added SHOCK_POWER term (5-Sep-2023).
	REAL(10) VALS(MAX_RECS,10)								   |		REAL*8 VALS(MAX_RECS,10)
	REAL(10) TA(MAX_RECS)									   |		REAL*8 TA(MAX_RECS)
	REAL(10), ALLOCATABLE :: BOUND(:)							   |		REAL*8, ALLOCATABLE :: BOUND(:)
	REAL(10), ALLOCATABLE :: SUM(:)								   |		REAL*8, ALLOCATABLE :: SUM(:)
	REAL(10), ALLOCATABLE :: TOTAL_RATE(:)							   |		REAL*8, ALLOCATABLE :: TOTAL_RATE(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: ATOM_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: ATOM_DENSITY(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: NET_RATE(:)							   |		REAL*8, ALLOCATABLE :: NET_RATE(:)
	REAL(10), ALLOCATABLE :: COOLING_TIME(:)						   |		REAL*8, ALLOCATABLE :: COOLING_TIME(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RAD_DECAY(:)							   |		REAL*8, ALLOCATABLE :: RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: COL_RATE(:)							   |		REAL*8, ALLOCATABLE :: SHOCK_POWER(:)
	REAL(10), ALLOCATABLE :: BF_RATE(:)							   |		REAL*8, ALLOCATABLE :: COL_RATE(:)
	REAL(10), ALLOCATABLE :: FF_RATE(:)							   |		REAL*8, ALLOCATABLE :: BF_RATE(:)
	REAL(10), ALLOCATABLE :: XKS_RATE(:)							   |		REAL*8, ALLOCATABLE :: FF_RATE(:)
	REAL(10), ALLOCATABLE :: NT_RATE(:)							   |		REAL*8, ALLOCATABLE :: XKS_RATE(:)
	REAL(10), ALLOCATABLE :: CHG_RATE(:)							   |		REAL*8, ALLOCATABLE :: NT_RATE(:)
	REAL(10), ALLOCATABLE :: ART_HT(:)							   |		REAL*8, ALLOCATABLE :: CHG_RATE(:)
	REAL(10), ALLOCATABLE :: AC_RV(:)							   |		REAL*8, ALLOCATABLE :: ART_HT(:)
	REAL(10), ALLOCATABLE :: AC_RdT(:)							   |		REAL*8, ALLOCATABLE :: AC_RV(:)
												   >		REAL*8, ALLOCATABLE :: AC_RdT(:)
	REAL(10) T1										   |		REAL*8 T1
	ALLOCATE (RAD_DECAY(ND)); RAD_DECAY=0.0D0						   |		ALLOCATE (RAD_DECAY(ND));    RAD_DECAY=0.0D0
	ALLOCATE (COL_RATE(ND));   COL_RATE=0.0D0						   |		ALLOCATE (SHOCK_POWER(ND)); SHOCK_POWER=0.0D0
	ALLOCATE (BF_RATE(ND));     BF_RATE=0.0D0						   |		ALLOCATE (COL_RATE(ND));       COL_RATE=0.0D0
	ALLOCATE (FF_RATE(ND));     FF_RATE=0.0D0						   |		ALLOCATE (BF_RATE(ND));        BF_RATE=0.0D0
	ALLOCATE (NT_RATE(ND));     NT_RATE=0.0D0						   |		ALLOCATE (FF_RATE(ND));        FF_RATE=0.0D0
	ALLOCATE (XKS_RATE(ND));   XKS_RATE=0.0D0						   |		ALLOCATE (NT_RATE(ND));        NT_RATE=0.0D0
	ALLOCATE (ART_HT(ND));       ART_HT=0.0D0						   |		ALLOCATE (XKS_RATE(ND));      XKS_RATE=0.0D0
	ALLOCATE (CHG_RATE(ND));   CHG_RATE=0.0D0						   |		ALLOCATE (ART_HT(ND));          ART_HT=0.0D0
	ALLOCATE (AC_RV(ND));         AC_RV=0.0D0						   |		ALLOCATE (CHG_RATE(ND));      CHG_RATE=0.0D0
	ALLOCATE (AC_RdT(ND));       AC_RDT=0.0D0						   |		ALLOCATE (AC_RV(ND));            AC_RV=0.0D0
												   >		ALLOCATE (AC_RdT(ND));          AC_RDT=0.0D0
												   >		      ELSE IF( INDEX(STRING,'Shock Power Term') .NE. 0)THEN
												   >		        TMP_STR=STRING
												   >		        TMP_STR=ADJUSTL(TMP_STR)
												   >		        K=INDEX(TMP_STR,' ')
												   >		        READ(20,'(A)')STRING
												   >		        CALL SUM_RATES(TOTAL_RATE,SHOCK_POWER,STRING,ID,ND)
												   >		        WRITE(21,'(A,T12,A)')'|Sh. Pow.|',TRIM(STRING)
	TOTAL_RATE=TOTAL_RATE+AC_RdT+CHG_RATE-RAD_DECAY-ART_HT					   |		TOTAL_RATE=TOTAL_RATE+AC_RdT+CHG_RATE-RAD_DECAY-ART_HT-SHOCK_POWER
												   >		  WRITE(22,'(A,T12,10ES12.4)')' |Sh. Pow.|',(SHOCK_POWER(K),K=ID,MIN(ID+9,ND))
	REAL(10) TOTAL_RATE(ND)									   |		REAL*8 TOTAL_RATE(ND)
	REAL(10) SPECIFIC_RATE(ND)								   |		REAL*8 SPECIFIC_RATE(ND)
	REAL(10) TEMP_VEC(ND)									   |		REAL*8 TEMP_VEC(ND)
./misc/mod_prrr.f
	REAL(10), ALLOCATABLE :: PHOT(:,:)							   |		REAL*8, ALLOCATABLE :: PHOT(:,:)
	REAL(10), ALLOCATABLE :: RECOM(:,:)							   |		REAL*8, ALLOCATABLE :: RECOM(:,:)
	REAL(10), ALLOCATABLE :: RECOM_SUM(:)							   |		REAL*8, ALLOCATABLE :: RECOM_SUM(:)
	REAL(10), ALLOCATABLE :: PHOT_SUM(:)							   |		REAL*8, ALLOCATABLE :: PHOT_SUM(:)
	REAL(10), ALLOCATABLE :: COL_IR(:)							   |		REAL*8, ALLOCATABLE :: COL_IR(:)
	REAL(10), ALLOCATABLE :: CHG_IR(:)							   |		REAL*8, ALLOCATABLE :: CHG_IR(:)
	REAL(10), ALLOCATABLE :: NT_IR(:)							   |		REAL*8, ALLOCATABLE :: NT_IR(:)
	REAL(10), ALLOCATABLE :: COL_RR(:)							   |		REAL*8, ALLOCATABLE :: COL_RR(:)
	REAL(10), ALLOCATABLE :: XRAY_RR(:)							   |		REAL*8, ALLOCATABLE :: XRAY_RR(:)
	REAL(10), ALLOCATABLE :: RR_COEF(:)							   |		REAL*8, ALLOCATABLE :: RR_COEF(:)
	REAL(10), ALLOCATABLE :: CHG_RR(:)							   |		REAL*8, ALLOCATABLE :: CHG_RR(:)
	REAL(10), ALLOCATABLE :: ADVEC_RR(:)							   |		REAL*8, ALLOCATABLE :: ADVEC_RR(:)
!												   |	!
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: TEMP(:)							   |		REAL*8, ALLOCATABLE :: TEMP(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: DI(:)								   |		REAL*8, ALLOCATABLE :: DI(:)
!												   |	!
	REAL(10), ALLOCATABLE :: XVEC(:)							   |		REAL*8, ALLOCATABLE :: XVEC(:)
	REAL(10), ALLOCATABLE :: YVEC(:)							   |		REAL*8, ALLOCATABLE :: YVEC(:)
	REAL(10), ALLOCATABLE :: TOT_SUM(:)							   |		REAL*8, ALLOCATABLE :: TOT_SUM(:)
	REAL(10), ALLOCATABLE :: YLEV(:)							   |		REAL*8, ALLOCATABLE :: YLEV(:)
	REAL(10), ALLOCATABLE :: XLEV(:)							   |		REAL*8, ALLOCATABLE :: XLEV(:)
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) MIN_VAL									   |		REAL*8 MIN_VAL
	REAL(10) XVEC(ND)									   |		REAL*8 XVEC(ND)
	REAL(10) PHOT_SUM(ND)									   |		REAL*8 PHOT_SUM(ND)
	REAL(10) TOT_SUM(ND)									   |		REAL*8 TOT_SUM(ND)
	REAL(10) YVEC(ND)									   |		REAL*8 YVEC(ND)
./misc/n_col_merge.f
./misc/n_multi_merge.f
./misc/n_pair_merge.f
./misc/output_term_seq.f
	REAL(10) STAT_WGT(NLEV)									   |		REAL*8 STAT_WGT(NLEV)
	REAL(10) FEDGE(NLEV)									   |		REAL*8 FEDGE(NLEV)
./misc/pack_osc.f
	REAL(10) FEDGE(NLEV)									   |		REAL*8 FEDGE(NLEV)
	REAL(10) ENERGY(NLEV)									   |		REAL*8 ENERGY(NLEV)
	REAL(10) G(NLEV)									   |		REAL*8 G(NLEV)
	REAL(10) LAM_EDGE(NLEV)									   |		REAL*8 LAM_EDGE(NLEV)
	REAL(10) E_STRT(NLEV)									   |		REAL*8 E_STRT(NLEV)
!												   |	!
	REAL(10) EDGE_SUM(NLEV)									   |		REAL*8 EDGE_SUM(NLEV)
	REAL(10) G_SUM(NLEV)									   |		REAL*8 G_SUM(NLEV)
	REAL(10) FOSC(NLEV,NLEV)								   |		REAL*8 FOSC(NLEV,NLEV)
	REAL(10) GF_CUT										   |		REAL*8 GF_CUT
	REAL(10) AT_NO										   |		REAL*8 AT_NO
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) ZION_RD									   |		REAL*8 ZION_RD
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) PHOT_GION									   |		REAL*8 PHOT_GION
	REAL(10) EXC_EN										   |		REAL*8 EXC_EN
	REAL(10) ION_EN										   |		REAL*8 ION_EN
	REAL(10) VSM_DIE_KMS									   |		REAL*8 VSM_DIE_KMS
	REAL(10) SIG_GAU_KMS									   |		REAL*8 SIG_GAU_KMS
	REAL(10) FRAC_SIG_GAU									   |		REAL*8 FRAC_SIG_GAU
	REAL(10) CUT_ACCURACY									   |		REAL*8 CUT_ACCURACY
	REAL(10) EMIN_PACK									   |		REAL*8 EMIN_PACK
	REAL(10), ALLOCATABLE :: EDGE_PACK(:)							   |		REAL*8, ALLOCATABLE :: EDGE_PACK(:)
	REAL(10), ALLOCATABLE :: FOSC_PACK(:,:)							   |		REAL*8, ALLOCATABLE :: FOSC_PACK(:,:)
	REAL(10), ALLOCATABLE :: G_PACK(:)							   |		REAL*8, ALLOCATABLE :: G_PACK(:)
	REAL(10), ALLOCATABLE :: RECOM_PACK(:,:)						   |		REAL*8, ALLOCATABLE :: RECOM_PACK(:,:)
	REAL(10), ALLOCATABLE :: ARAD(:)							   |		REAL*8, ALLOCATABLE :: ARAD(:)
	REAL(10), ALLOCATABLE :: GAM2(:)							   |		REAL*8, ALLOCATABLE :: GAM2(:)
	REAL(10), ALLOCATABLE :: GAM4(:)							   |		REAL*8, ALLOCATABLE :: GAM4(:)
	REAL(10), ALLOCATABLE :: FLOW_SUM(:)							   |		REAL*8, ALLOCATABLE :: FLOW_SUM(:)
	REAL(10), ALLOCATABLE :: FHIGH_SUM(:)							   |		REAL*8, ALLOCATABLE :: FHIGH_SUM(:)
	REAL(10), ALLOCATABLE :: ALOW_SUM(:)							   |		REAL*8, ALLOCATABLE :: ALOW_SUM(:)
	REAL(10), ALLOCATABLE :: AHIGH_SUM(:)							   |		REAL*8, ALLOCATABLE :: AHIGH_SUM(:)
	REAL(10), ALLOCATABLE :: FOSC_TMP(:,:)							   |		REAL*8, ALLOCATABLE :: FOSC_TMP(:,:)
	REAL(10), ALLOCATABLE :: VEC_DP_WRK(:)							   |		REAL*8, ALLOCATABLE :: VEC_DP_WRK(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		DOUBLE PRECISION CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) G(NLEV)									   |		REAL*8 G(NLEV)
	REAL(10) T1										   |		REAL*8 T1
./misc/plt_alpha.f
	REAL(10) R(NMAX,2)									   |		REAL*8 R(NMAX,2)
	REAL(10) V(NMAX,2)									   |		REAL*8 V(NMAX,2)
	REAL(10) E(NMAX,2)									   |		REAL*8 E(NMAX,2)
	REAL(10) VdVdR(NMAX,2)									   |		REAL*8 VdVdR(NMAX,2)
	REAL(10) dPdR(NMAX,2)									   |		REAL*8 dPdR(NMAX,2)
	REAL(10) g_tot(NMAX,2)									   |		REAL*8 g_tot(NMAX,2)
	REAL(10) g_rad(NMAX,2)									   |		REAL*8 g_rad(NMAX,2)
	REAL(10) g_elec(NMAX,2)									   |		REAL*8 g_elec(NMAX,2)
	REAL(10) Gamma(NMAX,2)									   |		REAL*8 Gamma(NMAX,2)
	REAL(10) XV(NMAX)									   |		REAL*8 XV(NMAX)
	REAL(10) YV(NMAX)									   |		REAL*8 YV(NMAX)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) P_VEL(200)									   |		REAL*8 P_VEL(200)
	REAL(10) P_REQ(200)									   |		REAL*8 P_REQ(200)
	REAL(10) P_GRAD(200)									   |		REAL*8 P_GRAD(200)
	REAL(10) P_GELEC(200)									   |		REAL*8 P_GELEC(200)
./misc/plt_cmf_lum.f
												   >	! Altered: 30-Aug-2023 -- Added LOC_SHOCK and cleaned up curve labeling.
												   >	!                            Zero curves now omitted from plots.
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: POPS(:,:)							   |		REAL*8, ALLOCATABLE :: POPS(:,:)
	REAL(10), ALLOCATABLE :: XAXIS(:)							   |		REAL*8, ALLOCATABLE :: XAXIS(:)
!												   |	!
	REAL(10), ALLOCATABLE :: LUM(:)								   |		REAL*8, ALLOCATABLE :: LUM(:)
	REAL(10), ALLOCATABLE :: HJ_LUM(:)							   |		REAL*8, ALLOCATABLE :: HJ_LUM(:)
	REAL(10), ALLOCATABLE :: MECH(:)							   |		REAL*8, ALLOCATABLE :: MECH(:)
	REAL(10), ALLOCATABLE :: ADI(:)								   |		REAL*8, ALLOCATABLE :: LOC_SHOCK(:)
	REAL(10), ALLOCATABLE :: DJDT(:)							   |		REAL*8, ALLOCATABLE :: ADI(:)
	REAL(10), ALLOCATABLE :: dT_ON_T(:)							   |		REAL*8, ALLOCATABLE :: DJDT(:)
	REAL(10), ALLOCATABLE :: RAD_DECAY(:)							   |		REAL*8, ALLOCATABLE :: dT_ON_T(:)
	REAL(10), ALLOCATABLE :: TOTAL(:)							   |		REAL*8, ALLOCATABLE :: RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: CHANGE(:)							   |		REAL*8, ALLOCATABLE :: TOTAL(:)
	REAL(10), ALLOCATABLE :: WRK_VEC(:)							   |		REAL*8, ALLOCATABLE :: CHANGE(:)
												   >		REAL*8, ALLOCATABLE :: WRK_VEC(:)
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) T1										   |		REAL*8 T1
	LOGICAL HJ_NOT_ZERO									   |		LOGICAL NON_ZERO_HJ_LUM
												   >		LOGICAL NON_ZERO_MECH
												   >		LOGICAL NON_ZERO_ADI
												   >		LOGICAL NON_ZERO_DJDt
												   >		LOGICAL NON_ZERO_LOC_SHOCK
												   >		LOGICAL NON_ZERO_RAD_DECAY
												   >		IF(IOS .EQ. 0)ALLOCATE (LOC_SHOCK(ND),STAT=IOS)
	LUM=0.0D0; HJ_LUM=0.0D0; MECH=0.0D0; DJDT=0.0D0; ADI=0.0D0				   |		LUM=0.0D0; HJ_LUM=0.0D0; MECH=0.0D0; DJDT=0.0D0; ADI=0.0D0; LOC_SHOCK=0.0D0
	HJ_NOT_ZERO=.FALSE.									   <
												   >		  NON_ZERO_MECH=.FALSE.; NON_ZERO_LOC_SHOCK=.FALSE.
												   >		  NON_ZERO_ADI=.FALSE.; NON_ZERO_DJDT=.FALSE.
												   >		  NON_ZERO_HJ_LUM=.FALSE.; NON_ZERO_RAD_DECAY=.FALSE.
												   >		      IF(MAXVAL(ABS(MECH)) .GT. 0.0D0)NON_ZERO_MECH=.TRUE.
												   >		    ELSE IF(INDEX(STRING,'locally by the shock') .NE. 0)THEN
												   >		      READ(20,*)(LOC_SHOCK(I),I=1,ND)
												   >		      IF(MAXVAL(ABS(LOC_SHOCK)) .GT. 0.0D0)NON_ZERO_LOC_SHOCK=.TRUE.
												   >		      IF(MAXVAL(ABS(ADI)) .GT. 0.0D0)NON_ZERO_ADI=.TRUE.
												   >		      IF(MAXVAL(ABS(HJ_LUM)) .GT. 0.0D0)NON_ZERO_HJ_LUM=.TRUE.
												   >		      IF(MAXVAL(ABS(DJDt)) .GT. 0.0D0)NON_ZERO_DJDt=.TRUE.
												   >		      IF(MAXVAL(ABS(RAD_DECAY)) .GT. 0.0D0)NON_ZERO_RAD_DECAY=.TRUE.
	IF(SUM(HJ_LUM) .NE. 0.0D0)HJ_NOT_ZERO=.TRUE.						   <
	IF(HJ_NOT_ZERO)TOTAL=HJ_LUM								   |		IF(NON_ZERO_HJ_LUM)TOTAL=HJ_LUM
	  T1=T1+RAD_DECAY(I)-MECH(I)-ADI(I)-DJDT(I)						   |		  T1=T1+LOC_SHOCK(I)+RAD_DECAY(I)-MECH(I)-ADI(I)-DJDT(I)
	CALL DP_CURVE(ND,XAXIS,LUM)								   |		CALL DP_CURVE_LAB(ND,XAXIS,LUM,'L(cmf)')
	CALL DP_CURVE(ND,XAXIS,TOTAL)								   |		CALL DP_CURVE_LAB(ND,XAXIS,TOTAL,'L(cons)')
	CALL DP_CURVE(ND,XAXIS,dT_ON_T)								   |		CALL DP_CURVE_LAB(ND,XAXIS,dT_ON_T,'dT/T')
	CALL DP_CURVE(ND,XAXIS,WRK_VEC)								   |		CALL DP_CURVE_LAB(ND,XAXIS,WRK_VEC,'L(cons)')
	WRITE(6,'(3A)')PG_PEN(2)//' The "mechanical" luminosity contribution at each depth is pl   |		I=1
	WRITE(6,'(3A)')PG_PEN(3)//' The "adiabatic" luminosity contribution at each depth is plo   |		IF(NON_ZERO_RAD_DECAY)THEN
	WRITE(6,'(3A)')PG_PEN(4)//' The "DJDTt" luminosity contribution at each depth is plotted   |		  CALL DP_CURVE_LAB(ND,XAXIS,RAD_DECAY,'Rad. Dec.'); I=I+1
	WRITE(6,'(3A)')PG_PEN(5)//' The "radioactove"  contribution at each depth is plotted in    |		  WRITE(6,'(3A)')PG_PEN(I)//' The "radioactive decay" contribution at each depth.',DEF_P
	WRITE(6,*)' '										   |		END IF
	CALL DP_CURVE(ND,XAXIS,MECH)								   |		IF(NON_ZERO_LOC_SHOCK)THEN
	CALL DP_CURVE(ND,XAXIS,ADI)								   |		  CALL DP_CURVE_LAB(ND,XAXIS,LOC_SHOCK,'Shock');  I=I+1
	CALL DP_CURVE(ND,XAXIS,DJDT)								   |		  WRITE(6,'(3A)')PG_PEN(I)//' The "local shock" contribution at each depth.',DEF_PEN
	CALL DP_CURVE(ND,XAXIS,RAD_DECAY)							   |		END IF
												   >		IF(NON_ZERO_MECH)THEN
												   >		  CALL DP_CURVE_LAB(ND,XAXIS,MECH,'Mechanical');  I=I+1
												   >		  WRITE(6,'(3A)')PG_PEN(I)//' The "mechanical" luminosity contribution at each depth.',D
												   >		END IF
												   >		IF(NON_ZERO_ADI)THEN
												   >		  CALL DP_CURVE_LAB(ND,XAXIS,ADI,'Adibat.');    I=I+1
												   >		  WRITE(6,'(3A)')PG_PEN(I)//' The "adiabatic" luminosity contribution at each depth.',DE
												   >		END IF
												   >		IF(NON_ZERO_ADI)THEN
												   >		  CALL DP_CURVE_LAB(ND,XAXIS,DJDT,'DJDt');   I=I+1
												   >		  WRITE(6,'(3A)')PG_PEN(I)//' The "DJDt" luminosity contribution at each depth. ',DEF_PE
												   >		END IF
												   >		WRITE(6,*)' '
												   >		LOC_SHOCK(2:ND)=LOC_SHOCK(1:ND-1); LOC_SHOCK(1)=0.0D0
												   >		  LOC_SHOCK(I)=LOC_SHOCK(I)+LOC_SHOCK(I-1)
												   >		WRITE(6,*)
												   >		I=2
	CALL DP_CURVE(ND,XAXIS,TOTAL)								   |		CALL DP_CURVE_LAB(ND,XAXIS,TOTAL,'Cor. Lum.')
	WRITE(6,'(3A)')PG_PEN(3)//'    The term due to radioactive decay is in blue',DEF_PEN	   |		IF(NON_ZERO_RAD_DECAY)THEN
	CALL DP_CURVE(ND,XAXIS,RAD_DECAY)							   |		  CALL DP_CURVE_LAB(ND,XAXIS,RAD_DECAY,'Rad. decay'); I=I+1
												   >		  WRITE(6,'(3A)')PG_PEN(I)//'    The term due to radioactive decay',DEF_PEN
												   >		END IF
												   >	!
												   >		IF(NON_ZERO_LOC_SHOCK)THEN
												   >		  CALL DP_CURVE_LAB(ND,XAXIS,LOC_SHOCK,'Shock');  I=I+1
												   >		WRITE(6,'(3A)')PG_PEN(I)//'  Local shock energy is in yellow',DEF_PEN
												   >		END IF
	WRITE(6,'(3A)')PG_PEN(4)//'                       The DJDT term is in green',DEF_PEN	   |		IF(NON_ZERO_DJDt)THEN
	CALL DP_CURVE(ND,XAXIS,DJDT)								   |		  CALL DP_CURVE_LAB(ND,XAXIS,DJDT,'DJDt');   I=I+1
												   >		  WRITE(6,'(3A)')PG_PEN(I)//'                       The DJDT term is in green',DEF_PEN
												   >		END IF
	WRITE(6,'(3A)')PG_PEN(5)//'      The work on the gas term (MECH) is in purple',DEF_PEN	   |		IF(NON_ZERO_MECH)THEN
	CALL DP_CURVE(ND,XAXIS,MECH)								   |		  CALL DP_CURVE_LAB(ND,XAXIS,MECH,'Mech.');    I=I+1
												   >		  WRITE(6,'(3A)')PG_PEN(I)//'      The work on the gas term (MECH) is in purple',DEF_PEN
												   >		END IF
	WRITE(6,'(3A)')PG_PEN(6)//'  Adiabatic cooling/internal energy is in pink',DEF_PEN	   |		IF(NON_ZERO_ADI)THEN
	CALL DP_CURVE(ND,XAXIS,ADI)								   |		  CALL DP_CURVE_LAB(ND,XAXIS,ADI,'Adiab.');  I=I+1
												   >		  WRITE(6,'(3A)')PG_PEN(I)//'  Adiabatic cooling/internal energy is in pink',DEF_PEN
												   >		END IF
	WRITE(6,'(3A)')PG_PEN(7)//' The total of the corrections terms in in yellow',DEF_PEN	   |		I=I+1
	CHANGE=MECH+ADI+DJDT+RAD_DECAY								   |		WRITE(6,'(3A)')PG_PEN(I)//' The total of the corrections terms in in yellow',DEF_PEN
												   >		CHANGE=MECH+ADI+DJDT+RAD_DECAY+LOC_SHOCK
												   >		CALL DP_CURVE_LAB(ND,XAXIS,CHANGE,'Total Cor.')
												   >		WRITE(6,*)'MECH',MECH(ND)
												   >		WRITE(6,*)'ADI',ADI(ND)
												   >		WRITE(6,*)'DJDT',DJDT(ND)
												   >		WRITE(6,*)'RAD_DECAY',RAD_DECAY(ND)
												   >		WRITE(6,*)'LOC_SHOCK',LOC_SHOCK(ND)
	CALL DP_CURVE(ND,XAXIS,CHANGE)								   <
	CALL DP_CURVE(ND,XAXIS,TOTAL)								   |		CALL DP_CURVE_LAB(ND,XAXIS,TOTAL,'Cor. Lum.')
	CALL DP_CURVE(ND,XAXIS,CHANGE)								   |		CALL DP_CURVE_LAB(ND,XAXIS,CHANGE,'Total Cor.')
./misc/plt_cool.f
	REAL(10) R(ND_MAX)									   |		REAL*8 R(ND_MAX)
	REAL(10) T(ND_MAX)									   |		REAL*8 T(ND_MAX)
	REAL(10) ED(ND_MAX)									   |		REAL*8 ED(ND_MAX)
	REAL(10) LUM(ND_MAX)									   |		REAL*8 LUM(ND_MAX)
	REAL(10) NET(ND_MAX)									   |		REAL*8 NET(ND_MAX)
	REAL(10) NET_PER(ND_MAX)								   |		REAL*8 NET_PER(ND_MAX)
	  ED(1:ND)=LOG10(ED(1:ND))								   |		  ED(1:ND)=DLOG10(ED(1:ND))
./misc/plt_cool_sort.f
												   >	! Altered: 24-Sep-2023  Added ATOM_DEN and SHOCK_POWER as variables (5-Sep-2023).
												   >	!                         NSH option added.
												   >	! Altered: 11-Sep-2024 -- Fixed labeling bug
	REAL(10) R(ND_MAX)									   |		REAL*8 R(ND_MAX)
	REAL(10) V(ND_MAX)									   |		REAL*8 V(ND_MAX)
	REAL(10) T(ND_MAX)									   |		REAL*8 T(ND_MAX)
	REAL(10) ED(ND_MAX)									   |		REAL*8 ED(ND_MAX)
	REAL(10) PER_CR(ND_MAX)									   |		REAL*8 ATOM_DEN(ND_MAX)
	REAL(10) NET_CR(ND_MAX)									   |		REAL*8 PER_CR(ND_MAX)
	REAL(10) COOL_TIME(ND_MAX)								   |		REAL*8 NET_CR(ND_MAX)
	REAL(10) XV(ND_MAX)									   |		REAL*8 COOL_TIME(ND_MAX)
	REAL(10) YV(ND_MAX)									   |		REAL*8 XV(ND_MAX)
	REAL(10) TOTAL(ND_MAX)									   |		REAL*8 YV(ND_MAX)
	REAL(10) TMP_VEC(ND_MAX)								   |		REAL*8 TOTAL(ND_MAX)
	REAL(10) LUM(NREC_MAX)									   |		REAL*8 TMP_VEC(ND_MAX)
	REAL(10) T1,T2										   |		REAL*8 LUM(NREC_MAX)
	REAL(10) LSTAR,LSUN									   |		REAL*8 T1,T2
!												   |		REAL*8 LSTAR,LSUN
	REAL(10), ALLOCATABLE :: RATE(:,:)							   |	!
	REAL(10), ALLOCATABLE :: VRATE(:,:)							   |		REAL*8, ALLOCATABLE :: RATE(:,:)
	REAL(10), ALLOCATABLE :: dLUM(:,:)							   |		REAL*8, ALLOCATABLE :: VRATE(:,:)
	REAL(10), ALLOCATABLE :: TMP_RATE(:,:)							   |		REAL*8, ALLOCATABLE :: dLUM(:,:)
												   >		REAL*8, ALLOCATABLE :: TMP_RATE(:,:)
	REAL(10) LUM_SUN									   |		REAL*8 LUM_SUN
	WRITE(6,'(A)')' This routine is still in devlopment and may need'			   |		WRITE(6,'(A)')' This routine is still in devlopment and may need further changes.'
	WRITE(6,'(A)')' further changes.'							   <
												   >	        CALL RD_SING_VEC_RVTJ(ATOM_DEN,ND,'Atom Density','RVTJ',LU_RD,IOS)
	WRITE(6,*)'Read in data'								   |		WRITE(6,'(/,2A,I4,3X,A,I3,A,/)')RED_PEN,' Read in data: ND=', ND,'NREC=',NREC,DEF_PEN
	WRITE(6,*)'ND=',ND									   <
	WRITE(6,*)'NREC=',NREC									   <
          PLT_OPT='P'										   |		  IF(FIRST_TIME)THEN
          CALL GEN_IN(PLT_OPT,'Plot option')							   |		  ELSE
	  CALL SET_CASE_UP(PLT_OPT,IZERO,IZERO)							   |	            PLT_OPT='P'
												   >	            CALL GEN_IN(PLT_OPT,'Plot option')
												   >		    CALL SET_CASE_UP(PLT_OPT,IZERO,IZERO)
												   >		  END IF
												   >	!
												   >		  ELSE IF(PLT_OPT .EQ. 'XLOGR')THEN
												   >		    XV(1:ND)=LOG10(R(1:ND)/R(ND))
												   >		    XAXIS='Log R/R(ND)'
												   >	!
	    WRITE(6,'(A,A)')'X vector is ',TRIM(XAXIS)						   |		    WRITE(6,'(/,A,A)')' X vector is ',TRIM(XAXIS)
	      T1=XV(1);  CALL GEN_IN(T1,'First depth for plotting')				   |		      T1=XV(1);  CALL GEN_IN(T1,'First depth for cooling selection')
	      T2=XV(ND); CALL GEN_IN(T2,'Last depth for plotting')				   |		      T2=XV(ND); CALL GEN_IN(T2,'Last depth for cooling slection')
	      T1=XV(ND); CALL GEN_IN(T1,'First depth for plotting')				   |		      T1=XV(ND); CALL GEN_IN(T1,'First depth for cooling selecton')
	      T2=XV(1);  CALL GEN_IN(T2,'Last depth for plotting')				   |		      T2=XV(1);  CALL GEN_IN(T2,'Last depth for cooling selection')
												   >		      IF(IST .GT. IEND)THEN
												   >		        I=IEND; IEND=IST; IST=I
												   >		      END IF
												   >	!
	    WRITE(6,*)'Deallocated TMP_RATE'							   <
	    WRITE(6,*)'Allocated TMP_RATE'							   <
												   >	!
	        CALL DP_CURVE_LAB(ND,XV,YV,LABEL(L))						   |		        CALL DP_CURVE_LAB(ND,XV,YV,LABEL(POINT(L)))
	    WRITE(6,*)IVEC									   <
												   >		  ELSE IF(PLT_OPT .EQ. 'NSH')THEN
												   >		    DO I=1,NREC
												   >		      IF(LABEL(I) .EQ. '|Sh. Pow.|')THEN
												   >		        DO K=1,ND
												   >		          YV(K)=RATE(I,K)/ED(K)/ATOM_DEN(K)
												   >		        END DO
												   >		        CALL DP_CURVE(ND,XV,YV)
												   >		      END IF
												   >		    END DO
												   >	!
												   >		     WRITE(6,'(A)')'XLOGR      Set X axis to Log R/R*'
												   >		     WRITE(6,'(A)')'NSH        Plot shock power normalized by density'
./misc/plt_ddt_work.f
	REAL(10) R(ND_MAX)									   |		REAL*8 R(ND_MAX)
	REAL(10) ED(ND_MAX)									   |		REAL*8 ED(ND_MAX)
	REAL(10) XVEC(ND_MAX)									   |		REAL*8 XVEC(ND_MAX)
	REAL(10) T(ND_MAX)									   |		REAL*8 T(ND_MAX)
	REAL(10) OLD_T(ND_MAX)									   |		REAL*8 OLD_T(ND_MAX)
	REAL(10) ER(ND_MAX)									   |		REAL*8 ER(ND_MAX)
	REAL(10) OLD_ER(ND_MAX)									   |		REAL*8 OLD_ER(ND_MAX)
	REAL(10) EK(ND_MAX)									   |		REAL*8 EK(ND_MAX)
	REAL(10) OLD_EK(ND_MAX)									   |		REAL*8 OLD_EK(ND_MAX)
	REAL(10) IE(ND_MAX)									   |		REAL*8 IE(ND_MAX)
	REAL(10) OLD_IE(ND_MAX)									   |		REAL*8 OLD_IE(ND_MAX)
	REAL(10) CHI(ND_MAX)									   |		REAL*8 CHI(ND_MAX)
	REAL(10) RSQJ(ND_MAX)									   |		REAL*8 RSQJ(ND_MAX)
	REAL(10) RSQH(ND_MAX)									   |		REAL*8 RSQH(ND_MAX)
	REAL(10) OLD_RSQJ(ND_MAX)								   |		REAL*8 OLD_RSQJ(ND_MAX)
	REAL(10) E_RSQJ(ND_MAX)									   |		REAL*8 E_RSQJ(ND_MAX)
	REAL(10) T1										   |		REAL*8 T1
./misc/plt_gf.f
	REAL(10) V(ND_MAX)									   |		REAL*8 V(ND_MAX)
	REAL(10) INDX(ND_MAX)									   |		REAL*8 INDX(ND_MAX)
	REAL(10) FRAC(ND_MAX,12)								   |		REAL*8 FRAC(ND_MAX,12)
	REAL(10) LAM(12)									   |		REAL*8 LAM(12)
./misc/plt_hydro.f
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) STAR_MASS									   |		REAL*8 STAR_MASS
	REAL(10) GRAVITATIONAL_CONSTANT, MASS_SUN,BOLTZMANN_CONSTANT				   |		REAL*8 GRAVITATIONAL_CONSTANT, MASS_SUN,BOLTZMANN_CONSTANT
	  REAL(10), ALLOCATABLE :: R(:)								   |		  REAL*8, ALLOCATABLE :: R(:)
	  REAL(10), ALLOCATABLE :: VEL(:)							   |		  REAL*8, ALLOCATABLE :: VEL(:)
	  REAL(10), ALLOCATABLE :: dVdR(:)							   |		  REAL*8, ALLOCATABLE :: dVdR(:)
	  REAL(10), ALLOCATABLE :: VdVdR(:)							   |		  REAL*8, ALLOCATABLE :: VdVdR(:)
	  REAL(10), ALLOCATABLE :: dPdR(:)							   |		  REAL*8, ALLOCATABLE :: dPdR(:)
	  REAL(10), ALLOCATABLE :: dTPdR(:)							   |		  REAL*8, ALLOCATABLE :: dTPdR(:)
	  REAL(10), ALLOCATABLE :: REQ(:)							   |		  REAL*8, ALLOCATABLE :: REQ(:)
	  REAL(10), ALLOCATABLE :: GRAD(:)							   |		  REAL*8, ALLOCATABLE :: GRAD(:)
	  REAL(10), ALLOCATABLE :: GELEC(:)							   |		  REAL*8, ALLOCATABLE :: GELEC(:)
	  REAL(10), ALLOCATABLE :: GAM(:)							   |		  REAL*8, ALLOCATABLE :: GAM(:)
	  REAL(10), ALLOCATABLE :: GTOT(:)							   |		  REAL*8, ALLOCATABLE :: GTOT(:)
	  REAL(10), ALLOCATABLE :: GRAV(:)							   |		  REAL*8, ALLOCATABLE :: GRAV(:)
	  REAL(10), ALLOCATABLE :: ED(:)							   |		  REAL*8, ALLOCATABLE :: ED(:)
	  REAL(10), ALLOCATABLE :: ATOM(:)							   |		  REAL*8, ALLOCATABLE :: ATOM(:)
	  REAL(10), ALLOCATABLE :: TEMP(:)							   |		  REAL*8, ALLOCATABLE :: TEMP(:)
	  REAL(10), ALLOCATABLE :: GAS_PRES(:)							   |		  REAL*8, ALLOCATABLE :: GAS_PRES(:)
	  REAL(10), ALLOCATABLE :: TA(:)							   |		  REAL*8, ALLOCATABLE :: TA(:)
	  REAL(10), ALLOCATABLE :: TB(:)							   |		  REAL*8, ALLOCATABLE :: TB(:)
	  REAL(10), ALLOCATABLE :: XVEC(:)							   |		  REAL*8, ALLOCATABLE :: XVEC(:)
	  REAL(10), ALLOCATABLE :: YVEC(:)							   |		  REAL*8, ALLOCATABLE :: YVEC(:)
	  REAL(10), ALLOCATABLE :: ZVEC(:)							   |		  REAL*8, ALLOCATABLE :: ZVEC(:)
	  REAL(10), ALLOCATABLE :: SOUND(:)							   |		  REAL*8, ALLOCATABLE :: SOUND(:)
	  REAL(10), ALLOCATABLE :: TAU(:)							   |		  REAL*8, ALLOCATABLE :: TAU(:)
	  REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		  REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	  REAL(10), ALLOCATABLE :: DENSITY(:)							   |		  REAL*8, ALLOCATABLE :: DENSITY(:)
	  REAL(10), ALLOCATABLE :: TAU_FLUX(:)							   |		  REAL*8, ALLOCATABLE :: TAU_FLUX(:)
	  REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		  REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	  REAL(10) STARS_MASS									   |		  REAL*8 STARS_MASS
	  REAL(10) STARS_MDOT									   |		  REAL*8 STARS_MDOT
	  REAL(10) DEP_WIND_MOM									   |		  REAL*8 DEP_WIND_MOM
	  REAL(10) WIND_MOM_MDOT								   |		  REAL*8 WIND_MOM_MDOT
	  REAL(10) TAU_SONIC									   |		  REAL*8 TAU_SONIC
	  REAL(10) R_SONIC									   |		  REAL*8 R_SONIC
	  REAL(10) C_SONIC									   |		  REAL*8 C_SONIC
	REAL(10), ALLOCATABLE :: DATA_VECS(:,:)							   |		REAL*8, ALLOCATABLE :: DATA_VECS(:,:)
	REAL(10), ALLOCATABLE :: COEF(:,:)							   |		REAL*8, ALLOCATABLE :: COEF(:,:)
												   >		ELSE IF(XOPT .EQ. 'DGRADV')THEN
												   >		  DO ID=1,NMOD
												   >		    ND=ATM(ID)%ND
												   >		    ATM(ID)%ZVEC=ATM(ID)%GRAD-0.99D0*MINVAL(ATM(ID)%GRAD)
												   >		    CALL DERIVCHI(ATM(ID)%YVEC,ATM(ID)%ZVEC,ATM(ID)%VEL,ND,'LINMON')
												   >		    ATM(ID)%YVEC=ATM(ID)%YVEC*ATM(ID)%VEL/ATM(ID)%ZVEC
												   >		    CALL DP_CURVE(ATM(ID)%ND,ATM(ID)%XVEC,ATM(ID)%YVEC)
												   >		  END DO
												   >		  YLAB=TRIM(YLAB)//'dln(Grad-Gmin)/dln(V)'
												   >	!
												   >	!
												   >	!
												   >		ELSE IF(XOPT .EQ. 'DPGAS')THEN
												   >		  DO ID=1,NMOD
												   >		    ND=ATM(ID)%ND
												   >		    IF(ALLOCATED(COEF))DEALLOCATE(COEF)
												   >		    ALLOCATE (COEF(ND,4))
												   >		    ATM(ID)%TA=ATM(ID)%GAS_PRES*ATM(ID)%CLUMP_FAC
												   >	            CALL MON_INT_FUNS_V2(COEF,ATM(ID)%TA,ATM(ID)%R,ND)
												   >		    ATM(ID)%YVEC=1.0D-10*COEF(:,3)/(ATM(ID)%DENSITY*ATM(ID)%CLUMP_FAC)
												   >		    CALL DP_CURVE(ND,ATM(ID)%XVEC,ATM(ID)%YVEC)
												   >		    ATM(ID)%REQ=ATM(ID)%VdVdR+ATM(ID)%YVEC+ATM(ID)%dTPdR+ATM(ID)%GRAV
												   >		  END DO
												   >		  YLAB=TRIM(YLAB)//'; dg\dPgas/dr'
./misc/plt_ion_mf.f
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: ES_KAPPA(:)							   |		REAL*8, ALLOCATABLE :: ES_KAPPA(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: ION_FLUX_MEAN(:,:)						   |		REAL*8, ALLOCATABLE :: ION_FLUX_MEAN(:,:)
	REAL(10), ALLOCATABLE :: DPTH_VEC(:)							   |		REAL*8, ALLOCATABLE :: DPTH_VEC(:)
	REAL(10), ALLOCATABLE :: WRK_VEC(:)							   |		REAL*8, ALLOCATABLE :: WRK_VEC(:)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) SUM_TO,SUM_FROM								   |		REAL*8 SUM_TO,SUM_FROM
./misc/plt_j_comp.f
	REAL(10) INDX(NCF_MAX)									   |		REAL*8 INDX(NCF_MAX)
	REAL(10) NU(NCF_MAX)									   |		REAL*8 NU(NCF_MAX)
	REAL(10) LAM(NCF_MAX)									   |		REAL*8 LAM(NCF_MAX)
!												   |	!
	REAL(10) JM_OUT(NCF_MAX)								   |		REAL*8 JM_OUT(NCF_MAX)
	REAL(10) JR_OUT(NCF_MAX)								   |		REAL*8 JR_OUT(NCF_MAX)
	REAL(10) DIFF_OUT(NCF_MAX)								   |		REAL*8 DIFF_OUT(NCF_MAX)
	REAL(10) HBC_CMF(NCF_MAX)								   |		REAL*8 HBC_CMF(NCF_MAX)
!												   |	!
	REAL(10) JM_IN(NCF_MAX)									   |		REAL*8 JM_IN(NCF_MAX)
	REAL(10) JR_IN(NCF_MAX)									   |		REAL*8 JR_IN(NCF_MAX)
	REAL(10) DIFF_IN(NCF_MAX)								   |		REAL*8 DIFF_IN(NCF_MAX)
	REAL(10) YV(NCF_MAX)									   |		REAL*8 YV(NCF_MAX)
	REAL(10) SUM1										   |		REAL*8 SUM1
	REAL(10) SUM2										   |		REAL*8 SUM2
	REAL(10) SUM3										   |		REAL*8 SUM3
	REAL(10) YV(NCF)									   |		REAL*8 YV(NCF)
	REAL(10) RJ(NCF)									   |		REAL*8 RJ(NCF)
./misc/plt_ln_heat.f
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: LAM(:)								   |		REAL*8, ALLOCATABLE :: LAM(:)
	REAL(10), ALLOCATABLE :: SCALE_FAC(:)							   |		REAL*8, ALLOCATABLE :: SCALE_FAC(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: Y(:)								   |		REAL*8, ALLOCATABLE :: Y(:)
	REAL(10) SUMD(NS_MAX)									   |		REAL*8 SUMD(NS_MAX)
	REAL(10), ALLOCATABLE :: LH(:,:)							   |		REAL*8, ALLOCATABLE :: LH(:,:)
	REAL(10), ALLOCATABLE :: SE_SCL(:,:)							   |		REAL*8, ALLOCATABLE :: SE_SCL(:,:)
	REAL(10), ALLOCATABLE :: SE_NOSCL(:,:)							   |		REAL*8, ALLOCATABLE :: SE_NOSCL(:,:)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) CUR_SUM									   |		REAL*8 CUR_SUM
./misc/plt_lte_ross.f
	REAL(10), ALLOCATABLE :: CHI(:,:)							   |		REAL*8, ALLOCATABLE :: CHI(:,:)
	REAL(10), ALLOCATABLE :: ESEC(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC(:,:)
	REAL(10), ALLOCATABLE :: KAP(:,:)							   |		REAL*8, ALLOCATABLE :: KAP(:,:)
	REAL(10), ALLOCATABLE :: KES(:,:)							   |		REAL*8, ALLOCATABLE :: KES(:,:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:,:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:,:)
	REAL(10), ALLOCATABLE :: ED(:,:)							   |		REAL*8, ALLOCATABLE :: ED(:,:)
	REAL(10), ALLOCATABLE :: RHO(:)								   |		REAL*8, ALLOCATABLE :: RHO(:)
	REAL(10), ALLOCATABLE :: TEMP(:)							   |		REAL*8, ALLOCATABLE :: TEMP(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10) ATOM_DEN									   |		REAL*8 ATOM_DEN
	REAL(10) KAP_VAL									   |		REAL*8 KAP_VAL
	REAL(10) KAP_ES										   |		REAL*8 KAP_ES
	REAL(10) LTE_ED										   |		REAL*8 LTE_ED
	REAL(10) TVAL										   |		REAL*8 TVAL
	REAL(10) DENSITY									   |		REAL*8 DENSITY
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) D1,D2										   |		REAL*8 D1,D2
	REAL(10) ALPHA										   |		REAL*8 ALPHA
./misc/plt_net.f
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: DI(:)								   |		REAL*8, ALLOCATABLE :: DI(:)
!												   |	!
	REAL(10), ALLOCATABLE :: PHOT_RATE(:,:)							   |		REAL*8, ALLOCATABLE :: PHOT_RATE(:,:)
	REAL(10), ALLOCATABLE :: REC_RATE(:,:)							   |		REAL*8, ALLOCATABLE :: REC_RATE(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: TOT_PHOT_RATE(:)						   |		REAL*8, ALLOCATABLE :: TOT_PHOT_RATE(:)
	REAL(10), ALLOCATABLE :: TOT_REC_RATE(:)						   |		REAL*8, ALLOCATABLE :: TOT_REC_RATE(:)
	REAL(10), ALLOCATABLE :: COL_ION_RATE(:)						   |		REAL*8, ALLOCATABLE :: COL_ION_RATE(:)
	REAL(10), ALLOCATABLE :: COL_REC_RATE(:)						   |		REAL*8, ALLOCATABLE :: COL_REC_RATE(:)
	REAL(10), ALLOCATABLE :: ADV_REC_RATE(:)						   |		REAL*8, ALLOCATABLE :: ADV_REC_RATE(:)
	REAL(10), ALLOCATABLE :: NT_ION_RATE(:)							   |		REAL*8, ALLOCATABLE :: NT_ION_RATE(:)
	REAL(10), ALLOCATABLE :: XRAY_REC_RATE_PS(:)						   |		REAL*8, ALLOCATABLE :: XRAY_REC_RATE_PS(:)
	REAL(10), ALLOCATABLE :: XRAY_REC_RATE_GS(:)						   |		REAL*8, ALLOCATABLE :: XRAY_REC_RATE_GS(:)
	REAL(10), ALLOCATABLE :: REC_COEF(:)							   |		REAL*8, ALLOCATABLE :: REC_COEF(:)
	REAL(10), ALLOCATABLE :: NET(:)								   |		REAL*8, ALLOCATABLE :: NET(:)
!												   |	!
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10) SUM_VAL									   |		REAL*8 SUM_VAL
./misc/plt_non_therm.f
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: RAD_ENERGY(:)							   |		REAL*8, ALLOCATABLE :: RAD_ENERGY(:)
	REAL(10), ALLOCATABLE :: XAXIS(:)							   |		REAL*8, ALLOCATABLE :: XAXIS(:)
	REAL(10), ALLOCATABLE :: XKT(:)								   |		REAL*8, ALLOCATABLE :: XKT(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: LELEC(:)							   |		REAL*8, ALLOCATABLE :: LELEC(:)
	REAL(10), ALLOCATABLE :: YE(:,:)							   |		REAL*8, ALLOCATABLE :: YE(:,:)
	REAL(10) E_EV(NX)									   |		REAL*8 E_EV(NX)
	REAL(10) ED_EV(NX)									   |		REAL*8 ED_EV(NX)
	REAL(10) dX										   |		REAL*8 dX
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) THERMAL_ED									   |		REAL*8 THERMAL_ED
	REAL(10) NON_THERMAL_ED									   |		REAL*8 NON_THERMAL_ED
./misc/plt_q_col.f
	REAL(10) Q(NKT)										   |		REAL*8 Q(NKT)
	REAL(10) COL_STRENGTH(NKT)								   |		REAL*8 COL_STRENGTH(NKT)
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT(NKT)									   |		REAL*8 dXKT(NKT)
!												   |	!
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10) ECOL(100),YCOL(100)								   |		REAL*8 ECOL(100),YCOL(100)
	REAL(10) GBAR(NKT)									   |		REAL*8 GBAR(NKT)
	REAL(10) X										   |		REAL*8 X
	REAL(10) U1										   |		REAL*8 U1
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
!												   |	!
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) GLOW										   |		REAL*8 GLOW
	REAL(10) FVAL										   |		REAL*8 FVAL
	REAL(10) OMEGA										   |		REAL*8 OMEGA
	REAL(10) ARN_HeI(5)									   |		REAL*8 ARN_HeI(5)
	    T2=LOG(U1)										   |		    T2=DLOG(U1)
./misc/plt_rates.f
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: LAM(:)								   |		REAL*8, ALLOCATABLE :: LAM(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10), ALLOCATABLE :: LONG_XV(:)							   |		REAL*8, ALLOCATABLE :: LONG_XV(:)
	REAL(10), ALLOCATABLE :: LONG_YV(:)							   |		REAL*8, ALLOCATABLE :: LONG_YV(:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: STAT_WT(:)							   |		REAL*8, ALLOCATABLE :: STAT_WT(:)
	REAL(10), ALLOCATABLE :: ENERGY(:)							   |		REAL*8, ALLOCATABLE :: ENERGY(:)
	REAL(10), ALLOCATABLE :: FEDGE(:)							   |		REAL*8, ALLOCATABLE :: FEDGE(:)
	REAL(10) IONIZATION_ENERGY,ZION								   |		REAL*8 IONIZATION_ENERGY,ZION
	REAL(10), ALLOCATABLE :: RATES(:,:)							   |		REAL*8, ALLOCATABLE :: RATES(:,:)
	REAL(10), ALLOCATABLE :: NEW_RATES(:,:)							   |		REAL*8, ALLOCATABLE :: NEW_RATES(:,:)
	REAL(10), ALLOCATABLE :: SUM_RATES(:)							   |		REAL*8, ALLOCATABLE :: SUM_RATES(:)
	REAL(10),  ALLOCATABLE :: NT_RATES(:,:)							   |		REAL*8,  ALLOCATABLE :: NT_RATES(:,:)
	REAL(10),  ALLOCATABLE :: NEW_NT_RATES(:,:)						   |		REAL*8,  ALLOCATABLE :: NEW_NT_RATES(:,:)
	REAL(10),  ALLOCATABLE :: COL_RATES(:,:)						   |		REAL*8,  ALLOCATABLE :: COL_RATES(:,:)
	REAL(10),  ALLOCATABLE :: NEW_COL_RATES(:,:)						   |		REAL*8,  ALLOCATABLE :: NEW_COL_RATES(:,:)
	REAL(10), ALLOCATABLE :: PHOT_RATE(:,:)							   |		REAL*8, ALLOCATABLE :: PHOT_RATE(:,:)
	REAL(10), ALLOCATABLE :: REC_RATE(:,:)							   |		REAL*8, ALLOCATABLE :: REC_RATE(:,:)
	REAL(10), ALLOCATABLE :: AUTO_RATE(:,:)							   |		REAL*8, ALLOCATABLE :: AUTO_RATE(:,:)
	REAL(10), ALLOCATABLE :: AUTO_REC_RATE(:,:)						   |		REAL*8, ALLOCATABLE :: AUTO_REC_RATE(:,:)
	REAL(10),  ALLOCATABLE :: DPTH_VEC(:)							   |		REAL*8,  ALLOCATABLE :: DPTH_VEC(:)
	REAL(10),  ALLOCATABLE :: NORM_VEC(:)							   |		REAL*8,  ALLOCATABLE :: NORM_VEC(:)
	REAL(10),  ALLOCATABLE :: WRK_VEC(:)							   |		REAL*8,  ALLOCATABLE :: WRK_VEC(:)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) RATE_THRESHOLD									   |		REAL*8 RATE_THRESHOLD
	REAL(10) SUM_TO,SUM_FROM								   |		REAL*8 SUM_TO,SUM_FROM
	REAL(10) NT_SUM_TO,NT_SUM_FROM								   |		REAL*8 NT_SUM_TO,NT_SUM_FROM
	REAL(10) COL_SUM_TO,COL_SUM_FROM							   |		REAL*8 COL_SUM_TO,COL_SUM_FROM
	REAL(10) NET_AUTO									   |		REAL*8 NET_AUTO
	REAL(10) MAX_RATE									   |		REAL*8 MAX_RATE
	REAL(10) CUR_SUM									   |		REAL*8 CUR_SUM
	  ELSE IF(UC(PLT_OPT(1:3)) .EQ. 'LID')THEN						   |		  ELSE IF(UC(PLT_OPT(1:4)) .EQ. 'LID')THEN
	    MAX_RATE=MAX(MAX_RATE,T1)								   <
												   >		    MAX_RATE=MAX(MAX_RATE,T1)
	    TMP_STR='(1X,A,T'//TMP_STR(1:2)//',ES15.4E5,3X,ES15.4E5,3X,F9.5)'			   |		    TMP_STR='(1X,A,T'//TMP_STR(1:2)//',F8.5,3X,F12.5,3X,F9.5)'
./misc/plt_raw_xray.f
	REAL(10) TSHOCK_1									   |		REAL*8 TSHOCK_1
	REAL(10) TSHOCK_2									   |		REAL*8 TSHOCK_2
	REAL(10) CONV_FACT									   |		REAL*8 CONV_FACT
./misc/rd_ba_mat.f
	REAL(10) POPS(N)									   |		REAL*8 POPS(N)
	REAL(10) STEQ(N)									   |		REAL*8 STEQ(N)
	REAL(10) CMAT(N,N)									   |		REAL*8 CMAT(N,N)
./misc/rd_f_to_s_ids.f
./misc/rd_f_to_s_ids_v2.f
./misc/recom_chk_v2.f
	REAL(10) RECOM(NC2)									   |		REAL*8 RECOM(NC2)
	REAL(10) EDGE_GS(NC2)									   |		REAL*8 EDGE_GS(NC2)
	REAL(10) GC2(NC2)									   |		REAL*8 GC2(NC2)
	REAL(10) GIONC2										   |		REAL*8 GIONC2
	REAL(10) EXC_EN										   |		REAL*8 EXC_EN
	REAL(10) T										   |		REAL*8 T
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) LOW_CROSS(NC2)									   |		REAL*8 LOW_CROSS(NC2)
	REAL(10) HIGH_CROSS(NC2)								   |		REAL*8 HIGH_CROSS(NC2)
	REAL(10) LTE_POP(NC2)									   |		REAL*8 LTE_POP(NC2)
C												   |	C
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) RGU										   |		REAL*8 RGU
	REAL(10) DEL_NU										   |		REAL*8 DEL_NU
	REAL(10) MAX_dNU									   |		REAL*8 MAX_dNU
	REAL(10) LOW_NU,HIGH_NU,HIGH_NU_MAX							   |		REAL*8 LOW_NU,HIGH_NU,HIGH_NU_MAX
	REAL(10) FOUR_PI_ON_H									   |		REAL*8 FOUR_PI_ON_H
	RGU=LOG(2.07078D-22)									   |		RGU=DLOG(2.07078D-22)
./misc/recomz.f
	REAL(10) Z,A,GAMMA,T,N,E,ALPHA								   |		REAL*8 Z,A,GAMMA,T,N,E,ALPHA
./misc/rev_hydro_file.f
	REAL(10) R										   |		REAL*8 R
	REAL(10) V										   |		REAL*8 V
	REAL(10) E										   |		REAL*8 E
	REAL(10) VdVdR										   |		REAL*8 VdVdR
	REAL(10) dPdR										   |		REAL*8 dPdR
	REAL(10) g_tot										   |		REAL*8 g_tot
	REAL(10) g_rad										   |		REAL*8 g_rad
	REAL(10) g_elec										   |		REAL*8 g_elec
	REAL(10) Gamma										   |		REAL*8 Gamma
	REAL(10) MT										   |		REAL*8 MT
	REAL(10) RND										   |		REAL*8 RND
	REAL(10) MASS_NEW									   |		REAL*8 MASS_NEW
	REAL(10) MASS_OLD									   |		REAL*8 MASS_OLD
	REAL(10) GSUR_NEW									   |		REAL*8 GSUR_NEW
	REAL(10) GSUR_OLD									   |		REAL*8 GSUR_OLD
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) GRAVITATIONAL_CONSTANT, MASS_SUN						   |		REAL*8 GRAVITATIONAL_CONSTANT, MASS_SUN
./misc/rev_hydro_turb.f
	REAL(10) R										   |		REAL*8 R
	REAL(10) RSQ										   |		REAL*8 RSQ
	REAL(10) V										   |		REAL*8 V
	REAL(10) E,E_ON_GRAD									   |		REAL*8 E,E_ON_GRAD
	REAL(10) VdVdR										   |		REAL*8 VdVdR
	REAL(10) dPdR										   |		REAL*8 dPdR
	REAL(10) g_tot										   |		REAL*8 g_tot
	REAL(10) g_rad										   |		REAL*8 g_rad
	REAL(10) g_elec										   |		REAL*8 g_elec
	REAL(10) Gamma										   |		REAL*8 Gamma
	REAL(10) MT										   |		REAL*8 MT
	REAL(10) RND										   |		REAL*8 RND
	REAL(10) MASS_NEW									   |		REAL*8 MASS_NEW
	REAL(10) MASS_OLD									   |		REAL*8 MASS_OLD
	REAL(10) GSUR_NEW									   |		REAL*8 GSUR_NEW
	REAL(10) GSUR_OLD									   |		REAL*8 GSUR_OLD
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) RPHOT										   |		REAL*8 RPHOT
!												   |	!
	REAL(10) dTPdR										   |		REAL*8 dTPdR
        REAL(10) VTURB										   |	        REAL*8 VTURB
	REAL(10) T1,T2										   |		REAL*8 T1,T2
        REAL(10) SUM_ERROR,SUM_R,DENOM,DEL_M							   |	        REAL*8 SUM_ERROR,SUM_R,DENOM,DEL_M
	REAL(10) GRAVITATIONAL_CONSTANT, MASS_SUN						   |		REAL*8 GRAVITATIONAL_CONSTANT, MASS_SUN
	REAL(10) P_R(200)									   |		REAL*8 P_R(200)
	REAL(10) P_VEL(200)									   |		REAL*8 P_VEL(200)
	REAL(10) P_dVdR(200)									   |		REAL*8 P_dVdR(200)
	REAL(10) P_dPdR(200)									   |		REAL*8 P_dPdR(200)
	REAL(10) P_REQ(200)									   |		REAL*8 P_REQ(200)
	REAL(10) P_GRAD(200)									   |		REAL*8 P_GRAD(200)
	REAL(10) P_GELEC(200)									   |		REAL*8 P_GELEC(200)
	REAL(10) P_GTOT(200)									   |		REAL*8 P_GTOT(200)
	REAL(10) P_GRAV(200)									   |		REAL*8 P_GRAV(200)
	REAL(10) ED(200)									   |		REAL*8 ED(200)
	REAL(10) TA(200)									   |		REAL*8 TA(200)
	REAL(10) XVEC(200)									   |		REAL*8 XVEC(200)
	REAL(10) YVEC(200)									   |		REAL*8 YVEC(200)
	REAL(10) ZVEC(200)									   |		REAL*8 ZVEC(200)
./misc/rev_rdinr.f
	REAL(10) R(MAX_ND)									   |		REAL*8 R(MAX_ND)
	REAL(10) DI(MAX_ND)									   |		REAL*8 DI(MAX_ND)
	REAL(10) ED(MAX_ND)									   |		REAL*8 ED(MAX_ND)
	REAL(10) T(MAX_ND)									   |		REAL*8 T(MAX_ND)
	REAL(10) IRAT(MAX_ND)									   |		REAL*8 IRAT(MAX_ND)
	REAL(10) VEL(MAX_ND)									   |		REAL*8 VEL(MAX_ND)
	REAL(10) CLUMP_FAC(MAX_ND)								   |		REAL*8 CLUMP_FAC(MAX_ND)
	REAL(10) OLD_TAU(MAX_ND)								   |		REAL*8 OLD_TAU(MAX_ND)
	REAL(10) TAU_SAV(MAX_ND)								   |		REAL*8 TAU_SAV(MAX_ND)
!												   |	!
	REAL(10) RTMP(MAX_ND)									   |		REAL*8 RTMP(MAX_ND)
	REAL(10) OLD_XV(MAX_ND)									   |		REAL*8 OLD_XV(MAX_ND)
	REAL(10) NEW_XV(MAX_ND)									   |		REAL*8 NEW_XV(MAX_ND)
	REAL(10) NEW_TAU(MAX_ND)								   |		REAL*8 NEW_TAU(MAX_ND)
	REAL(10) NEW_VEL(MAX_ND)								   |		REAL*8 NEW_VEL(MAX_ND)
	REAL(10) TAU(MAX_ND)									   |		REAL*8 TAU(MAX_ND)
!												   |	!
	REAL(10) RMIN,RMAX,LUM									   |		REAL*8 RMIN,RMAX,LUM
	REAL(10) GRID_FACTOR,GRID_RATIO								   |		REAL*8 GRID_FACTOR,GRID_RATIO
	REAL(10) T1,T2,SCALE_FACTOR,DELR							   |		REAL*8 T1,T2,SCALE_FACTOR,DELR
	REAL(10) TAU_MIN,TAU_MAX								   |		REAL*8 TAU_MIN,TAU_MAX
	REAL(10) TAU_RAT									   |		REAL*8 TAU_RAT
	REAL(10) R_SCALE_FAC									   |		REAL*8 R_SCALE_FAC
	REAL(10) IB_RAT										   |		REAL*8 IB_RAT
	REAL(10) OB_RAT										   |		REAL*8 OB_RAT
	REAL(10) SCL_FAC									   |		REAL*8 SCL_FAC
	REAL(10) DTAU2_ON_DTAU1									   |		REAL*8 DTAU2_ON_DTAU1
	REAL(10) dLOGT_MAX									   |		REAL*8 dLOGT_MAX
	REAL(10) RMIN										   |		REAL*8 RMIN
	REAL(10) LUM										   |		REAL*8 LUM
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) DI(ND)										   |		REAL*8 DI(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) IRAT(ND)									   |		REAL*8 IRAT(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) OLD_TAU(ND)									   |		REAL*8 OLD_TAU(ND)
!												   |	!
	REAL(10) RTMP(NEW_ND)									   |		REAL*8 RTMP(NEW_ND)
	REAL(10) NEW_DI(NEW_ND)									   |		REAL*8 NEW_DI(NEW_ND)
	REAL(10) NEW_ED(NEW_ND)									   |		REAL*8 NEW_ED(NEW_ND)
	REAL(10) NEW_T(NEW_ND)									   |		REAL*8 NEW_T(NEW_ND)
	REAL(10) NEW_IRAT(NEW_ND)								   |		REAL*8 NEW_IRAT(NEW_ND)
	REAL(10) NEW_VEL(NEW_ND)								   |		REAL*8 NEW_VEL(NEW_ND)
	REAL(10) NEW_CLUMP_FAC(NEW_ND)								   |		REAL*8 NEW_CLUMP_FAC(NEW_ND)
	REAL(10) NEW_TAU(NEW_ND)								   |		REAL*8 NEW_TAU(NEW_ND)
	REAL(10) NEW_SIGMA(NEW_ND)								   |		REAL*8 NEW_SIGMA(NEW_ND)
	REAL(10) COEF(NEW_ND,4)									   |		REAL*8 COEF(NEW_ND,4)
	REAL(10) T1										   |		REAL*8 T1
./misc/rev_rvsig.f
	REAL(10) R_TRANS,V_TRANS								   |		REAL*8 R_TRANS,V_TRANS
	REAL(10) dVdR_TRANS									   |		REAL*8 dVdR_TRANS
	REAL(10) VINF,BETA									   |		REAL*8 VINF,BETA
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) VEXT										   |		REAL*8 VEXT
	REAL(10) RP2										   |		REAL*8 RP2
	REAL(10) SCALE_HEIGHT									   |		REAL*8 SCALE_HEIGHT
	REAL(10) RO										   |		REAL*8 RO
	REAL(10) dVdR										   |		REAL*8 dVdR
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) OLD_R(NMAX)									   |		REAL*8 OLD_R(NMAX)
	REAL(10) OLD_V(NMAX)									   |		REAL*8 OLD_V(NMAX)
	REAL(10) OLD_SIGMA(NMAX)								   |		REAL*8 OLD_SIGMA(NMAX)
	REAL(10) OLD_DENSITY(NMAX)								   |		REAL*8 OLD_DENSITY(NMAX)
	REAL(10) OLD_CLUMP_FAC(NMAX)								   |		REAL*8 OLD_CLUMP_FAC(NMAX)
	REAL(10) OLD_LOG_R(NMAX)								   |		REAL*8 OLD_LOG_R(NMAX)
!												   |	!
	REAL(10) R_PLT(NMAX)									   |		REAL*8 R_PLT(NMAX)
	REAL(10) V_PLT(NMAX)									   |		REAL*8 V_PLT(NMAX)
!												   |	!
	REAL(10) R(NMAX)									   |		REAL*8 R(NMAX)
	REAL(10) V(NMAX)									   |		REAL*8 V(NMAX)
	REAL(10) SIGMA(NMAX)									   |		REAL*8 SIGMA(NMAX)
	REAL(10) DENSITY(NMAX)									   |		REAL*8 DENSITY(NMAX)
	REAL(10) CLUMP_FAC(NMAX)								   |		REAL*8 CLUMP_FAC(NMAX)
	REAL(10) LOG_R(NMAX)									   |		REAL*8 LOG_R(NMAX)
!												   |	!
	REAL(10) RTMP(NMAX)									   |		REAL*8 RTMP(NMAX)
	REAL(10) OLD_TAU(NMAX)									   |		REAL*8 OLD_TAU(NMAX)
	REAL(10) TAU_SAV(NMAX)									   |		REAL*8 TAU_SAV(NMAX)
	REAL(10) TAU(NMAX)									   |		REAL*8 TAU(NMAX)
	REAL(10) CHI_ROSS(NMAX)									   |		REAL*8 CHI_ROSS(NMAX)
!												   |	!
	REAL(10) TMP_R(NMAX)									   |		REAL*8 TMP_R(NMAX)
	REAL(10) X1(NMAX)									   |		REAL*8 X1(NMAX)
	REAL(10) X2(NMAX)									   |		REAL*8 X2(NMAX)	
	REAL(10) WRK_VEC(NMAX)									   |		REAL*8 WRK_VEC(NMAX)	
	REAL(10), ALLOCATABLE :: COEF(:,:)							   |		REAL*8, ALLOCATABLE :: COEF(:,:)
	REAL(10) RX										   |		REAL*8 RX
	REAL(10) NEW_RSTAR									   |		REAL*8 NEW_RSTAR
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) FAC										   |		REAL*8 FAC
	REAL(10) V_MAX										   |		REAL*8 V_MAX
	REAL(10) V_MIN 										   |		REAL*8 V_MIN 
	REAL(10) MDOT										   |		REAL*8 MDOT
	REAL(10) OLD_MDOT									   |		REAL*8 OLD_MDOT
	REAL(10) LSTAR										   |		REAL*8 LSTAR
	REAL(10) OLD_LSTAR									   |		REAL*8 OLD_LSTAR
	REAL(10) TOP,BOT 									   |		REAL*8 TOP,BOT 
	REAL(10) dTOPdR,dBOTdR 									   |		REAL*8 dTOPdR,dBOTdR 
	REAL(10) V_CON,V_RAT_MAX,IB_RAT,OB_RAT,DTAU2_ON_DTAU1					   |		REAL*8 V_CON,V_RAT_MAX,IB_RAT,OB_RAT,DTAU2_ON_DTAU1
	  T1=EXP(LOG(V_MAX*OLD_R(I_ST)*OLD_R(I_ST)/V_MIN/OLD_R(I_END)/OLD_R(I_END))/(N_ADD+1))	   |		  T1=EXP(DLOG(V_MAX*OLD_R(I_ST)*OLD_R(I_ST)/V_MIN/OLD_R(I_END)/OLD_R(I_END))/(N_ADD+1))
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
!												   |	!
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) TOP,BOT									   |		REAL*8 TOP,BOT
	REAL(10) dTOPdR,dBOTdR									   |		REAL*8 dTOPdR,dBOTdR
./misc/rewrite_dc.f
	REAL(10), ALLOCATABLE :: A_O(:,:)							   |		REAL*8, ALLOCATABLE :: A_O(:,:)
	REAL(10), ALLOCATABLE :: EDGE_O(:)							   |		REAL*8, ALLOCATABLE :: EDGE_O(:)
	REAL(10), ALLOCATABLE :: G_O(:)								   |		REAL*8, ALLOCATABLE :: G_O(:)
	REAL(10), ALLOCATABLE :: A_N(:,:)							   |		REAL*8, ALLOCATABLE :: A_N(:,:)
	REAL(10), ALLOCATABLE :: EDGE_N(:)							   |		REAL*8, ALLOCATABLE :: EDGE_N(:)
	REAL(10), ALLOCATABLE :: G_N(:)								   |		REAL*8, ALLOCATABLE :: G_N(:)
	REAL(10), ALLOCATABLE :: DC(:)								   |		REAL*8, ALLOCATABLE :: DC(:)
	REAL(10) LSTAR										   |		REAL*8 LSTAR
	REAL(10) RSTAR										   |		REAL*8 RSTAR
	REAL(10) GF_LEV_CUT									   |		REAL*8 GF_LEV_CUT
	REAL(10) EN_LEV_CUT									   |		REAL*8 EN_LEV_CUT
	REAL(10) Z										   |		REAL*8 Z
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
./misc/rewrite_dc_v2.f
	REAL(10), ALLOCATABLE :: A_O(:,:)							   |		REAL*8, ALLOCATABLE :: A_O(:,:)
	REAL(10), ALLOCATABLE :: EDGE_O(:)							   |		REAL*8, ALLOCATABLE :: EDGE_O(:)
	REAL(10), ALLOCATABLE :: G_O(:)								   |		REAL*8, ALLOCATABLE :: G_O(:)
	REAL(10), ALLOCATABLE :: A_N(:,:)							   |		REAL*8, ALLOCATABLE :: A_N(:,:)
	REAL(10), ALLOCATABLE :: EDGE_N(:)							   |		REAL*8, ALLOCATABLE :: EDGE_N(:)
	REAL(10), ALLOCATABLE :: G_N(:)								   |		REAL*8, ALLOCATABLE :: G_N(:)
	REAL(10), ALLOCATABLE :: DC(:)								   |		REAL*8, ALLOCATABLE :: DC(:)
	REAL(10) LSTAR										   |		REAL*8 LSTAR
	REAL(10) RSTAR										   |		REAL*8 RSTAR
	REAL(10) GF_LEV_CUT									   |		REAL*8 GF_LEV_CUT
	REAL(10) EN_LEV_CUT									   |		REAL*8 EN_LEV_CUT
	REAL(10) Z										   |		REAL*8 Z
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
./misc/rewrite_scr.f
	REAL(10), ALLOCATABLE :: POPS(:,:)		!NT,ND					   |		REAL*8, ALLOCATABLE :: POPS(:,:)		!NT,ND
	REAL(10), ALLOCATABLE :: R(:)			!ND					   |		REAL*8, ALLOCATABLE :: R(:)			!ND
	REAL(10), ALLOCATABLE :: V(:)			!ND					   |		REAL*8, ALLOCATABLE :: V(:)			!ND
	REAL(10), ALLOCATABLE :: SIGMA(:)			!ND				   |		REAL*8, ALLOCATABLE :: SIGMA(:)			!ND
./misc/scale_omega_v1.f
	REAL(10) OMEGA_SCALE									   |		REAL*8 OMEGA_SCALE
	REAL(10) OMEGA_SET									   |		REAL*8 OMEGA_SET
	REAL(10) SCALE_FACTOR									   |		REAL*8 SCALE_FACTOR
	REAL(10) T_TABLE(MAX_TVALS)								   |		REAL*8 T_TABLE(MAX_TVALS)
	REAL(10) OMEGA(MAX_TVALS)								   |		REAL*8 OMEGA(MAX_TVALS)
./misc/set_hydro_hd_loc.f
./misc/set_new_sn_mod.f
	REAL(10) FRAC_TIME_STEP									   |		REAL*8 FRAC_TIME_STEP
	REAL(10) AGE										   |		REAL*8 AGE
	REAL(10) T1										   |		REAL*8 T1
./misc/solve_ba_mat.f
	REAL(10) POPS(N)									   |		REAL*8 POPS(N)
	REAL(10) PLTE(N)									   |		REAL*8 PLTE(N)
	REAL(10) STEQ(N)									   |		REAL*8 STEQ(N)
	REAL(10) CMAT(N,N)									   |		REAL*8 CMAT(N,N)
	REAL(10) STAT_WT(N)									   |		REAL*8 STAT_WT(N)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
!												   |	!
	REAL(10) SAV_CMAT(N,N)									   |		REAL*8 SAV_CMAT(N,N)
	REAL(10) SAV_STEQ(N)									   |		REAL*8 SAV_STEQ(N)
	REAL(10) RHS(N)										   |		REAL*8 RHS(N)
!												   |	!
	REAL(10) NEW_POPS(N)									   |		REAL*8 NEW_POPS(N)
	REAL(10) NEW_LTE(N)									   |		REAL*8 NEW_LTE(N)
	REAL(10) NEW_SOL(N)									   |		REAL*8 NEW_SOL(N)
	REAL(10) ED_NEW,DI_NEW,T_NEW								   |		REAL*8 ED_NEW,DI_NEW,T_NEW
!												   |	!
	REAL(10) ROW_SF(N)									   |		REAL*8 ROW_SF(N)
	REAL(10) COL_SF(N)									   |		REAL*8 COL_SF(N)
!												   |	!
	REAL(10) ROW_CND									   |		REAL*8 ROW_CND
	REAL(10) COL_CND									   |		REAL*8 COL_CND
	REAL(10) MAX_VAL									   |		REAL*8 MAX_VAL
!												   |	!
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) GION,RGU,X,Y									   |		REAL*8 GION,RGU,X,Y
	REAL(10) IONIZATION_ENERGY								   |		REAL*8 IONIZATION_ENERGY
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  RGU=LOG(2.07078D-22)									   |		  RGU=DLOG(2.07078D-22)
	  RGU=LOG(2.07078D-22)									   |		  RGU=DLOG(2.07078D-22)
./misc/tlusty_vel.f
	REAL(10), ALLOCATABLE :: DM(:)		!Column mass density				   |		REAL*8, ALLOCATABLE :: DM(:)		!Column mass density
	REAL(10), ALLOCATABLE :: TAUR(:)		!Rosseland optical depth		   |		REAL*8, ALLOCATABLE :: TAUR(:)		!Rosseland optical depth
	REAL(10), ALLOCATABLE :: AROSS(:)		!Absorption Rosseland optical depth scal   |		REAL*8, ALLOCATABLE :: AROSS(:)		!Absorption Rosseland optical depth scale
	REAL(10), ALLOCATABLE :: T(:)		!Temperature					   |		REAL*8, ALLOCATABLE :: T(:)		!Temperature
	REAL(10), ALLOCATABLE :: ED(:)		!Electron density (/cm^3)			   |		REAL*8, ALLOCATABLE :: ED(:)		!Electron density (/cm^3)
	REAL(10), ALLOCATABLE :: DSH(:)		!Density (gm/cm^3)				   |		REAL*8, ALLOCATABLE :: DSH(:)		!Density (gm/cm^3)
	REAL(10), ALLOCATABLE :: RD(:)		!Radius						   |		REAL*8, ALLOCATABLE :: RD(:)		!Radius
	REAL(10), ALLOCATABLE :: RD_NORM(:)	!Radius normalized by core radius		   |		REAL*8, ALLOCATABLE :: RD_NORM(:)	!Radius normalized by core radius
	REAL(10), ALLOCATABLE :: ZZ(:)            !Height above core				   |		REAL*8, ALLOCATABLE :: ZZ(:)            !Height above core
	REAL(10), ALLOCATABLE :: VPH(:)		!Velocity deduced from density structure (assumi   |		REAL*8, ALLOCATABLE :: VPH(:)		!Velocity deduced from density structure (assumi
	REAL(10), ALLOCATABLE :: dVdR_PH(:)	!dVdR deduced from density structure		   |		REAL*8, ALLOCATABLE :: dVdR_PH(:)	!dVdR deduced from density structure
	REAL(10), ALLOCATABLE :: KAPPA(:)		!Mass absorption coefficient		   |		REAL*8, ALLOCATABLE :: KAPPA(:)		!Mass absorption coefficient
	REAL(10), ALLOCATABLE :: RA(:)								   |		REAL*8, ALLOCATABLE :: RA(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: RA_NORM(:)							   |		REAL*8, ALLOCATABLE :: RA_NORM(:)
	REAL(10), ALLOCATABLE :: VPA(:)		!Velocity deduced from density structure	   |		REAL*8, ALLOCATABLE :: VPA(:)		!Velocity deduced from density structure
	REAL(10), ALLOCATABLE :: VW(:)		!Beta-wind velocity				   |		REAL*8, ALLOCATABLE :: VW(:)		!Beta-wind velocity
	REAL(10), ALLOCATABLE :: DSHA(:)		!Density				   |		REAL*8, ALLOCATABLE :: DSHA(:)		!Density
	REAL(10), ALLOCATABLE :: TAUR_A(:)							   |		REAL*8, ALLOCATABLE :: TAUR_A(:)
	REAL(10), ALLOCATABLE :: KAPPA_A(:)							   |		REAL*8, ALLOCATABLE :: KAPPA_A(:)
	REAL(10), ALLOCATABLE :: R_F(:)								   |		REAL*8, ALLOCATABLE :: R_F(:)
	REAL(10), ALLOCATABLE :: T_F(:)								   |		REAL*8, ALLOCATABLE :: T_F(:)
	REAL(10), ALLOCATABLE :: VW_F(:)							   |		REAL*8, ALLOCATABLE :: VW_F(:)
	REAL(10), ALLOCATABLE :: DSH_F(:)							   |		REAL*8, ALLOCATABLE :: DSH_F(:)
	REAL(10), ALLOCATABLE ::dVdR_F(:)							   |		REAL*8, ALLOCATABLE ::dVdR_F(:)
	REAL(10), ALLOCATABLE :: TAUR_F(:)							   |		REAL*8, ALLOCATABLE :: TAUR_F(:)
	REAL(10), ALLOCATABLE :: TEMP_F(:)							   |		REAL*8, ALLOCATABLE :: TEMP_F(:)
	REAL(10), ALLOCATABLE :: R_CMF(:)							   |		REAL*8, ALLOCATABLE :: R_CMF(:)
	REAL(10), ALLOCATABLE :: DENS_CMF(:)							   |		REAL*8, ALLOCATABLE :: DENS_CMF(:)
	REAL(10), ALLOCATABLE :: V_CMF(:)							   |		REAL*8, ALLOCATABLE :: V_CMF(:)
	REAL(10), ALLOCATABLE :: T_CMF(:)							   |		REAL*8, ALLOCATABLE :: T_CMF(:)
	REAL(10), ALLOCATABLE :: dVdR_CMF(:)							   |		REAL*8, ALLOCATABLE :: dVdR_CMF(:)
	REAL(10), ALLOCATABLE :: TAUR_CMF(:)							   |		REAL*8, ALLOCATABLE :: TAUR_CMF(:)
!												   |	!
	REAL(10) RSTAR			!Radius of Rstar in Rsun				   |		REAL*8 RSTAR			!Radius of Rstar in Rsun
	REAL(10) RMAX			!Outer radius of star					   |		REAL*8 RMAX			!Outer radius of star
	REAL(10) MDOT			!Mass-loss in Msun/yr					   |		REAL*8 MDOT			!Mass-loss in Msun/yr
	REAL(10) VINF			!Velocity (km/s)					   |		REAL*8 VINF			!Velocity (km/s)
	REAL(10) BETA			!Exponent for Beta-velocity law in outer wind.		   |		REAL*8 BETA			!Exponent for Beta-velocity law in outer wind.
	REAL(10) BETA_MIN			!Exponent for Beta-velocity law in inner wind.	   |		REAL*8 BETA_MIN			!Exponent for Beta-velocity law in inner wind.
	REAL(10) BETA_SCL			!Exponent for Beta-velocity law.		   |		REAL*8 BETA_SCL			!Exponent for Beta-velocity law.
	REAL(10) VW_BEG                   !Velocity at wind/photosphere interface when defining    |		REAL*8 VW_BEG                   !Velocity at wind/photosphere interface when defining CM
!												   |	!
	REAL(10) AMDOT										   |		REAL*8 AMDOT
	REAL(10) RCORE										   |		REAL*8 RCORE
!												   |	!
	REAL(10) MIN_VAL									   |		REAL*8 MIN_VAL
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) CONS,EPS									   |		REAL*8 CONS,EPS
	REAL(10) DELR										   |		REAL*8 DELR
	REAL(10) R0										   |		REAL*8 R0
	REAL(10) FUN_PI,PI									   |		REAL*8 FUN_PI,PI
	  TEMP_F(1:NF)=LOG(TAUR_F(1:NF))							   |		  TEMP_F(1:NF)=DLOG(TAUR_F(1:NF))
	    TEMP_F(1:NF)=LOG( TAUR_F(1:NF)/(CONS+VW_F(1:NF))**EPS )				   |		    TEMP_F(1:NF)=DLOG( TAUR_F(1:NF)/(CONS+VW_F(1:NF))**EPS )
./misc/tst_ba_mat_sol.f
	CHARACTER(LEN=200) STRING								   |		CHARACTER(LEN=80) STRING
	REAL(10) POPS_RD(NT)									   |		REAL*8 POPS_RD(NT)
	REAL(10) STEQ_RD(NT)									   |		REAL*8 STEQ_RD(NT)
	REAL(10) CMAT_RD(NT,NT)									   |		REAL*8 CMAT_RD(NT,NT)
	REAL(10) POPS(N)									   |		REAL*8 POPS(N)
	REAL(10) PLTE(N)									   |		REAL*8 PLTE(N)
	REAL(10) STEQ(N)									   |		REAL*8 STEQ(N)
	REAL(10) CMAT(N,N)									   |		REAL*8 CMAT(N,N)
	REAL(10) STAT_WT(N)									   |		REAL*8 STAT_WT(N)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) POP_SOLS(N,5)									   |		REAL*8 POP_SOLS(N,5)
!												   |	!
	REAL(10) SAV_CMAT(N,N)									   |		REAL*8 SAV_CMAT(N,N)
	REAL(10) SAV_STEQ(N)									   |		REAL*8 SAV_STEQ(N)
	REAL(10) RHS(N)										   |		REAL*8 RHS(N)
	REAL(10) LARGEST_VAL(N)									   |		REAL*8 LARGEST_VAL(N)
	REAL(10) OLD_SOL(N)									   |		REAL*8 OLD_SOL(N)
!												   |	!
	REAL(10) NEW_POPS(N)									   |		REAL*8 NEW_POPS(N)
	REAL(10) NEW_LTE(N)									   |		REAL*8 NEW_LTE(N)
	REAL(10) ED_NEW,DI_NEW,T_NEW								   |		REAL*8 ED_NEW,DI_NEW,T_NEW
!												   |	!
	REAL(10) ROW_SF(N)									   |		REAL*8 ROW_SF(N)
	REAL(10) COL_SF(N)									   |		REAL*8 COL_SF(N)
!												   |	!
	REAL(10) ROW_CND									   |		REAL*8 ROW_CND
	REAL(10) COL_CND									   |		REAL*8 COL_CND
	REAL(10) MAX_VAL									   |		REAL*8 MAX_VAL
	REAL(10) T1,T2										   |		REAL*8 T1
!												   |	!
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) GION,RGU,X,Y									   |		REAL*8 GION,RGU,X,Y
	REAL(10) IONIZATION_ENERGY								   |		REAL*8 IONIZATION_ENERGY
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  RGU=LOG(2.07078D-22)									   |		  RGU=DLOG(2.07078D-22)
	  RGU=LOG(2.07078D-22)									   |		  RGU=DLOG(2.07078D-22)
	I=164; T2=0.0D0										   <
	DO J=1,N										   <
	  T1=SAV_CMAT(I,J)*STEQ(J)								   <
	  T2=T2+T1										   <
	  WRITE(175,'(I6,6ES15.4E4)')J,STEQ(J),SAV_CMAT(I,J),T1,T2,POPS(J),POP_SOLS(J,1)	   <
	END DO											   <
	WRITE(175,*)I,'RHS(I)=',RHS(I)								   <
	FLUSH(UNIT=175)										   <
!												   <
!	DO I=1,NT										   |		DO I=1,NT
!	  WRITE(30,'(1X,I5,3ES14.4)')I,STEQ(I),STEQ(I)*CMAT_RD(NT,I)				   |		  WRITE(30,'(1X,I5,3ES14.4)')I,STEQ(I),STEQ(I)*CMAT_RD(NT,I)
!	END DO											   |		END DO
./misc/tst_char_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) P_CMF(NP)									   |		REAL*8 P_CMF(NP)
	REAL(10) MU_AT_RMAX(NP)									   |		REAL*8 MU_AT_RMAX(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) X(ND_MAX)									   |		REAL*8 X(ND_MAX)
	REAL(10) Y(ND_MAX)									   |		REAL*8 Y(ND_MAX)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) VMIN										   |		REAL*8 VMIN
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./misc/update_pg_filename.f
./misc/wr_f_to_s.f
	REAL(10) FEDGE(N_MAX)									   |		REAL*8 FEDGE(N_MAX)
	REAL(10) ENERGY(N_MAX)									   |		REAL*8 ENERGY(N_MAX)
	REAL(10) G(N_MAX)									   |		REAL*8 G(N_MAX)
	REAL(10) LAM_EDGE(N_MAX)								   |		REAL*8 LAM_EDGE(N_MAX)
	REAL(10) E_STRT(N_MAX)									   |		REAL*8 E_STRT(N_MAX)
	REAL(10) EDGE_SUM(N_MAX)								   |		REAL*8 EDGE_SUM(N_MAX)
	REAL(10) G_SUM(N_MAX)									   |		REAL*8 G_SUM(N_MAX)
	REAL(10) LS_EMIN(N_MAX)									   |		REAL*8 LS_EMIN(N_MAX)
	REAL(10) LS_EMAX(N_MAX)									   |		REAL*8 LS_EMAX(N_MAX)
	REAL(10) LS_EMID(N_MAX)									   |		REAL*8 LS_EMID(N_MAX)
	REAL(10) ACC										   |		REAL*8 ACC
	REAL(10) DC(N_MAX,3),ED(3),TEMP(3)							   |		REAL*8 DC(N_MAX,3),ED(3),TEMP(3)
	REAL(10) DI,RVAL,RSTAR,RLUM								   |		REAL*8 DI,RVAL,RSTAR,RLUM
	REAL(10) T_EXCITE,G_GS,G_ION								   |		REAL*8 T_EXCITE,G_GS,G_ION
	REAL(10) ION_EN										   |		REAL*8 ION_EN
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		DOUBLE PRECISION CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DEL_E_CM									   |		REAL*8 DEL_E_CM
	REAL(10) DEL_E_CUR									   |		REAL*8 DEL_E_CUR
	REAL(10) FRAC_DEL_E									   |		REAL*8 FRAC_DEL_E
	REAL(10) OLD_F_TO_S									   |		REAL*8 OLD_F_TO_S
	REAL(10) R_IR,V1,CL_FAC									   |		REAL*8 R_IR,V1,CL_FAC
./misc/write_osc_v2.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		DOUBLE PRECISION CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) FEDGECIV(NCIV)			!Photoionization frequency			   |		REAL*8 FEDGECIV(NCIV)			!Photoionization frequency
	REAL(10) ACIV(NCIV,NCIV)			!Oscilator strengths			   |		REAL*8 ACIV(NCIV,NCIV)			!Oscilator strengths
	REAL(10) GCIV(NCIV)			!Statistical weights				   |		REAL*8 GCIV(NCIV)			!Statistical weights
	REAL(10) ARAD(NCIV)			!						   |		REAL*8 ARAD(NCIV)			!
	REAL(10) GAM2(NCIV)			!						   |		REAL*8 GAM2(NCIV)			!
	REAL(10) GAM4(NCIV)			!						   |		REAL*8 GAM4(NCIV)			!
	REAL(10) IONCIV,ZSCR									   |		REAL*8 IONCIV,ZSCR
	REAL(10) SPEED_OF_LIGHT,LAMVACAIR							   |		REAL*8 SPEED_OF_LIGHT,LAMVACAIR
	REAL(10) NEW_ARAD(NCIV)			!						   |		REAL*8 NEW_ARAD(NCIV)			!
	REAL(10) C_LIGHT,T1,T2									   |		REAL*8 C_LIGHT,T1,T2
	REAL(10) NU_TO_EV									   |		REAL*8 NU_TO_EV
./misc/tmp_ng_ed.txt
 
Comparing files in ./new_main with those in  /home/hillier/wnode04/cmf_testing_real8//new_main
 
./new_main/Makefile
./new_main/cmfgen.f
												   >	! Altered 02-Sep-2023: Now zero ABS_MEAN
												   >	! Altered 24-Sep-2023: Updated phsical and opacity constants.
	REAL(10) T1		!Temporary variable						   |		REAL*8 T1		!Temporary variable
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	INTEGER LUER,LUWARN									   |		INTEGER  LUER,LUWARN
	INTEGER ERROR_LU,WARNING_LU								   |		INTEGER  ERROR_LU,WARNING_LU
	EXTERNAL ERROR_LU,WARNING_LU								   |		REAL*8   PLANCKS_CONSTANT, FUN_PI, SPEED_OF_LIGHT, BOLTZMANN_CONSTANT
												   >		REAL*8   ELECTRON_MASS, ELECTRON_CHARGE
												   >		EXTERNAL ERROR_LU,WARNING_LU, PLANCKS_CONSTANT, FUN_PI
												   >		EXTERNAL SPEED_OF_LIGHT, BOLTZMANN_CONSTANT, ELECTRON_CHARGE, ELECTRON_MASS
! Set constants.										   |	! Open output files for all errors and comments. Change DO_TERM_OUT to
!												   <
	CHIBF=2.815D-06										   <
	CHIFF=3.69D-29										   <
	HDKT=4.7994145D0									   <
	TWOHCSQ=0.0147452575D0									   <
	OPLIN=2.6540081D+08									   <
	EMLIN=5.27296D-03									   <
	LUER=ERROR_LU()										   <
	LUWARN=WARNING_LU()									   <
!												   <
! Open output file for all errors and comments. Change DO_TERM_OUT to				   <
												   >		LUER=ERROR_LU()
												   >		LUWARN=WARNING_LU()
												   >	!
												   >	! Set constants.
												   >	!
												   >		CHIBF=2.815D-06
												   >		CHIFF=3.69D-29
												   >		HDKT=1.0D+11*PLANCKS_CONSTANT()/BOLTZMANN_CONSTANT()                                  !O
												   >		TWOHCSQ=2.0D45*PLANCKS_CONSTANT()/(SPEED_OF_LIGHT())**2                               !O
												   >		OPLIN=1.0D+10*FUN_PI()*(ELECTRON_CHARGE())**2/ELECTRON_MASS()/SPEED_OF_LIGHT()        !O
												   >		EMLIN=1.0D+25*PLANCKS_CONSTANT()/4.0D0/FUN_PI()                                       !O
												   >	!
												   >		WRITE(LUER,*)' '
												   >		WRITE(LUER,*)' Opacity/excitaion parameters adopted in CMFGEN are:'
												   >		WRITE(LUER,'(30X,A,ES16.8)')'     CHIBF=',CHIBF
												   >		WRITE(LUER,'(30X,A,ES16.8)')'     CHIFF=',CHIFF
												   >		WRITE(LUER,'(30X,A,ES16.8)')'      HDKT=',HDKT
												   >		WRITE(LUER,'(30X,A,ES16.8)')' TWOHONCSQ=',TWOHCSQ
												   >		WRITE(LUER,'(30X,A,ES16.8)')'     OPLIN=',OPLIN
												   >		WRITE(LUER,'(30X,A,ES16.8)')'     EMLIN=',EMLIN
												   >		WRITE(LUER,*)' '
												   >		
./new_main/cmfgen_sub.f
												   >	! Altered 24-Sep-2023 : Adding consistency checks betwwen radiative equilibrium and electron coo
	REAL(10) SOL(NT,ND)		!Temp. stor. area for ST. EQ.				   |		REAL*8 SOL(NT,ND)		!Temp. stor. area for ST. EQ.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) S1,REPA									   |		REAL*8 S1,REPA
	REAL(10) MAXCH,MAXCH_SUM								   |		REAL*8 MAXCH,MAXCH_SUM
	REAL(10) T1,T2,T3,T4,SRAT								   |		REAL*8 T1,T2,T3,T4,SRAT,FF_SUM,FF_SUM2
	REAL(10) FL,AMASS,FL_OLD								   |		REAL*8 FL,AMASS,FL_OLD
	REAL(10) FG_COUNT									   |		REAL*8 FG_COUNT
	REAL(10) SCL_FAC									   |		REAL*8 SCL_FAC
	REAL(10) SUM_BA										   |		REAL*8 SUM_BA
	REAL(10) RLUMST_BND									   |		REAL*8 RLUMST_BND
	REAL(10) LUM_FOR_TEFF									   |		REAL*8 LUM_FOR_TEFF
	REAL(10) LUM_SCL_FAC									   |		REAL*8 LUM_SCL_FAC
	REAL(10) DOP_PRO									   |		REAL*8 DOP_PRO
	REAL(10) S15ADF										   |		REAL*8 S15ADF
	REAL(10) LAMVACAIR									   |		REAL*8 LAMVACAIR
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) GRAVITATIONAL_CONSTANT								   |		REAL*8 GRAVITATIONAL_CONSTANT
	REAL(10) RAD_SUN									   |		REAL*8 RAD_SUN
	REAL(10) TEFF_SUN									   |		REAL*8 TEFF_SUN
	REAL(10) MASS_SUN									   |		REAL*8 MASS_SUN
	REAL(10) POPS(NT,ND)		!Population for all species.				   |		REAL*8 POPS(NT,ND)		!Population for all species.
	REAL(10) MEAN_ATOMIC_WEIGHT	!Mean atomic weight of atoms  (neutrals			   |		REAL*8 MEAN_ATOMIC_WEIGHT	!Mean atomic weight of atoms  (neutrals
	REAL(10) ABUND_SUM									   |		REAL*8 ABUND_SUM
	REAL(10), ALLOCATABLE :: U_PAR_FN(:,:)							   |		REAL*8, ALLOCATABLE :: U_PAR_FN(:,:)
	REAL(10), ALLOCATABLE :: PHI_PAR_FN(:,:)						   |		REAL*8, ALLOCATABLE :: PHI_PAR_FN(:,:)
	REAL(10), ALLOCATABLE :: Z_PAR_FN(:)							   |		REAL*8, ALLOCATABLE :: Z_PAR_FN(:)
	REAL(10) TGREY(ND)									   |		REAL*8 TGREY(ND)
	REAL(10) T_SAVE(ND)									   |		REAL*8 T_SAVE(ND)
!	REAL(10) AVE_ENERGY(NT)		!Average energy of each super level			   |	!	REAL*8 AVE_ENERGY(NT)		!Average energy of each super level
	REAL(10) STEQ_T_SCL(ND)									   |		REAL*8 STEQ_T_SCL(ND)
	REAL(10) STEQ_T_NO_SCL(ND)								   |		REAL*8 STEQ_T_NO_SCL(ND)
												   >		REAL*8 STEQ_T_NO_LINES(ND)
	REAL(10) EDGEDIE(NMAXDIE)		!Ionization frequency (negative)		   |		REAL*8 EDGEDIE(NMAXDIE)		!Ionization frequency (negative)
	REAL(10) EINADIE(NMAXDIE)		!Einstein A coefficient				   |		REAL*8 EINADIE(NMAXDIE)		!Einstein A coefficient
	REAL(10) GUPDIE(NMAXDIE)		!Stat. weight of autoionizing level.		   |		REAL*8 GUPDIE(NMAXDIE)		!Stat. weight of autoionizing level.
	REAL(10) GLOW,GION									   |		REAL*8 GLOW,GION
	REAL(10) NUST(ND)			!LTE autoionizing population.			   |		REAL*8 NUST(ND)			!LTE autoionizing population.
	REAL(10) DION(ND)			!Ion population					   |		REAL*8 DION(ND)			!Ion population
	REAL(10), ALLOCATABLE :: DIERECOM(:,:)   !Chk for all species.				   |		REAL*8, ALLOCATABLE :: DIERECOM(:,:)   !Chk for all species.
	REAL(10), ALLOCATABLE :: DIECOOL(:,:)    !Dielec. cooling check for all spec.		   |		REAL*8, ALLOCATABLE :: DIECOOL(:,:)    !Dielec. cooling check for all spec.
	REAL(10), ALLOCATABLE :: ADDRECOM(:,:)     						   |		REAL*8, ALLOCATABLE :: ADDRECOM(:,:)     
	REAL(10) CHIL(ND)                 !Line opacity (without prof.)				   |		REAL*8 CHIL(ND)                 !Line opacity (without prof.)
	REAL(10) ETAL(ND)                 !Line emissivity (without prof.)			   |		REAL*8 ETAL(ND)                 !Line emissivity (without prof.)
	REAL(10) FQW(NCF_MAX)		!Frequency weights					   |		REAL*8 FQW(NCF_MAX)		!Frequency weights
	REAL(10) R_OLD(NDMAX)		!Used to store previous R grid in SN models.		   |		REAL*8 R_OLD(NDMAX)		!Used to store previous R grid in SN models.
	REAL(10) AV(ND)										   |		REAL*8 AV(ND)
	REAL(10) VB(NDMAX)		!Used for error calculations				   |		REAL*8 VB(NDMAX)		!Used for error calculations
	REAL(10) VC(NDMAX)		!Used for error calculations				   |		REAL*8 VC(NDMAX)		!Used for error calculations
	REAL(10) H(ND)										   |		REAL*8 H(ND)
	REAL(10) Q(ND)			!FREQ DEPENDENT.					   |		REAL*8 Q(ND)			!FREQ DEPENDENT.
	REAL(10) QH(ND)			!  "      "						   |		REAL*8 QH(ND)			!  "      "
	REAL(10) GAM(ND)			!FREQ INDEPENDENT				   |		REAL*8 GAM(ND)			!FREQ INDEPENDENT
	REAL(10) GAMH(ND)			!  "      "					   |		REAL*8 GAMH(ND)			!  "      "
	REAL(10) CONT_INT,EW									   |		REAL*8 CONT_INT,EW
	REAL(10) CNM(NDMAX,NDMAX)		!For collisions cross-section in		   |		REAL*8 CNM(NDMAX,NDMAX)		!For collisions cross-section in
	REAL(10) DCNM(NDMAX,NDMAX)	!STEQGEN						   |		REAL*8 DCNM(NDMAX,NDMAX)	!STEQGEN
	REAL(10)     LAM_FLUX_MEAN_BAND_END(N_FLUX_MEAN_BANDS)					   |		REAL*8     LAM_FLUX_MEAN_BAND_END(N_FLUX_MEAN_BANDS)
	REAL(10)     BAND_FLUX_MEAN(ND,N_FLUX_MEAN_BANDS)					   |		REAL*8     BAND_FLUX_MEAN(ND,N_FLUX_MEAN_BANDS)
	REAL(10)     BAND_FLUX(ND,N_FLUX_MEAN_BANDS)						   |		REAL*8     BAND_FLUX(ND,N_FLUX_MEAN_BANDS)
	REAL(10) NU(NCF_MAX)		!Continuum and line frequencies				   |		REAL*8 NU(NCF_MAX)		!Continuum and line frequencies
	REAL(10) NU_EVAL_CONT(NCF_MAX)	!Frequencies to evaluate continuum			   |		REAL*8 NU_EVAL_CONT(NCF_MAX)	!Frequencies to evaluate continuum
	REAL(10) OBS(NCF_MAX)		!Observers spectrum					   |		REAL*8 OBS(NCF_MAX)		!Observers spectrum
	REAL(10) OBS_FREQ(NCF_MAX)		!Since N_OBS < NCF =< NCF_MAX			   |		REAL*8 OBS_FREQ(NCF_MAX)		!Since N_OBS < NCF =< NCF_MAX
	REAL(10) OBS_FLUX(NCF_MAX)								   |		REAL*8 OBS_FLUX(NCF_MAX)
	REAL(10) AMASS_ALL(NT)									   |		REAL*8 AMASS_ALL(NT)
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) NU_MAX_OBS									   |		REAL*8 NU_MAX_OBS
	REAL(10) NU_MIN_OBS									   |		REAL*8 NU_MIN_OBS
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) dJREC_CRdT(ND)									   |		REAL*8 dJREC_CRdT(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) Z_POP(NT)		!Ionic charge for each species				   |		REAL*8 Z_POP(NT)		!Ionic charge for each species
	REAL(10) X_RECOM(ND,0:NION)			!Next X-ray recombination rate		   |		REAL*8 X_RECOM(ND,0:NION)			!Next X-ray recombination rate
	REAL(10) X_COOL(ND,0:NION)			!Next X-ray cooling			   |		REAL*8 X_COOL(ND,0:NION)			!Next X-ray cooling
	REAL(10) OBS_XRAY_LUM_0P1								   |		REAL*8 OBS_XRAY_LUM_0P1
	REAL(10) OBS_XRAY_LUM_1KEV								   |		REAL*8 OBS_XRAY_LUM_1KEV
	REAL(10) GFF,XCROSS_V2									   |		REAL*8 GFF,XCROSS_V2
	REAL(10) SPEC_DEN(ND,NUM_SPECIES)		!Used by ELEC_PREP			   |		REAL*8 SPEC_DEN(ND,NUM_SPECIES)		!Used by ELEC_PREP
	REAL(10) AT_NO_VEC(ND,NUM_SPECIES)							   |		REAL*8 AT_NO_VEC(ND,NUM_SPECIES)
	REAL(10) AD_COOL_V(ND)									   |		REAL*8 AD_COOL_V(ND)
	REAL(10) AD_COOL_DT(ND)									   |		REAL*8 AD_COOL_DT(ND)
	REAL(10) ARTIFICIAL_HEAT_TERM(ND)							   |		REAL*8 ARTIFICIAL_HEAT_TERM(ND)
	REAL(10) dE_RAD_DECAY(ND)								   |		REAL*8 dE_RAD_DECAY(ND)
	REAL(10) RAD_DECAY_LUM(ND)								   |		REAL*8 RAD_DECAY_LUM(ND)
	REAL(10) dE_WORK(ND)									   |		REAL*8 dE_WORK(ND)
	REAL(10) dE_SHOCK_POWER(ND)								   |		REAL*8 dE_SHOCK_POWER(ND)
	REAL(10) SHOCK_POWER_LUM(ND)								   |		REAL*8 SHOCK_POWER_LUM(ND)
	REAL(10) TAU_EDGE(N_TAU_EDGE)								   |		REAL*8 TAU_EDGE(N_TAU_EDGE)
	OPEN(UNIT=173,FILE='SOL_LINKS',STATUS='UNKNOWN')					   <
        DO ID=1,NUM_IONS									   <
           IF(ATM(ID)%XzV_PRES)THEN								   <
             DO J=1,ATM(ID)%NXzV_F								   <
               WRITE(173,'(1X,A10,A40,I6)')ION_ID(ID),ATM(ID)%XzVLEVNAME_F(J),			   <
	1                   ATM(ID)%F_TO_S_XzV(J)						   <
             END DO										   <
           END IF										   <
        END DO											   <
	CLOSE(UNIT=173)										   <
!												   <
	CLOSE(UNIT=LUMOD)									   |		FLUSH(LUMOD)
												   >	!CLOSE(UNIT=LUMOD)
												   >	! 
												   >	!
												   >	! Compute CLUMP_FAC(1:ND) which allow for the possibility that the wind is
												   >	! clumped. At the sime time, we compute the vectors which give the density,
												   >	! the atom density, and the species density at each depth.
												   >	!
												   >		CALL SET_ABUND_CLUMP(MEAN_ATOMIC_WEIGHT,ABUND_SUM,LUER,ND)
												   >	!
	VTURB_VEC(1:ND)=VTURB_MIN+(VTURB_MAX-VTURB_MIN)*V(1:ND)/V(1)				   <
! Compute CLUMP_FAC(1:ND) which allow for the possibility that the wind is			   <
! clumped. At the sime time, we compute the vectors which give the density,			   <
! the atom density, and the species density at each depth.					   <
!												   <
	CALL SET_ABUND_CLUMP(MEAN_ATOMIC_WEIGHT,ABUND_SUM,LUER,ND)				   <
!												   <
! 												   <
!												   <
	  DO SIM_INDX=1,MAX_SIM									   |		      DO SIM_INDX=1,MAX_SIM
	    IF(RESONANCE_ZONE(SIM_INDX))THEN							   |		        IF(RESONANCE_ZONE(SIM_INDX))THEN
	      NL=SIM_NL(SIM_INDX)								   |		          NL=SIM_NL(SIM_INDX)
	      NUP=SIM_NUP(SIM_INDX)								   |		          NUP=SIM_NUP(SIM_INDX)
	      VCHI(NL,ND)=VCHI(NL,ND)+LINE_PROF_SIM(ND,SIM_INDX)*				   |		          VCHI(NL,ND)=VCHI(NL,ND)+LINE_PROF_SIM(ND,SIM_INDX)*
	1        LINE_OPAC_CON(SIM_INDX)*L_STAR_RATIO(ND,SIM_INDX)				   |		1            LINE_OPAC_CON(SIM_INDX)*L_STAR_RATIO(ND,SIM_INDX)
	      VCHI(NUP,ND)=VCHI(NUP,ND)-LINE_PROF_SIM(ND,SIM_INDX)*				   |		          VCHI(NUP,ND)=VCHI(NUP,ND)-LINE_PROF_SIM(ND,SIM_INDX)*
	1        LINE_OPAC_CON(SIM_INDX)*U_STAR_RATIO(ND,SIM_INDX)*				   |		1            LINE_OPAC_CON(SIM_INDX)*U_STAR_RATIO(ND,SIM_INDX)*
	1        GLDGU(SIM_INDX)								   |		1            GLDGU(SIM_INDX)
												   >		        END IF
												   >		      END DO
	  END DO										   |	!
	END IF											   |	! Update DTDR
												   >	!
												   >		    T1=HDKT*NU(ML)/T(ND)
												   >		    T3=FQW(ML)*TWOHCSQ*( NU(ML)**3 )*T1*EMHNUKT(ND)/
												   >		1         CHI(ND)/T(ND)/(1.0D0-EMHNUKT(ND))**2
												   >		    DTDR=DTDR+T3
	    CALL TUNE(IONE,'DTDR_VEC')								   <
	    DO I=1,NT										   |		      CALL TUNE(IONE,'DTDR_VEC')
	      TA(I)=VCHI(I,ND)									   |		      DO I=1,NT
	    END DO										   |		        TA(I)=VCHI(I,ND)
	    END IF										   |		      END DO
	    T1=HDKT*NU(ML)/T(ND)								   |		      T1=HDKT*NU(ML)/T(ND)
	    T3=FQW(ML)*TWOHCSQ*( NU(ML)**3 )*T1*EMHNUKT(ND)/					   |		      T3=FQW(ML)*TWOHCSQ*( NU(ML)**3 )*T1*EMHNUKT(ND)/
	1         CHI(ND)/T(ND)/(1.0_DP-EMHNUKT(ND))**2						   |		1         CHI(ND)/T(ND)/(1.0D0-EMHNUKT(ND))**2
	    DTDR=DTDR+T3									   <
	    IF(.NOT. LAMBDA_ITERATION .AND. COMPUTE_BA)THEN					   <
	       END DO										   |		      END DO
	       DIFFW(NT)=DIFFW(NT)+T3*(TA(NT)/CHI(ND)-(T1*(1.0_DP+EMHNUKT(ND))			   |		      DIFFW(NT)=DIFFW(NT)+T3*(TA(NT)/CHI(ND)-(T1*(1.0D0+EMHNUKT(ND))
	1           /(1.0_DP-EMHNUKT(ND))-2.0_DP)/T(ND))					   |		1           /(1.0D0-EMHNUKT(ND))-2.0D0)/T(ND))
												   >		      CALL TUNE(ITWO,'DTDR_VEC')
	    CALL TUNE(ITWO,'DTDR_VEC')								   <
	  T1=( DTDR**2 )/T1									   |		  IF(.NOT. LAMBDA_ITERATION .AND. COMPUTE_BA)THEN
	  DO I=1,NT										   |		    T1=( DTDR**2 )/T1
	    DIFFW(I)=DIFFW(I)*T1								   |		    DO I=1,NT
	  END DO										   |		      DIFFW(I)=DIFFW(I)*T1
												   >		    END DO
												   >		  END IF
												   >		STEQ_T_NO_LINES=0.0D0
	      IF(ION_ID(ID) .EQ. 'CIII')THEN							   <
	          WRITE(173,'(A,3X,ES16.5E4)')'COL',SE(ID)%STEQ(56,5)				   <
	      END IF										   <
	          IF(ION_ID(ID) .EQ. 'CIII')THEN						   <
	            WRITE(173,'(A,3X,ES16.5E4)')'COL',SE(ID)%STEQ(56,5)				   <
	            FLUSH(UNIT=173)								   <
	          END IF									   <
!												   <
												   >	!	WRITE(171,'(I7,5ES15.5)')ML,FL,STEQ_T(5)
												   >	!	WRITE(166,'(I7,3ES16.6,5X,A)')ML,FL,STEQ_T_EHB(5),STEQ_T_EHB(35),'STEQ'!
												   >	!	STEQ_T_EHB(5)=0.0D0; STEQ_T_EHB(35)=0.0D0
	    WRITE(190,'(ES18.8)')EMHNUKT(1:5); FLUSH(UNIT=190)					   <
												   >		  DO K=1,ND
												   >		    STEQ_T_NO_LINES(K)=STEQ_T_NO_LINES(K)+ FQW(ML)*(CHI_NOSCAT(K)*RJ(K) - ETA_NOSCAT(K))
												   >		  END DO
!$OMP PARALLEL DO SCHEDULE(DYNAMIC) PRIVATE(ID_SAV)						   |	!!$OMP PARALLEL DO SCHEDULE(DYNAMIC) PRIVATE(ID_SAV)
!$OMP END PARALLEL DO										   |	!!$OMP END PARALLEL DO
												   >	!	  WRITE(166,'(I7,3ES16.6,5X,A)')ML,FL,STEQ_T_EHB(5),STEQ_T_EHB(35),'BF'
												   >		  WRITE(841,'(I7,2ES15.5,I7)')ML,FL,STEQ_T(5),ID
												   >	!	WRITE(172,'(I7,2ES15.5)')ML,FL,STEQ_T(5),ID
												   >	!	WRITE(173,'(I7,2ES15.5)')ML,FL,STEQ_T(5),ID
	    T2=EINA(SIM_INDX)*ATM(ID)%XzV_F(MNUP_F,5)*ZNET_SIM(5,SIM_INDX)			   <
	    IF(NL .EQ. 284 .OR. NUP .EQ. 284)THEN						   <
	      WRITE(173,'(I7,3ES16.5E3,3X,A50)')ML,T2,SE(ID)%STEQ(MNL,5),			   <
	1       SE(ID)%STEQ(MNUP,5),TRIM(TRANS_NAME_SIM(SIM_INDX))				   <
	      FLUSH(UNIT=173)									   <
	    END IF    										   <
												   >	!	WRITE(174,'(I7,2ES15.5)')ML,FL,STEQ_T(5),ID
												   >		  IF(ML .EQ. 1)FF_SUM=0.0D0
												   >		  IF(ML .EQ. 1)FF_SUM2=0.0D0
												   >		  FF_SUM=FF_SUM+T1*(CHI(5)*RJ(5)-ETA(5))
												   >		  FF_SUM2=FF_SUM2-T1*ETA(5)
												   >		  IF(ML .EQ. NCF)WRITE(6,*)'At depth 5 FF_SUM=',FF_SUM,FF_SUM2
												   >		TA=0.0D0
												   >		DO ID=1,NUM_IONS
												   >		  IF(TRIM(ION_ID(ID)) .EQ. 'HeI')THEN
												   >		    J=ID; T1=SUM(ATM(ID)%BFCRXzV(:,5)); T3=SUM(ATM(ID)%BFCRXzV(:,35))
												   >		  ELSE IF(TRIM(ION_ID(ID)) .EQ. 'C2')THEN
												   >		    K=ID; T2=SUM(ATM(ID)%BFCRXzV(:,5)); T4=SUM(ATM(ID)%BFCRXzV(:,35))
												   >		  ELSE IF(TRIM(ION_ID(ID)) .EQ. 'O2')THEN
												   >		    L=ID; TA(1)=SUM(ATM(ID)%BFCRXzV(:,5)); TA(2)=SUM(ATM(ID)%BFCRXzV(:,35))
												   >		  END IF
												   >		  IF(ATM(ID)%XzV_PRES)THEN
												   >		    TA(3)=TA(3)+SUM(ATM(ID)%BFCRXzV(:,5))
												   >		    TA(4)=TA(4)+SUM(ATM(ID)%BFCRXzV(:,35))
												   >		    TA(5)=TA(5)+ATM(ID)%FFXzV(5)
												   >		  END IF
												   >		END DO
												   >	!	WRITE(168,'(I7,10ES15.5,5X,A)')ML,FL,STEQ_T_EHB(5),T1,T2,TA(1),T1+T2+TA(1),ATM(J)%BFCRXz
												   >	!	WRITE(169,'(I7,10ES15.5,5X,A)')ML,FL,STEQ_T_EHB(35),T3,T4,TA(2),T3+T4+TA(2),ATM(K)%BFCRX
												   >	!	WRITE(170,'(I7,10ES15.5,5X,A)')ML,FL,STEQ_T_EHB(5),TA(3),TA(4),FF_SUM,TA(5),STEQ_T_EHB(5
												   >	!
												   >	!	WRITE(175,'(I7,5ES15.5)')ML,FL,STEQ_T(5),STEQ_T_NO_LINES(5),TA(3),TA(5)
												   >	!
												   >		I=178
												   >		CALL CHK_COOL_RATE_CONSIS(AVE_ENERGY, STEQ_T_NO_LINES, NU, ML, NCF, ND, I)
												   >	!
												   >		I=178
												   >		CALL CHK_COOL_RATE_CONSIS(AVE_ENERGY, STEQ_T_NO_LINES, NU, NCF, NCF, ND, I)
												   >		IF(INC_SHOCK_POWER)THEN
												   >		  CALL EVAL_SHOCK_POWER(dE_SHOCK_POWER,ND,SHOCK_POWER_FAC)
												   >		  STEQ_T_EHB=STEQ_T_EHB+SHOCK_POWER_FAC*dE_SHOCK_POWER
												   >		END IF
												   >	!
	    IF (INC_SHOCK_POWER)CALL EVAL_SHOCK_POWER(dE_SHOCK_POWER,ND,SHOCK_POWER_FAC)	   <
												   >		I=178
												   >		CALL CHK_COOL_RATE_CONSIS(AVE_ENERGY, STEQ_T_NO_LINES, NU, NCF, NCF, ND, I)
												   >	!
												   >		  CLOSE(LUMOD)
	    WRITE(LU_POP,'(1X,1P8E16.7)')(FLUX_MEAN(I),I=1,ND); FLUSH(LU_POP)			   |		    WRITE(LU_POP,'(1X,1P8E16.7)')(FLUX_MEAN(I),I=1,ND)
	    WRITE(LU_POP,'(1X,1P8E16.7)')(PLANCK_MEAN(I),I=1,ND); FLUSH(LU_POP)			   |		    WRITE(LU_POP,'(1X,1P8E16.7)')(PLANCK_MEAN(I),I=1,ND)
	    WRITE(LU_POP,'(1X,1P8E16.7)')(ABS_MEAN(I),I=1,ND); FLUSH(LU_POP)			   |		    WRITE(LU_POP,'(1X,1P8E16.7)')(ABS_MEAN(I),I=1,ND)
	    WRITE(LU_POP,'(1X,1P8E16.7)')(J_INT(I)/LUM_SCL_FAC,I=1,ND); FLUSH(LU_POP)		   |		    WRITE(LU_POP,'(1X,1P8E16.7)')(J_INT(I)/LUM_SCL_FAC,I=1,ND)
	    WRITE(LU_POP,'(1X,1P8E16.7)')(H_INT(I)/LUM_SCL_FAC,I=1,ND); FLUSH(LU_POP)		   |		    WRITE(LU_POP,'(1X,1P8E16.7)')(H_INT(I)/LUM_SCL_FAC,I=1,ND)
	    WRITE(LU_POP,'(1X,1P8E16.7)')(K_INT(I)/LUM_SCL_FAC,I=1,ND); FLUSH(LU_POP)		   |		    WRITE(LU_POP,'(1X,1P8E16.7)')(K_INT(I)/LUM_SCL_FAC,I=1,ND)
./new_main/GET_J_CHI.INC
 
Comparing files in ./new_main/mod_subs with those in  /home/hillier/wnode04/cmf_testing_real8//new_main/mod_subs
 
./new_main/mod_subs/Makefile
./new_main/mod_subs/adjust_den_vecs.f
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
./new_main/mod_subs/adjust_r_grid.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) JQW(ND,NP)									   |		REAL*8 JQW(ND,NP)
	REAL(10) HQW(ND,NP)									   |		REAL*8 HQW(ND,NP)
	REAL(10) KQW(ND,NP)									   |		REAL*8 KQW(ND,NP)
	REAL(10) HMIDQW(ND,NP)									   |		REAL*8 HMIDQW(ND,NP)
	REAL(10) NMIDQW(ND,NP)									   |		REAL*8 NMIDQW(ND,NP)
	REAL(10) MU_AT_RMAX(NP)									   |		REAL*8 MU_AT_RMAX(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) FLUXMEAN(ND)									   |		REAL*8 FLUXMEAN(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) RG_PARS(N_PARS)								   |		REAL*8 RG_PARS(N_PARS)
	REAL(10) dTAU_OLD(ND)									   |		REAL*8 dTAU_OLD(ND)
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) TAU_OLD(ND)									   |		REAL*8 TAU_OLD(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) FG_MIN                   !Default=-3.0D0					   |		REAL*8 FG_MIN                   !Default=-3.0D0
	REAL(10) FG_MAX			!Default=1.5D0						   |		REAL*8 FG_MAX			!Default=1.5D0
	REAL(10) FG_RANGE			!Default=4.5D0					   |		REAL*8 FG_RANGE			!Default=4.5D0
	REAL(10) W1(NP),W2(NP),W3(NP)								   |		REAL*8 W1(NP),W2(NP),W3(NP)
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) T1										   |		REAL*8 T1
	TAU_OLD(1:ND)=LOG10(TAU_OLD(1:ND))							   |		TAU_OLD(1:ND)=DLOG10(TAU_OLD(1:ND))
./new_main/mod_subs/adjust_r_grid_v2.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) JQW(ND,NP)									   |		REAL*8 JQW(ND,NP)
	REAL(10) HQW(ND,NP)									   |		REAL*8 HQW(ND,NP)
	REAL(10) KQW(ND,NP)									   |		REAL*8 KQW(ND,NP)
	REAL(10) HMIDQW(ND,NP)									   |		REAL*8 HMIDQW(ND,NP)
	REAL(10) NMIDQW(ND,NP)									   |		REAL*8 NMIDQW(ND,NP)
	REAL(10) MU_AT_RMAX(NP)									   |		REAL*8 MU_AT_RMAX(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) FLUXMEAN(ND)									   |		REAL*8 FLUXMEAN(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) RG_PARS(N_PARS)								   |		REAL*8 RG_PARS(N_PARS)
	REAL(10) dTAU_OLD(ND)									   |		REAL*8 dTAU_OLD(ND)
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) TAU_OLD(ND)									   |		REAL*8 TAU_OLD(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) FG_MIN                   !Default=-3.0D0					   |		REAL*8 FG_MIN                   !Default=-3.0D0
	REAL(10) FG_MAX			!Default=1.5D0						   |		REAL*8 FG_MAX			!Default=1.5D0
	REAL(10) FG_RANGE			!Default=4.5D0					   |		REAL*8 FG_RANGE			!Default=4.5D0
	REAL(10) W1(NP),W2(NP),W3(NP)								   |		REAL*8 W1(NP),W2(NP),W3(NP)
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) T1										   |		REAL*8 T1
	TAU_OLD(1:ND)=LOG10(TAU_OLD(1:ND))							   |		TAU_OLD(1:ND)=DLOG10(TAU_OLD(1:ND))
./new_main/mod_subs/adjust_r_grid_v3.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) ESEC(ND)			!Electron scattering opacity			   |		REAL*8 ESEC(ND)			!Electron scattering opacity
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) dTAU_OLD(ND)									   |		REAL*8 dTAU_OLD(ND)
	REAL(10) TAU_OLD(ND)									   |		REAL*8 TAU_OLD(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) TA(ND)			!Work vectors						   |		REAL*8 TA(ND)			!Work vectors
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) FG_MIN			!Min Tau for FG						   |		REAL*8 FG_MIN			!Min Tau for FG
	REAL(10) FG_MAX			!Max Tau for FG						   |		REAL*8 FG_MAX			!Max Tau for FG
	REAL(10) FG_RANGE									   |		REAL*8 FG_RANGE
!												   |	!
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LOG_TAU									   |		REAL*8 DLOG_TAU
	REAL(10) STRETCH_POW		!Power law exponent to stretch tau scale about 1	   |		REAL*8 STRETCH_POW		!Power law exponent to stretch tau scale about 1
	REAL(10) OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.   |		REAL*8 OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.
	REAL(10) IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.	   |		REAL*8 IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.
	TAU_OLD(1:ND)=LOG10(TAU_OLD(1:ND))							   |		TAU_OLD(1:ND)=DLOG10(TAU_OLD(1:ND))
	  LOG_TAU=(TAU_OLD(ND)-TAU_OLD(1))/(ND-NUM_OBND_PARAMS-NUM_IBND_PARAMS-1)		   |		  DLOG_TAU=(TAU_OLD(ND)-TAU_OLD(1))/(ND-NUM_OBND_PARAMS-NUM_IBND_PARAMS-1)
	    TAU(I)=TAU_OLD(1)+LOG_TAU*(I-NUM_IBND_PARAMS-1)					   |		    TAU(I)=TAU_OLD(1)+DLOG_TAU*(I-NUM_IBND_PARAMS-1)
          LOG_TAU=T1/(ND-NUM_IBND_PARAMS-NUM_OBND_PARAMS-NX)					   |	          DLOG_TAU=T1/(ND-NUM_IBND_PARAMS-NUM_OBND_PARAMS-NX)
	  I1=(FG_MIN-TAU_OLD(1))/LOG_TAU							   |		  I1=(FG_MIN-TAU_OLD(1))/DLOG_TAU
	  LOG_TAU=(FG_MIN-TAU_OLD(1))/I1							   |		  DLOG_TAU=(FG_MIN-TAU_OLD(1))/I1
	    TAU(I)=TAU_OLD(1)+LOG_TAU*(I-3)							   |		    TAU(I)=TAU_OLD(1)+DLOG_TAU*(I-3)
	  LOG_TAU=FG_RANGE/(NX-1)								   |		  DLOG_TAU=FG_RANGE/(NX-1)
	    TAU(I)=FG_MIN+LOG_TAU*(I-I1-1)							   |		    TAU(I)=FG_MIN+DLOG_TAU*(I-I1-1)
	  LOG_TAU=(TAU_OLD(ND)-FG_MAX)/I2							   |		  dLOG_TAU=(TAU_OLD(ND)-FG_MAX)/I2
	    TAU(I)=TAU(I-1)+LOG_TAU								   |		    TAU(I)=TAU(I-1)+DLOG_TAU
	LOG_TAU=TAU(ND)-TAU(ND-NUM_IBND_PARAMS-1)						   |		dLOG_TAU=TAU(ND)-TAU(ND-NUM_IBND_PARAMS-1)
	  TAU(ND-1)=TAU(ND)-0.1D0*LOG_TAU							   |		  TAU(ND-1)=TAU(ND)-0.1D0*dLOG_TAU
	  TAU(ND-2)=TAU(ND)-0.35D0*LOG_TAU							   |		  TAU(ND-2)=TAU(ND)-0.35D0*dLOG_TAU
	    TAU(ND-J)=TAU(ND)-LOG_TAU/IBND_PARAMS(J)						   |		    TAU(ND-J)=TAU(ND)-dLOG_TAU/IBND_PARAMS(J)
	LOG_TAU=TAU(NUM_OBND_PARAMS+2)-TAU(1)							   |		dLOG_TAU=TAU(NUM_OBND_PARAMS+2)-TAU(1)
	  TAU(2)=TAU(1)+0.02D0*LOG_TAU								   |		  TAU(2)=TAU(1)+0.02D0*dLOG_TAU
	  TAU(3)=TAU(1)+0.2D0*LOG_TAU								   |		  TAU(3)=TAU(1)+0.2D0*dLOG_TAU
	    WRITE(6,*)J,TAU(1),LOG_TAU,OBND_PARAMS(J)						   |		    WRITE(6,*)J,TAU(1),dLOG_TAU,OBND_PARAMS(J)
	    TAU(1+J)=TAU(1)+LOG_TAU/OBND_PARAMS(J)						   |		    TAU(1+J)=TAU(1)+dLOG_TAU/OBND_PARAMS(J)
./new_main/mod_subs/adjust_r_grid_v4.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) ESEC(ND)			!Electron scattering opacity			   |		REAL*8 ESEC(ND)			!Electron scattering opacity
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) V_OLD(ND)									   |		REAL*8 V_OLD(ND)
	REAL(10) SIGMA_OLD(ND)									   |		REAL*8 SIGMA_OLD(ND)
!												   |	!
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) dTAU_OLD(ND)									   |		REAL*8 dTAU_OLD(ND)
	REAL(10) TAU_OLD(ND)									   |		REAL*8 TAU_OLD(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
!												   |	!
	REAL(10) TA(ND)			!Work vectors						   |		REAL*8 TA(ND)			!Work vectors
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) COEF(ND,4)									   |		REAL*8 COEF(ND,4)
	REAL(10) FG_MIN			!Min Tau for FG						   |		REAL*8 FG_MIN			!Min Tau for FG
	REAL(10) FG_MAX			!Max Tau for FG						   |		REAL*8 FG_MAX			!Max Tau for FG
	REAL(10) FG_RANGE									   |		REAL*8 FG_RANGE
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DTAU2_ON_DTAU1									   |		REAL*8 MAX_RATIO,DR_STEP,DR_FAC
	REAL(10) LOG_TAU									   |		REAL*8 DTAU2_ON_DTAU1
	REAL(10) STRETCH_POW		!Power law exponent to stretch tau scale about 1	   |		REAL*8 DLOG_TAU
												   >		REAL*8 STRETCH_POW		!Power law exponent to stretch tau scale about 1
	REAL(10) OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.   |		REAL*8 OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.
	REAL(10) IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.	   |		REAL*8 IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.
												   >		INTEGER NLEV
												   >		INTEGER LEVELS(10)
												   >
	1            'Regridding method: TAU_SPACE, VEL_SPACE, FULL_R')				   |		1            'Regridding method: TAU_SPACE, VEL_SPACE, FULL_R, RATIO')
!												   |		IF(REGRIDDING_METHOD .EQ. 'RATIO')THEN
												   >		  CALL RD_STORE_INT(NLEV,'NLEV',L_TRUE,'Number of pops to be use  todefine R grid')
												   >		  DO J=1,NLEV
												   >		     WRITE(TMP_STR,*)NLEV; TMP_STR='LEV'//ADJUSTL(TMP_STR)
												   >		     CALL RD_STORE_INT(LEVELS,TMP_STR,L_TRUE,'Population level ID in POPS')
												   >		  END DO
												   >		  MAX_RATIO=1.2D0; DR_STEP=0.0D0; DR_FAC=0.0D0
												   >		END IF
												   >		ELSE IF(REGRIDDING_METHOD .EQ. 'RATIO')THEN
												   >		 CALL DEF_NEW_RG_V1(R,R_OLD,POPS,LEVELS,MAX_RATIO,DR_STEP,DR_FAC,DONE_R_REV,I,NT,ND)
./new_main/mod_subs/ang_qw_mod.f
	REAL(10), ALLOCATABLE :: P(:)              !NP						   |		REAL*8, ALLOCATABLE :: P(:)              !NP
	REAL(10), ALLOCATABLE :: AQW(:,:)          !ND,NP					   |		REAL*8, ALLOCATABLE :: AQW(:,:)          !ND,NP
	REAL(10), ALLOCATABLE :: HQW(:,:)          !ND,NP					   |		REAL*8, ALLOCATABLE :: HQW(:,:)          !ND,NP
	REAL(10), ALLOCATABLE :: KQW(:,:)          !ND,NP					   |		REAL*8, ALLOCATABLE :: KQW(:,:)          !ND,NP
	REAL(10), ALLOCATABLE :: NQW(:,:)          !ND,NP					   |		REAL*8, ALLOCATABLE :: NQW(:,:)          !ND,NP
	REAL(10), ALLOCATABLE :: HMIDQW(:,:)       !ND,NP					   |		REAL*8, ALLOCATABLE :: HMIDQW(:,:)       !ND,NP
	REAL(10), ALLOCATABLE :: NMIDQW(:,:)       !ND,NP					   |		REAL*8, ALLOCATABLE :: NMIDQW(:,:)       !ND,NP
	REAL(10), ALLOCATABLE :: PEXT(:)            !NPEXT					   |		REAL*8, ALLOCATABLE :: PEXT(:)            !NPEXT
	REAL(10), ALLOCATABLE :: AQWEXT(:,:)							   |		REAL*8, ALLOCATABLE :: AQWEXT(:,:)
	REAL(10), ALLOCATABLE :: HQWEXT(:,:)							   |		REAL*8, ALLOCATABLE :: HQWEXT(:,:)
	REAL(10), ALLOCATABLE :: KQWEXT(:,:)							   |		REAL*8, ALLOCATABLE :: KQWEXT(:,:)
	REAL(10), ALLOCATABLE :: NQWEXT(:,:)							   |		REAL*8, ALLOCATABLE :: NQWEXT(:,:)
	REAL(10), ALLOCATABLE :: HMIDQWEXT(:,:)							   |		REAL*8, ALLOCATABLE :: HMIDQWEXT(:,:)
	REAL(10), ALLOCATABLE :: NMIDQWEXT(:,:)							   |		REAL*8, ALLOCATABLE :: NMIDQWEXT(:,:)
        REAL(10)  NU_STORE(NST_CMF)								   |	        REAL*8  NU_STORE(NST_CMF)
        REAL(10) V_AT_RMAX                !Used if we extend the atmosphere.			   |	        REAL*8 V_AT_RMAX                !Used if we extend the atmosphere.
        REAL(10) RMAX_OBS									   |	        REAL*8 RMAX_OBS
        REAL(10) HFLUX_AT_OB		!In comoving frame					   |	        REAL*8 HFLUX_AT_OB		!In comoving frame
        REAL(10) HFLUX_AT_IB									   |	        REAL*8 HFLUX_AT_IB
        REAL(10), ALLOCATABLE :: IPLUS_STORE(:,:)						   |	        REAL*8, ALLOCATABLE :: IPLUS_STORE(:,:)
        REAL(10), ALLOCATABLE :: P_OBS(:)							   |	        REAL*8, ALLOCATABLE :: P_OBS(:)
        REAL(10), ALLOCATABLE :: IPLUS(:)							   |	        REAL*8, ALLOCATABLE :: IPLUS(:)
        REAL(10), ALLOCATABLE :: MU_AT_RMAX(:)							   |	        REAL*8, ALLOCATABLE :: MU_AT_RMAX(:)
        REAL(10), ALLOCATABLE :: HQW_AT_RMAX(:)							   |	        REAL*8, ALLOCATABLE :: HQW_AT_RMAX(:)
./new_main/mod_subs/check_param_consistency.f
./new_main/mod_subs/chg_exch_mod_v3.f
          REAL(10), ALLOCATABLE :: COEF_CHG_RD(:,:)						   |	          REAL*8, ALLOCATABLE :: COEF_CHG_RD(:,:)
          REAL(10), ALLOCATABLE :: TLO_CHG_RD(:)						   |	          REAL*8, ALLOCATABLE :: TLO_CHG_RD(:)
          REAL(10), ALLOCATABLE :: THI_CHG_RD(:)						   |	          REAL*8, ALLOCATABLE :: THI_CHG_RD(:)
          REAL(10), ALLOCATABLE :: COEF_CHG(:,:)						   |	          REAL*8, ALLOCATABLE :: COEF_CHG(:,:)
          REAL(10), ALLOCATABLE :: G_CHG(:,:)							   |	          REAL*8, ALLOCATABLE :: G_CHG(:,:)
          REAL(10), ALLOCATABLE :: TLO_CHG(:)							   |	          REAL*8, ALLOCATABLE :: TLO_CHG(:)
          REAL(10), ALLOCATABLE :: THI_CHG(:)							   |	          REAL*8, ALLOCATABLE :: THI_CHG(:)
          REAL(10), ALLOCATABLE :: Z_CHG(:,:)							   |	          REAL*8, ALLOCATABLE :: Z_CHG(:,:)
          REAL(10), ALLOCATABLE :: AI_AR_CHG(:,:)						   |	          REAL*8, ALLOCATABLE :: AI_AR_CHG(:,:)
          REAL(10), ALLOCATABLE :: dlnAI_AR_CHG_dlnT(:,:)					   |	          REAL*8, ALLOCATABLE :: dlnAI_AR_CHG_dlnT(:,:)
          REAL(10), ALLOCATABLE :: COOL_CHG(:,:)						   |	          REAL*8, ALLOCATABLE :: COOL_CHG(:,:)
./new_main/mod_subs/cmf_sob_mod.f
        REAL(10), ALLOCATABLE :: JNU(:,:)							   |	        REAL*8, ALLOCATABLE :: JNU(:,:)
        REAL(10), ALLOCATABLE :: HNU(:,:)							   |	        REAL*8, ALLOCATABLE :: HNU(:,:)
        REAL(10), ALLOCATABLE :: F_LINE(:,:)							   |	        REAL*8, ALLOCATABLE :: F_LINE(:,:)
        REAL(10), ALLOCATABLE :: G_LINE(:,:)               !ND,NLF+1				   |	        REAL*8, ALLOCATABLE :: G_LINE(:,:)               !ND,NLF+1
        REAL(10), ALLOCATABLE :: HBC_LINE(:,:)             !3,NLF+1				   |	        REAL*8, ALLOCATABLE :: HBC_LINE(:,:)             !3,NLF+1
        REAL(10), ALLOCATABLE :: NBC_LINE(:,:)             !3,NLF+1				   |	        REAL*8, ALLOCATABLE :: NBC_LINE(:,:)             !3,NLF+1
        REAL(10), ALLOCATABLE :: IN_HBC_LINE(:)            !NLF+1				   |	        REAL*8, ALLOCATABLE :: IN_HBC_LINE(:)            !NLF+1
	REAL(10), ALLOCATABLE :: JBLANK(:)                !ND					   |		REAL*8, ALLOCATABLE :: JBLANK(:)                !ND
	REAL(10), ALLOCATABLE :: HBLANK(:)                !ND					   |		REAL*8, ALLOCATABLE :: HBLANK(:)                !ND
	REAL(10), ALLOCATABLE :: JEW(:)                   !ND : Used to compute line Ew's.	   |		REAL*8, ALLOCATABLE :: JEW(:)                   !ND : Used to compute line Ew's.
	REAL(10), ALLOCATABLE :: JBAR(:)                  !ND : Mean line intensity.		   |		REAL*8, ALLOCATABLE :: JBAR(:)                  !ND : Mean line intensity.
	REAL(10), ALLOCATABLE :: ZNET(:)                  !ND : Net radiative rate		   |		REAL*8, ALLOCATABLE :: ZNET(:)                  !ND : Net radiative rate
	REAL(10), ALLOCATABLE :: PF(:)                    !NLF : Prof. freq. for line computatio   |		REAL*8, ALLOCATABLE :: PF(:)                    !NLF : Prof. freq. for line computations
	REAL(10), ALLOCATABLE :: PROF(:)                  !NLF : Line profile			   |		REAL*8, ALLOCATABLE :: PROF(:)                  !NLF : Line profile
	REAL(10), ALLOCATABLE :: LFQW(:)                  !NLF : Quad. weights assoc. with line    |		REAL*8, ALLOCATABLE :: LFQW(:)                  !NLF : Quad. weights assoc. with line pr
	REAL(10), ALLOCATABLE :: ERF(:)								   |		REAL*8, ALLOCATABLE :: ERF(:)
	REAL(10), ALLOCATABLE :: VZNET(:,:,:)             !NT,NUM_BNDS,ND			   |		REAL*8, ALLOCATABLE :: VZNET(:,:,:)             !NT,NUM_BNDS,ND
	REAL(10), ALLOCATABLE :: FQAF(:,:,:)              !ND,ND,NM_KI				   |		REAL*8, ALLOCATABLE :: FQAF(:,:,:)              !ND,ND,NM_KI
	REAL(10), ALLOCATABLE :: FQAFD(:)                 !ND					   |		REAL*8, ALLOCATABLE :: FQAFD(:)                 !ND
./new_main/mod_subs/comp_grey.f
	REAL(10) TGREY(ND)									   |		REAL*8 TGREY(ND)
	REAL(10) TAU_ROSS(ND)									   |		REAL*8 TAU_ROSS(ND)
	REAL(10) ROSSMEAN(ND)									   |		REAL*8 ROSSMEAN(ND)
!												   |	!
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) GAMH(ND)									   |		REAL*8 GAMH(ND)
	REAL(10) SOB(ND)									   |		REAL*8 SOB(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) HBC_J										   |		REAL*8 HBC_J
	REAL(10) HBC_CMF									   |		REAL*8 HBC_CMF
	REAL(10) NBC_CMF									   |		REAL*8 NBC_CMF
	REAL(10) INBC										   |		REAL*8 INBC
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) HFLUX										   |		REAL*8 HFLUX
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/mod_subs/comp_grey_v2.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) TGREY(ND)									   |		REAL*8 TGREY(ND)
	REAL(10) TAU_ROSS(ND)									   |		REAL*8 TAU_ROSS(ND)
	REAL(10) ROSSMEAN(ND)									   |		REAL*8 ROSSMEAN(ND)
!												   |	!
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) GAMH(ND)									   |		REAL*8 GAMH(ND)
	REAL(10) SOB(ND)									   |		REAL*8 SOB(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) HBC_J										   |		REAL*8 HBC_J
	REAL(10) HBC_CMF									   |		REAL*8 HBC_CMF
	REAL(10) NBC_CMF									   |		REAL*8 NBC_CMF
	REAL(10) INBC										   |		REAL*8 INBC
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) HFLUX										   |		REAL*8 HFLUX
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/mod_subs/comp_grey_v3.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) TGREY(ND)									   |		REAL*8 TGREY(ND)
	REAL(10) TAU_ROSS(ND)									   |		REAL*8 TAU_ROSS(ND)
	REAL(10) ROSSMEAN(ND)									   |		REAL*8 ROSSMEAN(ND)
	REAL(10) PLANCKMEAN(ND)									   |		REAL*8 PLANCKMEAN(ND)
!												   |	!
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) GAMH(ND)									   |		REAL*8 GAMH(ND)
	REAL(10) SOB(ND)									   |		REAL*8 SOB(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) HBC_J										   |		REAL*8 HBC_J
	REAL(10) HBC_CMF									   |		REAL*8 HBC_CMF
	REAL(10) NBC_CMF									   |		REAL*8 NBC_CMF
	REAL(10) INBC										   |		REAL*8 INBC
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) HFLUX										   |		REAL*8 HFLUX
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/mod_subs/comp_grey_v4.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) TGREY(ND)									   |		REAL*8 TGREY(ND)
	REAL(10) TAU_ROSS(ND)									   |		REAL*8 TAU_ROSS(ND)
	REAL(10) ROSSMEAN(ND)									   |		REAL*8 ROSSMEAN(ND)
	REAL(10) PLANCKMEAN(ND)									   |		REAL*8 PLANCKMEAN(ND)
!												   |	!
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) GAMH(ND)									   |		REAL*8 GAMH(ND)
	REAL(10) SOB(ND)									   |		REAL*8 SOB(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) HBC_J										   |		REAL*8 HBC_J
	REAL(10) HBC_CMF									   |		REAL*8 HBC_CMF
	REAL(10) NBC_CMF									   |		REAL*8 NBC_CMF
	REAL(10) INBC										   |		REAL*8 INBC
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) HFLUX										   |		REAL*8 HFLUX
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/mod_subs/comp_j_blank.f
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) MAXCH										   |		REAL*8 MAXCH
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), SAVE :: FL_OLD								   |		REAL*8, SAVE :: FL_OLD
	REAL(10) BNUE										   |		REAL*8 BNUE
	REAL(10) S1										   |		REAL*8 S1
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	    LOG_NU=LOG(FL_OLD/FL)								   |		    dLOG_NU=dLOG(FL_OLD/FL)
	1            INBC,HBC_CMF(1),IPLUS,FL,LOG_NU,						   |		1            INBC,HBC_CMF(1),IPLUS,FL,dLOG_NU,
	1              FL,LOG_NU,INNER_BND_METH,DBB,IC,IB_STAB_FACTOR,				   |		1              FL,dLOG_NU,INNER_BND_METH,DBB,IC,IB_STAB_FACTOR,
	1                 FL,LOG_NU,DIF,DBB,IC,METHOD,						   |		1                 FL,dLOG_NU,DIF,DBB,IC,METHOD,
	    LOG_NU=LOG(FL_OLD/FL)								   |		    dLOG_NU=dLOG(FL_OLD/FL)
	1               IPLUS,FL,LOG_NU,DIF,DBB,IC,VDOP_VEC,DELV_FRAC_FG,			   |		1               IPLUS,FL,dLOG_NU,DIF,DBB,IC,VDOP_VEC,DELV_FRAC_FG,
	1                  FL,LOG_NU,BNUE,DBB,							   |		1                  FL,dLOG_NU,BNUE,DBB,
	1                  INBC,HBC_CMF(1),IPLUS,FL,LOG_NU,					   |		1                  INBC,HBC_CMF(1),IPLUS,FL,dLOG_NU,
	1                  FL,LOG_NU,DIF,DBB,IC,						   |		1                  FL,dLOG_NU,DIF,DBB,IC,
	1              VDOP_VEC,DELV_FRAC_MOM,FL,LOG_NU,DBB,					   |		1              VDOP_VEC,DELV_FRAC_MOM,FL,dLOG_NU,DBB,
	1             FL,LOG_NU,DBB,								   |		1             FL,dLOG_NU,DBB,
	1              FL,LOG_NU,INNER_BND_METH,DBB,IC,IB_STAB_FACTOR,				   |		1              FL,dLOG_NU,INNER_BND_METH,DBB,IC,IB_STAB_FACTOR,
	1                 FL,LOG_NU,DIF,DBB,IC,METHOD,						   |		1                 FL,dLOG_NU,DIF,DBB,IC,METHOD,
./new_main/mod_subs/comp_opac.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) NU_EVAL_CONT(NCF)								   |		REAL*8 NU_EVAL_CONT(NCF)
	REAL(10) FQW(NCF)									   |		REAL*8 FQW(NCF)
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) GFF										   |		REAL*8 GFF
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
./new_main/mod_subs/comp_var_opac.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
./new_main/mod_subs/control_variable_mod.f
! Altered : 20-Feb-2006 : ABOVE_EDGE changed to LOGICAL from REAL(10)				   |	! Altered : 20-Feb-2006 : ABOVE_EDGE changed to LOGICAL from REAL*8
	INTEGER, PARAMETER :: DP=SELECTED_REAL_KIND(15,3000)					   |		REAL*8, PARAMETER :: RZERO=0.0D0
	REAL(10), PARAMETER :: RZERO=0.0_DP							   |		REAL*8, PARAMETER :: RONE=1.0D0
	REAL(10), PARAMETER :: RONE=1.0_DP							   |		REAL*8, PARAMETER :: RTWO=2.0D0
	REAL(10), PARAMETER :: RTWO=2.0_DP							   <
	REAL(10) RP			!Stellar radius in units of 10^10 cm			   |		REAL*8 RP			!Stellar radius in units of 10^10 cm
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) RMDOT										   |		REAL*8 RMDOT
      	REAL(10) VRP,RN,VINF,EPPS1,GAMMA1							   |	      	REAL*8 VRP,RN,VINF,EPPS1,GAMMA1
	REAL(10) LUM										   |		REAL*8 LUM
	REAL(10) TEFF										   |		REAL*8 TEFF
	REAL(10) LOGG										   |		REAL*8 LOGG
	REAL(10) PRESSURE_VTURB									   |		REAL*8 PRESSURE_VTURB
	REAL(10) RP2,VRP2,RN2,VINF2,EPPS2,GAMMA2						   |		REAL*8 RP2,VRP2,RN2,VINF2,EPPS2,GAMMA2
	REAL(10) CONS_FOR_R_GRID								   |		REAL*8 CONS_FOR_R_GRID
	REAL(10) EXP_FOR_R_GRID									   |		REAL*8 EXP_FOR_R_GRID
	REAL(10) SCL_HT,VCORE,VPHOT								   |		REAL*8 SCL_HT,VCORE,VPHOT
	REAL(10) VINF1,V_BETA1,V_EPPS1								   |		REAL*8 VINF1,V_BETA1,V_EPPS1
	REAL(10) V_BETA2,V_EPPS2		!VINF2 above					   |		REAL*8 V_BETA2,V_EPPS2		!VINF2 above
	REAL(10) RHO_ZERO			!Density at core in gm/cm^3			   |		REAL*8 RHO_ZERO			!Density at core in gm/cm^3
	REAL(10) RCUB_RHO_ZERO            !r^3 . density at core in (in 10^{-30} gm}		   |		REAL*8 RCUB_RHO_ZERO            !r^3 . density at core in (in 10^{-30} gm}
	REAL(10) N_RHO			!Exponent for density (+ve)				   |		REAL*8 N_RHO			!Exponent for density (+ve)
	REAL(10) DJDT_RELAX_PARAM         !Factor to assist inclusion of DJDT terms.		   |		REAL*8 DJDT_RELAX_PARAM         !Factor to assist inclusion of DJDT terms.
	REAL(10) SN_AGE_DAYS              !Age of SN in days.					   |		REAL*8 SN_AGE_DAYS              !Age of SN in days.
	REAL(10) RMAX_ON_RCORE									   |		REAL*8 RMAX_ON_RCORE
	REAL(10) TIME_SEQ_NO              !Number of model in time sequence (need not be an inte   |		REAL*8 TIME_SEQ_NO              !Number of model in time sequence (need not be an intege
	REAL(10)  SHOCK_POWER_FAC_BEG    !Initial scaling factor read from VADAT file		   |		REAL*8  SHOCK_POWER_FAC_BEG    !Initial scaling factor read from VADAT file
	REAL(10)  SHOCK_POWER_FAC        !Current scaling factor				   |		REAL*8  SHOCK_POWER_FAC        !Current scaling factor
	REAL(10)  PRESCRIBED_SHOCK_POWER !Value in erg/s of the desired power			   |		REAL*8  PRESCRIBED_SHOCK_POWER !Value in erg/s of the desired power
	REAL(10)  VLOC_SHOCK_POWER       !Velocity at which we dump the shock power		   |		REAL*8  VLOC_SHOCK_POWER       !Velocity at which we dump the shock power
	REAL(10)  DVLOC_SHOCK_POWER      !Gaussian width for the shock power deposition profile	   |		REAL*8  DVLOC_SHOCK_POWER      !Gaussian width for the shock power deposition profile
	REAL(10) DEC_NRG_SCL_FAC_BEG								   |		REAL*8 DEC_NRG_SCL_FAC_BEG
	REAL(10) DEC_NRG_SCL_FAC								   |		REAL*8 DEC_NRG_SCL_FAC
	REAL(10) NT_OMIT_ION_SCALE        !Ion omitted if < NT_OMIT_ION_SCL*(largest ion pop.).	   |		REAL*8 NT_OMIT_ION_SCALE        !Ion omitted if < NT_OMIT_ION_SCL*(largest ion pop.).
	REAL(10) NT_OMIT_LEV_SCALE        !Fractional pops omitted if < NT_OMIT_SCL		   |		REAL*8 NT_OMIT_LEV_SCALE        !Fractional pops omitted if < NT_OMIT_SCL
        REAL(10) NT_EMAX			!Maximum energy of non-thermal electrons	   |	        REAL*8 NT_EMAX			!Maximum energy of non-thermal electrons
        REAL(10) NT_EMIN			!Minimum energy of non-thermal electrons	   |	        REAL*8 NT_EMIN			!Minimum energy of non-thermal electrons
	REAL(10) MINIMUM_ISO_POP          !Minimum isotop population for included isotope.	   |		REAL*8 MINIMUM_ISO_POP          !Minimum isotop population for included isotope.
	REAL(10) RG_PAR(N_RG_PAR_MAX)								   |		REAL*8 RG_PAR(N_RG_PAR_MAX)
	REAL(10) CLUMP_PAR(N_CLUMP_PAR_MAX)							   |		REAL*8 CLUMP_PAR(N_CLUMP_PAR_MAX)
	REAL(10) GREY_PAR									   |		REAL*8 GREY_PAR
	REAL(10) T_INIT_TAU									   |		REAL*8 T_INIT_TAU
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) T_EXCITE_MIN									   |		REAL*8 T_EXCITE_MIN
	REAL(10) SIG_GAU_KMS									   |		REAL*8 SIG_GAU_KMS
	REAL(10) FRAC_SIG_GAU									   |		REAL*8 FRAC_SIG_GAU
	REAL(10) CUT_ACCURACY									   |		REAL*8 CUT_ACCURACY
	REAL(10) VSM_DIE_KMS									   |		REAL*8 VSM_DIE_KMS
	REAL(10) MIN_CONT_FREQ 		!Minimum continuum frequency.				   |		REAL*8 MIN_CONT_FREQ 		!Minimum continuum frequency.
	REAL(10) MAX_CONT_FREQ    	!Maximum continuum frequency.				   |		REAL*8 MAX_CONT_FREQ    	!Maximum continuum frequency.
	REAL(10) SMALL_FREQ_RAT 		!Fractional spacing for small frequencies'	   |		REAL*8 SMALL_FREQ_RAT 		!Fractional spacing for small frequencies'
	REAL(10) dFREQ_bf_MAX		!Maximum spacing close to bf edge.			   |		REAL*8 dFREQ_bf_MAX		!Maximum spacing close to bf edge.
	REAL(10) BIG_FREQ_AMP		!Amplification factor					   |		REAL*8 BIG_FREQ_AMP		!Amplification factor
	REAL(10) dV_LEV_DIS		!dV on low side of bound-free edge.			   |		REAL*8 dV_LEV_DIS		!dV on low side of bound-free edge.
	REAL(10) AMP_DIS			!Amplification factor				   |		REAL*8 AMP_DIS			!Amplification factor
	REAL(10) MIN_FREQ_LEV_DIS		!Minimum frequency for lev dissolution.		   |		REAL*8 MIN_FREQ_LEV_DIS		!Minimum frequency for lev dissolution.
	REAL(10) R_PNT_SRCE									   |		REAL*8 R_PNT_SRCE
	REAL(10) TEFF_PNT_SRCE									   |		REAL*8 TEFF_PNT_SRCE
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) VDOP_FIX									   |		REAL*8 VDOP_FIX
	REAL(10) VTURB										   |		REAL*8 VTURB
	REAL(10) AMASS_DOP									   |		REAL*8 AMASS_DOP
	REAL(10) VTURB_MIN									   |		REAL*8 VTURB_MIN,VTURB_MAX,VTURB_POW
	REAL(10) VTURB_MAX									   |		REAL*8 VTURB_VEND
												   >		CHARACTER(LEN=10) VTURB_LAW
	REAL(10) DOP_PROF_LIMIT									   |		REAL*8 DOP_PROF_LIMIT
	REAL(10) VOIGT_PROF_LIMIT								   |		REAL*8 VOIGT_PROF_LIMIT
	REAL(10) V_PROF_LIMIT									   |		REAL*8 V_PROF_LIMIT
	REAL(10) MAX_PROF_ED									   |		REAL*8 MAX_PROF_ED
	REAL(10) GF_CUT										   |		REAL*8 GF_CUT
	REAL(10) AT_NO_GF_CUT									   |		REAL*8 AT_NO_GF_CUT
	REAL(10) V_DOP										   |		REAL*8 V_DOP
	REAL(10) MAX_DOP									   |		REAL*8 MAX_DOP
	REAL(10) FRAC_DOP									   |		REAL*8 FRAC_DOP
	REAL(10) dV_CMF_PROF									   |		REAL*8 dV_CMF_PROF
	REAL(10) dV_CMF_WING									   |		REAL*8 dV_CMF_WING
	REAL(10) ES_WING_EXT									   |		REAL*8 ES_WING_EXT
	REAL(10) R_CMF_WING_EXT									   |		REAL*8 R_CMF_WING_EXT
	REAL(10) EXT_LINE_VAR									   |		REAL*8 EXT_LINE_VAR
	REAL(10) ZNET_VAR_LIMIT									   |		REAL*8 ZNET_VAR_LIMIT
	REAL(10) OBS_PRO_EXT_RAT								   |		REAL*8 OBS_PRO_EXT_RAT
	REAL(10) dV_OBS_PROF									   |		REAL*8 dV_OBS_PROF
	REAL(10) dV_OBS_WING									   |		REAL*8 dV_OBS_WING
	REAL(10) dV_OBS_BIG									   |		REAL*8 dV_OBS_BIG
	REAL(10) DELV_CONT									   |		REAL*8 DELV_CONT
	REAL(10) DELV_FRAC_FG									   |		REAL*8 DELV_FRAC_FG
	REAL(10) DELV_FRAC_MOM									   |		REAL*8 DELV_FRAC_MOM
        REAL(10) OVER_FREQ_DIF									   |	        REAL*8 OVER_FREQ_DIF
        REAL(10) WEAK_LINE_LIMIT								   |	        REAL*8 WEAK_LINE_LIMIT
	REAL(10) WEAK_TAU_LINE_LIMIT								   |		REAL*8 WEAK_TAU_LINE_LIMIT
	REAL(10) FLUX_CAL_LAM_BEG								   |		REAL*8 FLUX_CAL_LAM_BEG
	REAL(10) FLUX_CAL_LAM_END								   |		REAL*8 FLUX_CAL_LAM_END
	REAL(10) ACC_FREQ_END									   |		REAL*8 ACC_FREQ_END
	REAL(10) ACC_EDD_FAC									   |		REAL*8 ACC_EDD_FAC
	REAL(10) ES_VAR_FAC									   |		REAL*8 ES_VAR_FAC
	REAL(10) VAL_DO_NG 		!Begin NG when MAXCH < VAL_DO_NG			   |		REAL*8 VAL_DO_NG 		!Begin NG when MAXCH < VAL_DO_NG
	REAL(10) MAX_LAM_COR	!Maximum fractional change for Lambda iteration.		   |		REAL*8 MAX_LAM_COR	!Maximum fractional change for Lambda iteration.
	REAL(10) MAX_LIN_COR	!Maximum fractional change for linearization.			   |		REAL*8 MAX_LIN_COR	!Maximum fractional change for linearization.
	REAL(10) MAX_dT_COR       !Maximum allowed change in the temperature.			   |		REAL*8 MAX_dT_COR       !Maximum allowed change in the temperature.
	REAL(10) MAX_CHNG_LIM									   |		REAL*8 MAX_CHNG_LIM
	REAL(10) BA_CHK_FAC									   |		REAL*8 BA_CHK_FAC
	REAL(10) SCL_LINE_HT_FAC								   |		REAL*8 SCL_LINE_HT_FAC
	REAL(10) SCL_LINE_DENSITY_LIMIT								   |		REAL*8 SCL_LINE_DENSITY_LIMIT
	REAL(10) EPS                    !If maximum fractional % change < EPS we terminate model   |		REAL*8 EPS                    !If maximum fractional % change < EPS we terminate model
	REAL(10) VAL_FIX_BA									   |		REAL*8 VAL_FIX_BA
	REAL(10) VAL_DO_LAM									   |		REAL*8 VAL_DO_LAM
	REAL(10) CON_SCL_T									   |		REAL*8 CON_SCL_T
	REAL(10) TAU_SCL_T									   |		REAL*8 TAU_SCL_T
	REAL(10) ADD_OPAC_SCL_FAC								   |		REAL*8 ADD_OPAC_SCL_FAC
	REAL(10)  ADVEC_RELAX_PARAM       !Allows advection terms to be added slowly		   |		REAL*8  ADVEC_RELAX_PARAM       !Allows advection terms to be added slowly
	REAL(10) TSTAR										   |		REAL*8 TSTAR
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) FILL_FAC_XRAYS_1,T_SHOCK_1,V_SHOCK_1						   |		REAL*8 FILL_FAC_XRAYS_1,T_SHOCK_1,V_SHOCK_1
	REAL(10) FILL_FAC_XRAYS_2,T_SHOCK_2,V_SHOCK_2						   |		REAL*8 FILL_FAC_XRAYS_2,T_SHOCK_2,V_SHOCK_2
	REAL(10) FILL_FAC_X1_BEG,FILL_X1_SAV							   |		REAL*8 FILL_FAC_X1_BEG,FILL_X1_SAV
	REAL(10) FILL_FAC_X2_BEG,FILL_X2_SAV							   |		REAL*8 FILL_FAC_X2_BEG,FILL_X2_SAV
	REAL(10) SLOW_XRAY_SCL_FAC								   |		REAL*8 SLOW_XRAY_SCL_FAC
	REAL(10) XRAY_EMISS_1,XRAY_EMISS_2							   |		REAL*8 XRAY_EMISS_1,XRAY_EMISS_2
	REAL(10) VSMOOTH_XRAYS									   |		REAL*8 VSMOOTH_XRAYS
	REAL(10) ALLOWED_XRAY_FLUX_ERROR       !Fractional error allowed before X-ray emissivtie   |		REAL*8 ALLOWED_XRAY_FLUX_ERROR       !Fractional error allowed before X-ray emissivties 
        REAL(10) DESIRED_XRAY_LUM              !Desired X-ray luminosity (> 0.1 keV)		   |	        REAL*8 DESIRED_XRAY_LUM              !Desired X-ray luminosity (> 0.1 keV)
	REAL(10) NU_XRAY_END									   |		REAL*8 NU_XRAY_END
	REAL(10) DELV_XRAY									   |		REAL*8 DELV_XRAY
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) OUT_BC_PARAM_ONE								   |		REAL*8 OUT_BC_PARAM_ONE
	REAL(10) REXT_FAC									   |		REAL*8 REXT_FAC
./new_main/mod_subs/do_var_cont.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) FL				!Current frequency in units of 10^15 Hz		   |		REAL*8 FL				!Current frequency in units of 10^15 Hz
	REAL(10) CONT_FREQ			!frequency at which opacity was evaluated.	   |		REAL*8 CONT_FREQ			!frequency at which opacity was evaluated.
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), SAVE :: FL_OLD								   |		REAL*8, SAVE :: FL_OLD
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
        REAL(10) OPLIN,EMLIN									   |	        REAL*8 OPLIN,EMLIN
	1           FIRST_FREQ,L_FALSE,LOG_NU,DIF,dTdR,DBB,dDBBdT,IC,				   |		1           FIRST_FREQ,L_FALSE,dLOG_NU,DIF,dTdR,DBB,dDBBdT,IC,
	1                  FIRST_FREQ,FL,LOG_NU,						   |		1                  FIRST_FREQ,FL,dLOG_NU,
	1           INCL_DJDT_TERMS,USE_DR4JDT,DJDT_RELAX_PARAM,FIRST_FREQ,FL,LOG_NU,		   |		1           INCL_DJDT_TERMS,USE_DR4JDT,DJDT_RELAX_PARAM,FIRST_FREQ,FL,dLOG_NU,
	1           FIRST_FREQ,LOG_NU,								   |		1           FIRST_FREQ,dLOG_NU,
	1                  FIRST_FREQ,LOG_NU,DIF,dTdR,DBB,dDBBdT,IC,				   |		1                  FIRST_FREQ,dLOG_NU,DIF,dTdR,DBB,dDBBdT,IC,
./new_main/mod_subs/eddfac_rec_defs_mod.f
./new_main/mod_subs/eval_lte_v4.f
./new_main/mod_subs/eval_lte_v5.f
./new_main/mod_subs/grey_t_iterate.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) Z_POP(NT)			!Vector containing Z of atom/ion (not core)	   |		REAL*8 Z_POP(NT)			!Vector containing Z of atom/ion (not core)
	REAL(10) FQW(NCF)									   |		REAL*8 FQW(NCF)
	REAL(10) NU_EVAL_CONT(NCF)								   |		REAL*8 NU_EVAL_CONT(NCF)
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
        REAL(10), ALLOCATABLE :: U_PAR_FN(:,:)							   |	        REAL*8, ALLOCATABLE :: U_PAR_FN(:,:)
        REAL(10), ALLOCATABLE :: PHI_PAR_FN(:,:)						   |	        REAL*8, ALLOCATABLE :: PHI_PAR_FN(:,:)
        REAL(10), ALLOCATABLE :: Z_PAR_FN(:)							   |	        REAL*8, ALLOCATABLE :: Z_PAR_FN(:)
        REAL(10) SPEC_DEN(ND,NUM_SPECIES)         !Used by ELEC_PREP				   |	        REAL*8 SPEC_DEN(ND,NUM_SPECIES)         !Used by ELEC_PREP
	REAL(10) AT_NO_VEC(ND,NUM_SPECIES)							   |		REAL*8 AT_NO_VEC(ND,NUM_SPECIES)
!												   |	!
	REAL(10) TGREY(ND)			!Grey temperature structure			   |		REAL*8 TGREY(ND)			!Grey temperature structure
	REAL(10) T_SAVE(ND)									   |		REAL*8 T_SAVE(ND)
	REAL(10) ROSSMEAN(ND)			!Rosseland mean opacity				   |		REAL*8 ROSSMEAN(ND)			!Rosseland mean opacity
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) QH(ND)										   |		REAL*8 QH(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) GAMH(ND)									   |		REAL*8 GAMH(ND)
	REAL(10) H(ND)										   |		REAL*8 H(ND)
	REAL(10) SOB(ND)									   |		REAL*8 SOB(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
!												   |	!
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) HBC_J										   |		REAL*8 HBC_J
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) FL		!Current frequency						   |		REAL*8 FL		!Current frequency
	REAL(10) CONT_FREQ	!Frequency at which current ETA/CHI was evaluated		   |		REAL*8 CONT_FREQ	!Frequency at which current ETA/CHI was evaluated
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/mod_subs/init_line_opac_var.f
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
./new_main/mod_subs/init_line_opac_var_v2.f
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) dZ(NM,NX,M)									   |		REAL*8 dZ(NM,NX,M)
./new_main/mod_subs/init_opac_mod.f
./new_main/mod_subs/line_mod.f
	REAL(10),  ALLOCATABLE :: EINA(:)                !MAX_SIM				   |		REAL*8,  ALLOCATABLE :: EINA(:)                !MAX_SIM
	REAL(10),  ALLOCATABLE :: OSCIL(:)               !MAX_SIM				   |		REAL*8,  ALLOCATABLE :: OSCIL(:)               !MAX_SIM
	REAL(10),  ALLOCATABLE :: GLDGU(:)               !MAX_SIM				   |		REAL*8,  ALLOCATABLE :: GLDGU(:)               !MAX_SIM
	REAL(10),  ALLOCATABLE :: AMASS_SIM(:)           !MAX_SIM				   |		REAL*8,  ALLOCATABLE :: AMASS_SIM(:)           !MAX_SIM
	REAL(10),  ALLOCATABLE :: FL_SIM(:)              !MAX_SIM				   |		REAL*8,  ALLOCATABLE :: FL_SIM(:)              !MAX_SIM
	REAL(10),  ALLOCATABLE :: CHIL_MAT(:,:)          !ND,MAX_SIM				   |		REAL*8,  ALLOCATABLE :: CHIL_MAT(:,:)          !ND,MAX_SIM
	REAL(10),  ALLOCATABLE :: ETAL_MAT(:,:)          !ND,MAX_SIM				   |		REAL*8,  ALLOCATABLE :: ETAL_MAT(:,:)          !ND,MAX_SIM
	REAL(10),  ALLOCATABLE :: BB_COR(:,:)            !ND,MAX_SIM				   |		REAL*8,  ALLOCATABLE :: BB_COR(:,:)            !ND,MAX_SIM
!												   |	!
	REAL(10),  ALLOCATABLE :: VB_SIM(:,:)            !ND,MAX_SIM				   |		REAL*8,  ALLOCATABLE :: VB_SIM(:,:)            !ND,MAX_SIM
	REAL(10),  ALLOCATABLE :: VC_SIM(:,:)                            !ND,MAX_SIM)		   |		REAL*8,  ALLOCATABLE :: VC_SIM(:,:)                            !ND,MAX_SIM)
	REAL(10),  ALLOCATABLE :: VB_2(:)                !ND					   |		REAL*8,  ALLOCATABLE :: VB_2(:)                !ND
	REAL(10),  ALLOCATABLE :: VC_2(:)                !ND					   |		REAL*8,  ALLOCATABLE :: VC_2(:)                !ND
!												   |	!
	REAL(10),  ALLOCATABLE :: BETA(:)                !ND : Sobolev escape probability	   |		REAL*8,  ALLOCATABLE :: BETA(:)                !ND : Sobolev escape probability
	REAL(10),  ALLOCATABLE :: BETAC(:)               !ND : Dilution factor weighted "escape    |		REAL*8,  ALLOCATABLE :: BETAC(:)               !ND : Dilution factor weighted "escape pr
!												   |	!
	REAL(10),  ALLOCATABLE :: BETAC_SIM(:,:)         !ND,MAX_SIM				   |		REAL*8,  ALLOCATABLE :: BETAC_SIM(:,:)         !ND,MAX_SIM
	REAL(10),  ALLOCATABLE :: ZNET_SIM(:,:)          !ND,MAX_SIM				   |		REAL*8,  ALLOCATABLE :: ZNET_SIM(:,:)          !ND,MAX_SIM
	REAL(10),  ALLOCATABLE :: JBAR_SIM(:,:)          !ND,MAX_SIM				   |		REAL*8,  ALLOCATABLE :: JBAR_SIM(:,:)          !ND,MAX_SIM
	REAL(10) OPAC_FAC									   |		REAL*8 OPAC_FAC
	REAL(10) EMIS_FAC									   |		REAL*8 EMIS_FAC
	REAL(10) STIM_FAC									   |		REAL*8 STIM_FAC
	REAL(10) MUL_FAC									   |		REAL*8 MUL_FAC
	REAL(10) dRATE_dT									   |		REAL*8 dRATE_dT
	REAL(10) dRATE_dLOW									   |		REAL*8 dRATE_dLOW
	REAL(10) dRATE_dUP									   |		REAL*8 dRATE_dUP
	REAL(10) RATE_FAC									   |		REAL*8 RATE_FAC
	REAL(10), ALLOCATABLE :: L_STAR_RATIO(:,:)    !ND,MAX_SIM				   |		REAL*8, ALLOCATABLE :: L_STAR_RATIO(:,:)    !ND,MAX_SIM
	REAL(10), ALLOCATABLE :: U_STAR_RATIO(:,:)    !ND,MAX_SIM				   |		REAL*8, ALLOCATABLE :: U_STAR_RATIO(:,:)    !ND,MAX_SIM
	REAL(10), ALLOCATABLE :: dL_RAT_dT(:,:)       !ND,MAX_SIM				   |		REAL*8, ALLOCATABLE :: dL_RAT_dT(:,:)       !ND,MAX_SIM
	REAL(10), ALLOCATABLE :: dU_RAT_dT(:,:)       !ND,MAX_SIM				   |		REAL*8, ALLOCATABLE :: dU_RAT_dT(:,:)       !ND,MAX_SIM
	REAL(10), ALLOCATABLE :: LOW_OCC_PROB(:)      !ND					   |		REAL*8, ALLOCATABLE :: LOW_OCC_PROB(:)      !ND
	REAL(10), ALLOCATABLE :: LINE_PROF_SIM(:,:)             !ND,MAX_SIM			   |		REAL*8, ALLOCATABLE :: LINE_PROF_SIM(:,:)             !ND,MAX_SIM
	REAL(10), ALLOCATABLE :: LINE_QW_SIM(:,:)               !ND,MAX_SIM			   |		REAL*8, ALLOCATABLE :: LINE_QW_SIM(:,:)               !ND,MAX_SIM
	REAL(10), ALLOCATABLE :: LINE_QW_SUM(:,:)               !ND,MAX_SIM			   |		REAL*8, ALLOCATABLE :: LINE_QW_SUM(:,:)               !ND,MAX_SIM
	REAL(10), ALLOCATABLE :: NEG_OPAC_FAC(:)                !ND				   |		REAL*8, ALLOCATABLE :: NEG_OPAC_FAC(:)                !ND
	REAL(10), ALLOCATABLE :: LINE_OPAC_CON(:)               !MAX_SIM			   |		REAL*8, ALLOCATABLE :: LINE_OPAC_CON(:)               !MAX_SIM
	REAL(10), ALLOCATABLE :: LINE_EMIS_CON(:)               !MAX_SIM			   |		REAL*8, ALLOCATABLE :: LINE_EMIS_CON(:)               !MAX_SIM
	REAL(10), ALLOCATABLE ::  AVE_ENERGY(:)                 !NT				   |		REAL*8, ALLOCATABLE ::  AVE_ENERGY(:)                 !NT
./new_main/mod_subs/line_vec_mod.f
	REAL(10),      ALLOCATABLE :: VEC_FREQ(:)             !NLINE_MAX			   |		REAL*8,      ALLOCATABLE :: VEC_FREQ(:)             !NLINE_MAX
	REAL(10),      ALLOCATABLE :: VEC_STRT_FREQ(:)        !NLINE_MAX			   |		REAL*8,      ALLOCATABLE :: VEC_STRT_FREQ(:)        !NLINE_MAX
	REAL(10),      ALLOCATABLE :: VEC_OSCIL(:)            !NLINE_MAX			   |		REAL*8,      ALLOCATABLE :: VEC_OSCIL(:)            !NLINE_MAX
	REAL(10),      ALLOCATABLE :: VEC_EINA(:)             !NLINE_MAX			   |		REAL*8,      ALLOCATABLE :: VEC_EINA(:)             !NLINE_MAX
	REAL(10),      ALLOCATABLE :: VEC_ARAD(:)             !NLINE_MAX			   |		REAL*8,      ALLOCATABLE :: VEC_ARAD(:)             !NLINE_MAX
	REAL(10),      ALLOCATABLE :: VEC_VDOP_MIN(:)         !NLINE_MAX			   |		REAL*8,      ALLOCATABLE :: VEC_VDOP_MIN(:)         !NLINE_MAX
	REAL(10),      ALLOCATABLE :: VEC_DP_WRK(:)           !NLINE_MAX			   |		REAL*8,      ALLOCATABLE :: VEC_DP_WRK(:)           !NLINE_MAX
./new_main/mod_subs/mod_cmfgen.f
	REAL(10) AT_MASS(NUM_SPECIES)		!Atomic mass in amu				   |		REAL*8 AT_MASS(NUM_SPECIES)		!Atomic mass in amu
	REAL(10) AT_NO(NUM_SPECIES)		!Atomic number of species			   |		REAL*8 AT_NO(NUM_SPECIES)		!Atomic number of species
	REAL(10) AT_ABUND(NUM_SPECIES)		!Fractional species abundance			   |		REAL*8 AT_ABUND(NUM_SPECIES)		!Fractional species abundance
	REAL(10) SOL_MASS_FRAC(NUM_SPECIES)	!Solar mass fraction				   |		REAL*8 SOL_MASS_FRAC(NUM_SPECIES)	!Solar mass fraction
	REAL(10) SOL_ABUND_HSCL(NUM_SPECIES)	!Solar abundance with H=12.0			   |		REAL*8 SOL_ABUND_HSCL(NUM_SPECIES)	!Solar abundance with H=12.0
	REAL(10), ALLOCATABLE :: POP_SPECIES(:,:)						   |		REAL*8, ALLOCATABLE :: POP_SPECIES(:,:)
	REAL(10), ALLOCATABLE :: GAM_SPECIES(:,:)						   |		REAL*8, ALLOCATABLE :: GAM_SPECIES(:,:)
	  REAL(10), ALLOCATABLE :: XzV_F(:,:)		!Level populations in FULL atom		   |		  REAL*8, ALLOCATABLE :: XzV_F(:,:)		!Level populations in FULL atom
	  REAL(10), ALLOCATABLE :: XzVLTE_F(:,:)		!LTE level populations in FULL a   |		  REAL*8, ALLOCATABLE :: XzVLTE_F(:,:)		!LTE level populations in FULL atom
          REAL(10), ALLOCATABLE :: LOG_XzVLTE_F(:,:)  	!Log(LTE level populations in FULL atom)   |	          REAL*8, ALLOCATABLE :: LOG_XzVLTE_F(:,:)  	!Log(LTE level populations in FULL atom)
          REAL(10), ALLOCATABLE :: XzVLTE_F_ON_S(:,:) 	!Log(LTE level populations in FULL atom)   |	          REAL*8, ALLOCATABLE :: XzVLTE_F_ON_S(:,:) 	!Log(LTE level populations in FULL atom)
	  REAL(10), ALLOCATABLE :: W_XzV_F(:,:)		!Level dissolution factors		   |		  REAL*8, ALLOCATABLE :: W_XzV_F(:,:)		!Level dissolution factors
	  REAL(10), ALLOCATABLE :: DXzV_F(:)		!Ion population for full atom		   |		  REAL*8, ALLOCATABLE :: DXzV_F(:)		!Ion population for full atom
	  REAL(10), ALLOCATABLE :: AXzV_F(:,:)		!Oscillator strength (A(I,j), i<j)	   |		  REAL*8, ALLOCATABLE :: AXzV_F(:,:)		!Oscillator strength (A(I,j), i<j)
	  REAL(10), ALLOCATABLE :: EDGEXzV_F(:)		!Ionization energy to g.s. (10^15 Hz)	   |		  REAL*8, ALLOCATABLE :: EDGEXzV_F(:)		!Ionization energy to g.s. (10^15 Hz)
	  REAL(10), ALLOCATABLE :: GXzV_F(:)		!Level statistical weights in full atom	   |		  REAL*8, ALLOCATABLE :: GXzV_F(:)		!Level statistical weights in full atom
	  REAL(10), ALLOCATABLE :: ARAD(:)                !Inverse radiative lifetime of level	   |		  REAL*8, ALLOCATABLE :: ARAD(:)                !Inverse radiative lifetime of level
	  REAL(10), ALLOCATABLE :: GAM2(:)                !Collisional profile parameter.	   |		  REAL*8, ALLOCATABLE :: GAM2(:)                !Collisional profile parameter.
	  REAL(10), ALLOCATABLE :: GAM4(:)                !Collisional profile parameter.	   |		  REAL*8, ALLOCATABLE :: GAM4(:)                !Collisional profile parameter.
	  REAL(10), ALLOCATABLE :: DXzV(:)		!Ion population for super level		   |		  REAL*8, ALLOCATABLE :: DXzV(:)		!Ion population for super level
	  REAL(10), ALLOCATABLE :: XzV(:,:)		!Level population in SL atom		   |		  REAL*8, ALLOCATABLE :: XzV(:,:)		!Level population in SL atom
	  REAL(10), ALLOCATABLE :: XzVLTE(:,:)		!LTE populations in SL atom		   |		  REAL*8, ALLOCATABLE :: XzVLTE(:,:)		!LTE populations in SL atom
          REAL(10), ALLOCATABLE :: LOG_XzVLTE(:,:)    	!LOG(LTE populations in SL atom)	   |	          REAL*8, ALLOCATABLE :: LOG_XzVLTE(:,:)    	!LOG(LTE populations in SL atom)
	  REAL(10), ALLOCATABLE :: dlnXzVLTE_dlnT(:,:)						   |		  REAL*8, ALLOCATABLE :: dlnXzVLTE_dlnT(:,:)
!												   |	!
	  REAL(10), ALLOCATABLE :: WSXzV(:,:,:)		!Weights assoc. with s.e. eval.		   |		  REAL*8, ALLOCATABLE :: WSXzV(:,:,:)		!Weights assoc. with s.e. eval.
	  REAL(10), ALLOCATABLE :: WCRXzV(:,:,:)		!Weights assoc. with cooling.	   |		  REAL*8, ALLOCATABLE :: WCRXzV(:,:,:)		!Weights assoc. with cooling.
	  REAL(10), ALLOCATABLE :: dWSXzVdT(:,:,:)	!Weights assoc. with d(S.E. Eqn)/dT	   |		  REAL*8, ALLOCATABLE :: dWSXzVdT(:,:,:)	!Weights assoc. with d(S.E. Eqn)/dT
	  REAL(10), ALLOCATABLE :: dWCRXzVdT(:,:,:)	!Weights assoc. with d(EHB)/dT		   |		  REAL*8, ALLOCATABLE :: dWCRXzVdT(:,:,:)	!Weights assoc. with d(EHB)/dT
	  REAL(10), ALLOCATABLE :: WSE_X_XzV(:,:)		!X-ray photoionization weights.	   |		  REAL*8, ALLOCATABLE :: WSE_X_XzV(:,:)		!X-ray photoionization weights.
	  REAL(10), ALLOCATABLE :: WCR_X_XzV(:,:)		!				   |		  REAL*8, ALLOCATABLE :: WCR_X_XzV(:,:)		!
!												   |	!
	  REAL(10), ALLOCATABLE :: APRXzV(:,:)		!Arrays for confirming the SE and RE	   |		  REAL*8, ALLOCATABLE :: APRXzV(:,:)		!Arrays for confirming the SE and RE
	  REAL(10), ALLOCATABLE :: ARRXzV(:,:)		!equations are satisfied.		   |		  REAL*8, ALLOCATABLE :: ARRXzV(:,:)		!equations are satisfied.
	  REAL(10), ALLOCATABLE :: BFCRXzV(:,:)							   |		  REAL*8, ALLOCATABLE :: BFCRXzV(:,:)		
	  REAL(10), ALLOCATABLE :: FFXzV(:)							   |		  REAL*8, ALLOCATABLE :: FFXzV(:)
	  REAL(10), ALLOCATABLE :: CRRXzV(:)							   |		  REAL*8, ALLOCATABLE :: CRRXzV(:)
	  REAL(10), ALLOCATABLE :: CPRXzV(:)							   |		  REAL*8, ALLOCATABLE :: CPRXzV(:)
	  REAL(10), ALLOCATABLE :: COOLXzV(:)							   |		  REAL*8, ALLOCATABLE :: COOLXzV(:)
!												   |	!
	  REAL(10), ALLOCATABLE :: NTCXzV(:)                   !Non-thermal cooling rate for spe   |		  REAL*8, ALLOCATABLE :: NTCXzV(:)                   !Non-thermal cooling rate for speci
	  REAL(10), ALLOCATABLE :: NTIXzV(:)                   !Non-thermal ionization rate	   |		  REAL*8, ALLOCATABLE :: NTIXzV(:)                   !Non-thermal ionization rate
	  REAL(10), ALLOCATABLE :: NT_ION_CXzV(:)              !Non thermal cooling rate (ioniza   |		  REAL*8, ALLOCATABLE :: NT_ION_CXzV(:)              !Non thermal cooling rate (ionizati
	  REAL(10), ALLOCATABLE :: NT_EXC_CXzV(:)              !Non thermal cooling rate (excita   |		  REAL*8, ALLOCATABLE :: NT_EXC_CXzV(:)              !Non thermal cooling rate (excitati
	  REAL(10), ALLOCATABLE :: NT_OMEGA(:,:)               !Non thermal collision strength	   |		  REAL*8, ALLOCATABLE :: NT_OMEGA(:,:)               !Non thermal collision strength
	  REAL(10), ALLOCATABLE :: CHG_RRXzV(:)							   |		  REAL*8, ALLOCATABLE :: CHG_RRXzV(:)
	  REAL(10), ALLOCATABLE :: CHG_PRXzV(:)							   |		  REAL*8, ALLOCATABLE :: CHG_PRXzV(:)
	  REAL(10) ZXzV			!Charge on ion (=1 for HI)				   |		  REAL*8 ZXzV			!Charge on ion (=1 for HI)
	  REAL(10) GIONXzV_F		!Statistical weight of ion				   |		  REAL*8 GIONXzV_F		!Statistical weight of ion
	  REAL(10) CROSEC_NTFAC           !Factor to scale the non-thermal exictation cross-sect   |		  REAL*8 CROSEC_NTFAC           !Factor to scale the non-thermal exictation cross-sectio
	  REAL(10) ION_CROSEC_NTFAC       !Factor to scale non-thermal ioinzation cross-sections   |		  REAL*8 ION_CROSEC_NTFAC       !Factor to scale non-thermal ioinzation cross-sections
	REAL(10), ALLOCATABLE :: R(:)		!Radius in units of 10^10 cm			   |		REAL*8, ALLOCATABLE :: R(:)		!Radius in units of 10^10 cm
	REAL(10), ALLOCATABLE :: V(:)		!V in units of km/s				   |		REAL*8, ALLOCATABLE :: V(:)		!V in units of km/s
	REAL(10), ALLOCATABLE :: SIGMA(:)		!dlnV/dlnR-1				   |		REAL*8, ALLOCATABLE :: SIGMA(:)		!dlnV/dlnR-1
	REAL(10), ALLOCATABLE :: T(:)		!Temperature in units of 10^4 K			   |		REAL*8, ALLOCATABLE :: T(:)		!Temperature in units of 10^4 K
	REAL(10), ALLOCATABLE :: ED(:)		!Electron density (#/cm^3)			   |		REAL*8, ALLOCATABLE :: ED(:)		!Electron density (#/cm^3)
	REAL(10), ALLOCATABLE :: LANG_COORD(:)    !Lagrangian coordinate			   |		REAL*8, ALLOCATABLE :: LANG_COORD(:)    !Lagrangian coordinate
!												   |	!
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)	!Rosseland mean opacity.			   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)	!Rosseland mean opacity.
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)	!Planck mean opacity.				   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)	!Planck mean opacity.
	REAL(10), ALLOCATABLE :: ABS_MEAN(:)	!Absorption mean opacity.			   |		REAL*8, ALLOCATABLE :: ABS_MEAN(:)	!Absorption mean opacity.
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)	!Flux mean opacity				   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)	!Flux mean opacity
	REAL(10), ALLOCATABLE :: POP_ATOM(:)	!Total atom density (#/cm^3)			   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)	!Total atom density (#/cm^3)
	REAL(10), ALLOCATABLE :: DENSITY(:)	!Mass density (gm/cm^3)				   |		REAL*8, ALLOCATABLE :: DENSITY(:)	!Mass density (gm/cm^3)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)	!Volume filling factor for clumps		   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)	!Volume filling factor for clumps
	REAL(10), ALLOCATABLE :: POPION(:)	!Ion density					   |		REAL*8, ALLOCATABLE :: POPION(:)	!Ion density
	REAL(10), ALLOCATABLE :: VOL_EXP_FAC(:)	!Volume expansion factor (for time dependent SN    |		REAL*8, ALLOCATABLE :: VOL_EXP_FAC(:)	!Volume expansion factor (for time dependent SN 
	REAL(10), ALLOCATABLE :: VTURB_VEC(:)     !Depth dependent turbulent velocity		   |		REAL*8, ALLOCATABLE :: VTURB_VEC(:)     !Depth dependent turbulent velocity
	REAL(10) STARS_MASS			!In Msun					   |		REAL*8 STARS_MASS			!In Msun
	REAL(10) MOD_TAU_SCL_T									   |		REAL*8 MOD_TAU_SCL_T
./new_main/mod_subs/mod_lev_dis_blk.f
	REAL(10), ALLOCATABLE :: B_LEV_DIS(:)							   |		REAL*8, ALLOCATABLE :: B_LEV_DIS(:)
	REAL(10), ALLOCATABLE :: A_LEV_DIS(:)							   |		REAL*8, ALLOCATABLE :: A_LEV_DIS(:)
	REAL(10), ALLOCATABLE :: X_LEV_DIS(:)							   |		REAL*8, ALLOCATABLE :: X_LEV_DIS(:)
	REAL(10), PARAMETER :: PHOT_DIS_PARAMETER=1.0D-04		!Was 1.0E-06 (29-May-201   |		REAL*8, PARAMETER :: PHOT_DIS_PARAMETER=1.0D-04		!Was 1.0E-06 (29-May-2019) 
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) POPION(ND)									   |		REAL*8 POPION(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
./new_main/mod_subs/nuc_iso_mod.f
	REAL(10) :: NUC_ISO_MOD_DELTA_T								   |		REAL*8 :: NUC_ISO_MOD_DELTA_T
	REAL(10), POINTER :: RADIOACTIVE_DECAY_ENERGY(:)					   |		REAL*8, POINTER :: RADIOACTIVE_DECAY_ENERGY(:)
	REAL(10), POINTER :: KINETIC_DECAY_ENERGY(:)						   |		REAL*8, POINTER :: KINETIC_DECAY_ENERGY(:)
	  REAL(10), POINTER :: OLD_POP(:)							   |		  REAL*8, POINTER :: OLD_POP(:)
	  REAL(10), POINTER :: OLD_POP_DECAY(:)							   |		  REAL*8, POINTER :: OLD_POP_DECAY(:)
	  REAL(10), POINTER :: POP(:)								   |		  REAL*8, POINTER :: POP(:)
	  REAL(10), POINTER :: OLD_POP(:)							   |		  REAL*8, POINTER :: OLD_POP(:)
	  REAL(10), POINTER :: OLD_POP_DECAY(:)							   |		  REAL*8, POINTER :: OLD_POP_DECAY(:)
	  REAL(10), POINTER :: NUM_DECAYS(:)	! added to count the amount of gamma rays for de   |		  REAL*8, POINTER :: NUM_DECAYS(:)	! added to count the amount of gamma rays for de
	  REAL(10), POINTER :: DECAY_LUM(:) 	! Ergs/cm^3/s					   |		  REAL*8, POINTER :: DECAY_LUM(:) 	! Ergs/cm^3/s
	  REAL(10) MASS										   |		  REAL*8 MASS
	  REAL(10) HALF_LIFE              !seconds						   |		  REAL*8 HALF_LIFE              !seconds
	  REAL(10) DECAY_CONST		!seconds						   |		  REAL*8 DECAY_CONST		!seconds
	  REAL(10) MASS			!AMU							   |		  REAL*8 MASS			!AMU
	  REAL(10) DAUGHTER_MASS								   |		  REAL*8 DAUGHTER_MASS
	  REAL(10) ENERGY_PER_DECAY								   |		  REAL*8 ENERGY_PER_DECAY
	  REAL(10) KINETIC_PER_DECAY								   |		  REAL*8 KINETIC_PER_DECAY
./new_main/mod_subs/opac_mod.f
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
	REAL(10), ALLOCATABLE :: ETA_CONT(:)							   |		REAL*8, ALLOCATABLE :: ETA_CONT(:)
	REAL(10), ALLOCATABLE :: ETA_C_EVAL(:)							   |		REAL*8, ALLOCATABLE :: ETA_C_EVAL(:)
	REAL(10), ALLOCATABLE :: ETA_NOSCAT(:)							   |		REAL*8, ALLOCATABLE :: ETA_NOSCAT(:)
	REAL(10), ALLOCATABLE :: ETA_NOSCAT_EVAL(:)						   |		REAL*8, ALLOCATABLE :: ETA_NOSCAT_EVAL(:)
	REAL(10), ALLOCATABLE :: ETA_CLUMP(:)							   |		REAL*8, ALLOCATABLE :: ETA_CLUMP(:)
	REAL(10), ALLOCATABLE :: ETA_MECH(:)							   |		REAL*8, ALLOCATABLE :: ETA_MECH(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: CHI_CONT(:)							   |		REAL*8, ALLOCATABLE :: CHI_CONT(:)
	REAL(10), ALLOCATABLE :: CHI_C_EVAL(:)							   |		REAL*8, ALLOCATABLE :: CHI_C_EVAL(:)
	REAL(10), ALLOCATABLE :: CHI_NOSCAT(:)							   |		REAL*8, ALLOCATABLE :: CHI_NOSCAT(:)
	REAL(10), ALLOCATABLE :: CHI_NOSCAT_EVAL(:)						   |		REAL*8, ALLOCATABLE :: CHI_NOSCAT_EVAL(:)
	REAL(10), ALLOCATABLE :: CHI_CLUMP(:)							   |		REAL*8, ALLOCATABLE :: CHI_CLUMP(:)
	REAL(10), ALLOCATABLE :: TCHI(:)							   |		REAL*8, ALLOCATABLE :: TCHI(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CHI_SCAT(:)							   |		REAL*8, ALLOCATABLE :: CHI_SCAT(:)
	REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		REAL*8, ALLOCATABLE :: CHI_RAY(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: ESEC_CLUMP(:)							   |		REAL*8, ALLOCATABLE :: ESEC_CLUMP(:)
	REAL(10), ALLOCATABLE :: CHI_SCAT_CLUMP(:)						   |		REAL*8, ALLOCATABLE :: CHI_SCAT_CLUMP(:)
	REAL(10), ALLOCATABLE ::  CHI_PREV(:)							   |		REAL*8, ALLOCATABLE ::  CHI_PREV(:)
	REAL(10), ALLOCATABLE ::  CHI_NOSCAT_PREV(:)						   |		REAL*8, ALLOCATABLE ::  CHI_NOSCAT_PREV(:)
	REAL(10), ALLOCATABLE ::  CHI_SCAT_PREV(:)						   |		REAL*8, ALLOCATABLE ::  CHI_SCAT_PREV(:)
	REAL(10), ALLOCATABLE ::  ETA_PREV(:)							   |		REAL*8, ALLOCATABLE ::  ETA_PREV(:)
	REAL(10), ALLOCATABLE :: ES_COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: ES_COH_VEC(:)
	REAL(10), ALLOCATABLE :: THETA(:)							   |		REAL*8, ALLOCATABLE :: THETA(:)
	REAL(10), ALLOCATABLE :: ZETA(:)							   |		REAL*8, ALLOCATABLE :: ZETA(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
!												   |	!
	REAL(10), ALLOCATABLE :: EMHNUKT(:)							   |		REAL*8, ALLOCATABLE :: EMHNUKT(:)
	REAL(10), ALLOCATABLE :: EMHNUKT_CONT(:)						   |		REAL*8, ALLOCATABLE :: EMHNUKT_CONT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: XRAY_LUM_0P1(:)						   |		REAL*8, ALLOCATABLE :: XRAY_LUM_0P1(:)
	REAL(10), ALLOCATABLE :: XRAY_LUM_1KEV(:)						   |		REAL*8, ALLOCATABLE :: XRAY_LUM_1KEV(:)
	REAL(10), ALLOCATABLE :: XRAY_LUM_TOT(:)						   |		REAL*8, ALLOCATABLE :: XRAY_LUM_TOT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: VCHI(:,:)              !Variation of CHI array.		   |		REAL*8, ALLOCATABLE :: VCHI(:,:)              !Variation of CHI array.
        REAL(10), ALLOCATABLE :: VETA(:,:)              !Variation of ETA array.		   |	        REAL*8, ALLOCATABLE :: VETA(:,:)              !Variation of ETA array.
        REAL(10), ALLOCATABLE :: VCHI_SAV(:,:)							   |	        REAL*8, ALLOCATABLE :: VCHI_SAV(:,:)
        REAL(10), ALLOCATABLE :: VETA_SAV(:,:)							   |	        REAL*8, ALLOCATABLE :: VETA_SAV(:,:)
        REAL(10), ALLOCATABLE :: VCHI_ALL(:,:)							   |	        REAL*8, ALLOCATABLE :: VCHI_ALL(:,:)
	REAL(10), ALLOCATABLE :: VCHI_ALL_SAV(:,:)						   |		REAL*8, ALLOCATABLE :: VCHI_ALL_SAV(:,:)
        REAL(10), ALLOCATABLE :: VETA_ALL(:,:)							   |	        REAL*8, ALLOCATABLE :: VETA_ALL(:,:)
	REAL(10), ALLOCATABLE :: VETA_ALL_SAV(:,:)						   |		REAL*8, ALLOCATABLE :: VETA_ALL_SAV(:,:)
./new_main/mod_subs/radiation_mod.f
	REAL(10), ALLOCATABLE :: RJ(:)      	!ND - Mean intensity  (ND)			   |		REAL*8, ALLOCATABLE :: RJ(:)      	!ND - Mean intensity  (ND)
	REAL(10), ALLOCATABLE :: RJ_ES(:)   	!ND - Convolution of RJ with e.s. R(v'v')	   |		REAL*8, ALLOCATABLE :: RJ_ES(:)   	!ND - Convolution of RJ with e.s. R(v'v')
	REAL(10), ALLOCATABLE :: J_INT(:)   	!ND - Frequency integrated J			   |		REAL*8, ALLOCATABLE :: J_INT(:)   	!ND - Frequency integrated J
	REAL(10), ALLOCATABLE :: H_INT(:)   	!ND - Frequency integrated K			   |		REAL*8, ALLOCATABLE :: H_INT(:)   	!ND - Frequency integrated K
	REAL(10), ALLOCATABLE :: K_INT(:)   	!ND - Frequency integrated K			   |		REAL*8, ALLOCATABLE :: K_INT(:)   	!ND - Frequency integrated K
	REAL(10), ALLOCATABLE :: H_MOM(:)   	!ND - Frequency dependent H moment		   |		REAL*8, ALLOCATABLE :: H_MOM(:)   	!ND - Frequency dependent H moment
	REAL(10), ALLOCATABLE :: K_MOM(:)   	!ND - Frequency dependent K moment		   |		REAL*8, ALLOCATABLE :: K_MOM(:)   	!ND - Frequency dependent K moment
	REAL(10), ALLOCATABLE :: INT_dBdT(:)     	!ND - Int. of dB/dT dv (to calculate ROS   |		REAL*8, ALLOCATABLE :: INT_dBdT(:)     	!ND - Int. of dB/dT dv (to calculate ROSSMEAN)
	REAL(10), ALLOCATABLE :: RLUMST(:)      	!ND - Luminosity as a function of depth	   |		REAL*8, ALLOCATABLE :: RLUMST(:)      	!ND - Luminosity as a function of depth
	REAL(10), ALLOCATABLE :: MECH_LUM(:)     	!ND - Mechanical luminosity		   |		REAL*8, ALLOCATABLE :: MECH_LUM(:)     	!ND - Mechanical luminosity
	REAL(10), ALLOCATABLE :: SOB(:)      	!ND - Used in computing continuum flux		   |		REAL*8, ALLOCATABLE :: SOB(:)      	!ND - Used in computing continuum flux
	REAL(10), ALLOCATABLE :: LLUMST(:)      	!ND - Line luminosity.			   |		REAL*8, ALLOCATABLE :: LLUMST(:)      	!ND - Line luminosity.
	REAL(10), ALLOCATABLE :: DIELUM(:)      	!ND - Dielectronic line emission luminos   |		REAL*8, ALLOCATABLE :: DIELUM(:)      	!ND - Dielectronic line emission luminosity.
	REAL(10), ALLOCATABLE :: DEP_RAD_EQ(:)    !ND - Integrated departure from radiative equi   |		REAL*8, ALLOCATABLE :: DEP_RAD_EQ(:)    !ND - Integrated departure from radiative equili
	REAL(10), ALLOCATABLE :: DJDt_FLUX(:)     !ND - DJDT correction to integrated flux.	   |		REAL*8, ALLOCATABLE :: DJDt_FLUX(:)     !ND - DJDT correction to integrated flux.
	REAL(10), ALLOCATABLE :: DJDt_TERM(:)     !ND - 					   |		REAL*8, ALLOCATABLE :: DJDt_TERM(:)     !ND - 
	REAL(10), ALLOCATABLE :: VDOP_VEC(:)      !ND						   |		REAL*8, ALLOCATABLE :: VDOP_VEC(:)      !ND
	REAL(10), ALLOCATABLE :: Z(:)        	!NDMAX - Z displacement along a given array	   |		REAL*8, ALLOCATABLE :: Z(:)        	!NDMAX - Z displacement along a given array
	REAL(10), ALLOCATABLE :: TA(:)        	!NDMAX -					   |		REAL*8, ALLOCATABLE :: TA(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: TB(:)        	!NDMAX -					   |		REAL*8, ALLOCATABLE :: TB(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: TC(:)        	!NDMAX -					   |		REAL*8, ALLOCATABLE :: TC(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: XM(:)        	!NDMAX - R.H.S. (SOURCE VECTOR)			   |		REAL*8, ALLOCATABLE :: XM(:)        	!NDMAX - R.H.S. (SOURCE VECTOR)
	REAL(10), ALLOCATABLE :: DTAU(:)        	!NDMAX - Optical depth (used in error ca   |		REAL*8, ALLOCATABLE :: DTAU(:)        	!NDMAX - Optical depth (used in error calcs)
	REAL(10), ALLOCATABLE :: dCHIdR(:)        !NDMAX - Derivative of opacity.		   |		REAL*8, ALLOCATABLE :: dCHIdR(:)        !NDMAX - Derivative of opacity.
	REAL(10), ALLOCATABLE :: WM(:,:)        	!ND,ND - Coef. matrix of J & %J vector	   |		REAL*8, ALLOCATABLE :: WM(:,:)        	!ND,ND - Coef. matrix of J & %J vector
	REAL(10), ALLOCATABLE :: FB(:,:)        	!ND,ND - Coef. of J & %J vects in angula   |		REAL*8, ALLOCATABLE :: FB(:,:)        	!ND,ND - Coef. of J & %J vects in angular equ.
	REAL(10), ALLOCATABLE :: FEDD(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: FEDD(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: GEDD(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: GEDD(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: QEDD(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: QEDD(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: N_ON_J(:)        !NDMAX -					   |		REAL*8, ALLOCATABLE :: N_ON_J(:)        !NDMAX -
	REAL(10), ALLOCATABLE :: RSQHNU(:)        !NDMAX -					   |		REAL*8, ALLOCATABLE :: RSQHNU(:)        !NDMAX -
	REAL(10), ALLOCATABLE :: N_ON_J_NODE(:)		!					   |		REAL*8, ALLOCATABLE :: N_ON_J_NODE(:)		!
	REAL(10), ALLOCATABLE :: H_ON_J(:)		!					   |		REAL*8, ALLOCATABLE :: H_ON_J(:)		!
	REAL(10), ALLOCATABLE :: KMID_ON_J(:)		!					   |		REAL*8, ALLOCATABLE :: KMID_ON_J(:)		!
	REAL(10), ALLOCATABLE :: dlnJdlNR(:)		!					   |		REAL*8, ALLOCATABLE :: dlnJdlNR(:)		!
	REAL(10) HBC_CMF(3)									   |		REAL*8 HBC_CMF(3)
	REAL(10) NBC_CMF(3)									   |		REAL*8 NBC_CMF(3)
	REAL(10) INBC										   |		REAL*8 INBC
	REAL(10) HBC_J										   |		REAL*8 HBC_J
	REAL(10) HBC_S			!Bound. Cond. for JFEAU					   |		REAL*8 HBC_S			!Bound. Cond. for JFEAU
	REAL(10) HBC_PREV(3)									   |		REAL*8 HBC_PREV(3)
	REAL(10) NBC_PREV(3)									   |		REAL*8 NBC_PREV(3)
	REAL(10) INBC_PREV									   |		REAL*8 INBC_PREV
!												   |	!
	REAL(10), ALLOCATABLE :: FEDD_PREV(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: FEDD_PREV(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: GEDD_PREV(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: GEDD_PREV(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: JNU_PREV(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: JNU_PREV(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)        	!NDMAX -				   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)        	!NDMAX -
	REAL(10), ALLOCATABLE :: FOLD(:)        		!NDMAX				   |		REAL*8, ALLOCATABLE :: FOLD(:)        		!NDMAX
	REAL(10), ALLOCATABLE :: COEF(:,:)        	!0:3,NDMAX				   |		REAL*8, ALLOCATABLE :: COEF(:,:)        	!0:3,NDMAX
	REAL(10), ALLOCATABLE :: REXT(:)        		!NDMAX				   |		REAL*8, ALLOCATABLE :: REXT(:)        		!NDMAX
	REAL(10), ALLOCATABLE :: VEXT(:)        		!NDMAX				   |		REAL*8, ALLOCATABLE :: VEXT(:)        		!NDMAX
	REAL(10), ALLOCATABLE :: LANG_COORDEXT(:)        	!NDMAX				   |		REAL*8, ALLOCATABLE :: LANG_COORDEXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: TEXT(:)        		!NDMAX				   |		REAL*8, ALLOCATABLE :: TEXT(:)        		!NDMAX
	REAL(10), ALLOCATABLE :: SIGMAEXT(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: SIGMAEXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: VDOP_VEC_EXT(:)        	!NDMAX				   |		REAL*8, ALLOCATABLE :: VDOP_VEC_EXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: CHIEXT(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: CHIEXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: ESECEXT(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: ESECEXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: ETAEXT(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: ETAEXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: ZETAEXT(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: ZETAEXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: THETAEXT(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: THETAEXT(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: RJEXT(:)        		!NDMAX				   |		REAL*8, ALLOCATABLE :: RJEXT(:)        		!NDMAX
	REAL(10), ALLOCATABLE :: RJEXT_ES(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: RJEXT_ES(:)        	!NDMAX
	REAL(10), ALLOCATABLE :: FEXT(:)        		!NDMAX				   |		REAL*8, ALLOCATABLE :: FEXT(:)        		!NDMAX
	REAL(10), ALLOCATABLE :: QEXT(:)        		!NDMAX				   |		REAL*8, ALLOCATABLE :: QEXT(:)        		!NDMAX
	REAL(10), ALLOCATABLE :: SOURCEEXT(:)        	!NDMAX					   |		REAL*8, ALLOCATABLE :: SOURCEEXT(:)        	!NDMAX
	REAL(10) DTDR										   |		REAL*8 DTDR
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DDBBDT										   |		REAL*8 DDBBDT
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
./new_main/mod_subs/rd_cont_j.f
	REAL(10) FL										   |		REAL*8 FL
	REAL(10), SAVE :: LOW_FREQ, HIGH_FREQ							   |		REAL*8, SAVE :: LOW_FREQ, HIGH_FREQ
	REAL(10), ALLOCATABLE :: RJ_LOW(:)							   |		REAL*8, ALLOCATABLE :: RJ_LOW(:)
	REAL(10), ALLOCATABLE :: RJ_HIGH(:)							   |		REAL*8, ALLOCATABLE :: RJ_HIGH(:)
	REAL(10) T1										   |		REAL*8 T1
./new_main/mod_subs/rd_control_variables.f
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	    VTURB_MIN=VTURB; VTURB_MAX=VTURB							   |		    VTURB_MIN=VTURB; VTURB_MAX=VTURB; VTURB_POW=1; VTURB_LAW='POW'
												   >		    VTURB_LAW='POW'; VTURB_POW=1
												   >		    CALL RD_STORE_NCHAR(VTURB_LAW,'VTURB_LAW',ITEN,L_FALSE,
												   >		1      'Law describing variation of turbulent velocity with V')
												   >		    CALL RD_STORE_DBLE(VTURB_POW,'VTURB_POW',L_FALSE,
												   >		1      'Power describing variation of turbulent velocity with V')
												   >		    IF(VTURB_LAW .EQ. 'TRUNC_POW')THEN
												   >		      CALL RD_STORE_DBLE(VTURB_VEND,'VTURB_VEND',L_TRUE,
												   >		1        'V(km/s) at which lineare increase in Vturb ends')
												   >		    END IF
./new_main/mod_subs/set_abund_clump.f
												   >	! Altered 29-Jul-2023 : Update VTURB_VEC -- now allow for POW law option.
	REAL(10) MEAN_ATOMIC_WEIGHT	!In amu (does not include electrons)			   |		REAL*8 MEAN_ATOMIC_WEIGHT	!In amu (does not include electrons)
	REAL(10) ABUND_SUM									   |		REAL*8 ABUND_SUM
	REAL(10) T1,T2,T3,T4,PI									   |		REAL*8 T1,T2,T3,T4,PI
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10), ALLOCATABLE :: R_HYDRO(:),RHO_HYDRO(:),T_HYDRO(:),LOG_R_HYDRO(:)		   |		REAL*8, ALLOCATABLE :: R_HYDRO(:),RHO_HYDRO(:),T_HYDRO(:),LOG_R_HYDRO(:)
        REAL(10) ATOMIC_MASS_UNIT								   |	        REAL*8 ATOMIC_MASS_UNIT
												   >		IF(VTURB_LAW .EQ. 'POW')THEN
												   >		  VTURB_VEC(1:ND)=VTURB_MIN+(VTURB_MAX-VTURB_MIN)*(V(1:ND)/V(1))**VTURB_POW
												   >		ELSE IF(VTURB_LAW .EQ. 'TRUNC_POW')THEN
												   >		  DO I=1,ND
												   >		    T1=MIN(V(I),VTURB_VEND)/VTURB_VEND
												   >		    VTURB_VEC(I)=VTURB_MIN+(VTURB_MAX-VTURB_MIN)*(T1**VTURB_POW)
												   >		  END DO
												   >		ELSE
												   >		  WRITE(6,*)'Error VTURB law not recognized in SET_ABUND_CLUMP'
												   >		  STOP
												   >		END IF
												   >	!	
./new_main/mod_subs/set_ang_qw.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) REXT(NDEXT)									   |		REAL*8 REXT(NDEXT)
	REAL(10) W1(NPEXT),W2(NPEXT),W3(NPEXT)		!Work vectors				   |		REAL*8 W1(NPEXT),W2(NPEXT),W3(NPEXT)		!Work vectors
./new_main/mod_subs/set_ang_qw_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) REXT(NDEXT)									   |		REAL*8 REXT(NDEXT)
	REAL(10) R_PNT_SRCE									   |		REAL*8 R_PNT_SRCE
./new_main/mod_subs/set_frequency_grid.f
	REAL(10) NU(NCF_MAX)									   |		REAL*8 NU(NCF_MAX)
	REAL(10) FQW(NCF_MAX)									   |		REAL*8 FQW(NCF_MAX)
	REAL(10) NU_EVAL_CONT(NCF_MAX)								   |		REAL*8 NU_EVAL_CONT(NCF_MAX)
	REAL(10) OBS_FREQ(NCF_MAX)								   |		REAL*8 OBS_FREQ(NCF_MAX)
	REAL(10) OBS(NCF_MAX)									   |		REAL*8 OBS(NCF_MAX)
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) LAMVACAIR									   |		REAL*8 LAMVACAIR
	REAL(10) NU_MAX_OBS									   |		REAL*8 NU_MAX_OBS
	REAL(10) NU_MIN_OBS									   |		REAL*8 NU_MIN_OBS
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./new_main/mod_subs/set_frequency_grid_v2.f
	REAL(10) NU(NCF_MAX)									   |		REAL*8 NU(NCF_MAX)
	REAL(10) FQW(NCF_MAX)									   |		REAL*8 FQW(NCF_MAX)
	REAL(10) NU_EVAL_CONT(NCF_MAX)								   |		REAL*8 NU_EVAL_CONT(NCF_MAX)
	REAL(10) OBS_FREQ(NCF_MAX)								   |		REAL*8 OBS_FREQ(NCF_MAX)
	REAL(10) OBS(NCF_MAX)									   |		REAL*8 OBS(NCF_MAX)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) LOC_ED(ND)									   |		REAL*8 LOC_ED(ND)
	REAL(10) LOC_T(ND)									   |		REAL*8 LOC_T(ND)
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) LAMVACAIR									   |		REAL*8 LAMVACAIR
	REAL(10) NU_MAX_OBS									   |		REAL*8 NU_MAX_OBS
	REAL(10) NU_MIN_OBS									   |		REAL*8 NU_MIN_OBS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2
	REAL(10) C_KMS										   |		REAL*8 C_KMS
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
        REAL(10) OPLIN,EMLIN									   |	        REAL*8 OPLIN,EMLIN
	T3=1.0D0										   <
	1               T3,dV_OBS_PROF,dV_OBS_WING,dV_OBS_BIG,					   |		1               1.0D0,dV_OBS_PROF,dV_OBS_WING,dV_OBS_BIG,
./new_main/mod_subs/set_line_opac.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
        REAL(10) OPLIN,EMLIN									   |	        REAL*8 OPLIN,EMLIN
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) FL										   |		REAL*8 FL
./new_main/mod_subs/set_new_model_estimates.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) Z_POP(NT)			!Vector containing Z of atom/ion (not core)	   |		REAL*8 Z_POP(NT)			!Vector containing Z of atom/ion (not core)
	REAL(10) FQW(NCF)									   |		REAL*8 FQW(NCF)
	REAL(10) NU_EVAL_CONT(NCF)								   |		REAL*8 NU_EVAL_CONT(NCF)
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
        REAL(10), ALLOCATABLE :: U_PAR_FN(:,:)							   |	        REAL*8, ALLOCATABLE :: U_PAR_FN(:,:)
        REAL(10), ALLOCATABLE :: PHI_PAR_FN(:,:)						   |	        REAL*8, ALLOCATABLE :: PHI_PAR_FN(:,:)
        REAL(10), ALLOCATABLE :: Z_PAR_FN(:)							   |	        REAL*8, ALLOCATABLE :: Z_PAR_FN(:)
        REAL(10) SPEC_DEN(ND,NUM_SPECIES)         !Used by ELEC_PREP				   |	        REAL*8 SPEC_DEN(ND,NUM_SPECIES)         !Used by ELEC_PREP
	REAL(10) AT_NO_VEC(ND,NUM_SPECIES)							   |		REAL*8 AT_NO_VEC(ND,NUM_SPECIES)
!												   |	!
	REAL(10) TGREY(ND)			!Grey temperature structure			   |		REAL*8 TGREY(ND)			!Grey temperature structure
	REAL(10) T_SAVE(ND)									   |		REAL*8 T_SAVE(ND)
	REAL(10) ROSSMEAN(ND)			!Rosseland mean opacity				   |		REAL*8 ROSSMEAN(ND)			!Rosseland mean opacity
	REAL(10) PLANCKMEAN(ND)			!Planck mean opacity				   |		REAL*8 PLANCKMEAN(ND)			!Planck mean opacity
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) QH(ND)										   |		REAL*8 QH(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) GAMH(ND)									   |		REAL*8 GAMH(ND)
	REAL(10) H(ND)										   |		REAL*8 H(ND)
	REAL(10) SOB(ND)									   |		REAL*8 SOB(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
!												   |	!
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) HBC_J										   |		REAL*8 HBC_J
	REAL(10) NU_DOP										   |		REAL*8 NU_DOP
	REAL(10) FL		!Current frequency						   |		REAL*8 FL		!Current frequency
	REAL(10) CONT_FREQ	!Frequency at which current ETA/CHI was evaluated		   |		REAL*8 CONT_FREQ	!Frequency at which current ETA/CHI was evaluated
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	WRITE(6,*)'Calling AUTO_ADD_ION'							   |		WRITE(6,*)'Calling AUTO_ADD_ION';  FLUSH(UNIT=6)
	FLUSH(UNIT=6)										   <
! We use TA for ED and TB for T since ED and T have already been set.				   |		    TC(1:ND)=ED(1:ND)*CLUMP_FAC(1:ND)
!												   |		    IF(DC_INTERP_METHOD .EQ. 'R')THEN
	    WRITE(LUER,*)'Departure coefficients assumed to be function of R.'			   |		      WRITE(LUER,*)'Departure coefficients assumed to be function of R.'
												   >		    ELSE
												   >		      WRITE(LUER,*)'Departure coefficients assumed to be function of R and T.'
												   >		    END IF
	        CALL REGRID_LOG_DC_V1( ATM(ID)%XzV_F,R,ED,T, ATM(ID)%DXzV_F,CLUMP_FAC,		   |		        CALL REGRID_LOG_DC_V1( ATM(ID)%XzV_F,R,TC,T, ATM(ID)%DXzV_F,CLUMP_FAC,
./new_main/mod_subs/shock_power_mod.f
      REAL(10), ALLOCATABLE :: SHOCK_POWER(:)							   |	      REAL*8, ALLOCATABLE :: SHOCK_POWER(:)
./new_main/mod_subs/solve_for_pops.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) SOL(NT,ND)									   |		REAL*8 SOL(NT,ND)
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10), SAVE :: MAXCH_SUM=0.0D0							   |		REAL*8, SAVE :: MAXCH_SUM=0.0D0
./new_main/mod_subs/steq_data_mod.f
          REAL(10), POINTER :: STEQ(:,:)  		!Statistical equilibrium Eqns. for XzV	   |	          REAL*8, POINTER :: STEQ(:,:)  		!Statistical equilibrium Eqns. for XzV
          REAL(10), POINTER :: STEQ_ADV(:)  		!Statistical equilibrium ion eqns. for a   |	          REAL*8, POINTER :: STEQ_ADV(:)  		!Statistical equilibrium ion eqns. for a
          REAL(10), POINTER :: QFV_P(:,:)  		!					   |	          REAL*8, POINTER :: QFV_P(:,:)  		!
          REAL(10), POINTER :: QFV_R(:,:)  		!					   |	          REAL*8, POINTER :: QFV_R(:,:)  		!
          REAL(10), POINTER :: QFV_P_EHB(:,:)  		!					   |	          REAL*8, POINTER :: QFV_P_EHB(:,:)  		!
          REAL(10), POINTER :: QFV_R_EHB(:,:)  		!					   |	          REAL*8, POINTER :: QFV_R_EHB(:,:)  		!
          REAL(10), POINTER :: BA(:,:,:,:)		!BA matrix for XzV			   |	          REAL*8, POINTER :: BA(:,:,:,:)		!BA matrix for XzV
          REAL(10), POINTER :: BA_PAR(:,:,:)		!BA matrix for XzV (diagonal terms)	   |	          REAL*8, POINTER :: BA_PAR(:,:,:)		!BA matrix for XzV (diagonal terms)
        REAL(10), ALLOCATABLE :: STEQ_T(:)							   |	        REAL*8, ALLOCATABLE :: STEQ_T(:)
        REAL(10), ALLOCATABLE :: STEQ_ED(:)							   |	        REAL*8, ALLOCATABLE :: STEQ_ED(:)
        REAL(10), ALLOCATABLE :: BA_T(:,:,:)							   |	        REAL*8, ALLOCATABLE :: BA_T(:,:,:)
        REAL(10), ALLOCATABLE :: BA_ED(:,:,:)							   |	        REAL*8, ALLOCATABLE :: BA_ED(:,:,:)
        REAL(10), ALLOCATABLE :: BA_ADV_TERM(:,:)						   |	        REAL*8, ALLOCATABLE :: BA_ADV_TERM(:,:)
        REAL(10), ALLOCATABLE :: BA_T_PAR(:,:)							   |	        REAL*8, ALLOCATABLE :: BA_T_PAR(:,:)
        REAL(10), ALLOCATABLE :: STEQ_T_EHB(:)							   |	        REAL*8, ALLOCATABLE :: STEQ_T_EHB(:)
        REAL(10), ALLOCATABLE :: BA_T_EHB(:,:,:)						   |	        REAL*8, ALLOCATABLE :: BA_T_EHB(:,:,:)
        REAL(10), ALLOCATABLE :: BA_T_PAR_EHB(:,:)						   |	        REAL*8, ALLOCATABLE :: BA_T_PAR_EHB(:,:)
./new_main/mod_subs/sub_cmf_line.f
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) EW										   |		REAL*8 EW
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) VB(ND)										   |		REAL*8 VB(ND)
	REAL(10) VC(ND)										   |		REAL*8 VC(ND)
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
./new_main/mod_subs/sub_sob_line.f
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) EW										   |		REAL*8 EW
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) VB(ND)										   |		REAL*8 VB(ND)
	REAL(10) VC(ND)										   |		REAL*8 VC(ND)
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) SRAT										   |		REAL*8 SRAT
!	            IF( ABS(VJ(J,K,L)*POPS(J,LS)) .GE. T3 )THEN					   |	!	            IF( DABS(VJ(J,K,L)*POPS(J,LS)) .GE. T3 )THEN
./new_main/mod_subs/sub_sob_line_v2.f
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) EW										   |		REAL*8 EW
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) AVE_ENERGY(NT)									   |		REAL*8 AVE_ENERGY(NT)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) VB(ND)										   |		REAL*8 VB(ND)
	REAL(10) VC(ND)										   |		REAL*8 VC(ND)
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) SRAT										   |		REAL*8 SRAT
!	            IF( ABS(VJ(J,K,L)*POPS(J,LS)) .GE. T3 )THEN					   |	!	            IF( DABS(VJ(J,K,L)*POPS(J,LS)) .GE. T3 )THEN
./new_main/mod_subs/sub_sob_line_v3.f
	REAL(10) FL										   |		REAL*8 FL
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) EW										   |		REAL*8 EW
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) CHIL(ND)									   |		REAL*8 CHIL(ND)
	REAL(10) ETAL(ND)									   |		REAL*8 ETAL(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) VB(ND)										   |		REAL*8 VB(ND)
	REAL(10) VC(ND)										   |		REAL*8 VC(ND)
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) SRAT										   |		REAL*8 SRAT
!	            IF( ABS(VJ(J,K,L)*POPS(J,LS)) .GE. T3 )THEN					   |	!	            IF( DABS(VJ(J,K,L)*POPS(J,LS)) .GE. T3 )THEN
./new_main/mod_subs/sup_to_full_v4.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) Z_POP(NT)									   |		REAL*8 Z_POP(NT)
./new_main/mod_subs/two_phot_mod.f
	  REAL(10), ALLOCATABLE:: COEF_TWO(:,:)							   |		  REAL*8, ALLOCATABLE:: COEF_TWO(:,:)
          REAL(10), ALLOCATABLE :: Z_TWO(:)							   |	          REAL*8, ALLOCATABLE :: Z_TWO(:)
          REAL(10), ALLOCATABLE :: G_LOW_TWO(:)							   |	          REAL*8, ALLOCATABLE :: G_LOW_TWO(:)
          REAL(10), ALLOCATABLE :: G_UP_TWO(:)							   |	          REAL*8, ALLOCATABLE :: G_UP_TWO(:)
          REAL(10), ALLOCATABLE :: FS_RAT_LOW(:,:)						   |	          REAL*8, ALLOCATABLE :: FS_RAT_LOW(:,:)
          REAL(10), ALLOCATABLE :: FS_RAT_UP(:,:)						   |	          REAL*8, ALLOCATABLE :: FS_RAT_UP(:,:)
          REAL(10), ALLOCATABLE :: FREQ_TWO(:)							   |	          REAL*8, ALLOCATABLE :: FREQ_TWO(:)
!												   |	!
	  REAL(10), ALLOCATABLE :: DOWN_RATE_TWO(:,:)						   |		  REAL*8, ALLOCATABLE :: DOWN_RATE_TWO(:,:)
	  REAL(10), ALLOCATABLE :: UP_RATE_TWO(:,:)						   |		  REAL*8, ALLOCATABLE :: UP_RATE_TWO(:,:)
	  REAL(10), ALLOCATABLE :: PHOT_OC_TWO(:,:)						   |		  REAL*8, ALLOCATABLE :: PHOT_OC_TWO(:,:)
./new_main/mod_subs/var_rad_mod.f
	REAL(10), ALLOCATABLE :: DIFFW(:)         !NT - Variation of diffusion approx. at inner    |		REAL*8, ALLOCATABLE :: DIFFW(:)         !NT - Variation of diffusion approx. at inner bo
	REAL(10), ALLOCATABLE :: VK(:,:)    	!ND,ND - Coef. matrix of %CHI vector		   |		REAL*8, ALLOCATABLE :: VK(:,:)    	!ND,ND - Coef. matrix of %CHI vector
	REAL(10), ALLOCATABLE :: FC(:,:)    	!ND,ND - Coef. of %EMIS vector in angular equ.	   |		REAL*8, ALLOCATABLE :: FC(:,:)    	!ND,ND - Coef. of %EMIS vector in angular equ.
	REAL(10), ALLOCATABLE :: F2DA(:,:)    	!ND,ND - Coef. of %CHi in angular equ.		   |		REAL*8, ALLOCATABLE :: F2DA(:,:)    	!ND,ND - Coef. of %CHi in angular equ.
	REAL(10), ALLOCATABLE :: FA(:)    		!ND 					   |		REAL*8, ALLOCATABLE :: FA(:)    		!ND 
!												   |	!
	REAL(10), ALLOCATABLE :: F2DAEXT(:,:)    	!NDMAX,NDMAX 				   |		REAL*8, ALLOCATABLE :: F2DAEXT(:,:)    	!NDMAX,NDMAX 
	REAL(10), ALLOCATABLE :: FCEXT(:,:)    	!NDMAX,NDMAX 					   |		REAL*8, ALLOCATABLE :: FCEXT(:,:)    	!NDMAX,NDMAX 
	REAL(10), ALLOCATABLE :: FAEXT(:)    	!NDMAX- 					   |		REAL*8, ALLOCATABLE :: FAEXT(:)    	!NDMAX- 
	REAL(10), ALLOCATABLE :: VJ(:,:,:)    	!NT,NUM_BNDS,ND - 				   |		REAL*8, ALLOCATABLE :: VJ(:,:,:)    	!NT,NUM_BNDS,ND - 
	REAL(10), ALLOCATABLE :: TX(:,:,:)    	!ND,ND,NM - 					   |		REAL*8, ALLOCATABLE :: TX(:,:,:)    	!ND,ND,NM - 
	REAL(10), ALLOCATABLE :: TVX(:,:,:)    	!ND-1,ND,NM - 					   |		REAL*8, ALLOCATABLE :: TVX(:,:,:)    	!ND-1,ND,NM - 
	REAL(10), ALLOCATABLE :: TX_EXT(:,:,:)							   |		REAL*8, ALLOCATABLE :: TX_EXT(:,:,:)
	REAL(10), ALLOCATABLE :: TVX_EXT(:,:,:)							   |		REAL*8, ALLOCATABLE :: TVX_EXT(:,:,:)
	REAL(10), ALLOCATABLE :: KI(:,:,:)    		  !NDMAX,ND,NM_KI - 			   |		REAL*8, ALLOCATABLE :: KI(:,:,:)    		  !NDMAX,ND,NM_KI - 
!												   |	!
        REAL(10), ALLOCATABLE :: dJ_LOC(:,:,:)              !NM,NUM_BNDS,ND			   |	        REAL*8, ALLOCATABLE :: dJ_LOC(:,:,:)              !NM,NUM_BNDS,ND
        REAL(10), ALLOCATABLE :: dZ(:,:,:,:)                !NM,NUM_BNDS,ND,MAX_SIM		   |	        REAL*8, ALLOCATABLE :: dZ(:,:,:,:)                !NM,NUM_BNDS,ND,MAX_SIM
        REAL(10), ALLOCATABLE :: dZ_POPS(:,:,:)             !NT,NUM_BNDS,ND			   |	        REAL*8, ALLOCATABLE :: dZ_POPS(:,:,:)             !NT,NUM_BNDS,ND
!												   |	!
	REAL(10), ALLOCATABLE :: dJ_DIF_d_T_EXT(:)          !NDMAX -				   |		REAL*8, ALLOCATABLE :: dJ_DIF_d_T_EXT(:)          !NDMAX -
	REAL(10), ALLOCATABLE :: dJ_DIF_d_dTdR_EXT(:)       !NDMAX -				   |		REAL*8, ALLOCATABLE :: dJ_DIF_d_dTdR_EXT(:)       !NDMAX -
	REAL(10), ALLOCATABLE :: dJ_DIF_d_T(:)              !NDMAX -				   |		REAL*8, ALLOCATABLE :: dJ_DIF_d_T(:)              !NDMAX -
	REAL(10), ALLOCATABLE :: dJ_DIF_d_dTdR(:)           !NDMAX -				   |		REAL*8, ALLOCATABLE :: dJ_DIF_d_dTdR(:)           !NDMAX -
	REAL(10), ALLOCATABLE :: RHS_dHdCHI(:,:)            !NDMAX,ND -				   |		REAL*8, ALLOCATABLE :: RHS_dHdCHI(:,:)            !NDMAX,ND -
	REAL(10), ALLOCATABLE :: dRSQH_DIF_d_T(:)           !NDMAX -				   |		REAL*8, ALLOCATABLE :: dRSQH_DIF_d_T(:)           !NDMAX -
	REAL(10), ALLOCATABLE :: dRSQH_DIF_d_dTdR(:)        !NDMAX -				   |		REAL*8, ALLOCATABLE :: dRSQH_DIF_d_dTdR(:)        !NDMAX -
./new_main/mod_subs/wind_scale_pops_v1.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) Z_POP(NT)									   |		REAL*8 Z_POP(NT)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) OLD_POPATOM(ND)								   |		REAL*8 OLD_POPATOM(ND)
	REAL(10) T1										   |		REAL*8 T1
./new_main/mod_subs/gam_mu_mod.f90
	  REAL(10), DIMENSION(:), ALLOCATABLE :: MU_VECTOR					   |		  REAL*8, DIMENSION(:), ALLOCATABLE :: MU_VECTOR
	  REAL(10), DIMENSION(:), ALLOCATABLE :: MON_MU						   |		  REAL*8, DIMENSION(:), ALLOCATABLE :: MON_MU
	  REAL(10) :: dMU									   |		  REAL*8 :: dMU
./new_main/mod_subs/mod_gamma_trans_v3.f90
	REAL(10) :: GAMRAY_LUM									   |		REAL*8 :: GAMRAY_LUM
	REAL(10), DIMENSION(:), ALLOCATABLE :: NU_GRID_VEC					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: NU_GRID_VEC
	REAL(10), DIMENSION(:), ALLOCATABLE :: ETA_NORM_CONST					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: ETA_NORM_CONST
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAM_ENERGY_DEP					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAM_ENERGY_DEP
	REAL(10), DIMENSION(:), ALLOCATABLE :: NU_VEC !vector of gamma frequencies used from nuc   |		REAL*8, DIMENSION(:), ALLOCATABLE :: NU_VEC !vector of gamma frequencies used from nuc_d
        REAL(10), DIMENSION(:), ALLOCATABLE :: WORK1						   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: WORK1
	REAL(10), DIMENSION(:), ALLOCATABLE :: CROSS_KN						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: CROSS_KN
	REAL(10), DIMENSION(:), ALLOCATABLE :: XCHI,E_SCAT_CHI					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: XCHI,E_SCAT_CHI
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAM_OPAC,GAM_OPAC_CLUMP,GAM_OPAC_COPY		   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAM_OPAC,GAM_OPAC_CLUMP,GAM_OPAC_COPY
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAM_E_ME ! will be h*nu/mec^2 thus unitless	   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAM_E_ME ! will be h*nu/mec^2 thus unitless
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAM_NU_MAX ! will be h*nu/mec^2 thus unitless	   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAM_NU_MAX ! will be h*nu/mec^2 thus unitless
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAMRAY_LUM_VEC					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAMRAY_LUM_VEC
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAMRAY_EMISS					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAMRAY_EMISS
	REAL(10), DIMENSION(:), ALLOCATABLE :: ED_TOT						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: ED_TOT
	REAL(10), DIMENSION(:), ALLOCATABLE :: DECAY_KIN_E					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: DECAY_KIN_E
	REAL(10), DIMENSION(:), ALLOCATABLE :: TOTAL_DECAY_LUM					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: TOTAL_DECAY_LUM
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAMMA_TAU					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAMMA_TAU
	REAL(10), DIMENSION(:), ALLOCATABLE :: XRAY_TAU						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: XRAY_TAU
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAMMA_FLUX					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAMMA_FLUX
	REAL(10), DIMENSION(:), ALLOCATABLE :: NU_VEC_15					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: NU_VEC_15
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAMMA_NU_STORE					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAMMA_NU_STORE
	REAL(10), DIMENSION(:), ALLOCATABLE :: GAMMA_LAM					   |		REAL*8, DIMENSION(:), ALLOCATABLE :: GAMMA_LAM
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: KLEIN_ARRAY					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: KLEIN_ARRAY
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: GAM_ETA !array that gets passed as (mu,depth)	   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: GAM_ETA !array that gets passed as (mu,depth)
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: GAM_INT					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: GAM_INT
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: ETA_ISO					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: ETA_ISO
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: E_SCAT_ARRAY					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: E_SCAT_ARRAY
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: CHI_ARRAY_ABS					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: CHI_ARRAY_ABS
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: GAMMA_J					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: GAMMA_J
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: GAM_ETA_MUAVG					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: GAM_ETA_MUAVG
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: GAM_ETA_NUAVG					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: GAM_ETA_NUAVG
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: GAMMA_STORE					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: GAMMA_STORE
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: GAM_I_STORE					   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: GAM_I_STORE
	REAL(10), DIMENSION(:,:,:), ALLOCATABLE :: GAM_ETA_SCAT					   |		REAL*8, DIMENSION(:,:,:), ALLOCATABLE :: GAM_ETA_SCAT
	REAL(10), DIMENSION(:,:,:), ALLOCATABLE :: GAM_ETA_SCAT_T  ! Will be used as the transpo   |		REAL*8, DIMENSION(:,:,:), ALLOCATABLE :: GAM_ETA_SCAT_T  ! Will be used as the transpose
	REAL(10), DIMENSION(:,:,:), ALLOCATABLE :: GAM_I					   |		REAL*8, DIMENSION(:,:,:), ALLOCATABLE :: GAM_I
	REAL(10), DIMENSION(:,:,:), ALLOCATABLE :: GAM_I_T  	 ! Will be used as the transpose   |		REAL*8, DIMENSION(:,:,:), ALLOCATABLE :: GAM_I_T  	 ! Will be used as the transpose
	REAL(10), PARAMETER :: PLANCK = 4.135668D-21 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN M   |		REAL*8, PARAMETER :: PLANCK = 4.135668D-21 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN MeV
!	REAL(10), PARAMETER :: SOL = 299792 ! Units of km/s					   |	!	REAL*8, PARAMETER :: SOL = 299792 ! Units of km/s
	REAL(10), PARAMETER :: home = 8.09330118D-21	! home = h/mc^2 in units of seconds	   |		REAL*8, PARAMETER :: home = 8.09330118D-21	! home = h/mc^2 in units of seconds
./new_main/mod_subs/mod_rd_gamray_cntrl_variables.f90
	REAL(10) :: V_GAUSS									   |		REAL*8 :: V_GAUSS
	REAL(10) :: V_INF									   |		REAL*8 :: V_INF
	REAL(10) :: V_LINE									   |		REAL*8 :: V_LINE
	REAL(10) :: V_TAIL									   |		REAL*8 :: V_TAIL
	REAL(10) :: V_BETWEEN									   |		REAL*8 :: V_BETWEEN
	REAL(10) :: V_END									   |		REAL*8 :: V_END
	REAL(10) :: BLUE_GAUSS									   |		REAL*8 :: BLUE_GAUSS
	REAL(10) :: RED_GAUSS									   |		REAL*8 :: RED_GAUSS
	REAL(10) :: COMP_TAIL_SPLIT_FRAC							   |		REAL*8 :: COMP_TAIL_SPLIT_FRAC
	REAL(10) :: EGAM_MIN									   |		REAL*8 :: EGAM_MIN
	REAL(10) :: EGAM_MAX									   |		REAL*8 :: EGAM_MAX
./new_main/mod_subs/mod_read_nuc_decay_data_v2.f90
        REAL(10) :: GAMMA_E_VEC(LINE_MAX), PROB_VEC(LINE_MAX)					   |	        REAL*8 :: GAMMA_E_VEC(LINE_MAX), PROB_VEC(LINE_MAX)
        REAL(10) :: E_KIN_VEC(LINE_MAX), ATOM_MASS_VEC(LINE_MAX)				   |	        REAL*8 :: E_KIN_VEC(LINE_MAX), ATOM_MASS_VEC(LINE_MAX)
	 REAL(10) :: ATOMIC_MASS								   |		 REAL*8 :: ATOMIC_MASS
	 REAL(10), DIMENSION(30) :: E_GAMMA							   |		 REAL*8, DIMENSION(30) :: E_GAMMA
	 REAL(10), DIMENSION(30) :: PROB							   |		 REAL*8, DIMENSION(30) :: PROB
	 REAL(10) :: KIN_ENERGY									   |		 REAL*8 :: KIN_ENERGY
./new_main/mod_subs/LINEGEN.INC
 
Comparing files in ./new_main/gam_transport with those in  /home/hillier/wnode04/cmf_testing_real8//new_main/gam_transport
 
./new_main/gam_transport/Makefile
./new_main/gam_transport/gamma_xray_opac_v4_test.f
	REAL(10) :: CHI(ND)									   |		REAL*8 :: CHI(ND)
	REAL(10) :: E_SCAT_CHI(ND)								   |		REAL*8 :: E_SCAT_CHI(ND)
	REAL(10) :: ED_TOT(ND)									   |		REAL*8 :: ED_TOT(ND)
	REAL(10) :: PHOTABS(ND)									   |		REAL*8 :: PHOTABS(ND)
	REAL(10) :: T1,T2,T3,T4									   |		REAL*8 :: T1,T2,T3,T4
	REAL(10) :: NU 		! frequency in Hz 						   |		REAL*8 :: NU 		! frequency in Hz 
	REAL(10) :: XCROSS_V2									   |		REAL*8 :: XCROSS_V2
	REAL(10) :: CROSS_KN									   |		REAL*8 :: CROSS_KN
	REAL(10) :: COMPTON_SIG									   |		REAL*8 :: COMPTON_SIG
	REAL(10) :: EGAM									   |		REAL*8 :: EGAM
	REAL(10) :: XRAY									   |		REAL*8 :: XRAY
	REAL(10), PARAMETER :: PLANCK = 4.135668D-21 ! MeV*s					   |		REAL*8, PARAMETER :: PLANCK = 4.135668D-21 ! MeV*s
	REAL(10), PARAMETER :: SIGT = 6.6524587D-25 ! cm^2					   |		REAL*8, PARAMETER :: SIGT = 6.6524587D-25 ! cm^2
	REAL(10), PARAMETER :: ALPHA = 7.297355257D-3 ! units in cgs				   |		REAL*8, PARAMETER :: ALPHA = 7.297355257D-3 ! units in cgs
	REAL(10), PARAMETER :: MeC2 = 0.5109989 ! MeV						   |		REAL*8, PARAMETER :: MeC2 = 0.5109989 ! MeV
	REAL(10) :: NU										   |		REAL*8 :: NU
	REAL(10) :: CROSS_KN 	! will return in units of cm^2					   |		REAL*8 :: CROSS_KN 	! will return in units of cm^2
	REAL(10) :: EPSI									   |		REAL*8 :: EPSI
	REAL(10) :: X										   |		REAL*8 :: X
	REAL(10) :: PI										   |		REAL*8 :: PI
	REAL(10) :: R_E										   |		REAL*8 :: R_E
	REAL(10) :: R_E_SQD									   |		REAL*8 :: R_E_SQD
!												   |	!
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
	REAL(10), PARAMETER :: TWO=2.0D0							   |		REAL*8, PARAMETER :: TWO=2.0D0
	REAL(10), PARAMETER :: R_C=2.42630694715D-10 ! h/(m_e*c) in units of cm			   |		REAL*8, PARAMETER :: R_C=2.42630694715D-10 ! h/(m_e*c) in units of cm
	REAL(10), PARAMETER :: H = 4.135668E-021	! Units of MeV*s 			   |		REAL*8, PARAMETER :: H = 4.135668E-021	! Units of MeV*s 
	REAL(10), PARAMETER :: M_E = 0.5109989	! Units of MeV					   |		REAL*8, PARAMETER :: M_E = 0.5109989	! Units of MeV
	REAL(10), PARAMETER :: ALPHA=0.007297355257 	! Fine structure constant		   |		REAL*8, PARAMETER :: ALPHA=0.007297355257 	! Fine structure constant
./new_main/gam_transport/electron_density_calc_v2.f90
	REAL(10) :: ED_TOT(ND)									   |		REAL*8 :: ED_TOT(ND)
./new_main/gam_transport/eta_scat_v6.f90
	REAL(10) :: NU_GRID_VEC(NF_GRID_PTS)							   |		REAL*8 :: NU_GRID_VEC(NF_GRID_PTS)
        REAL(10) :: ETA(NA,ND,NF_GRID_PTS) ! (MU,DEPTH,FREQ)					   |	        REAL*8 :: ETA(NA,ND,NF_GRID_PTS) ! (MU,DEPTH,FREQ)
        REAL(10) :: INTENSITY(NA,ND,NF_GRID_PTS) ! (MU,ND,FREQ)					   |	        REAL*8 :: INTENSITY(NA,ND,NF_GRID_PTS) ! (MU,ND,FREQ)
	REAL(10) :: MON_I(MON_NA,ND)								   |		REAL*8 :: MON_I(MON_NA,ND)
	REAL(10) :: KLEIN_ARRAY(NF_GRID_PTS,NF_GRID_PTS)					   |		REAL*8 :: KLEIN_ARRAY(NF_GRID_PTS,NF_GRID_PTS)
	REAL(10) :: ED(ND)									   |		REAL*8 :: ED(ND)
!												   |	!
        REAL(10) :: C1,C2									   |	        REAL*8 :: C1,C2
        REAL(10) :: R_ELEC_SQRD									   |	        REAL*8 :: R_ELEC_SQRD
        REAL(10) :: A1										   |	        REAL*8 :: A1
	REAL(10) :: A2										   |		REAL*8 :: A2
	REAL(10) :: GAM_DIFF									   |		REAL*8 :: GAM_DIFF
	REAL(10) :: GAM_DIFF_SQD								   |		REAL*8 :: GAM_DIFF_SQD
	REAL(10) :: ROOT1									   |		REAL*8 :: ROOT1
	REAL(10) :: ROOT2									   |		REAL*8 :: ROOT2
	REAL(10) :: B1,B2									   |		REAL*8 :: B1,B2
        REAL(10) :: DISC									   |	        REAL*8 :: DISC
        REAL(10) :: CHEB_W									   |	        REAL*8 :: CHEB_W
        REAL(10) :: X(CHEB_ORDER),X2(CHEB_ORDER)						   |	        REAL*8 :: X(CHEB_ORDER),X2(CHEB_ORDER)
        REAL(10) :: E_VEC(NF_GRID_PTS) ! will be h*nu/mec^2 thus unitless			   |	        REAL*8 :: E_VEC(NF_GRID_PTS) ! will be h*nu/mec^2 thus unitless
	REAL(10) :: TEMPINT									   |		REAL*8 :: TEMPINT
	REAL(10) :: MU										   |		REAL*8 :: MU
	REAL(10) :: PI										   |		REAL*8 :: PI
	REAL(10) :: NU_PRIME_ON_NU								   |		REAL*8 :: NU_PRIME_ON_NU
	REAL(10) :: FAC										   |		REAL*8 :: FAC
	REAL(10) :: PRE_FAC(ND)									   |		REAL*8 :: PRE_FAC(ND)
	REAL(10) :: T1,T2,T3,T4									   |		REAL*8 :: T1,T2,T3,T4
	REAL(10) :: DELTA_NU									   |		REAL*8 :: DELTA_NU
	REAL(10), DIMENSION(:), ALLOCATABLE :: INTERP						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: INTERP
	REAL(10), DIMENSION(:), ALLOCATABLE :: INTERP2						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: INTERP2
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: COEF						   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: COEF
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: COEF2						   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: COEF2
	REAL(10), SAVE, ALLOCATABLE :: SQRT_ONE_MIN_B2(:,:)					   |		REAL*8, SAVE, ALLOCATABLE :: SQRT_ONE_MIN_B2(:,:)
	REAL(10)  SQRT_ONE_MIN_GAM_DIFF_SQD							   |		REAL*8  SQRT_ONE_MIN_GAM_DIFF_SQD
	REAL(10), DIMENSION(:,:,:), ALLOCATABLE :: ETA_NORM					   |		REAL*8, DIMENSION(:,:,:), ALLOCATABLE :: ETA_NORM
	REAL(10), DIMENSION(:), ALLOCATABLE :: I_NORM						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: I_NORM
	REAL(10), DIMENSION(:), ALLOCATABLE :: WRK						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: WRK
	REAL(10), DIMENSION(:,:), ALLOCATABLE :: WRK2						   |		REAL*8, DIMENSION(:,:), ALLOCATABLE :: WRK2
	REAL(10), DIMENSION(:), ALLOCATABLE :: NORM						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: NORM
	REAL(10) :: COMPTON_SIG									   |		REAL*8 :: COMPTON_SIG
	   REAL(10), DIMENSION(:,:), ALLOCATABLE :: C						   |		   REAL*8, DIMENSION(:,:), ALLOCATABLE :: C
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
	REAL(10), PARAMETER :: TWO=2.0D0							   |		REAL*8, PARAMETER :: TWO=2.0D0
	REAL(10), PARAMETER :: PLANCK = 4.135668E-021 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN    |		REAL*8, PARAMETER :: PLANCK = 4.135668E-021 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN Me
	REAL(10), PARAMETER :: R_ELEC = 2.8179403227D-13 ! Units of cm				   |		REAL*8, PARAMETER :: R_ELEC = 2.8179403227D-13 ! Units of cm
	REAL(10), PARAMETER :: HoMC2 = 8.09330118D-21     ! HoMC2 = h/mc^2 in units of seconds	   |		REAL*8, PARAMETER :: HoMC2 = 8.09330118D-21     ! HoMC2 = h/mc^2 in units of seconds
	REAL(10) :: NU										   |		REAL*8 :: NU
	REAL(10) :: COMPTON_SIG									   |		REAL*8 :: COMPTON_SIG
	REAL(10) :: EPSI									   |		REAL*8 :: EPSI
	REAL(10) :: X										   |		REAL*8 :: X
	REAL(10) :: PI										   |		REAL*8 :: PI
	REAL(10) :: R_E2									   |		REAL*8 :: R_E2
!												   |	!
	REAL(10), PARAMETER :: R_EL=2.8179403227D-13   ! cm					   |		REAL*8, PARAMETER :: R_EL=2.8179403227D-13   ! cm
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
	REAL(10), PARAMETER :: TWO=2.0D0							   |		REAL*8, PARAMETER :: TWO=2.0D0
	REAL(10), PARAMETER :: H  =4.135668D-21	     ! MeV*sec					   |		REAL*8, PARAMETER :: H  =4.135668D-21	     ! MeV*sec
        REAL(10), PARAMETER :: M_E=5.109989D-1         ! Units of MeV				   |	        REAL*8, PARAMETER :: M_E=5.109989D-1         ! Units of MeV
./new_main/gam_transport/gamma_emiss_eta_v9.f90
	REAL(10) :: NU_GRID_VEC(NF_GRID_PTS)							   |		REAL*8 :: NU_GRID_VEC(NF_GRID_PTS)
	REAL(10) :: ETA_EMISS(ND,NF_GRID_PTS)							   |		REAL*8 :: ETA_EMISS(ND,NF_GRID_PTS)
	REAL(10) :: R(ND)									   |		REAL*8 :: R(ND)
	REAL(10) :: DECAY_KIN_E(ND)								   |		REAL*8 :: DECAY_KIN_E(ND)
	REAL(10) :: GAUSS_INT									   |		REAL*8 :: GAUSS_INT
	REAL(10) :: V_GAUSS									   |		REAL*8 :: V_GAUSS
	REAL(10) :: T1,T2,T3,T4,T5,T6,T7							   |		REAL*8 :: T1,T2,T3,T4,T5,T6,T7
	REAL(10) :: TOT_EGAM,DE									   |		REAL*8 :: TOT_EGAM,DE
	REAL(10) :: DELTA_T									   |		REAL*8 :: DELTA_T
	REAL(10) :: PI										   |		REAL*8 :: PI
	REAL(10) :: FOURPI									   |		REAL*8 :: FOURPI
	REAL(10) :: NORM_FAC									   |		REAL*8 :: NORM_FAC
	REAL(10) :: DEL_T									   |		REAL*8 :: DEL_T
	REAL(10), PARAMETER :: PLANCK = 4.135668D-021 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN    |		REAL*8, PARAMETER :: PLANCK = 4.135668D-021 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN Me
	REAL(10), PARAMETER :: MeV_ERG = 1.602177D-06 						   |		REAL*8, PARAMETER :: MeV_ERG = 1.602177D-06 
	REAL(10), PARAMETER :: ERGS_TO_MEV = 624150.9 						   |		REAL*8, PARAMETER :: ERGS_TO_MEV = 624150.9 
	REAL(10) :: WORK1_EN(ND)								   |		REAL*8 :: WORK1_EN(ND)
	REAL(10) :: DECAY_EN									   |		REAL*8 :: DECAY_EN
	REAL(10) :: WORK2_EN(ND)								   |		REAL*8 :: WORK2_EN(ND)
	REAL(10) :: DECAY_ETA_EN								   |		REAL*8 :: DECAY_ETA_EN
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10) ::  GAUSS_INT									   |		REAL*8 ::  GAUSS_INT
	REAL(10) :: MU										   |		REAL*8 :: MU
	REAL(10) :: X,XO									   |		REAL*8 :: X,XO
	REAL(10), PARAMETER :: C=299792 !km/s							   |		REAL*8, PARAMETER :: C=299792 !km/s
	REAL(10) :: SIGMA,VAR ! VAR in km/s							   |		REAL*8 :: SIGMA,VAR ! VAR in km/s
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
	REAL(10), PARAMETER :: TWO=2.0D0							   |		REAL*8, PARAMETER :: TWO=2.0D0
	REAL(10) :: PI										   |		REAL*8 :: PI
	GAUSS_INT=EXP( -(X-XO)*(X-XO)/TWO/SIGMA/SIGMA )/SIGMA/SQRT(TWO*PI)			   |		GAUSS_INT=DEXP( -(X-XO)*(X-XO)/TWO/SIGMA/SIGMA )/SIGMA/SQRT(TWO*PI)
./new_main/gam_transport/gamma_energy_dep_v5.f90
	REAL(10) :: E_DEP(ND)									   |		REAL*8 :: E_DEP(ND)
	REAL(10) :: DECAY_KIN_E(ND)								   |		REAL*8 :: DECAY_KIN_E(ND)
	REAL(10) :: V(ND)									   |		REAL*8 :: V(ND)
	REAL(10) :: R(ND)									   |		REAL*8 :: R(ND)
	REAL(10) :: NU_GRID(NF)									   |		REAL*8 :: NU_GRID(NF)
	REAL(10) :: CHI_SCAT(NF,ND) 								   |		REAL*8 :: CHI_SCAT(NF,ND) 
	REAL(10) :: CHI_ABS(NF,ND)								   |		REAL*8 :: CHI_ABS(NF,ND)
	REAL(10) :: GAMRAY_EMISS(ND)								   |		REAL*8 :: GAMRAY_EMISS(ND)
	REAL(10) :: INTENSITY(NA,ND,NF)								   |		REAL*8 :: INTENSITY(NA,ND,NF)
	REAL(10) :: ETA(NA,ND,NF)								   |		REAL*8 :: ETA(NA,ND,NF)
	REAL(10) :: TEMP_INT1(NF,ND)								   |		REAL*8 :: TEMP_INT1(NF,ND)
	REAL(10) :: TEMP_INT2(ND)								   |		REAL*8 :: TEMP_INT2(ND)
	REAL(10) :: TEMP_INT3(ND)								   |		REAL*8 :: TEMP_INT3(ND)
	REAL(10) :: TEMP_ETA1(NF,ND)								   |		REAL*8 :: TEMP_ETA1(NF,ND)
	REAL(10) :: TEMP_ETA2(ND)								   |		REAL*8 :: TEMP_ETA2(ND)
	REAL(10) :: TEMP_FLUX(NF)								   |		REAL*8 :: TEMP_FLUX(NF)
	REAL(10) :: FLUX									   |		REAL*8 :: FLUX
	REAL(10) :: T1,T2,T3,T4									   |		REAL*8 :: T1,T2,T3,T4
	REAL(10) :: PI										   |		REAL*8 :: PI
	REAL(10) :: FOURPI									   |		REAL*8 :: FOURPI
./new_main/gam_transport/gamma_energy_dep_v7.f90
	REAL(10) :: E_DEP(ND)									   |		REAL*8 :: E_DEP(ND)
	REAL(10) :: DECAY_KIN_E(ND)								   |		REAL*8 :: DECAY_KIN_E(ND)
	REAL(10) :: V(ND)									   |		REAL*8 :: V(ND)
	REAL(10) :: R(ND)									   |		REAL*8 :: R(ND)
	REAL(10) :: NU_GRID(NF)									   |		REAL*8 :: NU_GRID(NF)
	REAL(10) :: CHI_SCAT(NF,ND) 								   |		REAL*8 :: CHI_SCAT(NF,ND) 
	REAL(10) :: CHI_ABS(NF,ND)								   |		REAL*8 :: CHI_ABS(NF,ND)
	REAL(10) :: CHI_TOT(NF,ND)								   |		REAL*8 :: CHI_TOT(NF,ND)
	REAL(10) :: GAMRAY_EMISS(ND)								   |		REAL*8 :: GAMRAY_EMISS(ND)
	REAL(10) :: INTENSITY(NA,ND,NF)								   |		REAL*8 :: INTENSITY(NA,ND,NF)
	REAL(10) :: ETA(NA,ND,NF)								   |		REAL*8 :: ETA(NA,ND,NF)
	REAL(10) :: TEMP_INT1(NF,ND)								   |		REAL*8 :: TEMP_INT1(NF,ND)
	REAL(10) :: TEMP_INT2(ND)								   |		REAL*8 :: TEMP_INT2(ND)
	REAL(10) :: TEMP_INT3(ND)								   |		REAL*8 :: TEMP_INT3(ND)
	REAL(10) :: TEMP_ETA1(NF,ND)								   |		REAL*8 :: TEMP_ETA1(NF,ND)
	REAL(10) :: TEMP_ETA2(ND)								   |		REAL*8 :: TEMP_ETA2(ND)
	REAL(10) :: TEMP_FLUX(NF)								   |		REAL*8 :: TEMP_FLUX(NF)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TD(:)								   |		REAL*8, ALLOCATABLE :: TD(:)
	REAL(10) :: FLUX									   |		REAL*8 :: FLUX
	REAL(10) :: T1,T2,T3,T4									   |		REAL*8 :: T1,T2,T3,T4
	REAL(10) :: PI										   |		REAL*8 :: PI
	REAL(10) :: FOURPI									   |		REAL*8 :: FOURPI
	REAL(10) :: SN_AGE_DAYS									   |		REAL*8 :: SN_AGE_DAYS
./new_main/gam_transport/gamma_nu_grid_v16.f90
	REAL(10) :: NU_VEC(N_GAMMA) ! input lines read in from NUC_DECAY_DATA			   |		REAL*8 :: NU_VEC(N_GAMMA) ! input lines read in from NUC_DECAY_DATA
	REAL(10) :: NU_GRID_VEC(NU_GRID_MAX)							   |		REAL*8 :: NU_GRID_VEC(NU_GRID_MAX)
	REAL(10) :: NU_NEW									   |		REAL*8 :: NU_NEW
	REAL(10) :: NU_MAX									   |		REAL*8 :: NU_MAX
	REAL(10) :: NU_MIN									   |		REAL*8 :: NU_MIN
	REAL(10) :: DNU										   |		REAL*8 :: DNU
	REAL(10) :: DNU_BLUE									   |		REAL*8 :: DNU_BLUE
	REAL(10) :: DNU_LINE									   |		REAL*8 :: DNU_LINE
	REAL(10) :: DNU_RED									   |		REAL*8 :: DNU_RED
	REAL(10) :: DNU_INF1									   |		REAL*8 :: DNU_INF1
	REAL(10) :: DNU_INF2									   |		REAL*8 :: DNU_INF2
	REAL(10) :: DNU_LINE_MIN								   |		REAL*8 :: DNU_LINE_MIN
	REAL(10) :: DNU_TAIL_MIN								   |		REAL*8 :: DNU_TAIL_MIN
	REAL(10) :: BETA_LINE_MIN								   |		REAL*8 :: BETA_LINE_MIN
	REAL(10) :: BETA_TAIL_MIN								   |		REAL*8 :: BETA_TAIL_MIN
	REAL(10) :: BETA_INF_MIN								   |		REAL*8 :: BETA_INF_MIN
	REAL(10) :: BETA									   |		REAL*8 :: BETA
	REAL(10) :: VGAUSS,VINF									   |		REAL*8 :: VGAUSS,VINF
        REAL(10) :: FWHM									   |	        REAL*8 :: FWHM
	REAL(10) :: EN_SUM									   |		REAL*8 :: EN_SUM
	REAL(10) :: T1,T2,T3									   |		REAL*8 :: T1,T2,T3
	REAL(10), DIMENSION(:), ALLOCATABLE :: WORK1						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: WORK1
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_BLUE						   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_BLUE
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_RED						   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_RED
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_RED_INF1					   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_RED_INF1
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_RED_INF2					   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_RED_INF2
	REAL(10), PARAMETER :: SOL = 299792 ! Units of km/s					   |		REAL*8, PARAMETER :: SOL = 299792 ! Units of km/s
	REAL(10), PARAMETER :: PLANCK = 4.135668E-21 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN M   |		REAL*8, PARAMETER :: PLANCK = 4.135668E-21 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN MeV
	REAL(10), PARAMETER :: ERGS_TO_MEV = 624150.9						   |		REAL*8, PARAMETER :: ERGS_TO_MEV = 624150.9
	REAL(10), PARAMETER :: HoMC2 = 8.09330118D-21  ! HoMC2 = h/mc^2 in units of seconds	   |		REAL*8, PARAMETER :: HoMC2 = 8.09330118D-21  ! HoMC2 = h/mc^2 in units of seconds
	REAL(10) :: NU(NMAX)									   |		REAL*8 :: NU(NMAX)
	REAL(10) :: NU_LINES(NGAM)								   |		REAL*8 :: NU_LINES(NGAM)
	REAL(10) :: NU_BLUE(NGAM)								   |		REAL*8 :: NU_BLUE(NGAM)
	REAL(10) :: NU_RED(NGAM)								   |		REAL*8 :: NU_RED(NGAM)
	REAL(10) :: NU_INF1(NGAM)								   |		REAL*8 :: NU_INF1(NGAM)
	REAL(10) :: NU_INF2(NGAM)								   |		REAL*8 :: NU_INF2(NGAM)
	REAL(10), PARAMETER :: H = 4.135668E-21 ! MeV*s since NU is in Hz			   |		REAL*8, PARAMETER :: H = 4.135668E-21 ! MeV*s since NU is in Hz
./new_main/gam_transport/gamma_nu_grid_v17.f90
	REAL(10) :: NU_VEC(N_GAMMA) ! input lines read in from NUC_DECAY_DATA			   |		REAL*8 :: NU_VEC(N_GAMMA) ! input lines read in from NUC_DECAY_DATA
	REAL(10) :: NU_GRID_VEC(NU_GRID_MAX)							   |		REAL*8 :: NU_GRID_VEC(NU_GRID_MAX)
	REAL(10) :: NU_NEW									   |		REAL*8 :: NU_NEW
	REAL(10) :: NU_MAX									   |		REAL*8 :: NU_MAX
	REAL(10) :: NU_MIN									   |		REAL*8 :: NU_MIN
	REAL(10) :: DNU										   |		REAL*8 :: DNU
	REAL(10) :: DNU_BLUE									   |		REAL*8 :: DNU_BLUE
	REAL(10) :: DNU_LINE									   |		REAL*8 :: DNU_LINE
	REAL(10) :: DNU_RED									   |		REAL*8 :: DNU_RED
	REAL(10) :: DNU_INF1									   |		REAL*8 :: DNU_INF1
	REAL(10) :: DNU_INF2									   |		REAL*8 :: DNU_INF2
	REAL(10) :: DNU_LINE_MIN								   |		REAL*8 :: DNU_LINE_MIN
	REAL(10) :: DNU_TAIL_MIN								   |		REAL*8 :: DNU_TAIL_MIN
	REAL(10) :: BETA_LINE_MIN								   |		REAL*8 :: BETA_LINE_MIN
	REAL(10) :: BETA_TAIL_MIN								   |		REAL*8 :: BETA_TAIL_MIN
	REAL(10) :: BETA_INF_MIN								   |		REAL*8 :: BETA_INF_MIN
	REAL(10) :: BETA									   |		REAL*8 :: BETA
	REAL(10) :: VGAUSS,VINF									   |		REAL*8 :: VGAUSS,VINF
        REAL(10) :: FWHM									   |	        REAL*8 :: FWHM
	REAL(10) :: EN_SUM									   |		REAL*8 :: EN_SUM
	REAL(10) :: T1,T2,T3									   |		REAL*8 :: T1,T2,T3
	REAL(10), DIMENSION(:), ALLOCATABLE :: WORK1						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: WORK1
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_BLUE						   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_BLUE
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_RED						   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_RED
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_RED_INF1					   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_RED_INF1
        REAL(10), DIMENSION(:), ALLOCATABLE :: NU_RED_INF2					   |	        REAL*8, DIMENSION(:), ALLOCATABLE :: NU_RED_INF2
	REAL(10), PARAMETER :: SOL = 299792 ! Units of km/s					   |		REAL*8, PARAMETER :: SOL = 299792 ! Units of km/s
	REAL(10), PARAMETER :: PLANCK = 4.135668E-21 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN M   |		REAL*8, PARAMETER :: PLANCK = 4.135668E-21 ! UNITS OF MeV*s SINCE PHOTON ENERGIES IN MeV
	REAL(10), PARAMETER :: ERGS_TO_MEV = 624150.9						   |		REAL*8, PARAMETER :: ERGS_TO_MEV = 624150.9
	REAL(10), PARAMETER :: HoMC2 = 8.09330118D-21  ! HoMC2 = h/mc^2 in units of seconds	   |		REAL*8, PARAMETER :: HoMC2 = 8.09330118D-21  ! HoMC2 = h/mc^2 in units of seconds
	REAL(10) :: NU(NMAX)									   |		REAL*8 :: NU(NMAX)
	REAL(10) :: NU_LINES(NGAM)								   |		REAL*8 :: NU_LINES(NGAM)
	REAL(10) :: NU_BLUE(NGAM)								   |		REAL*8 :: NU_BLUE(NGAM)
	REAL(10) :: NU_RED(NGAM)								   |		REAL*8 :: NU_RED(NGAM)
	REAL(10) :: NU_INF1(NGAM)								   |		REAL*8 :: NU_INF1(NGAM)
	REAL(10) :: NU_INF2(NGAM)								   |		REAL*8 :: NU_INF2(NGAM)
	REAL(10), PARAMETER :: H = 4.135668E-21 ! MeV*s since NU is in Hz			   |		REAL*8, PARAMETER :: H = 4.135668E-21 ! MeV*s since NU is in Hz
./new_main/gam_transport/gamray_sub_v3.f90
	REAL(10) :: T1,T2,T3,T4,T5								   |		REAL*8 :: T1,T2,T3,T4,T5
	REAL(10) :: P(NP)									   |		REAL*8 :: P(NP)
	REAL(10) :: R(ND)									   |		REAL*8 :: R(ND)
	REAL(10) :: V(ND)									   |		REAL*8 :: V(ND)
	REAL(10) :: SIGMA(ND)									   |		REAL*8 :: SIGMA(ND)
	REAL(10) :: VDOP_VEC(ND)								   |		REAL*8 :: VDOP_VEC(ND)
	REAL(10) :: CLUMP_FAC(ND)								   |		REAL*8 :: CLUMP_FAC(ND)
	REAL(10) :: MU_AT_RMAX(NP)								   |		REAL*8 :: MU_AT_RMAX(NP)
	REAL(10) :: HQW_AT_RMAX(NP)								   |		REAL*8 :: HQW_AT_RMAX(NP)
!												   |	!
	REAL(10) :: SN_AGE_DAYS									   |		REAL*8 :: SN_AGE_DAYS
	REAL(10) :: DELV_FRAC_FG								   |		REAL*8 :: DELV_FRAC_FG
	REAL(10) :: REXT_FAC									   |		REAL*8 :: REXT_FAC
	REAL(10) :: CHI_SCAT_CLUMP(ND)								   |		REAL*8 :: CHI_SCAT_CLUMP(ND)
	REAL(10) :: PI										   |		REAL*8 :: PI
	REAL(10) :: FOURPI									   |		REAL*8 :: FOURPI
!												   |	!
	REAL(10), ALLOCATABLE :: TA_WRK(:)							   |		REAL*8, ALLOCATABLE :: TA_WRK(:)
	REAL(10), ALLOCATABLE :: TB_WRK(:)							   |		REAL*8, ALLOCATABLE :: TB_WRK(:)
	REAL(10), ALLOCATABLE :: TC_WRK(:)							   |		REAL*8, ALLOCATABLE :: TC_WRK(:)
!	REAL(10), PARAMETER :: PLANCK = 4.135668E-18 	! keV*s					   |	!	REAL*8, PARAMETER :: PLANCK = 4.135668E-18 	! keV*s
	REAL(10) :: H_PL 	! keV*s								   |		REAL*8 :: H_PL 	! keV*s
	REAL(10), PARAMETER :: SOL = 299792 		! Units of km/s				   |		REAL*8, PARAMETER :: SOL = 299792 		! Units of km/s
	REAL(10), PARAMETER :: ERGS_TO_MEV = 624150.9	 					   |		REAL*8, PARAMETER :: ERGS_TO_MEV = 624150.9	 
	REAL(10), PARAMETER :: HoMC2 = 8.09330118D-21  	! HoMC2 = h/mc^2 in units of seconds	   |		REAL*8, PARAMETER :: HoMC2 = 8.09330118D-21  	! HoMC2 = h/mc^2 in units of seconds
	REAL(10) :: dLOG_NU									   |		REAL*8 :: dLOG_NU
	REAL(10) :: BNUE									   |		REAL*8 :: BNUE
	REAL(10) :: DBB										   |		REAL*8 :: DBB
	REAL(10) :: FL										   |		REAL*8 :: FL
	REAL(10) :: HFLUX_AT_IB									   |		REAL*8 :: HFLUX_AT_IB
	REAL(10) :: HFLUX_AT_OB									   |		REAL*8 :: HFLUX_AT_OB
	REAL(10) :: IPLUS(NP)									   |		REAL*8 :: IPLUS(NP)
	REAL(10) :: FEDD(NP)									   |		REAL*8 :: FEDD(NP)
	    dLOG_NU=LOG(NU_GRID_VEC(FI-1)/NU_GRID_VEC(FI))					   |		    dLOG_NU=DLOG(NU_GRID_VEC(FI-1)/NU_GRID_VEC(FI))
./new_main/gam_transport/klein_freq.f90
	REAL(10) :: KLEIN_ARRAY(NF_GRID_PTS,NF_GRID_PTS) ! KLEIN_ARRAY(INCOMING,OUTGOING)	   |		REAL*8 :: KLEIN_ARRAY(NF_GRID_PTS,NF_GRID_PTS) ! KLEIN_ARRAY(INCOMING,OUTGOING)
	REAL(10) :: E_VEC(NF_GRID_PTS)								   |		REAL*8 :: E_VEC(NF_GRID_PTS)
        REAL(10), PARAMETER :: a=8.09330118E-21 ! a=h/mc^2 in units of seconds			   |	        REAL*8, PARAMETER :: a=8.09330118E-21 ! a=h/mc^2 in units of seconds
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
./new_main/gam_transport/rd_gamray_cntrl_v2.f90
./new_main/gam_transport/read_nuc_decay_data_v3.f90
./new_main/gam_transport/write_array_v2.f90
        REAL(10) :: A(N,ND)									   |	        REAL*8 :: A(N,ND)
        REAL(10) :: B(N)									   |	        REAL*8 :: B(N)
./new_main/gam_transport/write_array_v2_ISO.f90
        REAL(10) :: A(ND,N)									   |	        REAL*8 :: A(ND,N)
        REAL(10) :: B(N)									   |	        REAL*8 :: B(N)
 
Comparing files in ./new_main/subs with those in  /home/hillier/wnode04/cmf_testing_real8//new_main/subs
 
./new_main/subs/Makefile
OPTION=$(FG)											   |	OPTION=$(FD)
												   >	      $(LIB)(chk_cool_rates_consis.o)\
												   >	      $(LIB)(def_new_rg_v1.o)\
./new_main/subs/add_par_to_full_v2.f
./new_main/subs/adjust_cmat_to_lte.f
	REAL(10) C_MAT(NT,NT)									   |		REAL*8 C_MAT(NT,NT)
	REAL(10) STEQ_VEC(NT)									   |		REAL*8 STEQ_VEC(NT)
./new_main/subs/adjust_pops.f
	REAL(10) LOG_OLD_TAU(OLD_ND)								   |		REAL*8 LOG_OLD_TAU(OLD_ND)
	REAL(10) TB(OLD_ND)									   |		REAL*8 TB(OLD_ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) Z_POP(NT)			!Vector containing Z of atom/ion (not core)	   |		REAL*8 Z_POP(NT)			!Vector containing Z of atom/ion (not core)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) LOG_TAU(ND)									   |		REAL*8 LOG_TAU(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/adjust_sn_r_grid.f
	REAL(10) R(ND)			!Returned						   |		REAL*8 R(ND)			!Returned
	REAL(10) OLD_R(NS)		!Input							   |		REAL*8 OLD_R(NS)		!Input
	REAL(10) OLD_T(NS)		!Input							   |		REAL*8 OLD_T(NS)		!Input
	REAL(10) OLD_TAU(NS)		!Input							   |		REAL*8 OLD_TAU(NS)		!Input
	REAL(10) LOG_OLD_R(NS)									   |		REAL*8 LOG_OLD_R(NS)
	REAL(10) LOG_OLD_T(NS)									   |		REAL*8 LOG_OLD_T(NS)
	REAL(10) LOG_OLD_TAU(NS)								   |		REAL*8 LOG_OLD_TAU(NS)
	REAL(10) XN(ND)                   !Used as integer grid					   |		REAL*8 XN(ND)                   !Used as integer grid
	REAL(10) ZN(IND*ND)		!Used as integer grid.					   |		REAL*8 ZN(IND*ND)		!Used as integer grid.
	REAL(10) LOG_R(IND*ND)									   |		REAL*8 LOG_R(IND*ND)
	REAL(10) TAU(IND*ND)									   |		REAL*8 TAU(IND*ND)
	REAL(10) LOG_T(IND*ND)									   |		REAL*8 LOG_T(IND*ND)
	REAL(10) LOG_TAU(IND*ND)								   |		REAL*8 LOG_TAU(IND*ND)
	REAL(10) IB_RAT			!dTAU(I+1)/dTAU(I) near inner boudary.			   |		REAL*8 IB_RAT			!dTAU(I+1)/dTAU(I) near inner boudary.
	REAL(10) OB_RAT			!dTAU(I+1)/dRAU(I) near outer bunary			   |		REAL*8 OB_RAT			!dTAU(I+1)/dRAU(I) near outer bunary
	REAL(10) R_SCALE_FAC		!Factor to increase dLOGR by so that TAU scale has highe   |		REAL*8 R_SCALE_FAC		!Factor to increase dLOGR by so that TAU scale has highe
	REAL(10) DTAU2_ON_DTAU1		!DTAU(2)/DTAU(1) at outer boundary.			   |		REAL*8 DTAU2_ON_DTAU1		!DTAU(2)/DTAU(1) at outer boundary.
	REAL(10) dLOGT_MAX									   |		REAL*8 dLOGT_MAX
	REAL(10) dTAU			!d(LOG(TAU))						   |		REAL*8 dTAU			!d(LOG(TAU))
	REAL(10) dTAU_COMP									   |		REAL*8 dTAU_COMP
	REAL(10) dLOGR										   |		REAL*8 dLOGR
	REAL(10) dLOGT										   |		REAL*8 dLOGT
	REAL(10) LOG_TAU_MIN									   |		REAL*8 LOG_TAU_MIN
	REAL(10) LOG_R_MAX									   |		REAL*8 LOG_R_MAX
	REAL(10) TAU_BEG,TAU_END								   |		REAL*8 TAU_BEG,TAU_END
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) NEXT_R										   |		REAL*8 NEXT_R
	REAL(10) OB_RAT_LOC									   |		REAL*8 OB_RAT_LOC
./new_main/subs/auto_add_ion.f
./new_main/subs/auto_clump_rev.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) CLUMP_PAR(N_CLUMP_PAR)								   |		REAL*8 CLUMP_PAR(N_CLUMP_PAR)
	REAL(10) OLD_CLUMP_FAC(ND)								   |		REAL*8 OLD_CLUMP_FAC(ND)
	REAL(10) CURRENT_CLUMP_VALUE								   |		REAL*8 CURRENT_CLUMP_VALUE
	REAL(10) NEW_CLUMP_VALUE								   |		REAL*8 NEW_CLUMP_VALUE
	REAL(10) DESIRED_CLUMP_VALUE								   |		REAL*8 DESIRED_CLUMP_VALUE
	REAL(10) CLUMP_REV_FACTOR								   |		REAL*8 CLUMP_REV_FACTOR
	REAL(10) SCALE_FACTOR									   |		REAL*8 SCALE_FACTOR
	REAL(10) CLUMP_PAR(N_CLUMP_PAR)								   |		REAL*8 CLUMP_PAR(N_CLUMP_PAR)
	REAL(10) V_VEC(1),E1,E2									   |		REAL*8 V_VEC(1),E1,E2
	REAL(10) NEW_CLUMP_VALUE(1)								   |		REAL*8 NEW_CLUMP_VALUE(1)
	REAL(10) CLUMP_PAR(N_CLUMP_PAR)								   |		REAL*8 CLUMP_PAR(N_CLUMP_PAR)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: DENSITY(:)							   |		REAL*8, ALLOCATABLE :: DENSITY(:)
	REAL(10), ALLOCATABLE :: DXzV(:)							   |		REAL*8, ALLOCATABLE :: DXzV(:)
	REAL(10), ALLOCATABLE :: XZV_F(:,:)							   |		REAL*8, ALLOCATABLE :: XZV_F(:,:)
	REAL(10) NEW_CLUMP_VALUE								   |		REAL*8 NEW_CLUMP_VALUE
	REAL(10) SN_AGE										   |		REAL*8 SN_AGE
	REAL(10) ZXzV										   |		REAL*8 ZXzV
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CLUMP_PAR(N_CLUMP_PAR)								   |		REAL*8 CLUMP_PAR(N_CLUMP_PAR)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: V_SN(:)							   |		REAL*8, ALLOCATABLE :: V_SN(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: T_SN(:)							   |		REAL*8, ALLOCATABLE :: T_SN(:)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) CLUMP_PAR(N_CLUMP_PAR)								   |		REAL*8 CLUMP_PAR(N_CLUMP_PAR)
./new_main/subs/ba_ehb_bf_update_v1.f
	REAL(10), ALLOCATABLE :: VJ_R(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_R(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_P(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_P(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_R_EHB(:,:,:)						   |		REAL*8, ALLOCATABLE :: VJ_R_EHB(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_P_EHB(:,:,:)						   |		REAL*8, ALLOCATABLE :: VJ_P_EHB(:,:,:)
	REAL(10), ALLOCATABLE :: RJ_SUM(:)							   |		REAL*8, ALLOCATABLE :: RJ_SUM(:)
	REAL(10), ALLOCATABLE :: RJ_SUM_EHB(:)							   |		REAL*8, ALLOCATABLE :: RJ_SUM_EHB(:)
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
!												   |	!
	REAL(10) ETA_CONT(ND)									   |		REAL*8 ETA_CONT(ND)
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
!												   |	!
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) STORE(ND)									   |		REAL*8 STORE(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) PLANCKS_CONSTANT,PC								   |		REAL*8 PLANCKS_CONSTANT,PC
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) RJ_RAD(ND)									   |		REAL*8 RJ_RAD(ND)
	REAL(10) LOC_QFV_P,LOC_QFV_R								   |		REAL*8 LOC_QFV_P,LOC_QFV_R
	REAL(10) LOC_QFV_P_EHB,LOC_QFV_R_EHB							   |		REAL*8 LOC_QFV_P_EHB,LOC_QFV_R_EHB
./new_main/subs/ba_ehb_ff_update_v1.f
	REAL(10), SAVE, ALLOCATABLE ::  VJ_T(:,:,:)						   |		REAL*8, SAVE, ALLOCATABLE ::  VJ_T(:,:,:)
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) VCHI_FF(NT,ND)									   |		REAL*8 VCHI_FF(NT,ND)
	REAL(10) VETA_FF(NT,ND)									   |		REAL*8 VETA_FF(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
!												   |	!
	REAL(10) ETA_FF(ND)									   |		REAL*8 ETA_FF(ND)
	REAL(10) CHI_FF(ND)									   |		REAL*8 CHI_FF(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) FOUR_PI									   |		REAL*8 FOUR_PI
	REAL(10) T1,T2,QFV_T									   |		REAL*8 T1,T2,QFV_T
	REAL(10) RJ_RAD(ND)									   |		REAL*8 RJ_RAD(ND)
./new_main/subs/ba_replace_v2.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)						   |		REAL*8 BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)
	REAL(10) BAION(NION,NT,NUM_BNDS,ND),STEQION(NION,ND)					   |		REAL*8 BAION(NION,NT,NUM_BNDS,ND),STEQION(NION,ND)
	REAL(10) C2(NC2,ND),DC2(ND),EDGEC2(NC2),T(ND)						   |		REAL*8 C2(NC2,ND),DC2(ND),EDGEC2(NC2),T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,FAC										   |		REAL*8 T1,FAC
./new_main/subs/ba_update_v6.f
	REAL(10), ALLOCATABLE :: VJ_R(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_R(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_P(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_P(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_T(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_T(:,:,:)
	REAL(10), ALLOCATABLE :: RJ_SUM(:)							   |		REAL*8, ALLOCATABLE :: RJ_SUM(:)
!                         ABS changed to ABS.							   |	!                         DABS changed to ABS.
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) dJ_CHK_FAC									   |		REAL*8 dJ_CHK_FAC
!												   |	!
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) COMP_VEC(NT)									   |		REAL*8 COMP_VEC(NT)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,QFV_T									   |		REAL*8 T1,T2,QFV_T
./new_main/subs/ba_update_v7.f
	REAL(10), ALLOCATABLE :: VJ_R(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_R(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_P(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_P(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_T(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_T(:,:,:)
	REAL(10), ALLOCATABLE :: RJ_SUM(:)							   |		REAL*8, ALLOCATABLE :: RJ_SUM(:)
!                         ABS changed to ABS.							   |	!                         DABS changed to ABS.
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) dJ_CHK_FAC									   |		REAL*8 dJ_CHK_FAC
!												   |	!
	REAL(10) ETA_CONT(ND)									   |		REAL*8 ETA_CONT(ND)
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) COMP_VEC(NT,NUM_BNDS,ND)							   |		REAL*8 COMP_VEC(NT,NUM_BNDS,ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,QFV_T									   |		REAL*8 T1,T2,QFV_T
	REAL(10) RJ_RAD(ND)									   |		REAL*8 RJ_RAD(ND)
./new_main/subs/check_hydro_def.f
./new_main/subs/check_ions_present.f
	REAL(10) MAX_RATIO(NUM_IONS)								   |		REAL*8 MAX_RATIO(NUM_IONS)
	REAL(10), PARAMETER ::  LOW_LIMIT=1.0D-10						   |		REAL*8, PARAMETER ::  LOW_LIMIT=1.0D-10
	REAL(10), PARAMETER :: HIGH_LIMIT=1.0D-04						   |		REAL*8, PARAMETER :: HIGH_LIMIT=1.0D-04
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) HDKT_EV									   |		REAL*8 HDKT_EV
	REAL(10) T_VAL										   |		REAL*8 T_VAL
	REAL(10) ED_VAL										   |		REAL*8 ED_VAL
	REAL(10) ION_FRAC									   |		REAL*8 ION_FRAC
	REAL(10) INTERNAL_ENERGY								   |		REAL*8 INTERNAL_ENERGY
	REAL(10) EXTRA_INT_EN									   |		REAL*8 EXTRA_INT_EN
	REAL(10) ATOM_ION_DENSITY								   |		REAL*8 ATOM_ION_DENSITY
	REAL(10) IP(20,28)									   |		REAL*8 IP(20,28)
./new_main/subs/check_tmin.f
	REAL(10), PARAMETER :: HDKT=4.7994145D0							   |		REAL*8, PARAMETER :: HDKT=4.7994145D0
	REAL(10) T1,T2,TMIN									   |		REAL*8 T1,T2,TMIN
./new_main/subs/cmf_blkband_v2.f
	REAL(10) STEQ_STORE(N,ND)								   |		REAL*8 STEQ_STORE(N,ND)
        REAL(10) STEQ(N,ND)									   |	        REAL*8 STEQ(N,ND)
        REAL(10) POPS(N,ND)									   |	        REAL*8 POPS(N,ND)
        REAL(10), ALLOCATABLE :: B_MAT(:,:)							   |	        REAL*8, ALLOCATABLE :: B_MAT(:,:)
        REAL(10), ALLOCATABLE :: C_MAT(:,:)							   |	        REAL*8, ALLOCATABLE :: C_MAT(:,:)
        REAL(10), ALLOCATABLE :: D_MAT(:,:,:)							   |	        REAL*8, ALLOCATABLE :: D_MAT(:,:,:)
        REAL(10) ROW_SF(N)									   |	        REAL*8 ROW_SF(N)
        REAL(10) COL_SF(N)									   |	        REAL*8 COL_SF(N)
        REAL(10) VEC(N)										   |	        REAL*8 VEC(N)
        REAL(10) ROW_CND,COL_CND,MAX_VAL							   |	        REAL*8 ROW_CND,COL_CND,MAX_VAL
        REAL(10) RUB	      !Not accessed when passed.					   |	        REAL*8 RUB	      !Not accessed when passed.
        REAL(10),      PARAMETER :: DP_NEG_ONE=-1.0D0						   |	        REAL*8,      PARAMETER :: DP_NEG_ONE=-1.0D0
        REAL(10),      PARAMETER :: DP_ONE=1.0D0						   |	        REAL*8,      PARAMETER :: DP_ONE=1.0D0
./new_main/subs/cmf_blkband_v3.f
	REAL(10) STEQ_STORE(N,ND)								   |		REAL*8 STEQ_STORE(N,ND)
        REAL(10) STEQ(N,ND)									   |	        REAL*8 STEQ(N,ND)
        REAL(10) POPS(N,ND)									   |	        REAL*8 POPS(N,ND)
        REAL(10), ALLOCATABLE :: B_MAT(:,:)							   |	        REAL*8, ALLOCATABLE :: B_MAT(:,:)
        REAL(10), ALLOCATABLE :: C_MAT(:,:)							   |	        REAL*8, ALLOCATABLE :: C_MAT(:,:)
        REAL(10), ALLOCATABLE :: D_MAT(:,:)							   |	        REAL*8, ALLOCATABLE :: D_MAT(:,:)
        REAL(10), ALLOCATABLE :: ORIG_POPS(:,:)							   |	        REAL*8, ALLOCATABLE :: ORIG_POPS(:,:)
        REAL(10), ALLOCATABLE :: PREV_D_MAT(:,:)						   |	        REAL*8, ALLOCATABLE :: PREV_D_MAT(:,:)
        REAL(10), ALLOCATABLE :: D_MAT_STORE(:,:,:)						   |	        REAL*8, ALLOCATABLE :: D_MAT_STORE(:,:,:)
        REAL(10), ALLOCATABLE :: RUB(:,:)	      	      !Not accessed when passed.	   |	        REAL*8, ALLOCATABLE :: RUB(:,:)	      	      !Not accessed when passed.
!												   |	!
        REAL(10) ROW_SF(N)									   |	        REAL*8 ROW_SF(N)
        REAL(10) COL_SF(N)									   |	        REAL*8 COL_SF(N)
        REAL(10) ROW_CND,COL_CND,MAX_VAL							   |	        REAL*8 ROW_CND,COL_CND,MAX_VAL
        REAL(10),      PARAMETER :: DP_NEG_ONE=-1.0D0						   |	        REAL*8,      PARAMETER :: DP_NEG_ONE=-1.0D0
        REAL(10),      PARAMETER :: DP_ONE=1.0D0						   |	        REAL*8,      PARAMETER :: DP_ONE=1.0D0
./new_main/subs/cmf_hydro_module.f
	  REAL(10) GAM_EDD									   |		  REAL*8 GAM_EDD
	  REAL(10) GAM_LIM									   |		  REAL*8 GAM_LIM
	  REAL(10) GAM_FULL									   |		  REAL*8 GAM_FULL
	  REAL(10) AMU			!Atomic mass unit					   |		  REAL*8 AMU			!Atomic mass unit
	  REAL(10) MU_ATOM		!Mean atomic mass in amu				   |		  REAL*8 MU_ATOM		!Mean atomic mass in amu
	  REAL(10) BC			!Boltzmann constant					   |		  REAL*8 BC			!Boltzmann constant
	  REAL(10) C_CMS									   |		  REAL*8 C_CMS
	  REAL(10) SIGMA_TH		!Thompson cross-section					   |		  REAL*8 SIGMA_TH		!Thompson cross-section
	  REAL(10) STEFAN_BC		!Stephan-Boltzmann constant				   |		  REAL*8 STEFAN_BC		!Stephan-Boltzmann constant
	  REAL(10) LOGG			!Log (surface gravity) (cgs units)			   |		  REAL*8 LOGG			!Log (surface gravity) (cgs units)
	  REAL(10) MDOT										   |		  REAL*8 MDOT
	  REAL(10) GRAV_CON									   |		  REAL*8 GRAV_CON
	  REAL(10) REFERENCE_RADIUS								   |		  REAL*8 REFERENCE_RADIUS
	  REAL(10) PREV_REF_RADIUS								   |		  REAL*8 PREV_REF_RADIUS
	  REAL(10) RADIUS_AT_TAU_23								   |		  REAL*8 RADIUS_AT_TAU_23
	  REAL(10) SOUND_SPEED									   |		  REAL*8 SOUND_SPEED
	  REAL(10) MOD_SOUND_SPEED								   |		  REAL*8 MOD_SOUND_SPEED
	  REAL(10) VTURB									   |		  REAL*8 VTURB
	  REAL(10) R_EST									   |		  REAL*8 R_EST
	  REAL(10) T_EST									   |		  REAL*8 T_EST
	  REAL(10) P_EST									   |		  REAL*8 P_EST
	  REAL(10) TAU_EST									   |		  REAL*8 TAU_EST
	  REAL(10) ED_ON_NA_EST 								   |		  REAL*8 ED_ON_NA_EST 
	  REAL(10) ATOM_EST									   |		  REAL*8 ATOM_EST
	  REAL(10) TEFF										   |		  REAL*8 TEFF
	  REAL(10) ROSS_ON_ES									   |		  REAL*8 ROSS_ON_ES
	  REAL(10) KAP_ROSS									   |		  REAL*8 KAP_ROSS
	  REAL(10) KAP_ES									   |		  REAL*8 KAP_ES
	  REAL(10) V_EST									   |		  REAL*8 V_EST
	  REAL(10) F_EST									   |		  REAL*8 F_EST
	  REAL(10) T_SCALING_FACTOR								   |		  REAL*8 T_SCALING_FACTOR
	  REAL(10) dPdR										   |		  REAL*8 dPdR
	  REAL(10) dTAUdR									   |		  REAL*8 dTAUdR
	  REAL(10) OLD_TEFF									   |		  REAL*8 OLD_TEFF
	  REAL(10) OLD_REF_RADIUS								   |		  REAL*8 OLD_REF_RADIUS
./new_main/subs/create_iv_links_v2.f
./new_main/subs/ddt_work.f
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) T_FROM_J(ND)									   |		REAL*8 T_FROM_J(ND)
	REAL(10) OLD_T_RET(ND)									   |		REAL*8 OLD_T_RET(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) TIME_SEQ_NO									   |		REAL*8 TIME_SEQ_NO
	REAL(10) TCUR(ND)									   |		REAL*8 TCUR(ND)
	REAL(10) EK_VEC(ND)									   |		REAL*8 EK_VEC(ND)
	REAL(10) EI_VEC(ND)									   |		REAL*8 EI_VEC(ND)
	REAL(10) P_VEC(ND)									   |		REAL*8 P_VEC(ND)
	REAL(10) GAMMA(ND)									   |		REAL*8 GAMMA(ND)
	REAL(10) INT_EN(ND)									   |		REAL*8 INT_EN(ND)
!												   |	!
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) OLD_GAMMA(ND)									   |		REAL*8 OLD_GAMMA(ND)
	REAL(10) OLD_POP_ATOM(ND)								   |		REAL*8 OLD_POP_ATOM(ND)
	REAL(10) OLD_INT_EN(ND)									   |		REAL*8 OLD_INT_EN(ND)
!												   |	!
	REAL(10) ION_EN(NT)									   |		REAL*8 ION_EN(NT)
	REAL(10) TOT_ENERGY(NT)									   |		REAL*8 TOT_ENERGY(NT)
	REAL(10) AVE_ENERGY(NT)									   |		REAL*8 AVE_ENERGY(NT)
	REAL(10), ALLOCATABLE, SAVE :: T_STORE(:,:)						   |		REAL*8, ALLOCATABLE, SAVE :: T_STORE(:,:)
	REAL(10), ALLOCATABLE, SAVE :: INT_EN_STORE(:,:)					   |		REAL*8, ALLOCATABLE, SAVE :: INT_EN_STORE(:,:)
	REAL(10) BOLTZMANN_CONSTANT,FUN_PI							   |		REAL*8 BOLTZMANN_CONSTANT,FUN_PI
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) T1,T2,PI									   |		REAL*8 T1,T2,PI
	REAL(10) DELTA_T_SECS									   |		REAL*8 DELTA_T_SECS
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/subs/determine_nse.f
./new_main/subs/det_lte_ed.f
	REAL(10) ION_POPS(ND,NUM_IONS)								   |		REAL*8 ION_POPS(ND,NUM_IONS)
	REAL(10) FSAHA(NUM_IONS)								   |		REAL*8 FSAHA(NUM_IONS)
	REAL(10) XZ(NUM_IONS)									   |		REAL*8 XZ(NUM_IONS)
	REAL(10) XZW(NUM_IONS)									   |		REAL*8 XZW(NUM_IONS)
	REAL(10) ED_OLD(ND)									   |		REAL*8 ED_OLD(ND)
	REAL(10) POPION_OLD(ND)									   |		REAL*8 POPION_OLD(ND)
	REAL(10) TEMP(ND)									   |		REAL*8 TEMP(ND)
	REAL(10) TMIN										   |		REAL*8 TMIN
!												   |	!
	REAL(10) XEDW										   |		REAL*8 XEDW
	REAL(10) XED_OLD									   |		REAL*8 XED_OLD
	REAL(10) XERR										   |		REAL*8 XERR
	REAL(10) XKBT										   |		REAL*8 XKBT
	REAL(10) XG0										   |		REAL*8 XG0
	REAL(10) XG1										   |		REAL*8 XG1
	REAL(10) XGE										   |		REAL*8 XGE
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) HSQR										   |		REAL*8 HSQR
	REAL(10), PARAMETER :: HDKT=4.7994145D0							   |		REAL*8, PARAMETER :: HDKT=4.7994145D0
	REAL(10), PARAMETER :: EPS=1.0D-05							   |		REAL*8, PARAMETER :: EPS=1.0D-05
!												   |	!
	REAL(10) PLANCKS_CONSTANT								   |		REAL*8 PLANCKS_CONSTANT
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) ELECTRON_MASS									   |		REAL*8 ELECTRON_MASS
	          FSAHA(ID) = (XG1*XGE/XG0) * T1 * EXP(-ATM(ID)%EDGEXzV_F(1)*T2)  		   |		          FSAHA(ID) = (XG1*XGE/XG0) * T1 * DEXP(-ATM(ID)%EDGEXzV_F(1)*T2)  
                XERR = ABS(1.0D0-XED_OLD/XEDW)							   |	                XERR = DABS(1.0D0-XED_OLD/XEDW)
./new_main/subs/do_cmf_hydro.f
	REAL(10) POPS(NT,MOD_ND)								   |		REAL*8 POPS(NT,MOD_ND)
	REAL(10) MOD_MDOT			!Mass loss rate (N=MOD_MDOT/V(kms)/r(10^10cm)^^2   |		REAL*8 MOD_MDOT			!Mass loss rate (N=MOD_MDOT/V(kms)/r(10^10cm)^^2)
	REAL(10) MOD_LUM			!In Lsun					   |		REAL*8 MOD_LUM			!In Lsun
	REAL(10) MOD_TEFF			!In unitos of 10^4 K				   |		REAL*8 MOD_TEFF			!In unitos of 10^4 K
	REAL(10) MOD_LOGG			!In cgs units					   |		REAL*8 MOD_LOGG			!In cgs units
	REAL(10) MOD_MASS			!Mass of star in Msun (returned and output to VA   |		REAL*8 MOD_MASS			!Mass of star in Msun (returned and output to VADAT)
	REAL(10) MOD_RMAX			!R(ND) on input					   |		REAL*8 MOD_RMAX			!R(ND) on input
	REAL(10) MOD_VINF			!km/s						   |		REAL*8 MOD_VINF			!km/s
	REAL(10) MOD_BETA			!Classic velocity law exponent			   |		REAL*8 MOD_BETA			!Classic velocity law exponent
	REAL(10) MOD_VTURB									   |		REAL*8 MOD_VTURB
        REAL(10) R(ND_MAX)									   |	        REAL*8 R(ND_MAX)
        REAL(10) V(ND_MAX)									   |	        REAL*8 V(ND_MAX)
        REAL(10) SIGMA(ND_MAX)									   |	        REAL*8 SIGMA(ND_MAX)
        REAL(10) T(ND_MAX)									   |	        REAL*8 T(ND_MAX)
        REAL(10) ED(ND_MAX)									   |	        REAL*8 ED(ND_MAX)
        REAL(10) TAU(ND_MAX)									   |	        REAL*8 TAU(ND_MAX)
        REAL(10) P(ND_MAX)									   |	        REAL*8 P(ND_MAX)
        REAL(10) ED_ON_NA(ND_MAX)								   |	        REAL*8 ED_ON_NA(ND_MAX)
	REAL(10) dPdR_VEC(ND_MAX)								   |		REAL*8 dPdR_VEC(ND_MAX)
!												   |	!
        REAL(10) ROSS_MEAN(ND_MAX)								   |	        REAL*8 ROSS_MEAN(ND_MAX)
        REAL(10) FLUX_MEAN(ND_MAX)								   |	        REAL*8 FLUX_MEAN(ND_MAX)
        REAL(10) POP_ATOM(ND_MAX)								   |	        REAL*8 POP_ATOM(ND_MAX)
        REAL(10) MASS_DENSITY(ND_MAX)								   |	        REAL*8 MASS_DENSITY(ND_MAX)
        REAL(10) CLUMP_FAC(ND_MAX)								   |	        REAL*8 CLUMP_FAC(ND_MAX)
        REAL(10) POPION(ND_MAX)									   |	        REAL*8 POPION(ND_MAX)
        REAL(10) CHI_ROSS(ND_MAX)								   |	        REAL*8 CHI_ROSS(ND_MAX)
        REAL(10) GAMMA_FULL(ND_MAX)								   |	        REAL*8 GAMMA_FULL(ND_MAX)
!												   |	!
	REAL(10) TA(ND_MAX)									   |		REAL*8 TA(ND_MAX)
	REAL(10) TB(ND_MAX)									   |		REAL*8 TB(ND_MAX)
	REAL(10) TC(ND_MAX)									   |		REAL*8 TC(ND_MAX)
	REAL(10), ALLOCATABLE :: REV_TAU(:)							   |		REAL*8, ALLOCATABLE :: REV_TAU(:)
        REAL(10), ALLOCATABLE :: REV_R(:)							   |	        REAL*8, ALLOCATABLE :: REV_R(:)
        REAL(10), ALLOCATABLE :: REV_V(:)							   |	        REAL*8, ALLOCATABLE :: REV_V(:)
        REAL(10), ALLOCATABLE :: REV_SIGMA(:)							   |	        REAL*8, ALLOCATABLE :: REV_SIGMA(:)
        REAL(10), ALLOCATABLE :: REV_POP_ATOM(:)						   |	        REAL*8, ALLOCATABLE :: REV_POP_ATOM(:)
        REAL(10), ALLOCATABLE :: REV_ED(:)							   |	        REAL*8, ALLOCATABLE :: REV_ED(:)
        REAL(10), ALLOCATABLE :: REV_T(:)							   |	        REAL*8, ALLOCATABLE :: REV_T(:)
        REAL(10), ALLOCATABLE :: REV_CHI_ROSS(:)						   |	        REAL*8, ALLOCATABLE :: REV_CHI_ROSS(:)
        REAL(10), ALLOCATABLE :: REV_GAMMA_FULL(:)						   |	        REAL*8, ALLOCATABLE :: REV_GAMMA_FULL(:)
        REAL(10), ALLOCATABLE :: COEF(:,:)							   |	        REAL*8, ALLOCATABLE :: COEF(:,:)
	REAL(10) dLOG_TAU									   |		REAL*8 dLOG_TAU
	REAL(10) V_SCL_FAC									   |		REAL*8 V_SCL_FAC
	REAL(10) OBND_PARS(20)									   |		REAL*8 OBND_PARS(20)
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) CONNECTION_VEL									   |		REAL*8 CONNECTION_VEL
	REAL(10) CONNECTION_RADIUS								   |		REAL*8 CONNECTION_RADIUS
	REAL(10) PI			!							   |		REAL*8 PI			!
	REAL(10) NI_ZERO			!Density at outer boundary			   |		REAL*8 NI_ZERO			!Density at outer boundary
	REAL(10) SCL_HT			!Atmopsheric scale height				   |		REAL*8 SCL_HT			!Atmopsheric scale height
	REAL(10) H			!Step size for Runge-Kutta integration			   |		REAL*8 H			!Step size for Runge-Kutta integration
	REAL(10) PTURB_ON_NA		!Turbulent pressure due to turbulence/ (# of atoms)	   |		REAL*8 PTURB_ON_NA		!Turbulent pressure due to turbulence/ (# of atoms)
	REAL(10) MASS_LOSS_SCALE_FACTOR	!Factor to convert MOD_MDOt to Msun/yr			   |		REAL*8 MASS_LOSS_SCALE_FACTOR	!Factor to convert MOD_MDOt to Msun/yr
	REAL(10) RBOUND										   |		REAL*8 RBOUND
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) OLD_TAU_MAX									   |		REAL*8 OLD_TAU_MAX
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) GAM_LIM_STORE									   |		REAL*8 GAM_LIM_STORE
	REAL(10) dP1,dTAU1									   |		REAL*8 dP1,dTAU1
	REAL(10) dP2,dTAU2									   |		REAL*8 dP2,dTAU2
	REAL(10) dP3,dTAU3									   |		REAL*8 dP3,dTAU3
	REAL(10) dP4,dTAU4									   |		REAL*8 dP4,dTAU4
	REAL(10) ATOMIC_MASS_UNIT,BOLTZMANN_CONSTANT,STEFAN_BOLTZ				   |		REAL*8 ATOMIC_MASS_UNIT,BOLTZMANN_CONSTANT,STEFAN_BOLTZ
	REAL(10) GRAVITATIONAL_CONSTANT,MASS_SUN,SPEED_OF_LIGHT,LUM_SUN				   |		REAL*8 GRAVITATIONAL_CONSTANT,MASS_SUN,SPEED_OF_LIGHT,LUM_SUN
	REAL(10) P										   |		REAL*8 P
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) ED_ON_NA									   |		REAL*8 ED_ON_NA
	REAL(10) POP_ATOM									   |		REAL*8 POP_ATOM
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SF										   |		REAL*8 SF
	REAL(10) FM										   |		REAL*8 FM
	REAL(10) ES										   |		REAL*8 ES
	REAL(10) RM										   |		REAL*8 RM
	REAL(10) LTE_ED										   |		REAL*8 LTE_ED
!												   |	!
	REAL(10) ED_EST										   |		REAL*8 ED_EST
	REAL(10) OLD_ATOM									   |		REAL*8 OLD_ATOM
	REAL(10) OLD_TEMP									   |		REAL*8 OLD_TEMP
	REAL(10) KAP_ROSS_OLD									   |		REAL*8 KAP_ROSS_OLD
	REAL(10) KAP_ROSS_LTE									   |		REAL*8 KAP_ROSS_LTE
	REAL(10) KAP_ROSS_EST									   |		REAL*8 KAP_ROSS_EST
	REAL(10) KAP_ES_OLD									   |		REAL*8 KAP_ES_OLD
	REAL(10) KAP_ES_LTE									   |		REAL*8 KAP_ES_LTE
./new_main/subs/do_cmf_hydro_v2.f
	REAL(10) POPS(NT,MOD_ND)								   |		REAL*8 POPS(NT,MOD_ND)
	REAL(10) MOD_MDOT			!Mass loss rate (N=MOD_MDOT/V(kms)/r(10^10cm)^^2   |		REAL*8 MOD_MDOT			!Mass loss rate (N=MOD_MDOT/V(kms)/r(10^10cm)^^2)
	REAL(10) MOD_LUM			!In Lsun					   |		REAL*8 MOD_LUM			!In Lsun
	REAL(10) MOD_TEFF			!In unitos of 10^4 K				   |		REAL*8 MOD_TEFF			!In unitos of 10^4 K
	REAL(10) MOD_LOGG			!In cgs units					   |		REAL*8 MOD_LOGG			!In cgs units
	REAL(10) MOD_MASS			!Mass of star in Msun (returned and output to VA   |		REAL*8 MOD_MASS			!Mass of star in Msun (returned and output to VADAT)
	REAL(10) MOD_RSTAR		!Returned						   |		REAL*8 MOD_RSTAR		!Returned
	REAL(10) MOD_RMAX			!R(ND) on input					   |		REAL*8 MOD_RMAX			!R(ND) on input
	REAL(10) MOD_VINF			!km/s						   |		REAL*8 MOD_VINF			!km/s
	REAL(10) MOD_BETA			!Classic velocity law exponent			   |		REAL*8 MOD_BETA			!Classic velocity law exponent
	REAL(10) MOD_VTURB									   |		REAL*8 MOD_VTURB
        REAL(10) R(ND_MAX)									   |	        REAL*8 R(ND_MAX)
        REAL(10) V(ND_MAX)									   |	        REAL*8 V(ND_MAX)
        REAL(10) SIGMA(ND_MAX)									   |	        REAL*8 SIGMA(ND_MAX)
        REAL(10) T(ND_MAX)									   |	        REAL*8 T(ND_MAX)
        REAL(10) ED(ND_MAX)									   |	        REAL*8 ED(ND_MAX)
        REAL(10) TAU(ND_MAX)									   |	        REAL*8 TAU(ND_MAX)
        REAL(10) P(ND_MAX)									   |	        REAL*8 P(ND_MAX)
        REAL(10) ED_ON_NA(ND_MAX)								   |	        REAL*8 ED_ON_NA(ND_MAX)
	REAL(10) dPdR_VEC(ND_MAX)								   |		REAL*8 dPdR_VEC(ND_MAX)
!												   |	!
        REAL(10) ROSS_MEAN(ND_MAX)								   |	        REAL*8 ROSS_MEAN(ND_MAX)
        REAL(10) FLUX_MEAN(ND_MAX)								   |	        REAL*8 FLUX_MEAN(ND_MAX)
        REAL(10) POP_ATOM(ND_MAX)								   |	        REAL*8 POP_ATOM(ND_MAX)
        REAL(10) MASS_DENSITY(ND_MAX)								   |	        REAL*8 MASS_DENSITY(ND_MAX)
        REAL(10) CLUMP_FAC(ND_MAX)								   |	        REAL*8 CLUMP_FAC(ND_MAX)
        REAL(10) POPION(ND_MAX)									   |	        REAL*8 POPION(ND_MAX)
        REAL(10) CHI_ROSS(ND_MAX)								   |	        REAL*8 CHI_ROSS(ND_MAX)
        REAL(10) GAMMA_FULL(ND_MAX)								   |	        REAL*8 GAMMA_FULL(ND_MAX)
!												   |	!
	REAL(10) TA(ND_MAX)									   |		REAL*8 TA(ND_MAX)
	REAL(10) TB(ND_MAX)									   |		REAL*8 TB(ND_MAX)
	REAL(10) TC(ND_MAX)									   |		REAL*8 TC(ND_MAX)
	REAL(10), ALLOCATABLE :: REV_TAU(:)							   |		REAL*8, ALLOCATABLE :: REV_TAU(:)
        REAL(10), ALLOCATABLE :: REV_R(:)							   |	        REAL*8, ALLOCATABLE :: REV_R(:)
        REAL(10), ALLOCATABLE :: REV_V(:)							   |	        REAL*8, ALLOCATABLE :: REV_V(:)
        REAL(10), ALLOCATABLE :: REV_SIGMA(:)							   |	        REAL*8, ALLOCATABLE :: REV_SIGMA(:)
        REAL(10), ALLOCATABLE :: REV_POP_ATOM(:)						   |	        REAL*8, ALLOCATABLE :: REV_POP_ATOM(:)
        REAL(10), ALLOCATABLE :: REV_ED(:)							   |	        REAL*8, ALLOCATABLE :: REV_ED(:)
        REAL(10), ALLOCATABLE :: REV_T(:)							   |	        REAL*8, ALLOCATABLE :: REV_T(:)
        REAL(10), ALLOCATABLE :: REV_CHI_ROSS(:)						   |	        REAL*8, ALLOCATABLE :: REV_CHI_ROSS(:)
        REAL(10), ALLOCATABLE :: REV_GAMMA_FULL(:)						   |	        REAL*8, ALLOCATABLE :: REV_GAMMA_FULL(:)
        REAL(10), ALLOCATABLE :: COEF(:,:)							   |	        REAL*8, ALLOCATABLE :: COEF(:,:)
	REAL(10) dLOG_TAU									   |		REAL*8 dLOG_TAU
	REAL(10) V_SCL_FAC									   |		REAL*8 V_SCL_FAC
	REAL(10) OBND_PARS(20)									   |		REAL*8 OBND_PARS(20)
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) CONNECTION_VEL									   |		REAL*8 CONNECTION_VEL
	REAL(10) CONNECTION_RADIUS								   |		REAL*8 CONNECTION_RADIUS
	REAL(10) OLD_CONNECTION_RADIUS								   |		REAL*8 OLD_CONNECTION_RADIUS
	REAL(10) RP2_ON_CON_RAD									   |		REAL*8 RP2_ON_CON_RAD
	REAL(10) VEXT										   |		REAL*8 VEXT
	REAL(10) PI			!							   |		REAL*8 PI			!
	REAL(10) NI_ZERO			!Density at outer boundary			   |		REAL*8 NI_ZERO			!Density at outer boundary
	REAL(10) SCL_HT			!Atmopsheric scale height				   |		REAL*8 SCL_HT			!Atmopsheric scale height
	REAL(10) H			!Step size for Runge-Kutta integration			   |		REAL*8 H			!Step size for Runge-Kutta integration
	REAL(10) PTURB_ON_NA		!Turbulent pressure due to turbulence/ (# of atoms)	   |		REAL*8 PTURB_ON_NA		!Turbulent pressure due to turbulence/ (# of atoms)
	REAL(10) MASS_LOSS_SCALE_FACTOR	!Factor to convert MOD_MDOt to Msun/yr			   |		REAL*8 MASS_LOSS_SCALE_FACTOR	!Factor to convert MOD_MDOt to Msun/yr
	REAL(10) RBOUND										   |		REAL*8 RBOUND
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) OLD_TAU_MAX									   |		REAL*8 OLD_TAU_MAX
	REAL(10) BOLD,BNEW									   |		REAL*8 BOLD,BNEW
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) GAM_LIM_STORE									   |		REAL*8 GAM_LIM_STORE
	REAL(10) VC_ON_SS									   |		REAL*8 VC_ON_SS
	REAL(10) TAU_REF									   |		REAL*8 TAU_REF
	REAL(10) MAX_ED_ON_NA									   |		REAL*8 MAX_ED_ON_NA
	REAL(10) dP1,dTAU1									   |		REAL*8 dP1,dTAU1
	REAL(10) dP2,dTAU2									   |		REAL*8 dP2,dTAU2
	REAL(10) dP3,dTAU3									   |		REAL*8 dP3,dTAU3
	REAL(10) dP4,dTAU4									   |		REAL*8 dP4,dTAU4
	REAL(10) ATOMIC_MASS_UNIT,BOLTZMANN_CONSTANT,STEFAN_BOLTZ				   |		REAL*8 ATOMIC_MASS_UNIT,BOLTZMANN_CONSTANT,STEFAN_BOLTZ
	REAL(10) GRAVITATIONAL_CONSTANT,MASS_SUN,SPEED_OF_LIGHT,LUM_SUN				   |		REAL*8 GRAVITATIONAL_CONSTANT,MASS_SUN,SPEED_OF_LIGHT,LUM_SUN
	REAL(10) P										   |		REAL*8 P
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) ED_ON_NA									   |		REAL*8 ED_ON_NA
	REAL(10) POP_ATOM									   |		REAL*8 POP_ATOM
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SF										   |		REAL*8 SF
	REAL(10) FM										   |		REAL*8 FM
	REAL(10) ES										   |		REAL*8 ES
	REAL(10) RM										   |		REAL*8 RM
	REAL(10) LTE_ED										   |		REAL*8 LTE_ED
!												   |	!
	REAL(10) ED_EST										   |		REAL*8 ED_EST
	REAL(10) OLD_ATOM									   |		REAL*8 OLD_ATOM
	REAL(10) OLD_TEMP									   |		REAL*8 OLD_TEMP
	REAL(10) KAP_ROSS_OLD									   |		REAL*8 KAP_ROSS_OLD
	REAL(10) KAP_ROSS_LTE									   |		REAL*8 KAP_ROSS_LTE
	REAL(10) KAP_ROSS_EST									   |		REAL*8 KAP_ROSS_EST
	REAL(10) KAP_ES_OLD									   |		REAL*8 KAP_ES_OLD
	REAL(10) KAP_ES_LTE									   |		REAL*8 KAP_ES_LTE
./new_main/subs/do_full_r_grid_v1.f
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) OLD_TAU(ND)									   |		REAL*8 OLD_TAU(ND)
	REAL(10) TCHI(ND)									   |		REAL*8 TCHI(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) R_SCALE_FAC									   |		REAL*8 R_SCALE_FAC
	REAL(10) TAU_SCALE_FAC									   |		REAL*8 TAU_SCALE_FAC
	REAL(10) IB_RAT										   |		REAL*8 IB_RAT
	REAL(10) OB_RAT										   |		REAL*8 OB_RAT
	REAL(10) DTAU2_ON_DTAU1									   |		REAL*8 DTAU2_ON_DTAU1
	REAL(10) dLOGT_MAX									   |		REAL*8 dLOGT_MAX
./new_main/subs/do_gam_abs_approx.f
	REAL(10) DECAY_ENERGY(ND)								   |		REAL*8 DECAY_ENERGY(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) R_EXT(3*ND-6)									   |		REAL*8 R_EXT(3*ND-6)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) SM_R(SM_ND)									   |		REAL*8 SM_R(SM_ND)
	REAL(10) SM_V(SM_ND)									   |		REAL*8 SM_V(SM_ND)
	REAL(10) SM_CHI(SM_ND)									   |		REAL*8 SM_CHI(SM_ND)
	REAL(10) DECAY_ENERGY(SM_ND)								   |		REAL*8 DECAY_ENERGY(SM_ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) Z(ND),RJ(ND),Q(ND),F(ND)							   |		REAL*8 Z(ND),RJ(ND),Q(ND),F(ND)
	REAL(10) DTAU(ND),XM(ND),ETA(ND)							   |		REAL*8 DTAU(ND),XM(ND),ETA(ND)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) SOURCE(ND),CHI(ND),DCHIDR(ND),THETA(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),DCHIDR(ND),THETA(ND)
	REAL(10) JQW(ND,NP),KQW(ND,NP)								   |		REAL*8 JQW(ND,NP),KQW(ND,NP)
	REAL(10) WM(ND,ND),FB(ND,ND)								   |		REAL*8 WM(ND,ND),FB(ND,ND)
	REAL(10) IC,T1,DBB,HBC_J,HBC_S,INBC							   |		REAL*8 IC,T1,DBB,HBC_J,HBC_S,INBC
./new_main/subs/do_gam_abs_approx_v2.f
												   >	! Altered: 26-Aug-2023 -- Updated to use new JTRPWGT_V2 and KTRPWGT_V2.
	REAL(10) LOCAL_ABS_ENERGY(ND)     	!Returned - energy absorbed locally		   |		REAL*8 LOCAL_ABS_ENERGY(ND)     	!Returned - energy absorbed locally
	REAL(10) TOTAL_DECAY_ENERGY(ND)           !Passed   - total energey EMITTED locally	   |		REAL*8 TOTAL_DECAY_ENERGY(ND)           !Passed   - total energey EMITTED locally
	REAL(10) KINETIC_DECAY_ENERGY(ND)         !Passed   - energy local emitted as kinetic en   |		REAL*8 KINETIC_DECAY_ENERGY(ND)         !Passed   - energy local emitted as kinetic ener
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) R_EXT(3*ND-6)									   |		REAL*8 R_EXT(3*ND-6)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) SM_R(SM_ND)									   |		REAL*8 SM_R(SM_ND)
	REAL(10) SM_V(SM_ND)									   |		REAL*8 SM_V(SM_ND)
	REAL(10) SM_CHI(SM_ND)									   |		REAL*8 SM_CHI(SM_ND)
	REAL(10) SM_CLUMP_FAC(SM_ND)								   |		REAL*8 SM_CLUMP_FAC(SM_ND)
	REAL(10) LOCAL_ABS_ENERGY(SM_ND)							   |		REAL*8 LOCAL_ABS_ENERGY(SM_ND)
	REAL(10) TOTAL_DECAY_ENERGY(SM_ND)							   |		REAL*8 TOTAL_DECAY_ENERGY(SM_ND)
	REAL(10) KINETIC_DECAY_ENERGY(SM_ND)							   |		REAL*8 KINETIC_DECAY_ENERGY(SM_ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) Z(ND),RJ(ND),Q(ND),F(ND)							   |		REAL*8 Z(ND),RJ(ND),Q(ND),F(ND)
	REAL(10) DTAU(ND),XM(ND),ETA(ND)							   |		REAL*8 DTAU(ND),XM(ND),ETA(ND)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) SOURCE(ND),CHI(ND),DCHIDR(ND),THETA(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),DCHIDR(ND),THETA(ND)
	REAL(10) JQW(ND,NP),KQW(ND,NP)								   |		REAL*8 JQW(ND,NP),KQW(ND,NP)
	REAL(10) WM(ND,ND),FB(ND,ND)								   |		REAL*8 WM(ND,ND),FB(ND,ND)
	REAL(10) ABS_OPT_DEPTH									   |		REAL*8 ABS_OPT_DEPTH
	REAL(10) IC,T1,T2,T3,CONV_FAC,DBB,HBC_J,HBC_S,INBC					   |		REAL*8 IC,T1,T2,T3,CONV_FAC,DBB,HBC_J,HBC_S,INBC
        EXTERNAL JTRPWGT,HTRPWGT,KTRPWGT,NTRPWGT						   |	        EXTERNAL JTRPWGT_V2,HTRPWGT_V2,KTRPWGT_V2,NTRPWGT_V2
        CALL GENANGQW(JQW,R,P,WM(1,1),WM(1,3),WM(1,5),NC,ND,NP,JTRPWGT,.FALSE.)			   |	        CALL GENANGQW_V2(JQW,R,P,NC,ND,NP,JTRPWGT_V2,.FALSE.)
        CALL GENANGQW(KQW,R,P,WM(1,1),WM(1,3),WM(1,5),NC,ND,NP,KTRPWGT,.FALSE.)			   |	        CALL GENANGQW_V2(KQW,R,P,NC,ND,NP,KTRPWGT_V2,.FALSE.)
./new_main/subs/do_lev_pop_decays.f
        REAL(10) OLD_POPS(NT,ND)								   |	        REAL*8 OLD_POPS(NT,ND)
	REAL(10) RATIO(ND)									   |		REAL*8 RATIO(ND)
./new_main/subs/do_ng_accel_band_v1.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) MAXDEC										   |		REAL*8 MAXDEC
	REAL(10) MAXINC										   |		REAL*8 MAXINC
	REAL(10) RDPOPS(NT,ND,4)								   |		REAL*8 RDPOPS(NT,ND,4)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) RDPOPS(NT*ND,4)								   |		REAL*8 RDPOPS(NT*ND,4)
	REAL(10) POPS(NT,ND)              !Initial/corrected populations (I/O) 			   |		REAL*8 POPS(NT,ND)              !Initial/corrected populations (I/O) 
	REAL(10) RDPOPS(NT,ND,4)		!Populations to be accelerated			   |		REAL*8 RDPOPS(NT,ND,4)		!Populations to be accelerated
	REAL(10) MAXINC										   |		REAL*8 MAXINC
	REAL(10) MAXDEC										   |		REAL*8 MAXDEC
	REAL(10) NEWPOP(NT,ND)									   |		REAL*8 NEWPOP(NT,ND)
	REAL(10) VEC_INC(ND)									   |		REAL*8 VEC_INC(ND)
	REAL(10) VEC_DEC(ND)									   |		REAL*8 VEC_DEC(ND)
	REAL(10) INT_ARRAY(ND)									   |		REAL*8 INT_ARRAY(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LOCINC,LOCDEC									   |		REAL*8 LOCINC,LOCDEC
	REAL(10) NEWPOP(NS)             !Returned with new estimates.				   |		REAL*8 NEWPOP(NS)             !Returned with new estimates.
	REAL(10) RDPOPS(NT,ND,4)								   |		REAL*8 RDPOPS(NT,ND,4)
	REAL(10) TEMP(4,NS)									   |		REAL*8 TEMP(4,NS)
./new_main/subs/do_ng_accel_band_v2.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) ROLD(ND)									   |		REAL*8 ROLD(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) MAXDEC										   |		REAL*8 MAXDEC
	REAL(10) MAXINC										   |		REAL*8 MAXINC
	REAL(10) BIG_POPS(NT+3,ND)								   |		REAL*8 BIG_POPS(NT+3,ND)
	REAL(10) RDPOPS(NT+3,ND,4)								   |		REAL*8 RDPOPS(NT+3,ND,4)
	REAL(10) POPS(NT,ND)              !Initial/corrected populations (I/O) 			   |		REAL*8 POPS(NT,ND)              !Initial/corrected populations (I/O) 
	REAL(10) RDPOPS(NT,ND,4)		!Populations to be accelerated			   |		REAL*8 RDPOPS(NT,ND,4)		!Populations to be accelerated
	REAL(10) MAXINC										   |		REAL*8 MAXINC
	REAL(10) MAXDEC										   |		REAL*8 MAXDEC
	REAL(10) NEWPOP(NT,ND)									   |		REAL*8 NEWPOP(NT,ND)
	REAL(10) VEC_INC(ND)									   |		REAL*8 VEC_INC(ND)
	REAL(10) VEC_DEC(ND)									   |		REAL*8 VEC_DEC(ND)
	REAL(10) INT_ARRAY(ND)									   |		REAL*8 INT_ARRAY(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LOCINC,LOCDEC									   |		REAL*8 LOCINC,LOCDEC
	REAL(10) NEWPOP(NS)             !Returned with new estimates.				   |		REAL*8 NEWPOP(NS)             !Returned with new estimates.
	REAL(10) RDPOPS(NT,ND,4)								   |		REAL*8 RDPOPS(NT,ND,4)
	REAL(10) TEMP(4,NS)									   |		REAL*8 TEMP(4,NS)
./new_main/subs/do_ng_accel_band_v4.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) ROLD(ND)									   |		REAL*8 ROLD(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) MAXDEC										   |		REAL*8 MAXDEC
	REAL(10) MAXINC										   |		REAL*8 MAXINC
	REAL(10) BIG_POPS(NT+3,ND)								   |		REAL*8 BIG_POPS(NT+3,ND)
	REAL(10) RDPOPS(NT+3,ND,4)								   |		REAL*8 RDPOPS(NT+3,ND,4)
	REAL(10) RATIO										   |		REAL*8 RATIO
	REAL(10) MEAN										   |		REAL*8 MEAN
	REAL(10) MIN_RATIO, MAX_RATIO								   |		REAL*8 MIN_RATIO, MAX_RATIO
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) POPS(NT,ND)              !Initial/corrected populations (I/O) 			   |		REAL*8 POPS(NT,ND)              !Initial/corrected populations (I/O) 
	REAL(10) RDPOPS(NT,ND,4)		!Populations to be accelerated			   |		REAL*8 RDPOPS(NT,ND,4)		!Populations to be accelerated
	REAL(10) MAXINC										   |		REAL*8 MAXINC
	REAL(10) MAXDEC										   |		REAL*8 MAXDEC
	REAL(10) NEWPOP(NT,ND)									   |		REAL*8 NEWPOP(NT,ND)
	REAL(10) VEC_INC(ND)									   |		REAL*8 VEC_INC(ND)
	REAL(10) VEC_DEC(ND)									   |		REAL*8 VEC_DEC(ND)
	REAL(10) INT_ARRAY(ND)									   |		REAL*8 INT_ARRAY(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) LOCINC,LOCDEC									   |		REAL*8 LOCINC,LOCDEC
	REAL(10) NEWPOP(NS)             !Returned with new estimates.				   |		REAL*8 NEWPOP(NS)             !Returned with new estimates.
	REAL(10) RDPOPS(NT,ND,4)								   |		REAL*8 RDPOPS(NT,ND,4)
	REAL(10) TEMP(4,NS)									   |		REAL*8 TEMP(4,NS)
./new_main/subs/do_species_decays.f
	REAL(10) VEC1(ND)									   |		REAL*8 VEC1(ND)
	REAL(10) VEC2(ND)									   |		REAL*8 VEC2(ND)
	REAL(10) VEC3(ND)									   |		REAL*8 VEC3(ND)
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
./new_main/subs/do_species_decays_v2.f
	REAL(10) VEC1(ND)									   |		REAL*8 VEC1(ND)
	REAL(10) VEC2(ND)									   |		REAL*8 VEC2(ND)
	REAL(10) VEC3(ND)									   |		REAL*8 VEC3(ND)
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) PREV_RAD_SUM,CUR_RAD_SUM							   |		REAL*8 PREV_RAD_SUM,CUR_RAD_SUM
	REAL(10) PREV_EK_SUM,CUR_EK_SUM								   |		REAL*8 PREV_EK_SUM,CUR_EK_SUM
./new_main/subs/do_tau_regrid.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) ESEC(ND)			!Electron scattering opacity			   |		REAL*8 ESEC(ND)			!Electron scattering opacity
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) NEW_V(ND)									   |		REAL*8 NEW_V(ND)
	REAL(10) dTAU_OLD(ND)									   |		REAL*8 dTAU_OLD(ND)
	REAL(10) TAU_OLD(ND)									   |		REAL*8 TAU_OLD(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) TA(ND)			!Work vectors						   |		REAL*8 TA(ND)			!Work vectors
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) FG_MIN			!Min Tau for FG						   |		REAL*8 FG_MIN			!Min Tau for FG
	REAL(10) FG_MAX			!Max Tau for FG						   |		REAL*8 FG_MAX			!Max Tau for FG
	REAL(10) FG_RANGE									   |		REAL*8 FG_RANGE
!												   |	!
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LOG_TAU									   |		REAL*8 DLOG_TAU
	REAL(10) STRETCH_POW		!Power law exponent to stretch tau scale about 1	   |		REAL*8 STRETCH_POW		!Power law exponent to stretch tau scale about 1
	REAL(10) OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.   |		REAL*8 OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.
	REAL(10) IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.	   |		REAL*8 IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.
	TAU_OLD(1:ND)=LOG10(TAU_OLD(1:ND))							   |		TAU_OLD(1:ND)=DLOG10(TAU_OLD(1:ND))
	  LOG_TAU=(TAU_OLD(ND)-TAU_OLD(1))/(ND-NUM_OBND_PARAMS-NUM_IBND_PARAMS-1)		   |		  DLOG_TAU=(TAU_OLD(ND)-TAU_OLD(1))/(ND-NUM_OBND_PARAMS-NUM_IBND_PARAMS-1)
	    TAU(I)=TAU_OLD(1)+LOG_TAU*(I-NUM_IBND_PARAMS-1)					   |		    TAU(I)=TAU_OLD(1)+DLOG_TAU*(I-NUM_IBND_PARAMS-1)
          LOG_TAU=T1/(ND-NUM_IBND_PARAMS-NUM_OBND_PARAMS-NX)					   |	          DLOG_TAU=T1/(ND-NUM_IBND_PARAMS-NUM_OBND_PARAMS-NX)
	  I1=(FG_MIN-TAU_OLD(1))/LOG_TAU							   |		  I1=(FG_MIN-TAU_OLD(1))/DLOG_TAU
	  LOG_TAU=(FG_MIN-TAU_OLD(1))/I1							   |		  DLOG_TAU=(FG_MIN-TAU_OLD(1))/I1
	    TAU(I)=TAU_OLD(1)+LOG_TAU*(I-3)							   |		    TAU(I)=TAU_OLD(1)+DLOG_TAU*(I-3)
	  LOG_TAU=FG_RANGE/(NX-1)								   |		  DLOG_TAU=FG_RANGE/(NX-1)
	    TAU(I)=FG_MIN+LOG_TAU*(I-I1-1)							   |		    TAU(I)=FG_MIN+DLOG_TAU*(I-I1-1)
	    TAU(I)=TAU(I-1)+LOG_TAU								   |		    TAU(I)=TAU(I-1)+DLOG_TAU
./new_main/subs/do_tau_regrid_v2.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) ESEC(ND)			!Electron scattering opacity			   |		REAL*8 ESEC(ND)			!Electron scattering opacity
	REAL(10) R_OLD(ND)									   |		REAL*8 R_OLD(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) LOG_R_OLD(ND)									   |		REAL*8 LOG_R_OLD(ND)
	REAL(10) V_OLD(ND)									   |		REAL*8 V_OLD(ND)
	REAL(10) SIGMA_OLD(ND)									   |		REAL*8 SIGMA_OLD(ND)
	REAL(10) dTAU_OLD(ND)									   |		REAL*8 dTAU_OLD(ND)
	REAL(10) TAU_OLD(ND)									   |		REAL*8 TAU_OLD(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) TA(ND)			!Work vectors						   |		REAL*8 TA(ND)			!Work vectors
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) FG_MIN			!Min Tau for FG						   |		REAL*8 FG_MIN			!Min Tau for FG
	REAL(10) FG_MAX			!Max Tau for FG						   |		REAL*8 FG_MAX			!Max Tau for FG
	REAL(10) FG_RANGE									   |		REAL*8 FG_RANGE
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DLOG_TAU									   |		REAL*8 DLOG_TAU
	REAL(10) STRETCH_POW		!Power law exponent to stretch tau scale about 1	   |		REAL*8 STRETCH_POW		!Power law exponent to stretch tau scale about 1
	REAL(10) OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.   |		REAL*8 OBND_PARAMS(5)		!Parameters specifying grid placement at outer boundary.
	REAL(10) IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.	   |		REAL*8 IBND_PARAMS(5)		!Parameters specifying grid placement at nner boundary.
	TAU_OLD(1:ND)=LOG10(TAU_OLD(1:ND))							   |		TAU_OLD(1:ND)=DLOG10(TAU_OLD(1:ND))
!	  TAU_OLD(1:ND)=LOG10( TAU_OLD(1:ND)/(0.1D0+V(1:ND)) )					   |	!	  TAU_OLD(1:ND)=DLOG10( TAU_OLD(1:ND)/(0.1D0+V(1:ND)) )
	  TAU_OLD(1:ND)=LOG10( TAU_OLD(1:ND)/(1.0D0 + MIN(20.0D0,V(1:ND))) )   !(0.1D0+MIN(V(1)/   |		  TAU_OLD(1:ND)=DLOG10( TAU_OLD(1:ND)/(1.0D0 + MIN(20.0D0,V(1:ND))) )   !(0.1D0+MIN(V(1)
	  DLOG_TAU=(TAU_OLD(ND)-FG_MAX)/I2							   |		  dLOG_TAU=(TAU_OLD(ND)-FG_MAX)/I2
	        TAU(I)=EXP(LOG(TAU(IEND-4))+(I+4-IEND)*T1)					   |		        TAU(I)=EXP(DLOG(TAU(IEND-4))+(I+4-IEND)*T1)
	  DLOG_TAU=TAU(ND)-TAU(ND-NUM_IBND_PARAMS-1)						   |		  dLOG_TAU=TAU(ND)-TAU(ND-NUM_IBND_PARAMS-1)
	    TAU(ND-1)=TAU(ND)-0.1D0*DLOG_TAU							   |		    TAU(ND-1)=TAU(ND)-0.1D0*dLOG_TAU
	    TAU(ND-2)=TAU(ND)-0.35D0*DLOG_TAU							   |		    TAU(ND-2)=TAU(ND)-0.35D0*dLOG_TAU
	      TAU(ND-J)=TAU(ND)-DLOG_TAU/IBND_PARAMS(J)						   |		      TAU(ND-J)=TAU(ND)-dLOG_TAU/IBND_PARAMS(J)
	  DLOG_TAU=TAU(NUM_OBND_PARAMS+2)-TAU(1)						   |		  dLOG_TAU=TAU(NUM_OBND_PARAMS+2)-TAU(1)
	    TAU(2)=TAU(1)+0.02D0*DLOG_TAU							   |		    TAU(2)=TAU(1)+0.02D0*dLOG_TAU
	    TAU(3)=TAU(1)+0.2D0*DLOG_TAU							   |		    TAU(3)=TAU(1)+0.2D0*dLOG_TAU
	      WRITE(LU,'(A,I3,3ES14.4)')'! ',J,TAU(1),DLOG_TAU,OBND_PARAMS(J)			   |		      WRITE(LU,'(A,I3,3ES14.4)')'! ',J,TAU(1),dLOG_TAU,OBND_PARAMS(J)
	      TAU(1+J)=TAU(1)+DLOG_TAU/OBND_PARAMS(J)						   |		      TAU(1+J)=TAU(1)+dLOG_TAU/OBND_PARAMS(J)
./new_main/subs/do_vel_regrid.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) CUR_LOG_POP(NT)								   |		REAL*8 CUR_LOG_POP(NT)
	REAL(10) OLD_LOG_POP(NT)								   |		REAL*8 OLD_LOG_POP(NT)
	REAL(10) LOG_ATOM_DEN									   |		REAL*8 LOG_ATOM_DEN
!												   |	!
	REAL(10) XNEW(NM*ND)									   |		REAL*8 XNEW(NM*ND)
	REAL(10) VNEW(NM*ND)									   |		REAL*8 VNEW(NM*ND)
	REAL(10) RNEW(NM*ND)									   |		REAL*8 RNEW(NM*ND)
	REAL(10) REVR(ND)									   |		REAL*8 REVR(ND)
	REAL(10) REVV(ND)									   |		REAL*8 REVV(ND)
	REAL(10) REVX(ND)									   |		REAL*8 REVX(ND)
	REAL(10) ROLD(ND)									   |		REAL*8 ROLD(ND)
!												   |	!
	REAL(10) TA(ND),RTA(NM*ND)								   |		REAL*8 TA(ND),RTA(NM*ND)
	REAL(10) TB(ND),RTB(NM*ND)								   |		REAL*8 TB(ND),RTB(NM*ND)
!												   |	!
	REAL(10) VLOW										   |		REAL*8 VLOW
	REAL(10) VHIGH										   |		REAL*8 VHIGH
	REAL(10) dDEN										   |		REAL*8 dDEN
!												   |	!
	REAL(10) dV										   |		REAL*8 dV
	REAL(10) dV_MAX										   |		REAL*8 dV_MAX
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) OBND_PARAMS(5)           !Parameters specifying grid placement at outer boundar   |		REAL*8 OBND_PARAMS(5)           !Parameters specifying grid placement at outer boundary.
	REAL(10) IBND_PARAMS(5)           !Parameters specifying grid placement at nner boundary   |		REAL*8 IBND_PARAMS(5)           !Parameters specifying grid placement at nner boundary.
	TA(1:ND)=LOG(POPS(IV1,1:ND))								   |		TA(1:ND)=DLOG(POPS(IV1,1:ND))
	TB(1:ND)=LOG(POPS(IV2,1:ND))								   |		TB(1:ND)=DLOG(POPS(IV2,1:ND))
	TA(1:ND)=LOG(POPS(IV1,1:ND))								   |		TA(1:ND)=DLOG(POPS(IV1,1:ND))
	TB(1:ND)=LOG(POPS(IV2,1:ND))								   |		TB(1:ND)=DLOG(POPS(IV2,1:ND))
./new_main/subs/do_vel_regrid_v2.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) CUR_LOG_POP(NT)								   |		REAL*8 CUR_LOG_POP(NT)
	REAL(10) OLD_LOG_POP(NT)								   |		REAL*8 OLD_LOG_POP(NT)
	REAL(10) LOG_ATOM_DEN									   |		REAL*8 LOG_ATOM_DEN
!												   |	!
	REAL(10) XNEW(NM*ND)									   |		REAL*8 XNEW(NM*ND)
	REAL(10) VNEW(NM*ND)									   |		REAL*8 VNEW(NM*ND)
	REAL(10) RNEW(NM*ND)									   |		REAL*8 RNEW(NM*ND)
	REAL(10) REVR(ND)									   |		REAL*8 REVR(ND)
	REAL(10) REVV(ND)									   |		REAL*8 REVV(ND)
	REAL(10) REVX(ND)									   |		REAL*8 REVX(ND)
	REAL(10) ROLD(ND)									   |		REAL*8 ROLD(ND)
!												   |	!
	REAL(10) TA(ND),RTA(NM*ND)								   |		REAL*8 TA(ND),RTA(NM*ND)
	REAL(10) TB(ND),RTB(NM*ND)								   |		REAL*8 TB(ND),RTB(NM*ND)
!												   |	!
	REAL(10) VLOW										   |		REAL*8 VLOW
	REAL(10) VHIGH										   |		REAL*8 VHIGH
	REAL(10) dDEN										   |		REAL*8 dDEN
!												   |	!
	REAL(10) dV										   |		REAL*8 dV
	REAL(10) dV_MAX										   |		REAL*8 dV_MAX
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) OBND_PARAMS(5)           !Parameters specifying grid placement at outer boundar   |		REAL*8 OBND_PARAMS(5)           !Parameters specifying grid placement at outer boundary.
	REAL(10) IBND_PARAMS(5)           !Parameters specifying grid placement at nner boundary   |		REAL*8 IBND_PARAMS(5)           !Parameters specifying grid placement at nner boundary.
	TA(1:ND)=LOG(POPS(IV1,1:ND))								   |		TA(1:ND)=DLOG(POPS(IV1,1:ND))
	TB(1:ND)=LOG(POPS(IV2,1:ND))								   |		TB(1:ND)=DLOG(POPS(IV2,1:ND))
	TA(1:ND)=LOG(POPS(IV1,1:ND))								   |		TA(1:ND)=DLOG(POPS(IV1,1:ND))
	TB(1:ND)=LOG(POPS(IV2,1:ND))								   |		TB(1:ND)=DLOG(POPS(IV2,1:ND))
./new_main/subs/do_wind_vel_v1.f
	REAL(10), ALLOCATABLE :: GRAD_STORE(:)							   |		REAL*8, ALLOCATABLE :: GRAD_STORE(:)
	REAL(10), ALLOCATABLE :: GRAD_RD(:)							   |		REAL*8, ALLOCATABLE :: GRAD_RD(:)
	REAL(10), ALLOCATABLE :: GELEC_RD(:)							   |		REAL*8, ALLOCATABLE :: GELEC_RD(:)
	REAL(10), ALLOCATABLE :: VdVdR_RD(:)							   |		REAL*8, ALLOCATABLE :: VdVdR_RD(:)
!												   |	!
	REAL(10), ALLOCATABLE :: R_OLD(:)							   |		REAL*8, ALLOCATABLE :: R_OLD(:)
	REAL(10), ALLOCATABLE :: V_OLD(:)							   |		REAL*8, ALLOCATABLE :: V_OLD(:)
	REAL(10), ALLOCATABLE :: SIGMA_OLD(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_OLD(:)
	REAL(10), ALLOCATABLE :: GRAD_OLD(:)							   |		REAL*8, ALLOCATABLE :: GRAD_OLD(:)
	REAL(10), ALLOCATABLE :: GELEC_OLD(:)							   |		REAL*8, ALLOCATABLE :: GELEC_OLD(:)
	REAL(10), ALLOCATABLE :: VdVdR_OLD(:)							   |		REAL*8, ALLOCATABLE :: VdVdR_OLD(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC_OLD(:)						   |		REAL*8, ALLOCATABLE :: CLUMP_FAC_OLD(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RHAT(:)							   |		REAL*8, ALLOCATABLE :: RHAT(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: V_NEW(:)							   |		REAL*8, ALLOCATABLE :: V_NEW(:)
	REAL(10), ALLOCATABLE :: SIGMA_NEW(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_NEW(:)
	REAL(10), ALLOCATABLE :: GELEC(:)							   |		REAL*8, ALLOCATABLE :: GELEC(:)
	REAL(10), ALLOCATABLE :: GRAD(:)							   |		REAL*8, ALLOCATABLE :: GRAD(:)
	REAL(10), ALLOCATABLE :: GRAD_MIN(:)							   |		REAL*8, ALLOCATABLE :: GRAD_MIN(:)
	REAL(10), ALLOCATABLE :: dFdR(:)							   |		REAL*8, ALLOCATABLE :: dFdR(:)
	REAL(10), ALLOCATABLE :: F_CORR(:)							   |		REAL*8, ALLOCATABLE :: F_CORR(:)
	REAL(10), ALLOCATABLE :: COEF(:,:)							   |		REAL*8, ALLOCATABLE :: COEF(:,:)
	REAL(10) MSTAR										   |		REAL*8 MSTAR
	REAL(10) R_RD(ND_RD)									   |		REAL*8 R_RD(ND_RD)
	REAL(10) V_RD(ND_RD)									   |		REAL*8 V_RD(ND_RD)
	REAL(10) SIGMA_RD(ND_RD)								   |		REAL*8 SIGMA_RD(ND_RD)
	REAL(10) CLUMP_FAC_RD(ND_RD)								   |		REAL*8 CLUMP_FAC_RD(ND_RD)
	REAL(10) GCRIT										   |		REAL*8 GCRIT
	REAL(10) RSTAR										   |		REAL*8 RSTAR
	REAL(10) MSUN										   |		REAL*8 MSUN
	REAL(10) GRAV_CONST									   |		REAL*8 GRAV_CONST
	REAL(10) VCRIT										   |		REAL*8 VCRIT
	REAL(10) VSOUND										   |		REAL*8 VSOUND
	REAL(10) RSOUND										   |		REAL*8 RSOUND
	REAL(10) RX		!Start radius for integration					   |		REAL*8 RX		!Start radius for integration
	REAL(10) VX 		!Start velocity for integration					   |		REAL*8 VX 		!Start velocity for integration
	REAL(10) LAMBERT_WM_FUN									   |		REAL*8 LAMBERT_WM_FUN
	REAL(10) ALPHA 										   |		REAL*8 ALPHA 
	REAL(10) GINT										   |		REAL*8 GINT
	REAL(10) Z										   |		REAL*8 Z
	REAL(10) LNZ										   |		REAL*8 LNZ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) ERROR, ALLOWED_CHANGE_IN_GRAD							   |		REAL*8 ERROR, ALLOWED_CHANGE_IN_GRAD
./new_main/subs/eval_adiabatic_v2.f
	REAL(10) AD_CR_V(ND)									   |		REAL*8 AD_CR_V(ND)
	REAL(10) AD_CR_DT(ND)									   |		REAL*8 AD_CR_DT(ND)
	REAL(10) POPION(ND)									   |		REAL*8 POPION(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) DIFFW(NT)		!d(dT/dR)/d?						   |		REAL*8 DIFFW(NT)		!d(dT/dR)/d?
	REAL(10) DTDR			!dT/dR (Program units)					   |		REAL*8 DTDR			!dT/dR (Program units)
	REAL(10) BOLTZMANN_CONSTANT,FUN_PI							   |		REAL*8 BOLTZMANN_CONSTANT,FUN_PI
	REAL(10) SCALE,T1,PI									   |		REAL*8 SCALE,T1,PI
./new_main/subs/eval_adiabatic_v3.f
	REAL(10) AD_CR_V(ND)									   |		REAL*8 AD_CR_V(ND)
	REAL(10) AD_CR_DT(ND)									   |		REAL*8 AD_CR_DT(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) AVE_ENERGY(NT)									   |		REAL*8 AVE_ENERGY(NT)
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) A(ND)										   |		REAL*8 A(ND)
	REAL(10) B(ND)										   |		REAL*8 B(ND)
	REAL(10) C(ND)										   |		REAL*8 C(ND)
	REAL(10) D(ND)										   |		REAL*8 D(ND)
	REAL(10) GAMMA(ND)									   |		REAL*8 GAMMA(ND)
	REAL(10) INT_EN(ND)									   |		REAL*8 INT_EN(ND)
	REAL(10) COL_EN(ND)									   |		REAL*8 COL_EN(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) ION_EN(NT)									   |		REAL*8 ION_EN(NT)
	REAL(10) TOT_ENERGY(NT)									   |		REAL*8 TOT_ENERGY(NT)
	REAL(10) BOLTZMANN_CONSTANT,FUN_PI							   |		REAL*8 BOLTZMANN_CONSTANT,FUN_PI
	REAL(10) SCALE,T1,T2,PI									   |		REAL*8 SCALE,T1,T2,PI
./new_main/subs/eval_rad_decay_v1.f
	REAL(10) de_RAD_DECAY(ND)								   |		REAL*8 de_RAD_DECAY(ND)
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) PI										   |		REAL*8 PI
./new_main/subs/evalse_lowt_v1.f
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) LOG_B_RAT									   |		REAL*8 LOG_B_RAT
	REAL(10) DI_FAC										   |		REAL*8 DI_FAC
	REAL(10) ED_FAC										   |		REAL*8 ED_FAC
	REAL(10) T_FAC										   |		REAL*8 T_FAC
	REAL(10) JREC										   |		REAL*8 JREC
	REAL(10) dRR			!Increment to radiative recombinaton rate.		   |		REAL*8 dRR			!Increment to radiative recombinaton rate.
!												   |	!
	REAL(10) SUM_SE										   |		REAL*8 SUM_SE
	REAL(10) SUM_VK_R									   |		REAL*8 SUM_VK_R
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
./new_main/subs/evalse_lowt_v2.f
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) LOG_B_RAT									   |		REAL*8 LOG_B_RAT
	REAL(10) DI_FAC										   |		REAL*8 DI_FAC
	REAL(10) ED_FAC										   |		REAL*8 ED_FAC
	REAL(10) T_FAC										   |		REAL*8 T_FAC
	REAL(10) JREC										   |		REAL*8 JREC
	REAL(10) dRR			!Increment to radiative recombinaton rate.		   |		REAL*8 dRR			!Increment to radiative recombinaton rate.
!												   |	!
	REAL(10) SUM_SE										   |		REAL*8 SUM_SE
	REAL(10) SUM_VK_R									   |		REAL*8 SUM_VK_R
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10), ALLOCATABLE, SAVE :: XzVLTE_MIN(:)						   |		REAL*8, ALLOCATABLE, SAVE :: XzVLTE_MIN(:)
./new_main/subs/evalse_qwvj_v6.f
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND)							   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND)
	REAL(10) WSE(NLEV,ND)									   |		REAL*8 WSE(NLEV,ND)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) NETR										   |		REAL*8 NETR
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) SUM_SE,SUM_VJ_R,SUM_VJ_P							   |		REAL*8 SUM_SE,SUM_VJ_R,SUM_VJ_P
	REAL(10) B_RAT										   |		REAL*8 B_RAT
./new_main/subs/evalse_qwvj_v7.f
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND)							   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND)
	REAL(10) WSE(NLEV,ND)									   |		REAL*8 WSE(NLEV,ND)
	REAL(10) DI(N_DI,ND)									   |		REAL*8 DI(N_DI,ND)
	REAL(10) LOG_DIST(N_DI,ND)								   |		REAL*8 LOG_DIST(N_DI,ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) NETR										   |		REAL*8 NETR
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) SUM_SE,SUM_VJ_R,SUM_VJ_P							   |		REAL*8 SUM_SE,SUM_VJ_R,SUM_VJ_P
	REAL(10) B_RAT										   |		REAL*8 B_RAT
./new_main/subs/evalse_qwvj_v8.f
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND)							   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND)
	REAL(10) WSE(NLEV,ND)									   |		REAL*8 WSE(NLEV,ND)
	REAL(10) WCR(NLEV,ND)									   |		REAL*8 WCR(NLEV,ND)
	REAL(10) DI(N_DI,ND)									   |		REAL*8 DI(N_DI,ND)
	REAL(10) LOG_DIST(N_DI,ND)								   |		REAL*8 LOG_DIST(N_DI,ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) NETR										   |		REAL*8 NETR
	REAL(10) T1,T2										   |		REAL*8 T1,T2,SUMD5
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) SUM_SE,SUM_VJ_R,SUM_VJ_P							   |		REAL*8 SUM_SE,SUM_VJ_R,SUM_VJ_P
	REAL(10) B_RAT										   |		REAL*8 B_RAT
	REAL(10) PLANCKS_CONSTANT,PC								   |		REAL*8 PLANCKS_CONSTANT,PC
												   >	!	WRITE(120,*)NLEV,'I,J,B_RAT,HNST(I,J),WSE(I,J),REV_HNST,JREC(J),HN(I,J),JPHOT(J)'
												   >		SUMD5=0.0D0
	  B_RAT=EXP(LOG_DIST(1,J)-LOG_DIST(ION_LEV,J))*(DI(ION_LEV,J)/DI(1,J))			   |	!	  B_RAT=EXP(LOG_DIST(1,J)-LOG_DIST(ION_LEV,J))*(DI(ION_LEV,J)/DI(1,J))
												   >		  B_RAT=EXP( LOG_DIST(1,J)-LOG_DIST(ION_LEV,J)+LOG(DI(ION_LEV,J))-LOG(DI(1,J)) )
												   >	!	      WRITE(120,'(2I5,7E16.8)')I,J,B_RAT,HNST(I,J),WSE(I,J),REV_HNST,JREC(J),HN(I,J),JPH
												   >	!	      FLUSH(120)
												   >		      IF(J .EQ. 5)THEN
												   >		        SUMD5=SUMD5+PC*(T1+T2)
												   >	!	        WRITE(185,*)I,PC*(T1+T2),WSE(I,J)
												   >		      END IF
												   >		    ELSE
												   >	!	      IF(J .EQ. 5)THEN
												   >	!	        WRITE(185,*)I,WSE(I,J)
												   >	!	      END IF
												   >	!	  IF(J .EQ. 5)THEN
												   >	!	     WRITE(185,*)NLEV,SUMD5; FLUSH(UNIT=185)
												   >	!	  END IF
./new_main/subs/evalse_x_qwvj_v4.f
	REAL(10) HN_A(N_A,ND)		!    Pops. of ith ionzation stage			   |		REAL*8 HN_A(N_A,ND)		!    Pops. of ith ionzation stage
	REAL(10) HNST_A(N_A,ND)		!LTE   "    "  "      "       "				   |		REAL*8 HNST_A(N_A,ND)		!LTE   "    "  "      "       "
	REAL(10) HN_B(N_B,ND)		!    Pops. of (i+1)th ionization stage			   |		REAL*8 HN_B(N_B,ND)		!    Pops. of (i+1)th ionization stage
	REAL(10) HNST_B(N_B,ND)		!LTE   "   "    "       "        "			   |		REAL*8 HNST_B(N_B,ND)		!LTE   "   "    "       "        "
	REAL(10) WSE_X(N_A,ND)									   |		REAL*8 WSE_X(N_A,ND)
	REAL(10) JREC(ND)			! Int (2h/c2v^3+J)*EXP(-hv/kT)/v dv		   |		REAL*8 JREC(ND)			! Int (2h/c2v^3+J)*EXP(-hv/kT)/v dv
	REAL(10) JPHOT(ND)		! Int J/v dv						   |		REAL*8 JPHOT(ND)		! Int J/v dv
	REAL(10) NETR										   |		REAL*8 NETR
	REAL(10) SUM_SE										   |		REAL*8 SUM_SE
	REAL(10) SUM_VJ_R,SUM_VJ_P								   |		REAL*8 SUM_VJ_R,SUM_VJ_P
	REAL(10) J_B_ION,B_ION									   |		REAL*8 J_B_ION,B_ION
./new_main/subs/eval_shock_power.f
      REAL(10) SCALE										   |	      REAL*8 SCALE
      REAL(10) PI										   |	      REAL*8 PI
      REAL(10) dE_SHOCK_POWER(ND)								   |	      REAL*8 dE_SHOCK_POWER(ND)
      REAL(10) SHOCK_POWER_FAC									   |	      REAL*8 SHOCK_POWER_FAC
./new_main/subs/eval_temp_ddt_v1.f
	REAL(10) AD_CR_V(ND)									   |		REAL*8 AD_CR_V(ND)
	REAL(10) AD_CR_DT(ND)									   |		REAL*8 AD_CR_DT(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) AVE_ENERGY(NT)									   |		REAL*8 AVE_ENERGY(NT)
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) EK_VEC(ND)									   |		REAL*8 EK_VEC(ND)
	REAL(10) EI_VEC(ND)									   |		REAL*8 EI_VEC(ND)
	REAL(10) P_VEC(ND)									   |		REAL*8 P_VEC(ND)
	REAL(10) GAMMA(ND)									   |		REAL*8 GAMMA(ND)
	REAL(10) INT_EN(ND)									   |		REAL*8 INT_EN(ND)
	REAL(10) COL_EN(ND)									   |		REAL*8 COL_EN(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
!												   |	!
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) OLD_GAMMA(ND)									   |		REAL*8 OLD_GAMMA(ND)
	REAL(10) OLD_POP_ATOM(ND)								   |		REAL*8 OLD_POP_ATOM(ND)
	REAL(10) OLD_INT_EN(ND)									   |		REAL*8 OLD_INT_EN(ND)
	REAL(10) OLD_COL_EN(ND)									   |		REAL*8 OLD_COL_EN(ND)
	REAL(10) ION_EN(NT)									   |		REAL*8 ION_EN(NT)
	REAL(10) TOT_ENERGY(NT)									   |		REAL*8 TOT_ENERGY(NT)
	REAL(10) BOLTZMANN_CONSTANT,FUN_PI							   |		REAL*8 BOLTZMANN_CONSTANT,FUN_PI
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) T1,T2,T3,T4,PI									   |		REAL*8 T1,T2,T3,T4,PI
	REAL(10) DELTA_T_SECS									   |		REAL*8 DELTA_T_SECS
./new_main/subs/eval_temp_ddt_v2.f
	REAL(10) AD_CR_V(ND)									   |		REAL*8 AD_CR_V(ND)
	REAL(10) AD_CR_DT(ND)									   |		REAL*8 AD_CR_DT(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) AVE_ENERGY(NT)									   |		REAL*8 AVE_ENERGY(NT)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) TIME_SEQ_NO									   |		REAL*8 TIME_SEQ_NO
	REAL(10) EK_VEC(ND)									   |		REAL*8 EK_VEC(ND)
	REAL(10) EI_VEC(ND)									   |		REAL*8 EI_VEC(ND)
	REAL(10) P_VEC(ND)									   |		REAL*8 P_VEC(ND)
	REAL(10) GAMMA(ND)									   |		REAL*8 GAMMA(ND)
	REAL(10) INT_EN(ND)									   |		REAL*8 INT_EN(ND)
!												   |	!
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) OLD_GAMMA(ND)									   |		REAL*8 OLD_GAMMA(ND)
	REAL(10) OLD_POP_ATOM(ND)								   |		REAL*8 OLD_POP_ATOM(ND)
	REAL(10) OLD_INT_EN(ND)									   |		REAL*8 OLD_INT_EN(ND)
	REAL(10) TOT_ENERGY(NT)									   |		REAL*8 TOT_ENERGY(NT)
	REAL(10) BOLTZMANN_CONSTANT,FUN_PI,STEFAN_BOLTZ,SPEED_OF_LIGHT				   |		REAL*8 BOLTZMANN_CONSTANT,FUN_PI,STEFAN_BOLTZ,SPEED_OF_LIGHT
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) EHB_CONSTANT									   |		REAL*8 EHB_CONSTANT
	REAL(10) T1,T2,T3,T4,PI									   |		REAL*8 T1,T2,T3,T4,PI
	REAL(10) DELTA_T_SECS									   |		REAL*8 DELTA_T_SECS
./new_main/subs/fiddle_pop_corrections.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) RELAX_PARAM(ND)								   |		REAL*8 RELAX_PARAM(ND)
	REAL(10) POP_LIM(ND)									   |		REAL*8 POP_LIM(ND)
	REAL(10) T_LIM(ND)									   |		REAL*8 T_LIM(ND)
	REAL(10) RELAX_VARIABLE									   |		REAL*8 RELAX_VARIABLE
	REAL(10) T_LIM_VARIABLE									   |		REAL*8 T_LIM_VARIABLE
	REAL(10) POP_LIM_VARIABLE								   |		REAL*8 POP_LIM_VARIABLE
	REAL(10) LIT_LIM,BIG_LIM								   |		REAL*8 LIT_LIM,BIG_LIM
	REAL(10) DPTH_LIT_LIM,DPTH_BIG_LIM							   |		REAL*8 DPTH_LIT_LIM,DPTH_BIG_LIM
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) MIN_SCALE									   |		REAL*8 MIN_SCALE
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) BAD_DECREASE_LIMIT								   |		REAL*8 BAD_DECREASE_LIMIT
	REAL(10) BAD_INCREASE_LIMIT								   |		REAL*8 BAD_INCREASE_LIMIT
./new_main/subs/fiddle_pop_corrections_v2.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) MAX_dT_COR									   |		REAL*8 MAX_dT_COR
	REAL(10) RELAX_PARAM(ND)								   |		REAL*8 RELAX_PARAM(ND)
	REAL(10) POP_LIM(ND)									   |		REAL*8 POP_LIM(ND)
	REAL(10) T_LIM(ND)									   |		REAL*8 T_LIM(ND)
	REAL(10) RELAX_VARIABLE									   |		REAL*8 RELAX_VARIABLE
	REAL(10) T_LIM_VARIABLE									   |		REAL*8 T_LIM_VARIABLE
	REAL(10) POP_LIM_VARIABLE								   |		REAL*8 POP_LIM_VARIABLE
	REAL(10) LIT_LIM,BIG_LIM								   |		REAL*8 LIT_LIM,BIG_LIM
	REAL(10) DPTH_LIT_LIM,DPTH_BIG_LIM							   |		REAL*8 DPTH_LIT_LIM,DPTH_BIG_LIM
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) MIN_SCALE									   |		REAL*8 MIN_SCALE
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) BAD_DECREASE_LIMIT								   |		REAL*8 BAD_DECREASE_LIMIT
	REAL(10) BAD_INCREASE_LIMIT								   |		REAL*8 BAD_INCREASE_LIMIT
./new_main/subs/fixpop_in_ba_v2.f
	REAL(10) BA(NT,NT)									   |		REAL*8 BA(NT,NT)
	REAL(10) STEQ(NT)									   |		REAL*8 STEQ(NT)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/fixpop_in_ba_v3.f
	REAL(10) BA(NT,NT)									   |		REAL*8 BA(NT,NT)
	REAL(10) STEQ(NT)									   |		REAL*8 STEQ(NT)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/fixpop_t.f
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/generate_full_matrix.f
        REAL(10) POPS(NT,ND)									   |	        REAL*8 POPS(NT,ND)
        REAL(10) C_MAT(NT,NT)									   |	        REAL*8 C_MAT(NT,NT)
	REAL(10) STEQ_VEC(NT)									   |		REAL*8 STEQ_VEC(NT)
	REAL(10) C_ION(NION,NT)									   |		REAL*8 C_ION(NION,NT)
	REAL(10) STEQ_ION(NION)									   |		REAL*8 STEQ_ION(NION)
	REAL(10) C_NC(NUM_SPECIES,NT)								   |		REAL*8 C_NC(NUM_SPECIES,NT)
	REAL(10) STEQ_NC(NUM_SPECIES)								   |		REAL*8 STEQ_NC(NUM_SPECIES)
!	REAL(10), PARAMETER :: FAC=1.0D+05							   |	!	REAL*8, PARAMETER :: FAC=1.0D+05
	REAL(10), PARAMETER :: FAC=1.0D+02							   |		REAL*8, PARAMETER :: FAC=1.0D+02
./new_main/subs/generate_full_matrix_v2.f
        REAL(10) POPS(NT,ND)									   |	        REAL*8 POPS(NT,ND)
        REAL(10) C_MAT(NT,NT)									   |	        REAL*8 C_MAT(NT,NT)
	REAL(10) STEQ_VEC(NT)									   |		REAL*8 STEQ_VEC(NT)
	REAL(10) C_ION(NION,NT)									   |		REAL*8 C_ION(NION,NT)
	REAL(10) STEQ_ION(NION)									   |		REAL*8 STEQ_ION(NION)
	REAL(10) C_NC(NUM_SPECIES,NT)								   |		REAL*8 C_NC(NUM_SPECIES,NT)
	REAL(10) STEQ_NC(NUM_SPECIES)								   |		REAL*8 STEQ_NC(NUM_SPECIES)
	REAL(10) G_SUM(NT)									   |		REAL*8 G_SUM(NT)
	REAL(10) EDGE_SUM(NT)									   |		REAL*8 EDGE_SUM(NT)
	REAL(10) SUM,T1										   |		REAL*8 SUM,T1
!	REAL(10), PARAMETER :: FAC=1.0D+05							   |	!	REAL*8, PARAMETER :: FAC=1.0D+05
	REAL(10), PARAMETER :: FAC=1.0D+02							   |		REAL*8, PARAMETER :: FAC=1.0D+02
./new_main/subs/generate_full_matrix_v3.f
        REAL(10) POPS(NT,ND)									   |	        REAL*8 POPS(NT,ND)
        REAL(10) C_MAT(NT,NT)									   |	        REAL*8 C_MAT(NT,NT)
	REAL(10) STEQ_VEC(NT)									   |		REAL*8 STEQ_VEC(NT)
	REAL(10) C_ION(NION,NT)									   |		REAL*8 C_ION(NION,NT)
	REAL(10) STEQ_ION(NION)									   |		REAL*8 STEQ_ION(NION)
	REAL(10) C_NC(NUM_SPECIES,NT)								   |		REAL*8 C_NC(NUM_SPECIES,NT)
	REAL(10) STEQ_NC(NUM_SPECIES)								   |		REAL*8 STEQ_NC(NUM_SPECIES)
	REAL(10) G_SUM(NT)									   |		REAL*8 G_SUM(NT)
	REAL(10) EDGE_SUM(NT)									   |		REAL*8 EDGE_SUM(NT)
	REAL(10) SUM,T1										   |		REAL*8 SUM,T1
!	REAL(10), PARAMETER :: FAC=1.0D+05							   |	!	REAL*8, PARAMETER :: FAC=1.0D+05
!	REAL(10), PARAMETER :: FAC=1.0D+02							   |	!	REAL*8, PARAMETER :: FAC=1.0D+02
	REAL(10), SAVE ::  FAC=1.0D+02								   |		REAL*8, SAVE ::  FAC=1.0D+02
./new_main/subs/get_decay_lum_v1.f
	REAL(10) dE_RAD_DECAY(ND)								   |		REAL*8 dE_RAD_DECAY(ND)
	REAL(10) RAD_DECAY_LUM									   |		REAL*8 RAD_DECAY_LUM
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
./new_main/subs/get_edep_shock_power.f
      REAL(10) r(nd)												   |	      real*8 r(nd)													
      REAL(10) v(nd)												   |	      real*8 v(nd)													
      REAL(10) density(nd)												   |	      real*8 density(nd)													
      REAL(10) wgt(nd)												   |	      real*8 wgt(nd)													
      REAL(10) wrk(nd)												   |	      real*8 wrk(nd)													
      REAL(10) t1												   |	      real*8 t1													
      ! set up the deposition profile												   |	! set up the deposition profile													
												   >	!													
         write(6,*) 'In get_edep i, V, FCL: ',i,v(i),clump_fac(i)												   <
         call flush(6)												   <
         if (abs(t1).lt.8.d0) wgt(i) = exp(-t1*t1)												   |	         if (dabs(t1).lt.8.d0) wgt(i) = exp(-t1*t1)													
         ! dividing by clump_fac makes the shock edep max in clumped regions 												   |	!													
         ! since CMFGEN scales the edep by clump_fac												   |	! dividing by clump_fac makes the shock edep max in clumped regions 													
												   >	! since CMFGEN scales the edep by clump_fac													
												   >	!													
./new_main/subs/get_non_loc_gamma_energy.f
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10), ALLOCATABLE :: VTMP(:),EDEPTMP(:),EDEPNEW(:)					   |		REAL*8, ALLOCATABLE :: VTMP(:),EDEPTMP(:),EDEPNEW(:)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/get_non_loc_gamma_energy_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10), ALLOCATABLE :: VTMP(:),EDEPTMP(:),EDEPNEW(:)					   |		REAL*8, ALLOCATABLE :: VTMP(:),EDEPTMP(:),EDEPNEW(:)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) CONV_CONST									   |		REAL*8 CONV_CONST
	REAL(10) WRK(ND)									   |		REAL*8 WRK(ND)
./new_main/subs/get_pops_at_prev_time_step_v2.f
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_SIGMA(ND)									   |		REAL*8 OLD_SIGMA(ND)
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_V(ND)									   |		REAL*8 OLD_V(ND)
	REAL(10) LOG_OLD_V(ND)									   |		REAL*8 LOG_OLD_V(ND)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) NEW_VEC(ND)									   |		REAL*8 NEW_VEC(ND)
	REAL(10) OLD_VEC(ND)									   |		REAL*8 OLD_VEC(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./new_main/subs/get_pops_at_prev_time_step_v3.f
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_V(ND)									   |		REAL*8 OLD_V(ND)
	REAL(10) OLD_SIGMA(ND)									   |		REAL*8 OLD_SIGMA(ND)
	REAL(10) LOG_OLD_V(ND)									   |		REAL*8 LOG_OLD_V(ND)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) NEW_VEC(ND)									   |		REAL*8 NEW_VEC(ND)
	REAL(10) OLD_VEC(ND)									   |		REAL*8 OLD_VEC(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./new_main/subs/get_pops_at_prev_time_step_v4.f
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10), ALLOCATABLE :: TMP_R(:)							   |		REAL*8, ALLOCATABLE :: TMP_R(:)
	REAL(10), ALLOCATABLE :: TMP_V(:)							   |		REAL*8, ALLOCATABLE :: TMP_V(:)
	REAL(10), ALLOCATABLE :: TMP_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: TMP_SIGMA(:)
	REAL(10), ALLOCATABLE :: TMP_POPS(:,:)							   |		REAL*8, ALLOCATABLE :: TMP_POPS(:,:)
	REAL(10), ALLOCATABLE :: TMP_VEC(:)							   |		REAL*8, ALLOCATABLE :: TMP_VEC(:)
	REAL(10), ALLOCATABLE :: TMP_DENSITY(:)							   |		REAL*8, ALLOCATABLE :: TMP_DENSITY(:)
	REAL(10), ALLOCATABLE :: TMP_POP_ATOM(:)						   |		REAL*8, ALLOCATABLE :: TMP_POP_ATOM(:)
	REAL(10), ALLOCATABLE :: LOG_TMP_V(:)							   |		REAL*8, ALLOCATABLE :: LOG_TMP_V(:)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) NEW_VEC(ND)									   |		REAL*8 NEW_VEC(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) OLD_SN_AGE									   |		REAL*8 OLD_SN_AGE
./new_main/subs/get_pops_at_prev_time_step_v5.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) TIME_SEQ_NO									   |		REAL*8 TIME_SEQ_NO
	REAL(10), ALLOCATABLE :: TMP_R(:)							   |		REAL*8, ALLOCATABLE :: TMP_R(:)
	REAL(10), ALLOCATABLE :: TMP_V(:)							   |		REAL*8, ALLOCATABLE :: TMP_V(:)
	REAL(10), ALLOCATABLE :: TMP_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: TMP_SIGMA(:)
	REAL(10), ALLOCATABLE :: TMP_POPS(:,:)							   |		REAL*8, ALLOCATABLE :: TMP_POPS(:,:)
	REAL(10), ALLOCATABLE :: TMP_VEC(:)							   |		REAL*8, ALLOCATABLE :: TMP_VEC(:)
	REAL(10), ALLOCATABLE :: TMP_DENSITY(:)							   |		REAL*8, ALLOCATABLE :: TMP_DENSITY(:)
	REAL(10), ALLOCATABLE :: TMP_POP_ATOM(:)						   |		REAL*8, ALLOCATABLE :: TMP_POP_ATOM(:)
	REAL(10), ALLOCATABLE :: LOG_TMP_V(:)							   |		REAL*8, ALLOCATABLE :: LOG_TMP_V(:)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) NEW_VEC(ND)									   |		REAL*8 NEW_VEC(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) OLD_SN_AGE									   |		REAL*8 OLD_SN_AGE
./new_main/subs/get_rad_decay_energy.f
	REAL(10) E_RAD_DECAY(ND)								   |		REAL*8 E_RAD_DECAY(ND)
./new_main/subs/new_ba_up_tst.f
	  REAL(10), POINTER :: VJ_R(:,:,:)							   |		  REAL*8, POINTER :: VJ_R(:,:,:)
	  REAL(10), POINTER :: VJ_P(:,:,:)							   |		  REAL*8, POINTER :: VJ_P(:,:,:)
	  REAL(10), POINTER :: VJ_T(:,:,:)							   |		  REAL*8, POINTER :: VJ_T(:,:,:)
	REAL(10), ALLOCATABLE :: RJ_SUM(:)							   |		REAL*8, ALLOCATABLE :: RJ_SUM(:)
!                         ABS changed to ABS.							   |	!                         DABS changed to ABS.
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) dJ_CHK_FAC									   |		REAL*8 dJ_CHK_FAC
!												   |	!
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) COMP_VEC(NT)									   |		REAL*8 COMP_VEC(NT)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,QFV_T									   |		REAL*8 T1,T2,QFV_T
./new_main/subs/old_grid_module.f
          REAL(10), ALLOCATABLE :: OLD_R(:)							   |	          REAL*8, ALLOCATABLE :: OLD_R(:)
          REAL(10), ALLOCATABLE :: OLD_T(:)							   |	          REAL*8, ALLOCATABLE :: OLD_T(:)
          REAL(10), ALLOCATABLE :: OLD_V(:)							   |	          REAL*8, ALLOCATABLE :: OLD_V(:)
          REAL(10), ALLOCATABLE :: OLD_SIGMA(:)							   |	          REAL*8, ALLOCATABLE :: OLD_SIGMA(:)
          REAL(10), ALLOCATABLE :: OLD_ED(:)							   |	          REAL*8, ALLOCATABLE :: OLD_ED(:)
          REAL(10), ALLOCATABLE :: OLD_POP_ATOM(:)						   |	          REAL*8, ALLOCATABLE :: OLD_POP_ATOM(:)
          REAL(10), ALLOCATABLE :: OLD_POPION(:)						   |	          REAL*8, ALLOCATABLE :: OLD_POPION(:)
          REAL(10), ALLOCATABLE :: OLD_MASS_DENSITY(:)						   |	          REAL*8, ALLOCATABLE :: OLD_MASS_DENSITY(:)
          REAL(10), ALLOCATABLE :: OLD_CLUMP_FAC(:)						   |	          REAL*8, ALLOCATABLE :: OLD_CLUMP_FAC(:)
          REAL(10), ALLOCATABLE :: OLD_TAU(:)							   |	          REAL*8, ALLOCATABLE :: OLD_TAU(:)
	  REAL(10), ALLOCATABLE :: OLD_SF(:)							   |		  REAL*8, ALLOCATABLE :: OLD_SF(:)
          REAL(10), ALLOCATABLE :: OLD_ESEC(:)							   |	          REAL*8, ALLOCATABLE :: OLD_ESEC(:)
          REAL(10), ALLOCATABLE :: OLD_ROSS_MEAN(:)						   |	          REAL*8, ALLOCATABLE :: OLD_ROSS_MEAN(:)
          REAL(10), ALLOCATABLE :: OLD_FLUX_MEAN(:)						   |	          REAL*8, ALLOCATABLE :: OLD_FLUX_MEAN(:)
          REAL(10), ALLOCATABLE :: OLD_KAP_ROSS(:)						   |	          REAL*8, ALLOCATABLE :: OLD_KAP_ROSS(:)
          REAL(10), ALLOCATABLE :: OLD_KAP_FLUX(:)						   |	          REAL*8, ALLOCATABLE :: OLD_KAP_FLUX(:)
          REAL(10), ALLOCATABLE :: OLD_KAP_ESEC(:)						   |	          REAL*8, ALLOCATABLE :: OLD_KAP_ESEC(:)
	  REAL(10), ALLOCATABLE :: HYDRO_TAU(:)							   |		  REAL*8, ALLOCATABLE :: HYDRO_TAU(:)
	  REAL(10), ALLOCATABLE :: HYDRO_ERROR(:,:)						   |		  REAL*8, ALLOCATABLE :: HYDRO_ERROR(:,:)
	  REAL(10), ALLOCATABLE :: HYDRO_ACTUAL_GAMMA(:,:)					   |		  REAL*8, ALLOCATABLE :: HYDRO_ACTUAL_GAMMA(:,:)
	  REAL(10), ALLOCATABLE :: HYDRO_PREDICTED_GAMMA(:,:)					   |		  REAL*8, ALLOCATABLE :: HYDRO_PREDICTED_GAMMA(:,:)
./new_main/subs/open_rw_eddfactor.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) LANG_COORD(ND)									   |		REAL*8 LANG_COORD(ND)
!												   |	!
	REAL(10) R_EXT(ND)									   |		REAL*8 R_EXT(ND)
	REAL(10) V_EXT(ND)									   |		REAL*8 V_EXT(ND)
	REAL(10) LANG_COORD_EXT(ND)								   |		REAL*8 LANG_COORD_EXT(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) LANG_COORD(ND)									   |		REAL*8 LANG_COORD(ND)
!												   |	!
	REAL(10) R_EXT(ND)									   |		REAL*8 R_EXT(ND)
	REAL(10) V_EXT(ND)									   |		REAL*8 V_EXT(ND)
	REAL(10) LANG_COORD_EXT(ND)								   |		REAL*8 LANG_COORD_EXT(ND)
./new_main/subs/out_line_force.f
	REAL(10) ION_LINE_FORCE(ND,NUM_IONS)							   |		REAL*8 ION_LINE_FORCE(ND,NUM_IONS)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) DENSITY(ND)									   |		REAL*8 DENSITY(ND)
	REAL(10) FLUXMEAN(ND)									   |		REAL*8 FLUXMEAN(ND)
	REAL(10) ROSSMEAN(ND)									   |		REAL*8 ROSSMEAN(ND)
	REAL(10) RLUMST(ND)									   |		REAL*8 RLUMST(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
./new_main/subs/out_sn_pops.f
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) X(ND)										   |		REAL*8 X(ND)
./new_main/subs/out_sn_pops_v2.f
	REAL(10) SN_AGE_DAYS									   |		REAL*8 SN_AGE_DAYS
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) X(ND)										   |		REAL*8 X(ND)
./new_main/subs/out_sn_pops_v3.f
	REAL(10) SN_AGE_DAYS									   |		REAL*8 SN_AGE_DAYS
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) X(ND)										   |		REAL*8 X(ND)
./new_main/subs/par_gen_mat.f
./new_main/subs/prevent_low_t.f
	REAL(10) HEAT(ND)           !Full heating term						   |		REAL*8 HEAT(ND)           !Full heating term
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) TA(ND)             !Temporary work vector					   |		REAL*8 TA(ND)             !Temporary work vector
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) EHB_CONSTANT									   |		REAL*8 EHB_CONSTANT
./new_main/subs/rd_nuc_decay_data.f
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ELECTRON_VOLT									   |		REAL*8 ELECTRON_VOLT
./new_main/subs/rd_nuc_decay_data_v2.f
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ELECTRON_VOLT									   |		REAL*8 ELECTRON_VOLT
./new_main/subs/rd_sn_data.f
! Altered: 17-Apr-2023 : MASS frcation now outout to MASS_FRACTION_SUMMARY_CHK rather than OUTGE   |	! Altered: 24-Sep-2023 : Now scale ISO pops so mass fractions add correctly (08-Sep-2023)
												   >	! Altered: 17-Apr-2023 : MASS fraction now output to MASS_FRACTION_SUMMARY_CHK rather than OUTGE
	REAL(10), ALLOCATABLE :: R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: R_HYDRO(:)
	REAL(10), ALLOCATABLE :: LOG_R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_HYDRO(:)
	REAL(10), ALLOCATABLE :: V_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: V_HYDRO(:)
	REAL(10), ALLOCATABLE :: SIGMA_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_HYDRO(:)
	REAL(10), ALLOCATABLE :: T_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: T_HYDRO(:)
	REAL(10), ALLOCATABLE :: DENSITY_HYDRO(:)						   |		REAL*8, ALLOCATABLE :: DENSITY_HYDRO(:)
	REAL(10), ALLOCATABLE :: ATOM_DEN_HYDRO(:)						   |		REAL*8, ALLOCATABLE :: ATOM_DEN_HYDRO(:)
	REAL(10), ALLOCATABLE :: ELEC_DEN_HYDRO(:)						   |		REAL*8, ALLOCATABLE :: ELEC_DEN_HYDRO(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC_HYDRO(:)						   |		REAL*8, ALLOCATABLE :: CLUMP_FAC_HYDRO(:)
	REAL(10), ALLOCATABLE :: POP_HYDRO(:,:)							   |		REAL*8, ALLOCATABLE :: POP_HYDRO(:,:)
	REAL(10), ALLOCATABLE :: ISO_HYDRO(:,:)							   |		REAL*8, ALLOCATABLE :: ISO_HYDRO(:,:)
	REAL(10), ALLOCATABLE :: WRK_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: WRK_HYDRO(:)
	REAL(10) MASS_SPECIES(100)								   |		REAL*8 MASS_SPECIES(100)
	REAL(10) WRK(ND)									   |		REAL*8 WRK(ND)
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) DELTA_T_SECS									   |		REAL*8 DELTA_T_SECS
	REAL(10) OLD_SN_AGE_DAYS								   |		REAL*8 OLD_SN_AGE_DAYS
	REAL(10) DEN_SCL_FAC									   |		REAL*8 DEN_SCL_FAC
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) MF_IB,MF_OB									   |		REAL*8 MF_IB,MF_OB
	REAL(10) ISO_MF_IB,ISO_MF_OB								   |		REAL*8 ISO_MF_IB,ISO_MF_OB
	WRITE(LUER,'(/,A)')' Entering RD_SN_DATA'						   |		WRITE(LUER,'(/,A)')' Entering RD_SN_DATA';    FLUSH(LUER)
												   >		WRITE(LUER,*)'NUM_SPECIES=',NUM_SPECIES
												   >		FLUSH(LUER)
												   >		  WRITE(LUER,*)'Read in SN_HYDRO_DATA data headers'
												   >		  FLUSH(UNIT=LUER)
												   >		 FLUSH(LUER)
												   >		  FLUSH(UNIT=LUER)
	WRITE(LUER,*)'   Read SN populations in RD_SN_DATA'					   |		WRITE(LUER,*)'   Read SN populations in RD_SN_DATA'; FLUSH(UNIT=LUER)
												   >		WRITE(LUER,*)'NUM_SPECIES=',NUM_SPECIES,NSP
												   >		FLUSH(LUER)
	DO K=1,NUM_SPECIES									   |		DO K=1,NSP                               !NUM_SPECIES
												   >		FLUSH(UNIT=LUER)
												   >	! Write -- also scaling ISO pops so MF conserved.
												   >	!
												   >		DO IS=1,NUM_ISOTOPES
												   >		  ISO(IS)%OLD_POP=ISO(IS)%OLD_POP/WRK
												   >		END DO
												   >	!
												   >		          FLUSH(LUER)
./new_main/subs/read_ba_data_v2.f
./new_main/subs/read_ba_data_v3.f
./new_main/subs/read_bcd_mat.f
	REAL(10) B(N,N)										   |		REAL*8 B(N,N)
	REAL(10) C(N,N)										   |		REAL*8 C(N,N)
	REAL(10) D(N,N)										   |		REAL*8 D(N,N)
	REAL(10) ROW_SF(N)									   |		REAL*8 ROW_SF(N)
	REAL(10) COL_SF(N)									   |		REAL*8 COL_SF(N)
	REAL(10) POPS(N)									   |		REAL*8 POPS(N)
	REAL(10) B(N,N)										   |		REAL*8 B(N,N)
	REAL(10) C(N,N)										   |		REAL*8 C(N,N)
	REAL(10) D(N,N)										   |		REAL*8 D(N,N)
	REAL(10) ROW_SF(N)									   |		REAL*8 ROW_SF(N)
	REAL(10) COL_SF(N)									   |		REAL*8 COL_SF(N)
	REAL(10) POPS(N)									   |		REAL*8 POPS(N)
./new_main/subs/read_seq_time_file_v1.f
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) OLD_V(ND)									   |		REAL*8 OLD_V(ND)
	REAL(10) OLD_SIGMA(ND)									   |		REAL*8 OLD_SIGMA(ND)
	REAL(10) OLD_POP_ATOM(ND)								   |		REAL*8 OLD_POP_ATOM(ND)
	REAL(10) OLD_DENSITY(ND)								   |		REAL*8 OLD_DENSITY(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) SN_AGE										   |		REAL*8 SN_AGE
	REAL(10), ALLOCATABLE :: OLD_XzV(:,:)							   |		REAL*8, ALLOCATABLE :: OLD_XzV(:,:)
	REAL(10), ALLOCATABLE :: TMP_XzV(:,:)							   |		REAL*8, ALLOCATABLE :: TMP_XzV(:,:)
	REAL(10), ALLOCATABLE :: TMP_DXzV(:)							   |		REAL*8, ALLOCATABLE :: TMP_DXzV(:)
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ZXzV										   |		REAL*8 ZXzV
./new_main/subs/read_time_model_v1.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) POPS(NT*ND)									   |		REAL*8 POPS(NT*ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) POPS(NT*ND)									   |		REAL*8 POPS(NT*ND)
./new_main/subs/rv_sn_model_sniin.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
!												   |	!
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) RP										   |		REAL*8 RP
	REAL(10) VCORE										   |		REAL*8 VCORE
	REAL(10) BETA1										   |		REAL*8 BETA1
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) T1,T2,DLNR									   |		REAL*8 T1,T2,DLNR
         REAL(10) XV,XD,XT,XL,XTAU,RAT								   |	         REAL*8 XV,XD,XT,XL,XTAU,RAT
         REAL(10) NEW_TAU(ND)									   |	         REAL*8 NEW_TAU(ND)
         REAL(10), ALLOCATABLE :: R_HYDRO(:),TAU_HYDRO(:),V_HYDRO(:)				   |	         REAL*8, ALLOCATABLE :: R_HYDRO(:),TAU_HYDRO(:),V_HYDRO(:)
         REAL(10) T0, S1, S2, RINT, HRHO, VRAT, VMIN, BETA_ACC					   |	         REAL*8 T0, S1, S2, RINT, HRHO, VRAT, VMIN, BETA_ACC
./new_main/subs/set_ba_storage.f
      REAL(10) MEMORY										   |	      REAL*8 MEMORY
./new_main/subs/set_depth_consistency.f
	REAL(10) STEQ_VALS(NT,ND)         !Suggested corrections to current populations		   |		REAL*8 STEQ_VALS(NT,ND)         !Suggested corrections to current populations
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) BAD_INCREASE_LIMIT	!Should be large and neagtive.				   |		REAL*8 BAD_INCREASE_LIMIT	!Should be large and neagtive.
	REAL(10) BAD_DECREASE_LIMIT	!Should be negative (typically just less than 1).	   |		REAL*8 BAD_DECREASE_LIMIT	!Should be negative (typically just less than 1).
	REAL(10) MAX_COR_VEC(ND)								   |		REAL*8 MAX_COR_VEC(ND)
	REAL(10) MIN_COR_VEC(ND)								   |		REAL*8 MIN_COR_VEC(ND)
	REAL(10) MAX_COR									   |		REAL*8 MAX_COR
	REAL(10) MIN_COR									   |		REAL*8 MIN_COR
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/set_imp_vec.f
./new_main/subs/set_new_grid.f
	REAL(10) REV_R(ND)									   |		REAL*8 REV_R(ND)
	REAL(10) REV_V(ND)									   |		REAL*8 REV_V(ND)
	REAL(10) REV_SIGMA(ND)									   |		REAL*8 REV_SIGMA(ND)
	REAL(10) REV_ED(ND)									   |		REAL*8 REV_ED(ND)
	REAL(10) REV_CHI_ROSS(ND)								   |		REAL*8 REV_CHI_ROSS(ND)
./new_main/subs/set_new_grid_v2.f
	REAL(10) REV_R(ND)									   |		REAL*8 REV_R(ND)
	REAL(10) REV_T(ND)									   |		REAL*8 REV_T(ND)
	REAL(10) REV_V(ND)									   |		REAL*8 REV_V(ND)
	REAL(10) REV_SIGMA(ND)									   |		REAL*8 REV_SIGMA(ND)
	REAL(10) REV_ED(ND)									   |		REAL*8 REV_ED(ND)
	REAL(10) REV_CHI_ROSS(ND)								   |		REAL*8 REV_CHI_ROSS(ND)
./new_main/subs/set_pops_to_pure_lte.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) REVISED_ED(ND)									   |		REAL*8 REVISED_ED(ND)
	REAL(10) VEC_SUM(ND)									   |		REAL*8 VEC_SUM(ND)
	REAL(10) Z_POP(NT)									   |		REAL*8 Z_POP(NT)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/set_rv_hydro_model.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) SN_AGE_DAYS									   |		REAL*8 SN_AGE_DAYS
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) RCORE										   |		REAL*8 RCORE
	REAL(10), ALLOCATABLE :: R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: R_HYDRO(:)
	REAL(10), ALLOCATABLE :: V_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: V_HYDRO(:)
	REAL(10), ALLOCATABLE :: SIGMA_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_HYDRO(:)
	REAL(10), ALLOCATABLE :: DENSITY_HYDRO(:)						   |		REAL*8, ALLOCATABLE :: DENSITY_HYDRO(:)
	REAL(10), ALLOCATABLE :: KAPPA_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: KAPPA_HYDRO(:)
	REAL(10), ALLOCATABLE :: TAU_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: TAU_HYDRO(:)
	REAL(10), ALLOCATABLE :: LOG_R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_HYDRO(:)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) XN(ND)										   |		REAL*8 XN(ND)
	REAL(10) TAU(2*ND)									   |		REAL*8 TAU(2*ND)
	REAL(10) LOG_R(2*ND)									   |		REAL*8 LOG_R(2*ND)
	REAL(10) OLD_SN_AGE_DAYS								   |		REAL*8 OLD_SN_AGE_DAYS
	REAL(10) SN_EXP_FACTOR									   |		REAL*8 SN_EXP_FACTOR
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) dLOGR										   |		REAL*8 dLOGR
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) NEXT_R										   |		REAL*8 NEXT_R
	REAL(10) TAU_BEG,TAU_END								   |		REAL*8 TAU_BEG,TAU_END
./new_main/subs/set_rv_hydro_model_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) RCORE										   |		REAL*8 RCORE
	REAL(10) RMAX_ON_RCORE									   |		REAL*8 RMAX_ON_RCORE
	REAL(10) SN_AGE_DAYS									   |		REAL*8 SN_AGE_DAYS
	REAL(10), ALLOCATABLE :: R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: R_HYDRO(:)
	REAL(10), ALLOCATABLE :: LOG_R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_HYDRO(:)
	REAL(10), ALLOCATABLE :: V_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: V_HYDRO(:)
	REAL(10), ALLOCATABLE :: SIGMA_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_HYDRO(:)
	REAL(10), ALLOCATABLE :: DENSITY_HYDRO(:)						   |		REAL*8, ALLOCATABLE :: DENSITY_HYDRO(:)
	REAL(10), ALLOCATABLE :: KAPPA_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: KAPPA_HYDRO(:)
	REAL(10), ALLOCATABLE :: TAU_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: TAU_HYDRO(:)
!												   |	!
	REAL(10), ALLOCATABLE :: OLD_R(:)							   |		REAL*8, ALLOCATABLE :: OLD_R(:)
	REAL(10), ALLOCATABLE :: LOG_OLD_R(:)							   |		REAL*8, ALLOCATABLE :: LOG_OLD_R(:)
	REAL(10), ALLOCATABLE :: OLD_TAU(:)							   |		REAL*8, ALLOCATABLE :: OLD_TAU(:)
	REAL(10), ALLOCATABLE :: COEF(:,:)							   |		REAL*8, ALLOCATABLE :: COEF(:,:)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) XN(ND)										   |		REAL*8 XN(ND)
	REAL(10) KAPPA(ND)									   |		REAL*8 KAPPA(ND)
	REAL(10) TAU(2*ND)									   |		REAL*8 TAU(2*ND)
	REAL(10) LOG_R(2*ND)									   |		REAL*8 LOG_R(2*ND)
	REAL(10) OLD_SN_AGE_DAYS								   |		REAL*8 OLD_SN_AGE_DAYS
	REAL(10) SN_EXP_FACTOR									   |		REAL*8 SN_EXP_FACTOR
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) dLOGR										   |		REAL*8 dLOGR
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) NEXT_R										   |		REAL*8 NEXT_R
	REAL(10) DEN_SCL_FAC									   |		REAL*8 DEN_SCL_FAC
	REAL(10) TAU_BEG,TAU_END								   |		REAL*8 TAU_BEG,TAU_END
./new_main/subs/set_rv_hydro_model_v3.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) RCORE										   |		REAL*8 RCORE
	REAL(10) RMAX_ON_RCORE									   |		REAL*8 RMAX_ON_RCORE
	REAL(10) SN_AGE_DAYS									   |		REAL*8 SN_AGE_DAYS
	REAL(10), ALLOCATABLE :: R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: R_HYDRO(:)
	REAL(10), ALLOCATABLE :: LOG_R_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_HYDRO(:)
	REAL(10), ALLOCATABLE :: V_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: V_HYDRO(:)
	REAL(10), ALLOCATABLE :: SIGMA_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_HYDRO(:)
	REAL(10), ALLOCATABLE :: T_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: T_HYDRO(:)
	REAL(10), ALLOCATABLE :: DENSITY_HYDRO(:)						   |		REAL*8, ALLOCATABLE :: DENSITY_HYDRO(:)
	REAL(10), ALLOCATABLE :: KAPPA_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: KAPPA_HYDRO(:)
	REAL(10), ALLOCATABLE :: TAU_HYDRO(:)							   |		REAL*8, ALLOCATABLE :: TAU_HYDRO(:)
!												   |	!
	REAL(10), ALLOCATABLE :: OLD_R(:)							   |		REAL*8, ALLOCATABLE :: OLD_R(:)
	REAL(10), ALLOCATABLE :: LOG_OLD_R(:)							   |		REAL*8, ALLOCATABLE :: LOG_OLD_R(:)
	REAL(10), ALLOCATABLE :: OLD_TAU(:)							   |		REAL*8, ALLOCATABLE :: OLD_TAU(:)
	REAL(10), ALLOCATABLE :: OLD_T(:)							   |		REAL*8, ALLOCATABLE :: OLD_T(:)
	REAL(10), ALLOCATABLE :: COEF(:,:)							   |		REAL*8, ALLOCATABLE :: COEF(:,:)
!												   |	!
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) XN(ND)										   |		REAL*8 XN(ND)
	REAL(10) KAPPA(ND)									   |		REAL*8 KAPPA(ND)
	REAL(10) TAU(2*ND)									   |		REAL*8 TAU(2*ND)
	REAL(10) LOG_R(2*ND)									   |		REAL*8 LOG_R(2*ND)
	REAL(10) OLD_SN_AGE_DAYS								   |		REAL*8 OLD_SN_AGE_DAYS
	REAL(10) SN_EXP_FACTOR									   |		REAL*8 SN_EXP_FACTOR
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) dLOGR										   |		REAL*8 dLOGR
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) NEXT_R										   |		REAL*8 NEXT_R
	REAL(10) DEN_SCL_FAC									   |		REAL*8 DEN_SCL_FAC
	REAL(10) TAU_BEG,TAU_END								   |		REAL*8 TAU_BEG,TAU_END
!												   |	!
	REAL(10) R_SCL_FAC									   |		REAL*8 R_SCL_FAC
	REAL(10) dLOG_T										   |		REAL*8 dLOG_T
	REAL(10) IB_RAT										   |		REAL*8 IB_RAT
	REAL(10) OB_RAT										   |		REAL*8 OB_RAT
	REAL(10) DTAU2_ON_DTAU1									   |		REAL*8 DTAU2_ON_DTAU1
	REAL(10), PARAMETER :: IB_FAC=2.5D0							   |		REAL*8, PARAMETER :: IB_FAC=2.5D0
	REAL(10), PARAMETER :: OB_FAC=1.5D0							   |		REAL*8, PARAMETER :: OB_FAC=1.5D0
./new_main/subs/set_sn_r_grid.f
	REAL(10) R(ND)			!Returned						   |		REAL*8 R(ND)			!Returned
	REAL(10) OLD_R(NS)		!Input							   |		REAL*8 OLD_R(NS)		!Input
	REAL(10) OLD_TAU(NS)		!Input							   |		REAL*8 OLD_TAU(NS)		!Input
	REAL(10) LOG_OLD_R(NS)									   |		REAL*8 LOG_OLD_R(NS)
	REAL(10) LOG_OLD_TAU(NS)								   |		REAL*8 LOG_OLD_TAU(NS)
	REAL(10) XN(ND)                   !Used as integer grid					   |		REAL*8 XN(ND)                   !Used as integer grid
	REAL(10) ZN(2*ND)			!Used as integer grid.				   |		REAL*8 ZN(2*ND)			!Used as integer grid.
	REAL(10) LOG_R(2*ND)									   |		REAL*8 LOG_R(2*ND)
	REAL(10) TAU(2*ND)									   |		REAL*8 TAU(2*ND)
	REAL(10) LOG_TAU(2*ND)									   |		REAL*8 LOG_TAU(2*ND)
	REAL(10) IB_RAT										   |		REAL*8 IB_RAT
	REAL(10) OB_RAT										   |		REAL*8 OB_RAT
	REAL(10) dTAU										   |		REAL*8 dTAU
	REAL(10) dTAU_OLD									   |		REAL*8 dTAU_OLD
	REAL(10) dLOGR										   |		REAL*8 dLOGR
	REAL(10) LOG_TAU_MIN									   |		REAL*8 LOG_TAU_MIN
	REAL(10) LOG_R_MAX									   |		REAL*8 LOG_R_MAX
	REAL(10) TAU_BEG,TAU_END								   |		REAL*8 TAU_BEG,TAU_END
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) NEXT_R										   |		REAL*8 NEXT_R
	REAL(10) OB_RAT_LOC									   |		REAL*8 OB_RAT_LOC
./new_main/subs/smooth_pops_as_we_iterate.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) STEQ_VALS(NT,ND)								   |		REAL*8 STEQ_VALS(NT,ND)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) RAT23,RAT12,RAT01								   |		REAL*8 RAT23,RAT12,RAT01
./new_main/subs/solveba_v10.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) MAX_INC_VEC(NV)								   |		REAL*8 MAX_INC_VEC(NV)
	REAL(10) MAX_DEC_VEC(NV)								   |		REAL*8 MAX_DEC_VEC(NV)
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/solveba_v11.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) MAX_INC_VEC(NV)								   |		REAL*8 MAX_INC_VEC(NV)
	REAL(10) MAX_DEC_VEC(NV)								   |		REAL*8 MAX_DEC_VEC(NV)
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/solveba_v12.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) MAX_INC_VEC(NV)								   |		REAL*8 MAX_INC_VEC(NV)
	REAL(10) MAX_DEC_VEC(NV)								   |		REAL*8 MAX_DEC_VEC(NV)
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/solveba_v13.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) MAX_dT_COR									   |		REAL*8 MAX_dT_COR
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) MAX_INC_VEC(NV)								   |		REAL*8 MAX_INC_VEC(NV)
	REAL(10) MAX_DEC_VEC(NV)								   |		REAL*8 MAX_DEC_VEC(NV)
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/solveba_v6.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) MAXCH,CHANGE_LIM								   |		REAL*8 MAXCH,CHANGE_LIM
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/solveba_v7.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/solveba_v8.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/solveba_v9.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) MAXCH										   |		REAL*8 MAXCH
	REAL(10) CHANGE_LIM									   |		REAL*8 CHANGE_LIM
	REAL(10) T_MIN										   |		REAL*8 T_MIN
	REAL(10) MAX_INC_VEC(NV)								   |		REAL*8 MAX_INC_VEC(NV)
	REAL(10) MAX_DEC_VEC(NV)								   |		REAL*8 MAX_DEC_VEC(NV)
	REAL(10) SCALE,MINSCALE,T1,T2,T3							   |		REAL*8 SCALE,MINSCALE,T1,T2,T3
	REAL(10) INCREASE,DECREASE								   |		REAL*8 INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./new_main/subs/spl_clump.f
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10), ALLOCATABLE :: VNODE(:)							   |		REAL*8, ALLOCATABLE :: VNODE(:)
	REAL(10), ALLOCATABLE :: FVAL(:)							   |		REAL*8, ALLOCATABLE :: FVAL(:)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/steq_advec_v1.f
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DERIV_CONST									   |		REAL*8 DERIV_CONST
	REAL(10) LOG_DERIV									   |		REAL*8 LOG_DERIV
./new_main/subs/steq_advec_v2.f
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DERIV_CONST									   |		REAL*8 DERIV_CONST
	REAL(10) LOG_DERIV									   |		REAL*8 LOG_DERIV
./new_main/subs/steq_advec_v3.f
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10) ADVEC_RR(ND)									   |		REAL*8 ADVEC_RR(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DERIV_FAC									   |		REAL*8 DERIV_FAC
	REAL(10) DERIV_CONST									   |		REAL*8 DERIV_CONST
	REAL(10) LOG_DERIV									   |		REAL*8 LOG_DERIV
./new_main/subs/steq_advec_v4.f
	REAL(10) RELAXATION_PARAMETER								   |		REAL*8 RELAXATION_PARAMETER
	REAL(10) SUM(NUM_IONS,ND)								   |		REAL*8 SUM(NUM_IONS,ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DERIV_CONST									   |		REAL*8 DERIV_CONST
	REAL(10) UNIT_CONST									   |		REAL*8 UNIT_CONST
./new_main/subs/steq_co_mov_deriv_v1.f
	REAL(10) RELAXATION_PARAMETER								   |		REAL*8 RELAXATION_PARAMETER
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) SUM(NUM_IONS,ND)								   |		REAL*8 SUM(NUM_IONS,ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DERIV_CONST									   |		REAL*8 DERIV_CONST
	REAL(10) DELTA_TIME_SECS			!Time step				   |		REAL*8 DELTA_TIME_SECS			!Time step
./new_main/subs/steq_co_mov_deriv_v2.f
	REAL(10) RELAXATION_PARAMETER								   |		REAL*8 RELAXATION_PARAMETER
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) SUM(NUM_IONS,ND)								   |		REAL*8 SUM(NUM_IONS,ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DERIV_CONST									   |		REAL*8 DERIV_CONST
	REAL(10) DELTA_TIME_SECS			!Time step				   |		REAL*8 DELTA_TIME_SECS			!Time step
./new_main/subs/steq_co_mov_deriv_v3.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) RELAXATION_PARAMETER								   |		REAL*8 RELAXATION_PARAMETER
	REAL(10) TIME_SEQ_NO									   |		REAL*8 TIME_SEQ_NO
	REAL(10) OLD_POPS(NT,ND)								   |		REAL*8 OLD_POPS(NT,ND)
	REAL(10) OLD_R(ND)									   |		REAL*8 OLD_R(ND)
	REAL(10) SUM(NUM_IONS,ND)								   |		REAL*8 SUM(NUM_IONS,ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DERIV_CONST									   |		REAL*8 DERIV_CONST
	REAL(10) DELTA_TIME_SECS			!Time step				   |		REAL*8 DELTA_TIME_SECS			!Time step
./new_main/subs/steq_multi_v10.f
	REAL(10) PLANCKS_CONSTANT								   |		REAL*8 PLANCKS_CONSTANT
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
!												   |	!
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) AVE_ENERGY(N_S)								   |		REAL*8 AVE_ENERGY(N_S)
!												   |	!
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F)									   |		REAL*8 A_F(N_F,N_F)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) POP(ND)		!Population of species.					   |		REAL*8 POP(ND)		!Population of species.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_VEC_ED(1)									   |		REAL*8 TMP_VEC_ED(1)
	REAL(10) TMP_VEC_COOL(1)								   |		REAL*8 TMP_VEC_COOL(1)
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
!	    IF(ZION .EQ. 3 .AND. J .EQ. 56 .AND. I .EQ. 5)THEN					   <
!	      WRITE(174,'(F5.1,I5,7ES16.5E4)')ZION,ID,T1,HNST_S(J,I),HN_S(J,I),CNM(J,J),ED(I),SE   <
!	      FLUSH(UNIT=174)									   <
!	     END IF										   <
	  END IF										   <
	  IF(ZION .EQ. 3 .AND.  I .EQ. 5)THEN							   <
	    WRITE(174,'(F5.1,I5,6ES16.5E4)')ZION,ID,SE(ID)%STEQ(56,I)				   <
	    FLUSH(UNIT=174)									   <
./new_main/subs/steq_multi_v10_save.f
./new_main/subs/steq_multi_v7.f
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
C												   |	C
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
C												   |	C
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F)									   |		REAL*8 A_F(N_F,N_F)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) POP(ND)		!Population of species.					   |		REAL*8 POP(ND)		!Population of species.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_VEC_ED(1)									   |		REAL*8 TMP_VEC_ED(1)
	REAL(10) TMP_VEC_COOL(1)								   |		REAL*8 TMP_VEC_COOL(1)
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
./new_main/subs/steq_multi_v8.f
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
!												   |	!
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
!												   |	!
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F)									   |		REAL*8 A_F(N_F,N_F)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) POP(ND)		!Population of species.					   |		REAL*8 POP(ND)		!Population of species.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_VEC_ED(1)									   |		REAL*8 TMP_VEC_ED(1)
	REAL(10) TMP_VEC_COOL(1)								   |		REAL*8 TMP_VEC_COOL(1)
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
./new_main/subs/steq_multi_v9.f
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
!												   |	!
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
!												   |	!
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F)									   |		REAL*8 A_F(N_F,N_F)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) POP(ND)		!Population of species.					   |		REAL*8 POP(ND)		!Population of species.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_VEC_ED(1)									   |		REAL*8 TMP_VEC_ED(1)
	REAL(10) TMP_VEC_COOL(1)								   |		REAL*8 TMP_VEC_COOL(1)
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
./new_main/subs/steqne_v4.f
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
./new_main/subs/store_ba_data_v2.f
./new_main/subs/store_ba_data_v3.f
./new_main/subs/store_old_grid.f
	REAL(10) MEAN_ATOMIC_MASS								   |		REAL*8 MEAN_ATOMIC_MASS
./new_main/subs/sub_guess_dc.f
												   >	! Altered 24-Sep-2023 - Can now work with Log of the departure coefficients to improve dynamic r
	REAL(10), ALLOCATABLE :: RJ(:,:)							   |		REAL*8, ALLOCATABLE :: RJ(:,:)
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ION_POP(:)							   |		REAL*8, ALLOCATABLE :: ION_POP(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
!												   |	!
	REAL(10), ALLOCATABLE :: PHOT_SUM(:)							   |		REAL*8, ALLOCATABLE :: PHOT_SUM(:)
	REAL(10), ALLOCATABLE :: RECOM_SUM(:)							   |		REAL*8, ALLOCATABLE :: RECOM_SUM(:)
	REAL(10), ALLOCATABLE :: GS_DC(:)		!GS denotes GS.				   |		REAL*8, ALLOCATABLE :: GS_DC(:)		!GS denotes GS.
	REAL(10), ALLOCATABLE :: DC(:,:)		!Departure coefficents			   |		REAL*8, ALLOCATABLE :: LN_DC(:,:)	!Log Departure coefficents (base e)
	REAL(10), ALLOCATABLE :: T_EXC(:)							   |		REAL*8, ALLOCATABLE :: T_EXC(:)
!												   |	!
	REAL(10), ALLOCATABLE :: GS_ION_POP(:)	!Ground-state ion population.			   |		REAL*8, ALLOCATABLE :: GS_ION_POP(:)	!Ground-state ion population.
	REAL(10), ALLOCATABLE :: DC_RUB(:)							   |		REAL*8, ALLOCATABLE :: DC_RUB(:)
	REAL(10), ALLOCATABLE :: WORK(:)							   |		REAL*8, ALLOCATABLE :: WORK(:)
	REAL(10) GION_SPEC									   |		REAL*8 GION_SPEC
	REAL(10) GION_REF									   |		REAL*8 GION_REF
	REAL(10) FEDGE(N_MAX)									   |		REAL*8 FEDGE(N_MAX)
	REAL(10) ENERGY(N_MAX)									   |		REAL*8 ENERGY(N_MAX)
	REAL(10) G(N_MAX)									   |		REAL*8 G(N_MAX)
	REAL(10) ION_EN										   |		REAL*8 ION_EN
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) NU1,NU2									   |		REAL*8 NU1,NU2
	REAL(10) RJ1,RJ2									   |		REAL*8 RJ1,RJ2
	REAL(10) T1,T2,T3,T4									   |		REAL*8 LN_TEN
												   >		REAL*8 T1,T2,T3,T4
	IF(ALLOCATED(DC))DEALLOCATE(DC)								   |		IF(ALLOCATED(LN_DC))DEALLOCATE(LN_DC)
	ALLOCATE (DC(NLEV,ND))									   |		ALLOCATE (LN_DC(NLEV,ND))
	   DC(J,I)=((T(I)/T_EXC(I))**1.5 )*EXP(HDKT*FEDGE(J)*(1.0D0/T_EXC(I)-1.0D0/T(I)))	   |		   LN_DC(J,I)=1.5D0*LOG(T(I)/T_EXC(I))+(HDKT*FEDGE(J)*(1.0D0/T_EXC(I)-1.0D0/T(I)))
	    T1=LOG(2.07078D-22*ED(I)*DC(1,I))							   |		    T1=DLOG(2.07078D-22*ED(I))+LN_DC(1,I)
	    WRITE(6,'(4ES16.4)')ED(I),DC(1,I),T1,HDKT*FEDGE(1)/T(I)				   <
	    IF(ION_POP(I) .LT. 1.0D-10*GS_ION_POP(I))THEN					   |		    IF(ION_POP(I) .LT. 1.0D-30*GS_ION_POP(I))THEN
	      T1=1.0D-10*GS_ION_POP(I)/ION_POP(I)						   |		      T1=1.0D-30*GS_ION_POP(I)/ION_POP(I)
	        DC(J,I)=DC(J,I)/T1								   |		        LN_DC(J,I)=LN_DC(J,I)-LOG(T1)
												   >		T1=10.0D0; LN_TEN=LOG(T1)
	  WRITE(LU_OUT,'(/,1X,A,T40,A)')'07-Jul-1997','!Format date'				   |		  WRITE(LU_OUT,'(/,1X,A,T40,A)')'10-Dec-2010','!Format date'
	    WRITE(LU_OUT,'(1X,1P,5E17.7)')(DC(J,I),J=1,NLEV)					   |		    WRITE(LU_OUT,'(1X,1P,5E17.7)')(LN_DC(J,I)/LN_TEN,J=1,NLEV)
	IF(ALLOCATED(DC))DEALLOCATE(DC)								   |		IF(ALLOCATED(LN_DC))DEALLOCATE(LN_DC)
./new_main/subs/sum_steq_sol.f
	REAL(10) SOL(NT,ND)									   |		REAL*8 SOL(NT,ND)
	REAL(10) MIN_CHANGE,MAX_CHANGE								   |		REAL*8 MIN_CHANGE,MAX_CHANGE
./new_main/subs/tst_1.f
	REAL(10), ALLOCATABLE :: D(:,:,:)							   |		REAL*8, ALLOCATABLE :: D(:,:,:)
./new_main/subs/tst_2.f
	REAL(10), ALLOCATABLE :: A(:,:)								   |		REAL*8, ALLOCATABLE :: A(:,:)
	REAL(10), ALLOCATABLE :: B(:,:)								   |		REAL*8, ALLOCATABLE :: B(:,:)
	REAL(10), ALLOCATABLE :: C(:,:)								   |		REAL*8, ALLOCATABLE :: C(:,:)
	REAL(10), ALLOCATABLE :: D(:,:)								   |		REAL*8, ALLOCATABLE :: D(:,:)
	REAL(10) DP_ONE,DP_ZERO,DP_NEG_ONE							   |		REAL*8 DP_ONE,DP_ZERO,DP_NEG_ONE
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) ST_CPU(MAX_IDS)								   |	        REAL*8 ST_CPU(MAX_IDS)
	REAL(10) CPUTOT(MAX_IDS)								   |		REAL*8 CPUTOT(MAX_IDS)
        REAL(10) WALLTOT(MAX_IDS)								   |	        REAL*8 WALLTOT(MAX_IDS)
	REAL(10) CLK_PERIOD,RR0									   |		REAL*8 CLK_PERIOD,RR0
./new_main/subs/tst_add.f
	REAL(10), ALLOCATABLE :: VJ_R(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_R(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_P(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_P(:,:,:)
	REAL(10), ALLOCATABLE :: VJ(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ(:,:,:)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) ST_CPU(MAX_IDS)								   |	        REAL*8 ST_CPU(MAX_IDS)
	REAL(10) CPUTOT(MAX_IDS)								   |		REAL*8 CPUTOT(MAX_IDS)
        REAL(10) WALLTOT(MAX_IDS)								   |	        REAL*8 WALLTOT(MAX_IDS)
	REAL(10) CLK_PERIOD,RR0									   |		REAL*8 CLK_PERIOD,RR0
./new_main/subs/tst_ba_1.f
	REAL(10), ALLOCATABLE :: VJ_R(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_R(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_P(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_P(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_T(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_T(:,:,:)
	REAL(10), ALLOCATABLE :: RJ_SUM(:)							   |		REAL*8, ALLOCATABLE :: RJ_SUM(:)
!                         ABS changed to ABS.							   |	!                         DABS changed to ABS.
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) dJ_CHK_FAC									   |		REAL*8 dJ_CHK_FAC
!												   |	!
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) COMP_VEC(NT)									   |		REAL*8 COMP_VEC(NT)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,QFV_T									   |		REAL*8 T1,T2,QFV_T
./new_main/subs/tst_loop.f
	REAL(10) VJ(NT,NB,ND)									   |		REAL*8 VJ(NT,NB,ND)
	REAL(10) VJ_SUM(NT,NB,ND)								   |		REAL*8 VJ_SUM(NT,NB,ND)
	REAL(10) VJ_SUM2(NT,NB,ND)								   |		REAL*8 VJ_SUM2(NT,NB,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) OLDJ(ND)									   |		REAL*8 OLDJ(ND)
./new_main/subs/tst_loop_v2.f
	REAL(10) VJ(NT,NB,ND)									   |		REAL*8 VJ(NT,NB,ND)
	REAL(10) VJ_SUM(NT,NB,ND)								   |		REAL*8 VJ_SUM(NT,NB,ND)
	REAL(10) VJ_SUM2(NT,NB,ND)								   |		REAL*8 VJ_SUM2(NT,NB,ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) OLDJ(ND)									   |		REAL*8 OLDJ(ND)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/tst_mat.f
	REAL(10) A(N,NR),C(N,NR),E(N,NR),WRKMAT(N,NR)						   |		REAL*8 A(N,NR),C(N,NR),E(N,NR),WRKMAT(N,NR)
	REAL(10) B(N,N),D(N,N),F(N,N),VEC(N)							   |		REAL*8 B(N,N),D(N,N),F(N,N),VEC(N)
	REAL(10) DP_ONE,DP_ZERO,DP_NEG_ONE							   |		REAL*8 DP_ONE,DP_ZERO,DP_NEG_ONE
./new_main/subs/tst_rd_seq.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10), ALLOCATABLE :: OLD_R(:)							   |		REAL*8, ALLOCATABLE :: OLD_R(:)
	REAL(10), ALLOCATABLE :: OLD_V(:)							   |		REAL*8, ALLOCATABLE :: OLD_V(:)
	REAL(10), ALLOCATABLE :: OLD_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: OLD_SIGMA(:)
	REAL(10), ALLOCATABLE :: OLD_POP_ATOM(:)						   |		REAL*8, ALLOCATABLE :: OLD_POP_ATOM(:)
	REAL(10), ALLOCATABLE :: OLD_DENSITY(:)							   |		REAL*8, ALLOCATABLE :: OLD_DENSITY(:)
	REAL(10), ALLOCATABLE :: OLD_POPS(:,:)							   |		REAL*8, ALLOCATABLE :: OLD_POPS(:,:)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) OLD_SN_AGE									   |		REAL*8 OLD_SN_AGE
./new_main/subs/update_ba_for_line.f
        REAL(10) FL										   |	        REAL*8 FL
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) VB(ND),VC(ND)									   |		REAL*8 VB(ND),VC(ND)
        REAL(10) T1,T2,T3,T4									   |	        REAL*8 T1,T2,T3,T4
	REAL(10) SCL_FAC									   |		REAL*8 SCL_FAC
	REAL(10), SAVE :: SUM_BA								   |		REAL*8, SAVE :: SUM_BA
	REAL(10), SAVE :: FL_OLD								   |		REAL*8, SAVE :: FL_OLD
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
        REAL(10) OPLIN,EMLIN									   |	        REAL*8 OPLIN,EMLIN
./new_main/subs/var_op_v10.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), TARGET :: VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)			   |		REAL*8, TARGET :: VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)
	REAL(10), TARGET :: VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)			   |		REAL*8, TARGET :: VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)
	REAL(10), TARGET :: VCHI_NOT_IMP(NT,ND)							   |		REAL*8, TARGET :: VCHI_NOT_IMP(NT,ND)
	REAL(10), TARGET :: VETA_NOT_IMP(NT,ND)							   |		REAL*8, TARGET :: VETA_NOT_IMP(NT,ND)
C												   |	C
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) LOG_HNST_S(N_S,ND)								   |		REAL*8 LOG_HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) DI_S(N_DI,ND)									   |		REAL*8 DI_S(N_DI,ND)
	REAL(10) LOG_DIST_S(N_DI,ND)								   |		REAL*8 LOG_DIST_S(N_DI,ND)
	REAL(10) dlnDIST_S_dlnT(N_DI,ND)							   |		REAL*8 dlnDIST_S_dlnT(N_DI,ND)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) Z			!Charge on ion						   |		REAL*8 Z			!Charge on ion
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperatuure (10^4 K)					   |		REAL*8 T(ND)			!Temperatuure (10^4 K)
	REAL(10) EMHNUKT(ND)		!exp(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!exp(-hv/kT)
	REAL(10), POINTER :: PCHI(:,:)								   |		REAL*8, POINTER :: PCHI(:,:)
	REAL(10), POINTER :: PETA(:,:)								   |		REAL*8, POINTER :: PETA(:,:)
	REAL(10) GFF_VAL(ND)		!Used as work vector					   |		REAL*8 GFF_VAL(ND)		!Used as work vector
	REAL(10) LOG_DI_RAT(ND)		!Used as work vector					   |		REAL*8 LOG_DI_RAT(ND)		!Used as work vector
	REAL(10) DT_TERM(ND)		!Used as work vector					   |		REAL*8 DT_TERM(ND)		!Used as work vector
	REAL(10) HDKT_ON_T(ND)		!Used as work vector					   |		REAL*8 HDKT_ON_T(ND)		!Used as work vector
	REAL(10) POP_SUM(ND)									   |		REAL*8 POP_SUM(ND)
C												   |	C
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N_F)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N_F)		!Photionization cross-section
	REAL(10) VCHI_TMP(N_F,ND)								   |		REAL*8 VCHI_TMP(N_F,ND)
	REAL(10) SUM_ION; REAL(10) SUM_T1; REAL(10) SUM_T2					   |		REAL*8 SUM_ION; REAL*8 SUM_T1; REAL*8 SUM_T2
	REAL(10) SUM_ION_NOT_IMP; REAL(10) SUM_T1_NOT_IMP; REAL(10) SUM_T2_NOT_IMP		   |		REAL*8 SUM_ION_NOT_IMP; REAL*8 SUM_T1_NOT_IMP; REAL*8 SUM_T2_NOT_IMP
	REAL(10) NEFF,ZION_CUBED,T1,T2								   |		REAL*8 NEFF,ZION_CUBED,T1,T2
	REAL(10) TCHI1,TCHI2,TETA1,TETA2,TETA3							   |		REAL*8 TCHI1,TCHI2,TETA1,TETA2,TETA3
	REAL(10) HNUONK,ALPHA									   |		REAL*8 HNUONK,ALPHA
./new_main/subs/var_op_v7.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)				   |		REAL*8 VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)
	REAL(10) VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)				   |		REAL*8 VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) DI_S(N_DI,ND)									   |		REAL*8 DI_S(N_DI,ND)
	REAL(10) DIST_S(N_DI,ND)								   |		REAL*8 DIST_S(N_DI,ND)
	REAL(10) dlnDIST_S_dlnT(N_DI,ND)							   |		REAL*8 dlnDIST_S_dlnT(N_DI,ND)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) Z			!Charge on ion						   |		REAL*8 Z			!Charge on ion
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperatuure (10^4 K)					   |		REAL*8 T(ND)			!Temperatuure (10^4 K)
	REAL(10) EMHNUKT(ND)		!exp(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!exp(-hv/kT)
	REAL(10) GFF_VAL(ND)		!Used as work vector					   |		REAL*8 GFF_VAL(ND)		!Used as work vector
	REAL(10) DI_RAT(ND)		!Used as work vector					   |		REAL*8 DI_RAT(ND)		!Used as work vector
	REAL(10) DT_TERM(ND)		!Used as work vector					   |		REAL*8 DT_TERM(ND)		!Used as work vector
	REAL(10) HDKT_ON_T(ND)		!Used as work vector					   |		REAL*8 HDKT_ON_T(ND)		!Used as work vector
C												   |	C
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N_F)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N_F)		!Photionization cross-section
	REAL(10) VCHI_ION(N_F)									   |		REAL*8 VCHI_ION(N_F)
	REAL(10) VCHI_T1(N_F)									   |		REAL*8 VCHI_T1(N_F)
	REAL(10) VCHI_T2(N_F)									   |		REAL*8 VCHI_T2(N_F)
	REAL(10) VCHI_TMP(N_F,ND)								   |		REAL*8 VCHI_TMP(N_F,ND)
	REAL(10) SUM_ION									   |		REAL*8 SUM_ION
	REAL(10) SUM_T1										   |		REAL*8 SUM_T1
	REAL(10) SUM_T2										   |		REAL*8 SUM_T2
	REAL(10) NEFF,ZION_CUBED,T1,T2								   |		REAL*8 NEFF,ZION_CUBED,T1,T2
	REAL(10) TCHI1,TCHI2,TETA1,TETA2,TETA3							   |		REAL*8 TCHI1,TCHI2,TETA1,TETA2,TETA3
	REAL(10) HNUONK,ALPHA									   |		REAL*8 HNUONK,ALPHA
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
./new_main/subs/var_op_v8.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), TARGET :: VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)			   |		REAL*8, TARGET :: VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)
	REAL(10), TARGET :: VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)			   |		REAL*8, TARGET :: VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)
	REAL(10), TARGET :: VCHI_NOT_IMP(NT,ND)							   |		REAL*8, TARGET :: VCHI_NOT_IMP(NT,ND)
	REAL(10), TARGET :: VETA_NOT_IMP(NT,ND)							   |		REAL*8, TARGET :: VETA_NOT_IMP(NT,ND)
C												   |	C
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) DI_S(N_DI,ND)									   |		REAL*8 DI_S(N_DI,ND)
	REAL(10) DIST_S(N_DI,ND)								   |		REAL*8 DIST_S(N_DI,ND)
	REAL(10) dlnDIST_S_dlnT(N_DI,ND)							   |		REAL*8 dlnDIST_S_dlnT(N_DI,ND)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) Z			!Charge on ion						   |		REAL*8 Z			!Charge on ion
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperatuure (10^4 K)					   |		REAL*8 T(ND)			!Temperatuure (10^4 K)
	REAL(10) EMHNUKT(ND)		!exp(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!exp(-hv/kT)
	REAL(10), POINTER :: PCHI(:,:)								   |		REAL*8, POINTER :: PCHI(:,:)
	REAL(10), POINTER :: PETA(:,:)								   |		REAL*8, POINTER :: PETA(:,:)
	REAL(10) GFF_VAL(ND)		!Used as work vector					   |		REAL*8 GFF_VAL(ND)		!Used as work vector
	REAL(10) DI_RAT(ND)		!Used as work vector					   |		REAL*8 DI_RAT(ND)		!Used as work vector
	REAL(10) DT_TERM(ND)		!Used as work vector					   |		REAL*8 DT_TERM(ND)		!Used as work vector
	REAL(10) HDKT_ON_T(ND)		!Used as work vector					   |		REAL*8 HDKT_ON_T(ND)		!Used as work vector
C												   |	C
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N_F)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N_F)		!Photionization cross-section
	REAL(10) VCHI_TMP(N_F,ND)								   |		REAL*8 VCHI_TMP(N_F,ND)
	REAL(10) SUM_ION; REAL(10) SUM_T1; REAL(10) SUM_T2					   |		REAL*8 SUM_ION; REAL*8 SUM_T1; REAL*8 SUM_T2
	REAL(10) SUM_ION_NOT_IMP; REAL(10) SUM_T1_NOT_IMP; REAL(10) SUM_T2_NOT_IMP		   |		REAL*8 SUM_ION_NOT_IMP; REAL*8 SUM_T1_NOT_IMP; REAL*8 SUM_T2_NOT_IMP
	REAL(10) NEFF,ZION_CUBED,T1,T2								   |		REAL*8 NEFF,ZION_CUBED,T1,T2
	REAL(10) TCHI1,TCHI2,TETA1,TETA2,TETA3							   |		REAL*8 TCHI1,TCHI2,TETA1,TETA2,TETA3
	REAL(10) HNUONK,ALPHA									   |		REAL*8 HNUONK,ALPHA
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
./new_main/subs/var_x_opa_eta_v3.f
	REAL(10) VCHI(NT,ND),VETA(NT,ND)							   |		REAL*8 VCHI(NT,ND),VETA(NT,ND)
	REAL(10) HN_A(N_A,ND),HNST_A(N_A,ND),dlnHNST_AdlnT(N_A,ND)				   |		REAL*8 HN_A(N_A,ND),HNST_A(N_A,ND),dlnHNST_AdlnT(N_A,ND)
	REAL(10) HN_B(N_B,ND),HNST_B(N_B,ND),dlnHNST_BdlnT(N_B,ND)				   |		REAL*8 HN_B(N_B,ND),HNST_B(N_B,ND),dlnHNST_BdlnT(N_B,ND)
	REAL(10) ED(ND),DI(ND),T(ND),EMHNUKT(ND),NU						   |		REAL*8 ED(ND),DI(ND),T(ND),EMHNUKT(ND),NU
	REAL(10) AT_NO,Z_A									   |		REAL*8 AT_NO,Z_A
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) ALPHA,LTE_POP,NO_ELEC								   |		REAL*8 ALPHA,LTE_POP,NO_ELEC
	REAL(10) TCHI1,TETA2,TETA3								   |		REAL*8 TCHI1,TETA2,TETA3
./new_main/subs/var_x_opa_eta_v4.f
	REAL(10) VCHI(NT,ND),VETA(NT,ND)							   |		REAL*8 VCHI(NT,ND),VETA(NT,ND)
	REAL(10) HN_A(N_A,ND),HNST_A(N_A,ND),dlnHNST_AdlnT(N_A,ND)				   |		REAL*8 HN_A(N_A,ND),HNST_A(N_A,ND),dlnHNST_AdlnT(N_A,ND)
	REAL(10) HN_B(N_B,ND),HNST_B(N_B,ND),dlnHNST_BdlnT(N_B,ND)				   |		REAL*8 HN_B(N_B,ND),HNST_B(N_B,ND),dlnHNST_BdlnT(N_B,ND)
	REAL(10) ED(ND),DI(ND),T(ND),EMHNUKT(ND),NU						   |		REAL*8 ED(ND),DI(ND),T(ND),EMHNUKT(ND),NU
	REAL(10) AT_NO,Z_A									   |		REAL*8 AT_NO,Z_A
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) LTE_POP_SUM(ND)								   |		REAL*8 LTE_POP_SUM(ND)
	REAL(10) dLTE_SUM_VEC(ND)								   |		REAL*8 dLTE_SUM_VEC(ND)
	REAL(10) LTE_POP									   |		REAL*8 LTE_POP
	REAL(10) dLTE_SUM									   |		REAL*8 dLTE_SUM
	REAL(10) ALPHA,NO_ELEC									   |		REAL*8 ALPHA,NO_ELEC
	REAL(10) TCHI1,TETA2,TETA3								   |		REAL*8 TCHI1,TETA2,TETA3
./new_main/subs/vehb_byj_v1.f
	REAL(10) WSE(NLEV,ND),dWSEdT(NLEV,ND)							   |		REAL*8 WSE(NLEV,ND),dWSEdT(NLEV,ND)
	REAL(10) WCR(NLEV,ND),dWCRdT(NLEV,ND)							   |		REAL*8 WCR(NLEV,ND),dWCRdT(NLEV,ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)
	REAL(10) DI(N_DI,ND)									   |		REAL*8 DI(N_DI,ND)
	REAL(10) LOG_DIST(N_DI,ND)								   |		REAL*8 LOG_DIST(N_DI,ND)
	REAL(10) dlnDIST_dlnT(N_DI,ND)								   |		REAL*8 dlnDIST_dlnT(N_DI,ND)
!												   |	!
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) dJREC_CRdT(ND)									   |		REAL*8 dJREC_CRdT(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) B_RAT										   |		REAL*8 B_RAT
	REAL(10) LOG_B_RAT									   |		REAL*8 LOG_B_RAT
	REAL(10) PLANCKS_CONSTANT,PC								   |		REAL*8 PLANCKS_CONSTANT,PC
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./new_main/subs/vsebyj_multi_v6.f
	REAL(10) WSE(NLEV,ND),dWSEdT(NLEV,ND)							   |		REAL*8 WSE(NLEV,ND),dWSEdT(NLEV,ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) dlnDIST_dlnT(N_DI,ND)								   |		REAL*8 dlnDIST_dlnT(N_DI,ND)
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T3										   |		REAL*8 T3
	REAL(10) B_RAT										   |		REAL*8 B_RAT
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./new_main/subs/vsebyj_multi_v7.f
	REAL(10) WSE(NLEV,ND),dWSEdT(NLEV,ND)							   |		REAL*8 WSE(NLEV,ND),dWSEdT(NLEV,ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)
	REAL(10) DI(N_DI,ND)									   |		REAL*8 DI(N_DI,ND)
	REAL(10) LOG_DIST(N_DI,ND)								   |		REAL*8 LOG_DIST(N_DI,ND)
	REAL(10) dlnDIST_dlnT(N_DI,ND)								   |		REAL*8 dlnDIST_dlnT(N_DI,ND)
!												   |	!
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T3										   |		REAL*8 T3
	REAL(10) B_RAT										   |		REAL*8 B_RAT
	REAL(10) LOG_B_RAT									   |		REAL*8 LOG_B_RAT
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./new_main/subs/vsebyj_multi_v8.f
	REAL(10) WSE(NLEV,ND),dWSEdT(NLEV,ND)							   |		REAL*8 WSE(NLEV,ND),dWSEdT(NLEV,ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)
	REAL(10) DI(N_DI,ND)									   |		REAL*8 DI(N_DI,ND)
	REAL(10) LOG_DIST(N_DI,ND)								   |		REAL*8 LOG_DIST(N_DI,ND)
	REAL(10) dlnDIST_dlnT(N_DI,ND)								   |		REAL*8 dlnDIST_dlnT(N_DI,ND)
!												   |	!
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T3										   |		REAL*8 T3
	REAL(10) B_RAT										   |		REAL*8 B_RAT
	REAL(10) LOG_B_RAT									   |		REAL*8 LOG_B_RAT
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./new_main/subs/vsebyj_x_v5.f
	REAL(10) WSE_X(N_A,ND)		!Quadrature weights (incl. cross. sec.)			   |		REAL*8 WSE_X(N_A,ND)		!Quadrature weights (incl. cross. sec.)
	REAL(10) HN_A(N_A,ND)		!Pops. of ith ionzation stage				   |		REAL*8 HN_A(N_A,ND)		!Pops. of ith ionzation stage
	REAL(10) HNST_A(N_A,ND)		!LTE   "    "  "      "       "				   |		REAL*8 HNST_A(N_A,ND)		!LTE   "    "  "      "       "
	REAL(10) dlnHNST_AdlnT(N_A,ND)								   |		REAL*8 dlnHNST_AdlnT(N_A,ND)	
	REAL(10) HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage			   |		REAL*8 HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage
	REAL(10) HNST_B(N_B,ND)		!LTE   "   "    "       "        "			   |		REAL*8 HNST_B(N_B,ND)		!LTE   "   "    "       "        "
	REAL(10) EDGE_B(N_B)									   |		REAL*8 EDGE_B(N_B)
!												   |	!
	REAL(10) DI(ND)			!Ion density for B levels.				   |		REAL*8 DI(ND)			!Ion density for B levels.
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature in 10^4K.					   |		REAL*8 T(ND)			!Temperature in 10^4K.
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) RJ(ND)			!Mean intensity						   |		REAL*8 RJ(ND)			!Mean intensity
	REAL(10) NU(NCF)			!frequency (10^15 Hz)				   |		REAL*8 NU(NCF)			!frequency (10^15 Hz)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T3,BSTIM									   |		REAL*8 T1,T3,BSTIM
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./new_main/subs/vsebyj_x_v6.f
	REAL(10) WSE_X(N_A,ND)		!Quadrature weights (incl. cross. sec.)			   |		REAL*8 WSE_X(N_A,ND)		!Quadrature weights (incl. cross. sec.)
	REAL(10) HN_A(N_A,ND)		!Pops. of ith ionzation stage				   |		REAL*8 HN_A(N_A,ND)		!Pops. of ith ionzation stage
	REAL(10) HNST_A(N_A,ND)		!LTE   "    "  "      "       "				   |		REAL*8 HNST_A(N_A,ND)		!LTE   "    "  "      "       "
	REAL(10) dlnHNST_AdlnT(N_A,ND)								   |		REAL*8 dlnHNST_AdlnT(N_A,ND)	
	REAL(10) HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage			   |		REAL*8 HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage
	REAL(10) HNST_B(N_B,ND)		!LTE   "   "    "       "        "			   |		REAL*8 HNST_B(N_B,ND)		!LTE   "   "    "       "        "
	REAL(10) EDGE_B(N_B)									   |		REAL*8 EDGE_B(N_B)
!												   |	!
	REAL(10) DI(ND)			!Ion density for B levels.				   |		REAL*8 DI(ND)			!Ion density for B levels.
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature in 10^4K.					   |		REAL*8 T(ND)			!Temperature in 10^4K.
	REAL(10) JREC(ND)			! (2hv^3/c/c+J).exp()*FQW/v			   |		REAL*8 JREC(ND)			! (2hv^3/c/c+J).exp()*FQW/v
	REAL(10) dJRECdT(ND)		!							   |		REAL*8 dJRECdT(ND)		!
	REAL(10) JPHOT(ND)	        ! J*FQW/v						   |		REAL*8 JPHOT(ND)	        ! J*FQW/v	
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T3,T4										   |		REAL*8 T3,T4
	REAL(10) RECIP_B_ION,BSTIM								   |		REAL*8 RECIP_B_ION,BSTIM
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./new_main/subs/vsebyj_x_v7.f
	REAL(10) WSE_X(N_A,ND)		!Quadrature weights (incl. cross. sec.)			   |		REAL*8 WSE_X(N_A,ND)		!Quadrature weights (incl. cross. sec.)
	REAL(10) HN_A(N_A,ND)		!Pops. of ith ionzation stage				   |		REAL*8 HN_A(N_A,ND)		!Pops. of ith ionzation stage
	REAL(10) HNST_A(N_A,ND)		!LTE   "    "  "      "       "				   |		REAL*8 HNST_A(N_A,ND)		!LTE   "    "  "      "       "
	REAL(10) dlnHNST_AdlnT(N_A,ND)								   |		REAL*8 dlnHNST_AdlnT(N_A,ND)	
	REAL(10) HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage			   |		REAL*8 HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage
	REAL(10) HNST_B(N_B,ND)		!LTE   "   "    "       "        "			   |		REAL*8 HNST_B(N_B,ND)		!LTE   "   "    "       "        "
	REAL(10) EDGE_B(N_B)									   |		REAL*8 EDGE_B(N_B)
!												   |	!
	REAL(10) DI(ND)			!Ion density for B levels.				   |		REAL*8 DI(ND)			!Ion density for B levels.
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature in 10^4K.					   |		REAL*8 T(ND)			!Temperature in 10^4K.
	REAL(10) JREC(ND)			! (2hv^3/c/c+J).exp()*FQW/v			   |		REAL*8 JREC(ND)			! (2hv^3/c/c+J).exp()*FQW/v
	REAL(10) dJRECdT(ND)		!							   |		REAL*8 dJRECdT(ND)		!
	REAL(10) JPHOT(ND)	        ! J*FQW/v						   |		REAL*8 JPHOT(ND)	        ! J*FQW/v	
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T3,T4										   |		REAL*8 T3,T4
	REAL(10) RECIP_B_ION,BSTIM								   |		REAL*8 RECIP_B_ION,BSTIM
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./new_main/subs/wr_asci_steq.f
./new_main/subs/write_cmat.f
	REAL(10) FL										   |		REAL*8 FL
./new_main/subs/write_seq_time_file_v1.f
	REAL(10) SN_AGE										   |		REAL*8 SN_AGE
 
Comparing files in ./new_main/subs/auto with those in  /home/hillier/wnode04/cmf_testing_real8//new_main/subs/auto
 
./new_main/subs/auto/Makefile
./new_main/subs/auto/add_auto_rates.f
	REAL(10) ARAD(N_F)									   |		REAL*8 ARAD(N_F)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) AUTO(N_F)									   |		REAL*8 AUTO(N_F)
./new_main/subs/auto/rd_auto_v1.f
	REAL(10) AUTO(NLEV)									   |		REAL*8 AUTO(NLEV)
	REAL(10) FEDGE(NLEV)									   |		REAL*8 FEDGE(NLEV)
	REAL(10) STAT_WT(NLEV)									   |		REAL*8 STAT_WT(NLEV)
	REAL(10) G_SUM(NLEV)									   |		REAL*8 G_SUM(NLEV)
	REAL(10) TMP_AUTO									   |		REAL*8 TMP_AUTO
	REAL(10) DEFAULT_AUTO_RATE								   |		REAL*8 DEFAULT_AUTO_RATE
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/auto/steq_auto_v1.f
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) AUTO(N_F)									   |		REAL*8 AUTO(N_F)
./new_main/subs/auto/steq_auto_v2.f
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) DIERECOM(ND)									   |		REAL*8 DIERECOM(ND)
	REAL(10) DIECOOL(ND)									   |		REAL*8 DIECOOL(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) PLNCKS_CONST									   |		REAL*8 PLNCKS_CONST
	REAL(10) AUTO(N_F)									   |		REAL*8 AUTO(N_F)
 
Comparing files in ./new_main/subs/chg with those in  /home/hillier/wnode04/cmf_testing_real8//new_main/subs/chg
 
./new_main/subs/chg/Makefile
./new_main/subs/chg/do_penning_ion.f
	REAL(10) HDKT										   |		REAL*8 HDKT
	REAL(10), PARAMETER :: ALPHA=7.5D-10							   |		REAL*8, PARAMETER :: ALPHA=7.5D-10
	REAL(10), PARAMETER :: CI=2.07078D-22							   |		REAL*8, PARAMETER :: CI=2.07078D-22
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) REV_RATE									   |		REAL*8 REV_RATE
	REAL(10) dREV_RATEdT									   |		REAL*8 dREV_RATEdT
	REAL(10) REV_RATE_COEF									   |		REAL*8 REV_RATE_COEF
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./new_main/subs/chg/eval_chg_rates_v3.f
												   >	! Altered 24-Dec-2024 : Now used call to get Planck's constant.
	REAL(10) CHG_PR(ND)									   |		REAL*8 CHG_PR(ND)
	REAL(10) CHG_RR(ND)									   |		REAL*8 CHG_RR(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), PARAMETER :: H=6.6261965D-27							   |		REAL*8 H
												   >		REAL*8 PLANCKS_CONSTANT
												   >		EXTERNAL PLANCKS_CONSTANT
	REAL(10) ALPHA_REC									   |		REAL*8 ALPHA_REC
	REAL(10) ALPHA_ION									   |		REAL*8 ALPHA_ION
	REAL(10) FRD_R										   |		REAL*8 FRD_R
	REAL(10) REV_R										   |		REAL*8 REV_R
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) TVAL										   |		REAL*8 TVAL
												   >		H=1.0D+15*PLANCKS_CONSTANT()
	          COOL_CHG(J,L)=COOL_CHG(J,L)*(FRD_R-REV_R)*H*1.0D+15				   |		          COOL_CHG(J,L)=COOL_CHG(J,L)*(FRD_R-REV_R)*H
./new_main/subs/chg/rd_chg_exch_v3.f
./new_main/subs/chg/set_chg_exch_v3.f
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) GION		!Statistical weight of ion					   |		REAL*8 GION		!Statistical weight of ion
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) G_CHG_VEC(ND)									   |		REAL*8 G_CHG_VEC(ND)
	REAL(10) dG_CHG_VEC(ND)									   |		REAL*8 dG_CHG_VEC(ND)
	REAL(10) T_VEC(ND)									   |		REAL*8 T_VEC(ND)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/chg/set_chg_exch_v4.f
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) GION		!Statistical weight of ion					   |		REAL*8 GION		!Statistical weight of ion
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) G_CHG_VEC(ND)									   |		REAL*8 G_CHG_VEC(ND)
	REAL(10) dG_CHG_VEC(ND)									   |		REAL*8 dG_CHG_VEC(ND)
	REAL(10) T_VEC(ND)									   |		REAL*8 T_VEC(ND)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/chg/set_chg_lev_id_v3.f
	REAL(10) ZION										   |		REAL*8 ZION
./new_main/subs/chg/set_chg_lev_id_v4.f
	REAL(10), ALLOCATABLE :: G_SUM(:,:)							   |		REAL*8, ALLOCATABLE :: G_SUM(:,:)
	REAL(10),  ALLOCATABLE :: TMP_G(:,:)							   |		REAL*8,  ALLOCATABLE :: TMP_G(:,:)
	REAL(10),  ALLOCATABLE :: TMP_Z(:,:)							   |		REAL*8,  ALLOCATABLE :: TMP_Z(:,:)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/chg/steq_ba_chg_exch_v3.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ALPHA_REC									   |		REAL*8 ALPHA_REC
	REAL(10) ALPHA_ION									   |		REAL*8 ALPHA_ION
	REAL(10) ALPHA_1									   |		REAL*8 ALPHA_1
	REAL(10) ALPHA_2									   |		REAL*8 ALPHA_2
	REAL(10) ALPHA_3									   |		REAL*8 ALPHA_3
	REAL(10) ALPHA_4									   |		REAL*8 ALPHA_4
	REAL(10) dRATEdT									   |		REAL*8 dRATEdT
	REAL(10) dlnALPHA_RECdlnT								   |		REAL*8 dlnALPHA_RECdlnT
	REAL(10) dlnALPHA_IONdlnT								   |		REAL*8 dlnALPHA_IONdlnT
	REAL(10) FRD_R										   |		REAL*8 FRD_R
	REAL(10) REV_R										   |		REAL*8 REV_R
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) TVAL										   |		REAL*8 TVAL
./new_main/subs/chg/verify_chg_exch_v3.f
./new_main/subs/chg/wr_chg_cool_v3.f
	REAL(10) NETCR(ND)	!Accumlated net cooling rate					   |		REAL*8 NETCR(ND)	!Accumlated net cooling rate
	REAL(10) TOTCR(ND)	!Accumulated sum of absoulte cooling rates.			   |		REAL*8 TOTCR(ND)	!Accumulated sum of absoulte cooling rates.
 
Comparing files in ./new_main/subs/two with those in  /home/hillier/wnode04/cmf_testing_real8//new_main/subs/two
 
./new_main/subs/two/Makefile
./new_main/subs/two/get_j_for_two_phot.f
	  REAL(10), ALLOCATABLE :: RJ_START(:)							   |		  REAL*8, ALLOCATABLE :: RJ_START(:)
	  REAL(10), ALLOCATABLE :: RJ_END(:)							   |		  REAL*8, ALLOCATABLE :: RJ_END(:)
	  REAL(10), ALLOCATABLE :: RJ_LOW(:)							   |		  REAL*8, ALLOCATABLE :: RJ_LOW(:)
	  REAL(10), ALLOCATABLE :: RJ_HIGH(:)							   |		  REAL*8, ALLOCATABLE :: RJ_HIGH(:)
	  REAL(10), ALLOCATABLE :: RJ_MID(:)							   |		  REAL*8, ALLOCATABLE :: RJ_MID(:)
	  REAL(10) FL_START									   |		  REAL*8 FL_START
	  REAL(10) FL_END									   |		  REAL*8 FL_END
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FL_LOW,FL_HIGH,FL_MID								   |		REAL*8 FL_LOW,FL_HIGH,FL_MID
./new_main/subs/two/get_two_indx.f
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) NU(NW)										   |		REAL*8 NU(NW)
./new_main/subs/two/set_two_phot_v2.f
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/subs/two/set_two_phot_v3.f
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./new_main/subs/two/steq_ba_two_phot_rate_v3.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) T1										   |		REAL*8 T1
./new_main/subs/two/tst_two.f
./new_main/subs/two/two_phot_opac.f
	REAL(10) ETA(ND)		!Emisivity 						   |		REAL*8 ETA(ND)		!Emisivity 
	REAL(10) CHI(ND)		!Opacity [in (10^10 cm)^-1]				   |		REAL*8 CHI(ND)		!Opacity [in (10^10 cm)^-1]
	REAL(10) POPS(NT,ND)	!Atomic populations						   |		REAL*8 POPS(NT,ND)	!Atomic populations
	REAL(10) T(ND)		!in 10^4 K							   |		REAL*8 T(ND)		!in 10^4 K
	REAL(10) FREQ		!Current frequency (10^15 Hz)					   |		REAL*8 FREQ		!Current frequency (10^15 Hz)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) PLANKS_CONSTANT	!cgs units						   |		REAL*8 PLANKS_CONSTANT	!cgs units
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) CONST										   |		REAL*8 CONST
	REAL(10) ETA_CONST	!Used to evaluate ETA						   |		REAL*8 ETA_CONST	!Used to evaluate ETA
	REAL(10) CHI_CONST	!Used to evaluate CHI						   |		REAL*8 CHI_CONST	!Used to evaluate CHI
	REAL(10) FREQ_B		!Frequency of other photon					   |		REAL*8 FREQ_B		!Frequency of other photon
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
./new_main/subs/two/two_phot_opac_v2.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) ETA(ND)		!Emisivity 						   |		REAL*8 ETA(ND)		!Emisivity 
	REAL(10) CHI(ND)		!Opacity [in (10^10 cm)^-1]				   |		REAL*8 CHI(ND)		!Opacity [in (10^10 cm)^-1]
	REAL(10) POPS(NT,ND)	!Atomic populations						   |		REAL*8 POPS(NT,ND)	!Atomic populations
	REAL(10) T(ND)		!in 10^4 K							   |		REAL*8 T(ND)		!in 10^4 K
	REAL(10) FREQ		!Current frequency (10^15 Hz)					   |		REAL*8 FREQ		!Current frequency (10^15 Hz)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) PLANKS_CONSTANT	!cgs units						   |		REAL*8 PLANKS_CONSTANT	!cgs units
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) CONST										   |		REAL*8 CONST
	REAL(10) ETA_CONST	!Used to evaluate ETA						   |		REAL*8 ETA_CONST	!Used to evaluate ETA
	REAL(10) CHI_CONST	!Used to evaluate CHI						   |		REAL*8 CHI_CONST	!Used to evaluate CHI
	REAL(10) FREQ_B		!Frequency of other photon					   |		REAL*8 FREQ_B		!Frequency of other photon
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
./new_main/subs/two/two_phot_opac_v3.f
												   >	! Altered 24-Sep-2023: Updated to use consistent physical constants (24-Sep-223).
	REAL(10) ETA(ND)		!Emisivity 						   |		REAL*8 ETA(ND)		!Emisivity 
	REAL(10) CHI(ND)		!Opacity [in (10^10 cm)^-1]				   |		REAL*8 CHI(ND)		!Opacity [in (10^10 cm)^-1]
	REAL(10) POPS(NT,ND)	!Atomic populations						   |		REAL*8 POPS(NT,ND)	!Atomic populations
	REAL(10) T(ND)		!in 10^4 K							   |		REAL*8 T(ND)		!in 10^4 K
	REAL(10) FREQ		!Current frequency (10^15 Hz)					   |		REAL*8 FREQ		!Current frequency (10^15 Hz)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) PLANKS_CONSTANT	!cgs units						   |		REAL*8 PI
	REAL(10) PI										   |		REAL*8 CONST
	REAL(10) CONST										   |		REAL*8 ETA_CONST	!Used to evaluate ETA
	REAL(10) ETA_CONST	!Used to evaluate ETA						   |		REAL*8 CHI_CONST	!Used to evaluate CHI
	REAL(10) CHI_CONST	!Used to evaluate CHI						   |		REAL*8 FREQ_B		!Frequency of other photon
	REAL(10) FREQ_B		!Frequency of other photon					   |		REAL*8 T1,T2
	REAL(10) T1,T2										   |		EXTERNAL PLANCKS_CONSTANT
												   >		REAL*8 PLANCKS_CONSTANT	!cgs units
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
	PLANKS_CONSTANT=6.626D-27			!cgs units				   <
	CONST=1.0D+10*PLANKS_CONSTANT/4.0D0/PI							   |		CONST=1.0D+10*PLANCKS_CONSTANT()/4.0D0/PI
./new_main/subs/two/two_phot_rate.f
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) FREQ		!In units of 10^15Hz						   |		REAL*8 FREQ		!In units of 10^15Hz
	REAL(10) FQW		!In Hz								   |		REAL*8 FQW		!In Hz
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) DOWN_CONST									   |		REAL*8 DOWN_CONST
	REAL(10) UP_CONST									   |		REAL*8 UP_CONST
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ALPHA_A		!2 h v^3 / c^2						   |		REAL*8 ALPHA_A		!2 h v^3 / c^2
	REAL(10) FREQ_B		!Frequency of other photon					   |		REAL*8 FREQ_B		!Frequency of other photon
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
./new_main/subs/two/two_phot_var_opac.f
												   >	! Altered 24-Sep-2023: Updated to use consistent physical constants (24-Sep-223).
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) h										   |		REAL*8 h
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) CONST										   |		REAL*8 CONST
	REAL(10) ETA_CONST									   |		REAL*8 ETA_CONST
	REAL(10) CHI_CONST									   |		REAL*8 CHI_CONST
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FREQ_B										   |		REAL*8 FREQ_B
												   >		REAL*8 PLANCKS_CONSTANT
												   >		EXTERNAL PLANCKS_CONSTANT
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
	h=6.626D-27			!cgs units						   |		h=PLANCKS_CONSTANT()			!cgs units
 
Comparing files in ./new_main/subs/non_therm with those in  /home/hillier/wnode04/cmf_testing_real8//new_main/subs/non_therm
 
./new_main/subs/non_therm/Makefile
      $(LIB)(rd_non_therm_elec_spec_v1.o)\							   |	      $(LIB)(rd_non_therm_elec_spec_v2.o)\
./new_main/subs/non_therm/arnaud_cross.f90
	REAL(10) U1										   |		REAL*8 U1
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	        T2=LOG(U1)									   |		        T2=DLOG(U1)
./new_main/subs/non_therm/arnaud_cross_v3.f90
!	REAL(10) XKT(NKT)									   |	!	REAL*8 XKT(NKT)
	REAL(10) U1										   |		REAL*8 U1
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	          T2=LOG(U1)									   |		          T2=DLOG(U1)
	        T1=LOG(XKT(IKT)/THD(IT)%XTAB(J))/LOG(THD(IT)%XTAB(J+1)/THD(IT)%XTAB(J))		   |		        T1=DLOG(XKT(IKT)/THD(IT)%XTAB(J))/DLOG(THD(IT)%XTAB(J+1)/THD(IT)%XTAB(J))
	        THD(IT)%CROSS_SEC(IKT)=EXP( T1*LOG(THD(IT)%YTAB(J+1)) + (1.0D0-T1)*LOG(THD(IT)%Y   |		        THD(IT)%CROSS_SEC(IKT)=EXP( T1*DLOG(THD(IT)%YTAB(J+1)) + (1.0D0-T1)*DLOG(THD(IT)
	      T1=LOG(THD(IT)%YTAB(I)/THD(IT)%YTAB(I-1))/LOG(THD(IT)%XTAB(I)/THD(IT)%XTAB(I-1))	   |		      T1=DLOG(THD(IT)%YTAB(I)/THD(IT)%YTAB(I-1))/DLOG(THD(IT)%XTAB(I)/THD(IT)%XTAB(I-1))
./new_main/subs/non_therm/bethe_approx.f90
	REAL(10) Q(NKT)										   |		REAL*8 Q(NKT)
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT(NKT)									   |		REAL*8 dXKT(NKT)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X										   |		REAL*8 X
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/bethe_approx_v3.f90
	REAL(10) Q(NKT)										   |		REAL*8 Q(NKT)
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT(NKT)									   |		REAL*8 dXKT(NKT)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X										   |		REAL*8 X
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/bethe_approx_v4.f90
	REAL(10) Q(NKT)										   |		REAL*8 Q(NKT)
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT(NKT)									   |		REAL*8 dXKT(NKT)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X										   |		REAL*8 X
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/bethe_approx_v5.f90
	REAL(10) Q(NKT)										   |		REAL*8 Q(NKT)
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT_ON_XKT(NKT)								   |		REAL*8 dXKT_ON_XKT(NKT)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10), PARAMETER :: CONNECT_POINT_SQ=CONNECT_POINT*CONNECT_POINT			   |		REAL*8, PARAMETER :: CONNECT_POINT_SQ=CONNECT_POINT*CONNECT_POINT
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X,XSQ										   |		REAL*8 X,XSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/electron_non_therm_spec.f90
												   >	! Altered 24-Oct-2023 : Now call V2 of RD_NON_THERM_ELEC_SPEC_V2 (7-Sep-2023).
	REAL(10), SAVE, ALLOCATABLE :: LELEC(:)							   |		REAL*8, SAVE, ALLOCATABLE :: LELEC(:)
	REAL(10), SAVE, ALLOCATABLE :: SOURCE(:)						   |		REAL*8, SAVE, ALLOCATABLE :: SOURCE(:)
	REAL(10), SAVE, ALLOCATABLE :: RHS(:)							   |		REAL*8, SAVE, ALLOCATABLE :: RHS(:)
	REAL(10), SAVE, ALLOCATABLE :: DETAI_DE(:)						   |		REAL*8, SAVE, ALLOCATABLE :: DETAI_DE(:)
	REAL(10), SAVE, ALLOCATABLE :: MAT(:,:)							   |		REAL*8, SAVE, ALLOCATABLE :: MAT(:,:)
	REAL(10), SAVE, ALLOCATABLE :: Qnn(:)							   |		REAL*8, SAVE, ALLOCATABLE :: Qnn(:)
	REAL(10), SAVE, ALLOCATABLE :: Qnn_TMP(:)						   |		REAL*8, SAVE, ALLOCATABLE :: Qnn_TMP(:)
	REAL(10), SAVE, ALLOCATABLE :: POP_VEC(:)						   |		REAL*8, SAVE, ALLOCATABLE :: POP_VEC(:)
	REAL(10) ION_SUM(NUM_IONS)								   |		REAL*8 ION_SUM(NUM_IONS)
	REAL(10) SPEC_SUM(NUM_IONS)								   |		REAL*8 SPEC_SUM(NUM_IONS)
	REAL(10) EKT										   |		REAL*8 EKT
	REAL(10) EKTP										   |		REAL*8 EKTP
	REAL(10) EMIN										   |		REAL*8 EMIN
	REAL(10) EMAX										   |		REAL*8 EMAX
	REAL(10) E_INIT										   |		REAL*8 E_INIT
	REAL(10) dE										   |		REAL*8 dE
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) SIG1,SIG2									   |		REAL*8 SIG1,SIG2
	REAL(10) XCROSS										   |		REAL*8 XCROSS
	REAL(10) NA_dX_CROSS									   |		REAL*8 NA_dX_CROSS
	REAL(10) XION_POT									   |		REAL*8 XION_POT
	REAL(10) NATOM										   |		REAL*8 NATOM
	REAL(10) QSUM										   |		REAL*8 QSUM
	REAL(10) SCALER_SPEC_SUM								   |		REAL*8 SCALER_SPEC_SUM
	REAL(10) SCALER_ION_SUM									   |		REAL*8 SCALER_ION_SUM
	REAL(10) dXKT_MIN									   |		REAL*8 dXKT_MIN
	REAL(10) INTSIGC									   |		REAL*8 INTSIGC
	REAL(10) XKT_MIN									   |		REAL*8 XKT_MIN
	REAL(10) XKT_MAX									   |		REAL*8 XKT_MAX
	REAL(10), PARAMETER :: Hz_to_eV=13.60569253D0/3.289841960D0				   |		REAL*8, PARAMETER :: Hz_to_eV=13.60569253D0/3.289841960D0
	REAL(10), PARAMETER :: DELTA_ENR_SOURCE=30.0D0						   |		REAL*8, PARAMETER :: DELTA_ENR_SOURCE=30.0D0
	  CALL RD_NON_THERM_ELEC_SPEC_V1(ND,LU_BETHE)						   |		  CALL RD_NON_THERM_ELEC_SPEC_V2(ND,LU_BETHE,IOS)
	  RETURN										   |		  IF(IOS .EQ. 0)RETURN
./new_main/subs/non_therm/get_lelec.f90
	REAL(10) LELEC(NKT)									   |		REAL*8 LELEC(NKT)
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) N_ELEC										   |		REAL*8 N_ELEC
	REAL(10) T1,T2,XV,XE_CGS								   |		REAL*8 T1,T2,XV,XE_CGS
	REAL(10) XI_E										   |		REAL*8 XI_E
	REAL(10) PLASMA_FREQ									   |		REAL*8 PLASMA_FREQ
	REAL(10) GAMMA_EULER									   |		REAL*8 GAMMA_EULER
	             log( ELECTRON_MASS * xv**3/ gamma_euler / ELECTRON_CHARGE**2 / plasma_freq    |		             dlog( ELECTRON_MASS * xv**3/ gamma_euler / ELECTRON_CHARGE**2 / plasma_freq
	             log(2.0D0 * xe_cgs / xi_e)							   |		             dlog(2.0D0 * xe_cgs / xi_e)
./new_main/subs/non_therm/intsigc.f90
	REAL(10) FUNCTION INTSIGC(ENR,XION_POT,EMIN,EMAX)					   |		REAL*8 FUNCTION INTSIGC(ENR,XION_POT,EMIN,EMAX)
	REAL(10) ENR              ! Energy at which we compute the integral of the cross section   |		REAL*8 ENR              ! Energy at which we compute the integral of the cross section
	REAL(10) XION_POT         ! (first) ionization potential of species under consideration	   |		REAL*8 XION_POT         ! (first) ionization potential of species under consideration
	REAL(10) EMIN,EMAX        ! Bounds of integration					   |		REAL*8 EMIN,EMAX        ! Bounds of integration
	REAL(10) XJ,ONEOVERJ									   |		REAL*8 XJ,ONEOVERJ
	   INTSIGC = (ATAN((EMAX-XION_POT)*ONEOVERJ)-ATAN((EMIN-XION_POT)*ONEOVERJ) ) &		   |		   INTSIGC = (DATAN((EMAX-XION_POT)*ONEOVERJ)-DATAN((EMIN-XION_POT)*ONEOVERJ) ) &
	          / ATAN((ENR-XION_POT)*ONEOVERJ/2.0D0)						   |		          / DATAN((ENR-XION_POT)*ONEOVERJ/2.0D0)
./new_main/subs/non_therm/mod_non_therm.f90
        REAL(10), ALLOCATABLE :: XKT(:)								   |	        REAL*8, ALLOCATABLE :: XKT(:)
        REAL(10), ALLOCATABLE :: dXKT(:)							   |	        REAL*8, ALLOCATABLE :: dXKT(:)
        REAL(10), ALLOCATABLE :: dXKT_ON_XKT(:)							   |	        REAL*8, ALLOCATABLE :: dXKT_ON_XKT(:)
        REAL(10), ALLOCATABLE :: YE(:,:)							   |	        REAL*8, ALLOCATABLE :: YE(:,:)
        REAL(10), ALLOCATABLE ::  FRAC_ELEC_HEATING(:)						   |	        REAL*8, ALLOCATABLE ::  FRAC_ELEC_HEATING(:)
        REAL(10), ALLOCATABLE ::  FRAC_ION_HEATING(:)						   |	        REAL*8, ALLOCATABLE ::  FRAC_ION_HEATING(:)
        REAL(10), ALLOCATABLE ::  FRAC_EXCITE_HEATING(:)					   |	        REAL*8, ALLOCATABLE ::  FRAC_EXCITE_HEATING(:)
	  REAL(10) :: N_ION_EL									   |		  REAL*8 :: N_ION_EL
	  REAL(10) :: ZION									   |		  REAL*8 :: ZION
	  REAL(10) :: PQN									   |		  REAL*8 :: PQN
	  REAL(10) :: ANG									   |		  REAL*8 :: ANG
	  REAL(10) :: ION_POT									   |		  REAL*8 :: ION_POT
	  REAL(10) :: N_ATOM									   |		  REAL*8 :: N_ATOM
	  REAL(10) :: A_COL,B_COL,C_COL, D_COL							   |		  REAL*8 :: A_COL,B_COL,C_COL, D_COL
	  REAL(10), POINTER :: CROSS_SEC(:)							   |		  REAL*8, POINTER :: CROSS_SEC(:)
	  REAL(10), ALLOCATABLE :: XTAB(:)							   |		  REAL*8, ALLOCATABLE :: XTAB(:)
	  REAL(10), ALLOCATABLE :: YTAB(:)							   |		  REAL*8, ALLOCATABLE :: YTAB(:)
./new_main/subs/non_therm/par_vec_sum.f90
	REAL(10) Y(NKT)										   |		REAL*8 Y(NKT)
	REAL(10) X(NKT)										   |		REAL*8 X(NKT)
./new_main/subs/non_therm/rd_non_therm_elec_spec_v1.f90
	REAL(10) LOC_XKT(NKT)									   |		REAL*8 LOC_XKT(NKT)
./new_main/subs/non_therm/rd_nt_crosec_sclfac_v2.f90
./new_main/subs/non_therm/read_arnaud_ion_data.f90
	REAL(10), PARAMETER :: Hz_TO_eV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_eV=4.1356691D0
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./new_main/subs/non_therm/read_nt_omega_data.f90
	REAL(10) T_TABLE(MAX_TVALS)								   |		REAL*8 T_TABLE(MAX_TVALS)
	REAL(10) OMEGA_TABLE(MAX_TAB_SIZE)							   |		REAL*8 OMEGA_TABLE(MAX_TAB_SIZE)
	REAL(10) OMEGA_SET,OMEGA_SCALE								   |		REAL*8 OMEGA_SET,OMEGA_SCALE
./new_main/subs/non_therm/se_ba_non_therm.f90
        REAL(10) dE_RAD_DECAY(ND)								   |	        REAL*8 dE_RAD_DECAY(ND)
	REAL(10) RADIOACTIVE_DECAY_ENERGY_eV(ND)						   |		REAL*8 RADIOACTIVE_DECAY_ENERGY_eV(ND)
	REAL(10) LOCAL_ION_HEATING(ND)								   |		REAL*8 LOCAL_ION_HEATING(ND)
	REAL(10) LOCAL_EXC_HEATING(ND)								   |		REAL*8 LOCAL_EXC_HEATING(ND)
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) ELECTRON_VOLT									   |		REAL*8 ELECTRON_VOLT
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) ION_EXC_EN									   |		REAL*8 ION_EXC_EN
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) GUPPER										   |		REAL*8 GUPPER
	REAL(10), SAVE :: SCALE_FACTOR=1.0D0							   |		REAL*8, SAVE :: SCALE_FACTOR=1.0D0
	REAL(10), PARAMETER :: Hz_to_eV=13.60D0/3.2897D0					   |		REAL*8, PARAMETER :: Hz_to_eV=13.60D0/3.2897D0
./new_main/subs/non_therm/se_ba_non_therm_v2.f90
        REAL(10) dE_RAD_DECAY(ND)								   |	        REAL*8 dE_RAD_DECAY(ND)
	REAL(10) RADIOACTIVE_DECAY_ENERGY_eV(ND)						   |		REAL*8 RADIOACTIVE_DECAY_ENERGY_eV(ND)
	REAL(10) LOCAL_ION_HEATING(ND)								   |		REAL*8 LOCAL_ION_HEATING(ND)
	REAL(10) LOCAL_EXC_HEATING(ND)								   |		REAL*8 LOCAL_EXC_HEATING(ND)
	REAL(10) MOD_YE(NKT,ND)									   |		REAL*8 MOD_YE(NKT,ND)
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) ELECTRON_VOLT									   |		REAL*8 ELECTRON_VOLT
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) ION_EXC_EN									   |		REAL*8 ION_EXC_EN
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) GUPPER										   |		REAL*8 GUPPER
	REAL(10) DEC_NRG_SCL_FAC								   |		REAL*8 DEC_NRG_SCL_FAC
	REAL(10), PARAMETER :: Hz_to_eV=13.60D0/3.2897D0					   |		REAL*8, PARAMETER :: Hz_to_eV=13.60D0/3.2897D0
	REAL(10), PARAMETER :: Hz_to_erg=6.6261965D-12						   |		REAL*8, PARAMETER :: Hz_to_erg=6.6261965D-12
./new_main/subs/non_therm/se_ba_non_therm_v3.f90
        REAL(10) dE_RAD_DECAY(ND)								   |	        REAL*8 dE_RAD_DECAY(ND)
	REAL(10) dE_SHOCK_POWER(ND)								   |		REAL*8 dE_SHOCK_POWER(ND)
	REAL(10) RADIOACTIVE_DECAY_ENERGY_eV(ND)						   |		REAL*8 RADIOACTIVE_DECAY_ENERGY_eV(ND)
	REAL(10) LOCAL_ION_HEATING(ND)								   |		REAL*8 LOCAL_ION_HEATING(ND)
	REAL(10) LOCAL_EXC_HEATING(ND)								   |		REAL*8 LOCAL_EXC_HEATING(ND)
	REAL(10) WRK_EDEP(ND)									   |		REAL*8 WRK_EDEP(ND)
	REAL(10) WRK_EDEP_eV(ND)								   |		REAL*8 WRK_EDEP_eV(ND)
	REAL(10) MOD_YE(NKT,ND)									   |		REAL*8 MOD_YE(NKT,ND)
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) ELECTRON_VOLT									   |		REAL*8 ELECTRON_VOLT
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) ION_EXC_EN									   |		REAL*8 ION_EXC_EN
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) GUPPER										   |		REAL*8 GUPPER
	REAL(10) DEC_NRG_SCL_FAC								   |		REAL*8 DEC_NRG_SCL_FAC
	REAL(10), PARAMETER :: Hz_to_eV=13.60D0/3.2897D0					   |		REAL*8, PARAMETER :: Hz_to_eV=13.60D0/3.2897D0
	REAL(10), PARAMETER :: Hz_to_erg=6.6261965D-12						   |		REAL*8, PARAMETER :: Hz_to_erg=6.6261965D-12
./new_main/subs/non_therm/set_xkt_array.f90
        t1 = log(x11/x0) / dble(n-2)								   |	        t1 = dlog(x11/x0) / dble(n-2)
./new_main/subs/non_therm/total_bethe_rate.f90
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT(NKT)									   |		REAL*8 dXKT(NKT)
	REAL(10) YE(NKT,ND)									   |		REAL*8 YE(NKT,ND)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X										   |		REAL*8 X
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/total_bethe_rate_v2.f90
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT(NKT)									   |		REAL*8 dXKT(NKT)
	REAL(10) YE(NKT,ND)									   |		REAL*8 YE(NKT,ND)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X										   |		REAL*8 X
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/total_bethe_rate_v3.f90
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) dXKT(NKT)									   |		REAL*8 dXKT(NKT)
	REAL(10) YE(NKT,ND)									   |		REAL*8 YE(NKT,ND)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X										   |		REAL*8 X
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/total_bethe_rate_v4.f90
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) XKT(NKT)									   |		REAL*8 XKT(NKT)
	REAL(10) MOD_YE(NKT,ND)									   |		REAL*8 MOD_YE(NKT,ND)
	REAL(10), PARAMETER :: PI=3.141592653589793238462643D0					   |		REAL*8, PARAMETER :: PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm		   |		REAL*8, PARAMETER :: A0 = 0.529189379D-8    		!Bohr radius in cm
	REAL(10), PARAMETER :: Hz_TO_EV=4.1356691D0						   |		REAL*8, PARAMETER :: Hz_TO_EV=4.1356691D0
	REAL(10), PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0			   |		REAL*8, PARAMETER :: COL_CONST=13.6D0*8.0D0*PI*PI*A0*A0/1.732D0
	REAL(10), PARAMETER :: COEF0=-0.0745397d0						   |		REAL*8, PARAMETER :: COEF0=-0.0745397d0
	REAL(10), PARAMETER :: COEF1=0.232715d0							   |		REAL*8, PARAMETER :: COEF1=0.232715d0
	REAL(10), PARAMETER :: COEF2=-0.00647558d0						   |		REAL*8, PARAMETER :: COEF2=-0.00647558d0
	REAL(10), PARAMETER :: CONNECT_POINT=1.2212243D0					   |		REAL*8, PARAMETER :: CONNECT_POINT=1.2212243D0
	REAL(10), PARAMETER :: CONNECT_POINT_SQ=CONNECT_POINT*CONNECT_POINT			   |		REAL*8, PARAMETER :: CONNECT_POINT_SQ=CONNECT_POINT*CONNECT_POINT
	REAL(10) GBAR										   |		REAL*8 GBAR
	REAL(10) X,XSQ										   |		REAL*8 X,XSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dE										   |		REAL*8 dE
	REAL(10) dE_eV										   |		REAL*8 dE_eV
./new_main/subs/non_therm/tst_set.f90
	REAL(10) X0,X1										   |		REAL*8 X0,X1
	REAL(10) X(N)										   |		REAL*8 X(N)
	REAL(10) dX(N)										   |		REAL*8 dX(N)
./new_main/subs/non_therm/write_non_therm_v1.f90
        REAL(10) dE_RAD_DECAY(ND)								   |	        REAL*8 dE_RAD_DECAY(ND)
	REAL(10) RADIOACTIVE_DECAY_ENERGY_eV(ND)						   |		REAL*8 RADIOACTIVE_DECAY_ENERGY_eV(ND)
	REAL(10) MOD_YE(NKT,ND)									   |		REAL*8 MOD_YE(NKT,ND)
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) ELECTRON_VOLT									   |		REAL*8 ELECTRON_VOLT
	REAL(10) RATE										   |		REAL*8 RATE
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) ION_EXC_EN									   |		REAL*8 ION_EXC_EN
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) GUPPER										   |		REAL*8 GUPPER
	REAL(10), ALLOCATABLE :: RATES(:,:,:)							   |		REAL*8, ALLOCATABLE :: RATES(:,:,:)
	REAL(10), ALLOCATABLE :: ION_RATES(:,:,:)						   |		REAL*8, ALLOCATABLE :: ION_RATES(:,:,:)
	REAL(10) DEC_NRG_SCL_FAC								   |		REAL*8 DEC_NRG_SCL_FAC
	REAL(10), PARAMETER :: Hz_to_eV=13.60D0/3.2897D0					   |		REAL*8, PARAMETER :: Hz_to_eV=13.60D0/3.2897D0
	REAL(10), PARAMETER :: Hz_to_erg=6.6261965D-12						   |		REAL*8, PARAMETER :: Hz_to_erg=6.6261965D-12
 
Comparing files in ./newsubs with those in  /home/hillier/wnode04/cmf_testing_real8//newsubs
 
./newsubs/Makefile
./newsubs/ave_level_energy.f
	REAL(10) EDGE(N_F)									   |		REAL*8 EDGE(N_F)
	REAL(10) STAT_WT(N_F)									   |		REAL*8 STAT_WT(N_F)
	REAL(10) AVE_ENERGY(NT)									   |		REAL*8 AVE_ENERGY(NT)
	REAL(10) G_SUM(N_S)									   |		REAL*8 G_SUM(N_S)
	REAL(10) EDGE_SUM(N_S)									   |		REAL*8 EDGE_SUM(N_S)
./newsubs/colcool_sl_v4.f
	REAL(10) COOL(ND),CRR(ND),CPR(ND)							   |		REAL*8 COOL(ND),CRR(ND),CPR(ND)
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) ZION,T(ND),ED(ND)								   |		REAL*8 ZION,T(ND),ED(ND)
C												   |	C
	REAL(10) HN_S(N_S,ND),HNST_S(N_S,ND)							   |		REAL*8 HN_S(N_S,ND),HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
C												   |	C
	REAL(10) HN_F(N_F,ND),HNST_F(N_F,ND)							   |		REAL*8 HN_F(N_F,ND),HNST_F(N_F,ND)	
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F),EDGE_F(N_F),G_F(N_F)						   |		REAL*8 A_F(N_F,N_F),EDGE_F(N_F),G_F(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) H,TMP_ED									   |		REAL*8 H,TMP_ED
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
./newsubs/colcool_sl_v5.f
												   >	! Altered 20-Sec-2023 : Updated to use standard value for Planck's constant.
	EXTERNAL OMEGA_COL									   |		REAL*8 PLANCKS_CONSTANT
												   >		EXTERNAL OMEGA_COL, PLANCKS_CONSTANT
	REAL(10) COOL(ND),CRR(ND),CPR(ND)							   |		REAL*8 COOL(ND),CRR(ND),CPR(ND)
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) ZION,T(ND),ED(ND)								   |		REAL*8 ZION,T(ND),ED(ND)
!												   |	!
	REAL(10) HN_S(N_S,ND),HNST_S(N_S,ND)							   |		REAL*8 HN_S(N_S,ND),HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
!												   |	!
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)	
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F),EDGE_F(N_F),G_F(N_F)						   |		REAL*8 A_F(N_F,N_F),EDGE_F(N_F),G_F(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) H,TMP_ED									   |		REAL*8 H,TMP_ED
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
	H=6.6261965D-12		!H*1.0E+15  (1.0E+15 due to times frequency)			   |		H=PLANCKS_CONSTANT()*1.0D+15             !ergs/s (*1.0E+15 due to *nu)
./newsubs/comp_free_free_v1.f
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) CHI_FF(ND)			!Opacity					   |		REAL*8 CHI_FF(ND)			!Opacity
	REAL(10) ETA_FF(ND)			!Emissivity					   |		REAL*8 ETA_FF(ND)			!Emissivity
	REAL(10) VCHI_FF(NT,ND)			!Opacity					   |		REAL*8 VCHI_FF(NT,ND)			!Opacity
	REAL(10) VETA_FF(NT,ND)			!Emissivity					   |		REAL*8 VETA_FF(NT,ND)			!Emissivity
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) GFF_VAL(ND)		!g(ff) as a function of depth				   |		REAL*8 GFF_VAL(ND)		!g(ff) as a function of depth
	REAL(10) POP_SUM(ND)		!Factor to convert HNST for ION_LEV			   |		REAL*8 POP_SUM(ND)		!Factor to convert HNST for ION_LEV
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) ALPHA,TCHI1,TETA1								   |		REAL*8 ALPHA,TCHI1,TETA1
	REAL(10) EMIS										   |		REAL*8 EMIS
	REAL(10) HNUONKT									   |		REAL*8 HNUONKT
./newsubs/comp_free_free_v2.f
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) CHI_FF(ND)			!Opacity					   |		REAL*8 CHI_FF(ND)			!Opacity
	REAL(10) ETA_FF(ND)			!Emissivity					   |		REAL*8 ETA_FF(ND)			!Emissivity
	REAL(10) VCHI_FF(NT,ND)			!Opacity					   |		REAL*8 VCHI_FF(NT,ND)			!Opacity
	REAL(10) VETA_FF(NT,ND)			!Emissivity					   |		REAL*8 VETA_FF(NT,ND)			!Emissivity
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) GFF_VAL(ND)		!g(ff) as a function of depth				   |		REAL*8 GFF_VAL(ND)		!g(ff) as a function of depth
	REAL(10), ALLOCATABLE, SAVE :: POP_SUM(:,:)						   |		REAL*8, ALLOCATABLE, SAVE :: POP_SUM(:,:)
	REAL(10), ALLOCATABLE, SAVE :: GFF_STORE(:,:)						   |		REAL*8, ALLOCATABLE, SAVE :: GFF_STORE(:,:)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ALPHA,TCHI1,TETA1								   |		REAL*8 ALPHA,TCHI1,TETA1
	REAL(10) EMIS										   |		REAL*8 EMIS
	REAL(10) HNUONKT									   |		REAL*8 HNUONKT
./newsubs/cut_points_v3.f
      REAL(10) NU_SM(NUM_SM),CROSS_SM(NUM_SM)							   |	      REAL*8 NU_SM(NUM_SM),CROSS_SM(NUM_SM)
      REAL(10) CUT_ACCURACY									   |	      REAL*8 CUT_ACCURACY
      REAL(10) NU_CUT(NUM_SM)									   |	      REAL*8 NU_CUT(NUM_SM)
      REAL(10) CROSS_CUT(NUM_SM)								   |	      REAL*8 CROSS_CUT(NUM_SM)
      REAL(10) DERIV(NUM_SM)									   |	      REAL*8 DERIV(NUM_SM)
      REAL(10) DIST(NUM_SM)									   |	      REAL*8 DIST(NUM_SM)
      REAL(10) X,Y,M										   |	      REAL*8 X,Y,M
      REAL(10) COMP_VAL										   |	      REAL*8 COMP_VAL
./newsubs/do_h0_ff.f
	REAL(10), SAVE, ALLOCATABLE :: CROSS(:,:)						   |		REAL*8, SAVE, ALLOCATABLE :: CROSS(:,:)
	REAL(10), SAVE, ALLOCATABLE :: LOG_T_TAB(:)						   |		REAL*8, SAVE, ALLOCATABLE :: LOG_T_TAB(:)
	REAL(10), SAVE, ALLOCATABLE :: LOG_NU_TAB(:)						   |		REAL*8, SAVE, ALLOCATABLE :: LOG_NU_TAB(:)
	REAL(10) LOG_NU										   |		REAL*8 LOG_NU
	REAL(10) LOG_T										   |		REAL*8 LOG_T
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ION_DEN(ND)									   |		REAL*8 ION_DEN(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) TEMP(ND)									   |		REAL*8 TEMP(ND)
	REAL(10) EMHNUKT(ND)									   |		REAL*8 EMHNUKT(ND)
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) FF(ND)										   |		REAL*8 FF(ND)
	REAL(10) ION_DEN(ND)									   |		REAL*8 ION_DEN(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) TEMP(ND)									   |		REAL*8 TEMP(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./newsubs/do_hmi_ff.f
	REAL(10), SAVE, ALLOCATABLE :: CROSS(:,:)						   |		REAL*8, SAVE, ALLOCATABLE :: CROSS(:,:)
	REAL(10), SAVE, ALLOCATABLE :: LOG_T_TAB(:)						   |		REAL*8, SAVE, ALLOCATABLE :: LOG_T_TAB(:)
	REAL(10), SAVE, ALLOCATABLE :: LOG_NU_TAB(:)						   |		REAL*8, SAVE, ALLOCATABLE :: LOG_NU_TAB(:)
	REAL(10) LOG_NU										   |		REAL*8 LOG_NU
	REAL(10) LOG_T										   |		REAL*8 LOG_T
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ION_DEN(ND)									   |		REAL*8 ION_DEN(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) TEMP(ND)									   |		REAL*8 TEMP(ND)
	REAL(10) EMHNUKT(ND)									   |		REAL*8 EMHNUKT(ND)
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) FF(ND)										   |		REAL*8 FF(ND)
	REAL(10) ION_DEN(ND)									   |		REAL*8 ION_DEN(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) TEMP(ND)									   |		REAL*8 TEMP(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./newsubs/ff_res_gaunt.f
	REAL(10) FREQ		!Frequency in units of 10^15 Hz					   |		REAL*8 FREQ		!Frequency in units of 10^15 Hz
	REAL(10) GION		!Ion statistical weight						   |		REAL*8 GION		!Ion statistical weight
	REAL(10) ZION		!Charge on ion.							   |		REAL*8 ZION		!Charge on ion.
	REAL(10) GFF(ND)		!Free-free Gaunt factor					   |		REAL*8 GFF(ND)		!Free-free Gaunt factor
	REAL(10) T(ND)		!Temperature in unitsof 10^4 K					   |		REAL*8 T(ND)		!Temperature in unitsof 10^4 K
	REAL(10) VOIGT										   |		REAL*8 VOIGT
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) DOP_NU										   |		REAL*8 DOP_NU
	REAL(10) A_VOIGT									   |		REAL*8 A_VOIGT
	REAL(10) V_VOIGT									   |		REAL*8 V_VOIGT
	REAL(10) PHI_VOIGT 									   |		REAL*8 PHI_VOIGT 
	REAL(10) CONST										   |		REAL*8 CONST
	REAL(10) T1										   |		REAL*8 T1
./newsubs/genopaeta_v10.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) ETA(ND)			!Emissivity					   |		REAL*8 ETA(ND)			!Emissivity
	REAL(10) HN(N,ND)									   |		REAL*8 HN(N,ND)
	REAL(10) HNST(N,ND)									   |		REAL*8 HNST(N,ND)
	REAL(10) LOG_HNST(N,ND)									   |		REAL*8 LOG_HNST(N,ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) DI(N_DI,ND)									   |		REAL*8 DI(N_DI,ND)
	REAL(10) LOG_DIST(N_DI,ND)								   |		REAL*8 LOG_DIST(N_DI,ND)
	REAL(10) T(ND)			!Temperature (K)					   |		REAL*8 T(ND)			!Temperature (K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) ZION			!Charge on resultiong ion.				   |		REAL*8 ZION			!Charge on resultiong ion.
	REAL(10) GION			!Charge on resultiong ion.				   |		REAL*8 GION			!Charge on resultiong ion.
	REAL(10) GFF_VAL(ND)		!g(ff) as a function of depth				   |		REAL*8 GFF_VAL(ND)		!g(ff) as a function of depth
	REAL(10) COR_FAC(ND)		!Factor to convert HNST for ION_LEV			   |		REAL*8 COR_FAC(ND)		!Factor to convert HNST for ION_LEV
	REAL(10) LOG_COR_FAC(ND)		!Factor to convert HNST for ION_LEV		   |		REAL*8 LOG_COR_FAC(ND)		!Factor to convert HNST for ION_LEV
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N)		!Photionization cross-section
	REAL(10) TMP_CHI(N)		!Photionization cross-section				   |		REAL*8 TMP_CHI(N)		!Photionization cross-section
	REAL(10) TMP_ETA(N)		!Photionization cross-section				   |		REAL*8 TMP_ETA(N)		!Photionization cross-section
	REAL(10) ALPHA,TCHI1,TETA1,TETA2							   |		REAL*8 ALPHA,TCHI1,TETA1,TETA2
	REAL(10) T1,T2,ZION_CUBED,NEFF								   |		REAL*8 T1,T2,ZION_CUBED,NEFF
./newsubs/genopaeta_v7.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) ETA(ND)			!Emissivity					   |		REAL*8 ETA(ND)			!Emissivity
	REAL(10) HN(N,ND),HNST(N,ND)								   |		REAL*8 HN(N,ND),HNST(N,ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) T(ND)			!Temperature (K)					   |		REAL*8 T(ND)			!Temperature (K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) ZION			!Charge on resultiong ion.				   |		REAL*8 ZION			!Charge on resultiong ion.
	REAL(10) GFF_VAL(ND)		!g(ff) as a function of depth				   |		REAL*8 GFF_VAL(ND)		!g(ff) as a function of depth
	REAL(10) COR_FAC(ND)		!Factor to convert HNST for ION_LEV			   |		REAL*8 COR_FAC(ND)		!Factor to convert HNST for ION_LEV
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N)		!Photionization cross-section
	REAL(10) TMP_CHI(N)		!Photionization cross-section				   |		REAL*8 TMP_CHI(N)		!Photionization cross-section
	REAL(10) TMP_ETA(N)		!Photionization cross-section				   |		REAL*8 TMP_ETA(N)		!Photionization cross-section
	REAL(10) ALPHA,TCHI1,TETA1,TETA2							   |		REAL*8 ALPHA,TCHI1,TETA1,TETA2
	REAL(10) T1,T2,ZION_CUBED,NEFF								   |		REAL*8 T1,T2,ZION_CUBED,NEFF
./newsubs/genopaeta_v8.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) ETA(ND)			!Emissivity					   |		REAL*8 ETA(ND)			!Emissivity
	REAL(10) HN(N,ND),HNST(N,ND)								   |		REAL*8 HN(N,ND),HNST(N,ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) T(ND)			!Temperature (K)					   |		REAL*8 T(ND)			!Temperature (K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) ZION			!Charge on resultiong ion.				   |		REAL*8 ZION			!Charge on resultiong ion.
	REAL(10) GION			!Charge on resultiong ion.				   |		REAL*8 GION			!Charge on resultiong ion.
	REAL(10) GFF_VAL(ND)		!g(ff) as a function of depth				   |		REAL*8 GFF_VAL(ND)		!g(ff) as a function of depth
	REAL(10) COR_FAC(ND)		!Factor to convert HNST for ION_LEV			   |		REAL*8 COR_FAC(ND)		!Factor to convert HNST for ION_LEV
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N)		!Photionization cross-section
	REAL(10) TMP_CHI(N)		!Photionization cross-section				   |		REAL*8 TMP_CHI(N)		!Photionization cross-section
	REAL(10) TMP_ETA(N)		!Photionization cross-section				   |		REAL*8 TMP_ETA(N)		!Photionization cross-section
	REAL(10) ALPHA,TCHI1,TETA1,TETA2							   |		REAL*8 ALPHA,TCHI1,TETA1,TETA2
	REAL(10) T1,T2,ZION_CUBED,NEFF								   |		REAL*8 T1,T2,ZION_CUBED,NEFF
./newsubs/genosc_v8.f
	REAL(10) EINA(N,N)		!f(i,j)/A(j,i) values (i < j)				   |		REAL*8 EINA(N,N)		!f(i,j)/A(j,i) values (i < j)
	REAL(10) FEDGE(N)			!Level ionization energy (10^15 Hz)		   |		REAL*8 FEDGE(N)			!Level ionization energy (10^15 Hz)
	REAL(10) STAT_WT(N)		!Statistical weight of level				   |		REAL*8 STAT_WT(N)		!Statistical weight of level
	REAL(10) ARAD(N)			!Inverse radiative lifetime of upper level.	   |		REAL*8 ARAD(N)			!Inverse radiative lifetime of upper level.
	REAL(10) GAM2(N)			!Collisional broadening parameter		   |		REAL*8 GAM2(N)			!Collisional broadening parameter
	REAL(10) GAM4(N)			!Collisional broadening parameter		   |		REAL*8 GAM4(N)			!Collisional broadening parameter
	REAL(10) IONIZATION_EN		!Ionization energy of ion (cm^-1}			   |		REAL*8 IONIZATION_EN		!Ionization energy of ion (cm^-1}
	REAL(10) ZION			!Charge on core (i.e. ion charge +1)			   |		REAL*8 ZION			!Charge on core (i.e. ion charge +1)
	REAL(10)    GF_CUT									   |		REAL*8    GF_CUT
	REAL(10) SPEED_OF_LIGHT,RD_FREE_VAL							   |		REAL*8 SPEED_OF_LIGHT,RD_FREE_VAL
	REAL(10) T1,T2,T3,SPEED_LIGHT								   |		REAL*8 T1,T2,T3,SPEED_LIGHT
	REAL(10) DOWN(N)									   |		REAL*8 DOWN(N)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./newsubs/genosc_v9.f
	REAL(10) EINA(N,N)		!f(i,j)/A(j,i) values (i < j)				   |		REAL*8 EINA(N,N)		!f(i,j)/A(j,i) values (i < j)
	REAL(10) FEDGE(N)			!Level ionization energy (10^15 Hz)		   |		REAL*8 FEDGE(N)			!Level ionization energy (10^15 Hz)
	REAL(10) STAT_WT(N)		!Statistical weight of level				   |		REAL*8 STAT_WT(N)		!Statistical weight of level
	REAL(10) ARAD(N)			!Inverse radiative lifetime of upper level.	   |		REAL*8 ARAD(N)			!Inverse radiative lifetime of upper level.
	REAL(10) GAM2(N)			!Collisional broadening parameter		   |		REAL*8 GAM2(N)			!Collisional broadening parameter
	REAL(10) GAM4(N)			!Collisional broadening parameter		   |		REAL*8 GAM4(N)			!Collisional broadening parameter
	REAL(10) IONIZATION_EN		!Ionization energy of ion (cm^-1}			   |		REAL*8 IONIZATION_EN		!Ionization energy of ion (cm^-1}
	REAL(10) ZION			!Charge on core (i.e. ion charge +1)			   |		REAL*8 ZION			!Charge on core (i.e. ion charge +1)
	REAL(10)    GF_CUT									   |		REAL*8    GF_CUT
	REAL(10) SPEED_OF_LIGHT,RD_FREE_VAL							   |		REAL*8 SPEED_OF_LIGHT,RD_FREE_VAL
	REAL(10) T1,T2,T3,SPEED_LIGHT								   |		REAL*8 T1,T2,T3,SPEED_LIGHT
	REAL(10) DOWN(N)									   |		REAL*8 DOWN(N)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./newsubs/get_scl_xray_fluxes_v1.f
	REAL(10) VSMOOTH									   |		REAL*8 VSMOOTH
	REAL(10) CUR_CONT_FREQ									   |		REAL*8 CUR_CONT_FREQ
	REAL(10) CONT_FREQ(NFREQ)								   |		REAL*8 CONT_FREQ(NFREQ)
	REAL(10) EMISS1										   |		REAL*8 EMISS1
	REAL(10) EMISS2										   |		REAL*8 EMISS2
	REAL(10) PREV_CONT_FREQ									   |		REAL*8 PREV_CONT_FREQ
	REAL(10) NEXT_CONT_FREQ									   |		REAL*8 NEXT_CONT_FREQ
	REAL(10) NU_LF_BIN,NU_HF_BIN								   |		REAL*8 NU_LF_BIN,NU_HF_BIN
	REAL(10) HIGH_F										   |		REAL*8 HIGH_F
	REAL(10) LOW_F										   |		REAL*8 LOW_F
	REAL(10) T1										   |		REAL*8 T1
./newsubs/newpertjd.f
	REAL(10) F2DA(ND,ND),FC(ND,ND),FB(ND,ND),VK(ND,ND)					   |		REAL*8 F2DA(ND,ND),FC(ND,ND),FB(ND,ND),VK(ND,ND)
	REAL(10) WM(ND,ND),AQW(ND,NP)								   |		REAL*8 WM(ND,ND),AQW(ND,NP)
	REAL(10) DTAU(ND),CHI(ND),dCHIdR(ND)							   |		REAL*8 DTAU(ND),CHI(ND),dCHIdR(ND)
	REAL(10) THETA(ND),SOURCE(ND),FA(ND),R(ND),Z(ND),P(NP)					   |		REAL*8 THETA(ND),SOURCE(ND),FA(ND),R(ND),Z(ND),P(NP)
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),ESEC(ND)						   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),ESEC(ND)
	REAL(10) IC,DBB										   |		REAL*8 IC,DBB
	REAL(10) F2DAT(ND,2*ND+1)								   |		REAL*8 F2DAT(ND,2*ND+1)
	REAL(10) IBOUND,TOR,DBC									   |		REAL*8 IBOUND,TOR,DBC
./newsubs/old_comp_free_free_v2.f
./newsubs/omega_gen_v3.f
	REAL(10) OMEGA(NLEV,NLEV),dln_OMEGA_dlnT(NLEV,NLEV)					   |		REAL*8 OMEGA(NLEV,NLEV),dln_OMEGA_dlnT(NLEV,NLEV)
	REAL(10) EIN_A(NLEV,NLEV)		!Einstein A coefficient				   |		REAL*8 EIN_A(NLEV,NLEV)		!Einstein A coefficient
	REAL(10) EDGE(NLEV)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE(NLEV)		!Ionization frequency (10^15 Hz)
	REAL(10) STAT_WT(NLEV)		!Statistical weight.					   |		REAL*8 STAT_WT(NLEV)		!Statistical weight.
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) TEMP	       		!Temperature (10^4 K)					   |		REAL*8 TEMP	       		!Temperature (10^4 K)
	REAL(10), PARAMETER :: THREE=3.0D0							   |		REAL*8, PARAMETER :: THREE=3.0D0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), SAVE :: T_TABLE(MAX_TVALS)							   |		REAL*8, SAVE :: T_TABLE(MAX_TVALS)
	REAL(10), SAVE :: OMEGA_TABLE(MAX_TAB_SIZE)						   |		REAL*8, SAVE :: OMEGA_TABLE(MAX_TAB_SIZE)
	REAL(10), SAVE :: OMEGA_SET,OMEGA_SCALE							   |		REAL*8, SAVE :: OMEGA_SET,OMEGA_SCALE
	REAL(10) EX_E1X,EX_E1X_FUN								   |		REAL*8 EX_E1X,EX_E1X_FUN
	REAL(10) X,FL,G1,G2,GBAR,dln_GBAR_dlnT,PHOT_CONST					   |		REAL*8 X,FL,G1,G2,GBAR,dln_GBAR_dlnT,PHOT_CONST
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), PARAMETER :: ZERO=0.0D0							   |		REAL*8, PARAMETER :: ZERO=0.0D0
	REAL(10), SAVE, ALLOCATABLE :: PHOT_CROSS(:)						   |		REAL*8, SAVE, ALLOCATABLE :: PHOT_CROSS(:)
	  T1=LOG(T_TABLE(L)/T_TABLE(L-1))							   |		  T1=DLOG(T_TABLE(L)/T_TABLE(L-1))
	    ALPHA=LOG(ALPHA)/T1									   |		    ALPHA=DLOG(ALPHA)/T1
./newsubs/phot_data_mod.f
	  REAL(10), POINTER :: NU_NORM(:)		!MAX_CROSS				   |		  REAL*8, POINTER :: NU_NORM(:)		!MAX_CROSS
	  REAL(10), POINTER :: CROSS_A(:)               !MAX_CROSS				   |		  REAL*8, POINTER :: CROSS_A(:)               !MAX_CROSS
          REAL(10), POINTER :: NEF(:,:)                 !NLOC,NS				   |	          REAL*8, POINTER :: NEF(:,:)                 !NLOC,NS
	  REAL(10), POINTER :: EXC_FREQ(:)              !NS					   |		  REAL*8, POINTER :: EXC_FREQ(:)              !NS
	  REAL(10), POINTER :: GION(:)              	!NS					   |		  REAL*8, POINTER :: GION(:)              	!NS
	  REAL(10), POINTER :: LST_CROSS(:,:)		!NLOC,NS				   |		  REAL*8, POINTER :: LST_CROSS(:,:)		!NLOC,NS
	  REAL(10), POINTER :: LST_FREQ(:,:)		!NLOC,NS				   |		  REAL*8, POINTER :: LST_FREQ(:,:)		!NLOC,NS
	  REAL(10), POINTER :: LST_LOC(:,:)		!NLOC,NS				   |		  REAL*8, POINTER :: LST_LOC(:,:)		!NLOC,NS
!												   |	!
	  REAL(10) AT_NO									   |		  REAL*8 AT_NO
	  REAL(10) ZION										   |		  REAL*8 ZION
	  REAL(10) ALPHA_BF									   |		  REAL*8 ALPHA_BF
	  REAL(10), POINTER :: OSC(:)			!NDIE_MAX				   |		  REAL*8, POINTER :: OSC(:)			!NDIE_MAX
	  REAL(10), POINTER :: GAMMA(:)			!NDIE_MAX				   |		  REAL*8, POINTER :: GAMMA(:)			!NDIE_MAX
	  REAL(10), POINTER :: NU_ZERO(:)		!NDIE_MAX				   |		  REAL*8, POINTER :: NU_ZERO(:)		!NDIE_MAX
	  REAL(10), POINTER :: NU_MAX(:)		!NDIE_MAX				   |		  REAL*8, POINTER :: NU_MAX(:)		!NDIE_MAX
	  REAL(10), POINTER :: NU_MIN(:)		!NDIE_MAX				   |		  REAL*8, POINTER :: NU_MIN(:)		!NDIE_MAX
	  REAL(10) VSM_KMS									   |		  REAL*8 VSM_KMS
	  REAL(10), POINTER :: FF_GF(:)								   |		  REAL*8, POINTER :: FF_GF(:)
	  REAL(10), POINTER :: FF_GAMMA(:)							   |		  REAL*8, POINTER :: FF_GAMMA(:)
	  REAL(10), POINTER :: FF_NU_ZERO(:)							   |		  REAL*8, POINTER :: FF_NU_ZERO(:)
	  REAL(10), POINTER :: FF_NU_EXCITE(:)							   |		  REAL*8, POINTER :: FF_NU_EXCITE(:)
	  REAL(10), POINTER :: FF_NU_MAX(:)							   |		  REAL*8, POINTER :: FF_NU_MAX(:)
	  REAL(10), POINTER :: FF_NU_MIN(:)							   |		  REAL*8, POINTER :: FF_NU_MIN(:)
	REAL(10) CONV_FAC									   |		REAL*8 CONV_FAC
	REAL(10) LG10_CONV_FAC									   |		REAL*8 LG10_CONV_FAC
./newsubs/quad_multi_v10.f
	REAL(10) WSE_S(N_S,ND)									   |		REAL*8 WSE_S(N_S,ND)
	REAL(10) dWSE_SdT(N_S,ND)								   |		REAL*8 dWSE_SdT(N_S,ND)
	REAL(10) WCR(N_S,ND)									   |		REAL*8 WCR(N_S,ND)
	REAL(10) dWCRdT(N_S,ND)									   |		REAL*8 dWCRdT(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) EDGE_F(N_F)			!In 10^15 Hz					   |		REAL*8 EDGE_F(N_F)			!In 10^15 Hz
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) YDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 YDIS(ND)		!Constant for computing level dissolution/
	REAL(10) XDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 XDIS(ND)		!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)	!Constant appearing in dissolution formula.			   |		REAL*8 DIS_CONST(N_F)	!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)									   |		REAL*8 ALPHA_VEC(N_F)
												   >		REAL*8 LOCAL_EDGE_F(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H						   |		REAL*8 T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H
												   >		IF(PHOT_ID .EQ. 1)THEN
												   >		    LOCAL_EDGE_F=EDGE_F
												   >		ELSE
												   >		  T1=0.0D0; J=-PHOT_ID
												   >	!	  WRITE(211,*)ID,N_F,PHOT_ID
												   >		  CALL SUB_PHOT_GEN(ID,LOCAL_EDGE_F,T1,EDGE_F,N_F,J,L_TRUE)
												   >	!	  DO J=1,N_F
												   >	!	    WRITE(211,*)J,EDGE_F(J),LOCAL_EDGE_F(J)
												   >	!	  END DO
												   >		END IF
												   >	!
	    IF(NU_CONT .GE. EDGE_F(I_F))THEN							   |		    IF(NU_CONT .GE. LOCAL_EDGE_F(I_F))THEN
	        WCR(I_S,J)=WCR(I_S,J) - EDGE_F(I_F)*T1*HNST_F_ON_S(I_F,J)			   |		        WCR(I_S,J)=WCR(I_S,J) - LOCAL_EDGE_F(I_F)*T1*HNST_F_ON_S(I_F,J)
	        dWCRdT(I_S,J)=dWCRdT(I_S,J) + EDGE_F(I_F)*T2					   |		        dWCRdT(I_S,J)=dWCRdT(I_S,J) + LOCAL_EDGE_F(I_F)*T2
	    IF(NU_CONT .GE. EDGE_F(I_F))THEN							   |		    IF(NU_CONT .GE. LOCAL_EDGE_F(I_F))THEN
	        WCR(I_S,J)=WCR(I_S,J) - EDGE_F(I_F)*T1*HNST_F_ON_S(I_F,J)			   |		        WCR(I_S,J)=WCR(I_S,J) - LOCAL_EDGE_F(I_F)*T1*HNST_F_ON_S(I_F,J)
./newsubs/quad_multi_v7.f
	REAL(10) WSE_S(N_S,ND)									   |		REAL*8 WSE_S(N_S,ND)
	REAL(10) dWSE_SdT(N_S,ND)								   |		REAL*8 dWSE_SdT(N_S,ND)
	REAL(10) WSE_CR_S(N_S,ND)								   |		REAL*8 WSE_CR_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)			!In 10^15 Hz					   |		REAL*8 EDGE_F(N_F)			!In 10^15 Hz
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) YDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 YDIS(ND)		!Constant for computing level dissolution/
	REAL(10) XDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 XDIS(ND)		!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)	!Constant appearing in dissolution formula.			   |		REAL*8 DIS_CONST(N_F)	!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)									   |		REAL*8 ALPHA_VEC(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H						   |		REAL*8 T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H
./newsubs/quad_multi_v8.f
	REAL(10) WSE_S(N_S,ND)									   |		REAL*8 WSE_S(N_S,ND)
	REAL(10) dWSE_SdT(N_S,ND)								   |		REAL*8 dWSE_SdT(N_S,ND)
	REAL(10) WSE_CR_S(N_S,ND)								   |		REAL*8 WSE_CR_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) EDGE_F(N_F)			!In 10^15 Hz					   |		REAL*8 EDGE_F(N_F)			!In 10^15 Hz
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) YDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 YDIS(ND)		!Constant for computing level dissolution/
	REAL(10) XDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 XDIS(ND)		!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)	!Constant appearing in dissolution formula.			   |		REAL*8 DIS_CONST(N_F)	!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)									   |		REAL*8 ALPHA_VEC(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H						   |		REAL*8 T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H
./newsubs/quad_multi_v9.f
	REAL(10) WSE_S(N_S,ND)									   |		REAL*8 WSE_S(N_S,ND)
	REAL(10) dWSE_SdT(N_S,ND)								   |		REAL*8 dWSE_SdT(N_S,ND)
	REAL(10) WSE_CR_S(N_S,ND)								   |		REAL*8 WSE_CR_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) EDGE_F(N_F)			!In 10^15 Hz					   |		REAL*8 EDGE_F(N_F)			!In 10^15 Hz
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) YDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 YDIS(ND)		!Constant for computing level dissolution/
	REAL(10) XDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 XDIS(ND)		!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)	!Constant appearing in dissolution formula.			   |		REAL*8 DIS_CONST(N_F)	!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)									   |		REAL*8 ALPHA_VEC(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H						   |		REAL*8 T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H
./newsubs/rayleigh_scat.f
	REAL(10) AHYD(NHYD,NHYD)		!No longer used					   |		REAL*8 AHYD(NHYD,NHYD)		!No longer used
	REAL(10) HYD(NHYD,ND)									   |		REAL*8 HYD(NHYD,ND)
	REAL(10) EDGE_HYD(NHYD)		!Ground state value used only.				   |		REAL*8 EDGE_HYD(NHYD)		!Ground state value used only.
	REAL(10) RKI(ND)									   |		REAL*8 RKI(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10), SAVE ::  FOSC(20)								   |		REAL*8, SAVE ::  FOSC(20)
	REAL(10) EDGE_FREQ									   |		REAL*8 EDGE_FREQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELF										   |		REAL*8 DELF
./newsubs/rd_hyd_bf_data.f
	  REAL(10) L_ST_U									   |		  REAL*8 L_ST_U
	  REAL(10) L_DEL_U									   |		  REAL*8 L_DEL_U
	  REAL(10),    ALLOCATABLE ::  BF_L_CROSS(:)						   |		  REAL*8,    ALLOCATABLE ::  BF_L_CROSS(:)
	  REAL(10) N_ST_U									   |		  REAL*8 N_ST_U
	  REAL(10) N_DEL_U									   |		  REAL*8 N_DEL_U
	  REAL(10),    ALLOCATABLE ::  BF_N_GAUNT(:)						   |		  REAL*8,    ALLOCATABLE ::  BF_N_GAUNT(:)
./newsubs/rd_mod_density.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) DENSITY(ND)									   |		REAL*8 DENSITY(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./newsubs/rd_phot_die_v1.f
	REAL(10) EDGE(NXzV)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE(NXzV)		!Ionization frequency (10^15 Hz)
	REAL(10) GION_GS			!St. Weight of g.s. of ion (eg CIII).		   |		REAL*8 GION_GS			!St. Weight of g.s. of ion (eg CIII).
	REAL(10) VSMOOTH_KMS									   |		REAL*8 VSMOOTH_KMS
	REAL(10) FUN_PI,SPEED_OF_LIGHT								   |		REAL*8 FUN_PI,SPEED_OF_LIGHT
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10), PARAMETER :: IZERO=0								   |		REAL*8, PARAMETER :: IZERO=0
	REAL(10) EDGEDIE									   |		REAL*8 EDGEDIE
	REAL(10) EINA										   |		REAL*8 EINA
	REAL(10) GUPDIE										   |		REAL*8 GUPDIE
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) IONIZATION_ENERGY								   |		REAL*8 IONIZATION_ENERGY
	REAL(10), ALLOCATABLE :: DIELEV(:)							   |		REAL*8, ALLOCATABLE :: DIELEV(:)
	REAL(10), ALLOCATABLE :: VEC_DP_WRK(:)							   |		REAL*8, ALLOCATABLE :: VEC_DP_WRK(:)
	REAL(10), ALLOCATABLE :: DIE_LEV_G(:)							   |		REAL*8, ALLOCATABLE :: DIE_LEV_G(:)
	REAL(10), ALLOCATABLE :: DIE_LEV_ENERGY(:)						   |		REAL*8, ALLOCATABLE :: DIE_LEV_ENERGY(:)
	REAL(10), ALLOCATABLE :: DIE_LEV_AUTO(:)						   |		REAL*8, ALLOCATABLE :: DIE_LEV_AUTO(:)
	REAL(10) GSUM										   |		REAL*8 GSUM
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DEL_NU,NU_DOP									   |		REAL*8 DEL_NU,NU_DOP
	REAL(10) A10,A20,A30									   |		REAL*8 A10,A20,A30
	REAL(10) A1,A2,A3,M1,M2,M3		!Effective recombination rate.			   |		REAL*8 A1,A2,A3,M1,M2,M3		!Effective recombination rate.
	REAL(10) WIA1,WIA2,WIA3,WIM1,WIM2,WIM3    !(included and missing).			   |		REAL*8 WIA1,WIA2,WIA3,WIM1,WIM2,WIM3    !(included and missing).
./newsubs/rdphot_gen_v1.f
	REAL(10) EDGE(NXzV)									   |		REAL*8 EDGE(NXzV)
	REAL(10) GION_GS									   |		REAL*8 GION_GS
	REAL(10) ZXzV										   |		REAL*8 ZXzV
	REAL(10) AT_NO_DUM									   |		REAL*8 AT_NO_DUM
	REAL(10) EDGEXzSIX_F(NXzSIX_F)								   |		REAL*8 EDGEXzSIX_F(NXzSIX_F)
	REAL(10) GXzSIX_F(NXzSIX_F)								   |		REAL*8 GXzSIX_F(NXzSIX_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) RD_FREE_VAL,SPEED_OF_LIGHT							   |		REAL*8 RD_FREE_VAL,SPEED_OF_LIGHT
	REAL(10) LOC_EXC_FREQ_ION,TOTAL_WT							   |		REAL*8 LOC_EXC_FREQ_ION,TOTAL_WT
	REAL(10) T1,NU_INF									   |		REAL*8 T1,NU_INF
	    IF(T1 .GT. 0)PD(ID)%NEF(I,PHOT_ID)=ZXzV*SQRT(T1)					   |		    IF(T1 .GT. 0)PD(ID)%NEF(I,PHOT_ID)=ZXzV*DSQRT(T1)
./newsubs/rdphot_gen_v2.f
	REAL(10) EDGE(NXzV)									   |		REAL*8 EDGE(NXzV)
	REAL(10) GION_GS									   |		REAL*8 GION_GS
	REAL(10) ZXzV										   |		REAL*8 ZXzV
	REAL(10) AT_NO_DUM									   |		REAL*8 AT_NO_DUM
	REAL(10) SIG_GAU_KMS		!V[FWHM]=2.34 SIG_AU_KMS				   |		REAL*8 SIG_GAU_KMS		!V[FWHM]=2.34 SIG_AU_KMS
	REAL(10) FRAC_SIG_GAU             !Spacing in smoothed cross section			   |		REAL*8 FRAC_SIG_GAU             !Spacing in smoothed cross section
	REAL(10) CUT_ACCURACY		!Accuracy to delete superflous data points		   |		REAL*8 CUT_ACCURACY		!Accuracy to delete superflous data points
	REAL(10) EDGEXzSIX_F(NXzSIX_F)								   |		REAL*8 EDGEXzSIX_F(NXzSIX_F)
	REAL(10) GXzSIX_F(NXzSIX_F)								   |		REAL*8 GXzSIX_F(NXzSIX_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) RD_FREE_VAL,SPEED_OF_LIGHT							   |		REAL*8 RD_FREE_VAL,SPEED_OF_LIGHT
	REAL(10) LOC_EXC_FREQ_ION,TOTAL_WT							   |		REAL*8 LOC_EXC_FREQ_ION,TOTAL_WT
	REAL(10) T1,NU_INF									   |		REAL*8 T1,NU_INF
	REAL(10) SIG_REV_KMS									   |		REAL*8 SIG_REV_KMS
	REAL(10) SIG_SM										   |		REAL*8 SIG_SM
	REAL(10) TMP_NU(N_CROSS_MAX)								   |		REAL*8 TMP_NU(N_CROSS_MAX)
	REAL(10) TMP_CROSS(N_CROSS_MAX)								   |		REAL*8 TMP_CROSS(N_CROSS_MAX)
	    IF(T1 .GT. 0.0D0)PD(ID)%NEF(I,PHOT_ID)=ZXzV*SQRT(T1)				   |		    IF(T1 .GT. 0.0D0)PD(ID)%NEF(I,PHOT_ID)=ZXzV*DSQRT(T1)
./newsubs/rd_rv_file_v2.f
	REAL(10) R(ND)			!Radial grin in 10^10 cm				   |		REAL*8 R(ND)			!Radial grin in 10^10 cm
	REAL(10) V(ND)			!V in km/s						   |		REAL*8 V(ND)			!V in km/s
	REAL(10) SIGMA(ND)		!dlnV/dlnr-1						   |		REAL*8 SIGMA(ND)		!dlnV/dlnr-1
	REAL(10) RMAX			!Maximum radius  (in 10^10 cm)				   |		REAL*8 RMAX			!Maximum radius  (in 10^10 cm)
	REAL(10) RP			!Core radius  (in 10^10 cm)				   |		REAL*8 RP			!Core radius  (in 10^10 cm)
	REAL(10) VINF                     !Terminal velocity					   |		REAL*8 VINF                     !Terminal velocity
	REAL(10) HT(ND-1)									   |		REAL*8 HT(ND-1)	
	REAL(10) VEL(ND-1)									   |		REAL*8 VEL(ND-1)
	REAL(10) dVdR(ND-1)									   |		REAL*8 dVdR(ND-1)
	REAL(10) T1										   |		REAL*8 T1
./newsubs/rd_store_log.f
	REAL(10) VALUE										   |		REAL*8 VALUE
	REAL(10) VALUE1,VALUE2									   |		REAL*8 VALUE1,VALUE2
./newsubs/rd_xray_spec.f
	REAL(10), ALLOCATABLE :: X_NU(:)							   |		REAL*8, ALLOCATABLE :: X_NU(:)
	REAL(10), ALLOCATABLE :: LOG_X_TEMP(:)							   |		REAL*8, ALLOCATABLE :: LOG_X_TEMP(:)
	REAL(10), ALLOCATABLE :: LOG_X_ED(:)							   |		REAL*8, ALLOCATABLE :: LOG_X_ED(:)
	REAL(10), ALLOCATABLE :: XRAY_FLUXES(:,:,:)						   |		REAL*8, ALLOCATABLE :: XRAY_FLUXES(:,:,:)
	REAL(10), ALLOCATABLE :: X_EMISS1(:)							   |		REAL*8, ALLOCATABLE :: X_EMISS1(:)
	REAL(10), ALLOCATABLE :: X_EMISS2(:)							   |		REAL*8, ALLOCATABLE :: X_EMISS2(:)
	REAL(10) BIN_MIN									   |		REAL*8 BIN_MIN
	REAL(10) BIN_SIZE									   |		REAL*8 BIN_SIZE
	REAL(10) LOG_T_MIN									   |		REAL*8 LOG_T_MIN
	REAL(10) DEL_LOG_T									   |		REAL*8 DEL_LOG_T
	REAL(10) LOG_ED_MIN									   |		REAL*8 LOG_ED_MIN
	REAL(10) DEL_LOG_ED									   |		REAL*8 DEL_LOG_ED
	REAL(10) T_SHOCK1_SAV									   |		REAL*8 T_SHOCK1_SAV
	REAL(10) T_SHOCK2_SAV									   |		REAL*8 T_SHOCK2_SAV
	REAL(10) T_SHOCK1		!In units of 10^4 K					   |		REAL*8 T_SHOCK1		!In units of 10^4 K
	REAL(10) T_SHOCK2									   |		REAL*8 T_SHOCK2
	REAL(10), PARAMETER :: EV_TO_HZ=0.241838D0						   |		REAL*8, PARAMETER :: EV_TO_HZ=0.241838D0
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LOG_T_SHOCK1									   |		REAL*8 LOG_T_SHOCK1
	REAL(10) LOG_T_SHOCK2									   |		REAL*8 LOG_T_SHOCK2
	REAL(10) FUN_PI,PI									   |		REAL*8 FUN_PI,PI
./newsubs/set_edge_freq_v3.f
	REAL(10) FREQ(NCF_MAX)									   |		REAL*8 FREQ(NCF_MAX)
	REAL(10) EDGEHI_F(NHI_F)								   |		REAL*8 EDGEHI_F(NHI_F)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), PARAMETER :: ZERO=0.0D0							   |		REAL*8, PARAMETER :: ZERO=0.0D0
	REAL(10) PHOT_CROSS(NHI_F)								   |		REAL*8 PHOT_CROSS(NHI_F)
	REAL(10) EDGE_FREQ(NHI_F)								   |		REAL*8 EDGE_FREQ(NHI_F)
./newsubs/set_edge_freq_v4.f
	REAL(10) EDGEHI_F(NHI_F)								   |		REAL*8 EDGEHI_F(NHI_F)
	REAL(10) EDGE_FREQ(NCF_MAX)								   |		REAL*8 EDGE_FREQ(NCF_MAX)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), PARAMETER :: ZERO=0.0D0							   |		REAL*8, PARAMETER :: ZERO=0.0D0
	REAL(10) PHOT_CROSS(NHI_F)								   |		REAL*8 PHOT_CROSS(NHI_F)
	REAL(10) LOC_EDGE_FREQ(NHI_F)								   |		REAL*8 LOC_EDGE_FREQ(NHI_F)
./newsubs/set_x_freq_v2.f
	REAL(10) MAX_CONT_FREQ		!Units 10^15 Hz						   |		REAL*8 MAX_CONT_FREQ		!Units 10^15 Hz
	REAL(10) FREQ(NCF_MAX)									   |		REAL*8 FREQ(NCF_MAX)
	REAL(10) ZCORE,ZION									   |		REAL*8 ZCORE,ZION
	REAL(10) CONV_FAC									   |		REAL*8 CONV_FAC
./newsubs/steq_multi_v4.f
	REAL(10) BA(2-NST:NT-NST+1,2-NST:NT-NST+1,NUM_BNDS,ND)					   |		REAL*8 BA(2-NST:NT-NST+1,2-NST:NT-NST+1,NUM_BNDS,ND)
	REAL(10) SE(2-NST:NT-NST+1,ND)								   |		REAL*8 SE(2-NST:NT-NST+1,ND)
	REAL(10) BAION(NION,2-NST:NT-NST+1,NUM_BNDS,ND),STEQION(NION,ND)			   |		REAL*8 BAION(NION,2-NST:NT-NST+1,NUM_BNDS,ND),STEQION(NION,ND)
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
C												   |	C
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
C												   |	C
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F)									   |		REAL*8 A_F(N_F,N_F)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) POP(ND)		!Population of species.					   |		REAL*8 POP(ND)		!Population of species.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_VEC_ED(1)									   |		REAL*8 TMP_VEC_ED(1)
	REAL(10) TMP_VEC_COOL(1)								   |		REAL*8 TMP_VEC_COOL(1)
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
./newsubs/subcol_multi_v4.f
C                       Bug FIX: COL_FILE was declared REAL(10), NOW declared			   |	C                       Bug FIX: COL_FILE was declared REAL*8, NOW declared
	REAL(10) OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)					   |		REAL*8 OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)
	REAL(10) COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)						   |		REAL*8 COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)
	REAL(10) HN_S(N_S,ND)		!Population of atom with super levels.			   |		REAL*8 HN_S(N_S,ND)		!Population of atom with super levels.
	REAL(10) HNST_S(N_S,ND)		!LTE pop. of atom with super levels.			   |		REAL*8 HNST_S(N_S,ND)		!LTE pop. of atom with super levels.
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
C												   |	C
	REAL(10) HN_F(N_F,ND)		!Population of FULL atom				   |		REAL*8 HN_F(N_F,ND)		!Population of FULL atom
	REAL(10) HNST_F(N_F,ND)		!LTE population of FULL atom				   |		REAL*8 HNST_F(N_F,ND)		!LTE population of FULL atom
	REAL(10) W_F(N_F,ND)		!Occupation probability					   |		REAL*8 W_F(N_F,ND)		!Occupation probability
	REAL(10) AHYD_F(N_F,N_F)		!Einstein A coefficient				   |		REAL*8 AHYD_F(N_F,N_F)		!Einstein A coefficient
	REAL(10) EDGE_F(N_F)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE_F(N_F)		!Ionization frequency (10^15 Hz)
	REAL(10) GHYD_F(N_F)		!Statistical weight.					   |		REAL*8 GHYD_F(N_F)		!Statistical weight.
	REAL(10) ZION			!Charge on ion (i.e. 1 for H)				   |		REAL*8 ZION			!Charge on ion (i.e. 1 for H)
	REAL(10) T(ND)			!Temperature (10^4 K)					   |		REAL*8 T(ND)			!Temperature (10^4 K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) COOL(ND)			!Net collisional cooling			   |		REAL*8 COOL(ND)			!Net collisional cooling
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X										   |		REAL*8 X
	REAL(10) BRAT										   |		REAL*8 BRAT
	REAL(10) CIJ,CJI,CII									   |		REAL*8 CIJ,CJI,CII
	      WRITE(180,*)I,J,K,HNST_S(L,K),HNST_F(I,K),W_F(I,K); FLUSH(UNIT=180)		   <
!	      WRITE(180,*)I,J,K,COOL(K),EDGE_F(I),CII,HN_S(L,K),HNST_F(I,K); FLUSH(UNIT=180)	   |		      COOL(K)=COOL(K)+EDGE_F(I)*CII*(HN_S(L,K)-HNST_S(L,K))
!	      COOL(K)=COOL(K)+EDGE_F(I)*CII*(HN_S(L,K)-HNST_S(L,K))				   <
!	        COOL(K)=COOL(K)+(HN_S(L,K)*CIJ-HN_S(U,K)*CJI)*					   |		        COOL(K)=COOL(K)+(HN_S(L,K)*CIJ-HN_S(U,K)*CJI)*
!	1                          (EDGE_F(I)-EDGE_F(J))					   |		1                          (EDGE_F(I)-EDGE_F(J))
!	    COOL(K)=COOL(K)+EDGE_F(I)*CII*(HN_S(L,K)-HNST_S(L,K))				   |		    COOL(K)=COOL(K)+EDGE_F(I)*CII*(HN_S(L,K)-HNST_S(L,K))
./newsubs/subcol_multi_v5.f
!                       Bug FIX: COL_FILE was declared REAL(10), NOW declared			   |	!                       Bug FIX: COL_FILE was declared REAL*8, NOW declared
	REAL(10) OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)					   |		REAL*8 OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)
	REAL(10) COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)						   |		REAL*8 COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)
	REAL(10) HN_S(N_S,ND)		!Population of atom with super levels.			   |		REAL*8 HN_S(N_S,ND)		!Population of atom with super levels.
	REAL(10) HNST_S(N_S,ND)		!LTE pop. of atom with super levels.			   |		REAL*8 HNST_S(N_S,ND)		!LTE pop. of atom with super levels.
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
!												   |	!
	REAL(10) HN_F(N_F,ND)		!Population of FULL atom				   |		REAL*8 HN_F(N_F,ND)		!Population of FULL atom
	REAL(10) HNST_F(N_F,ND)		!LTE population of FULL atom				   |		REAL*8 HNST_F(N_F,ND)		!LTE population of FULL atom
	REAL(10) HNST_F_ON_S(N_F,ND)	!LTE population of FULL atom				   |		REAL*8 HNST_F_ON_S(N_F,ND)	!LTE population of FULL atom
	REAL(10) W_F(N_F,ND)		!Occupation probability					   |		REAL*8 W_F(N_F,ND)		!Occupation probability
	REAL(10) AHYD_F(N_F,N_F)		!Einstein A coefficient				   |		REAL*8 AHYD_F(N_F,N_F)		!Einstein A coefficient
	REAL(10) EDGE_F(N_F)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE_F(N_F)		!Ionization frequency (10^15 Hz)
	REAL(10) GHYD_F(N_F)		!Statistical weight.					   |		REAL*8 GHYD_F(N_F)		!Statistical weight.
	REAL(10) ZION			!Charge on ion (i.e. 1 for H)				   |		REAL*8 ZION			!Charge on ion (i.e. 1 for H)
	REAL(10) T(ND)			!Temperature (10^4 K)					   |		REAL*8 T(ND)			!Temperature (10^4 K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) COOL(ND)			!Net collisional cooling			   |		REAL*8 COOL(ND)			!Net collisional cooling
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X										   |		REAL*8 X
	REAL(10) BRAT										   |		REAL*8 BRAT
	REAL(10) CIJ,CJI,CII									   |		REAL*8 CIJ,CJI,CII
./newsubs/subcol_multi_v6.f
!                       Bug FIX: COL_FILE was declared REAL(10), NOW declared			   |	!                       Bug FIX: COL_FILE was declared REAL*8, NOW declared
	REAL(10) OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)					   |		REAL*8 OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)
	REAL(10) COL_F(N_F,N_F),DCOL_F(N_F,N_F)							   |		REAL*8 COL_F(N_F,N_F),DCOL_F(N_F,N_F)
	REAL(10) COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)						   |		REAL*8 COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)
!												   |	!
	REAL(10) HN_S(N_S,ND)		!Population of atom with super levels.			   |		REAL*8 HN_S(N_S,ND)		!Population of atom with super levels.
	REAL(10) HNST_S(N_S,ND)		!LTE pop. of atom with super levels.			   |		REAL*8 HNST_S(N_S,ND)		!LTE pop. of atom with super levels.
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
!												   |	!
	REAL(10) HN_F(N_F,ND)		!Population of FULL atom				   |		REAL*8 HN_F(N_F,ND)		!Population of FULL atom
	REAL(10) HNST_F(N_F,ND)		!LTE population of FULL atom				   |		REAL*8 HNST_F(N_F,ND)		!LTE population of FULL atom
	REAL(10) HNST_F_ON_S(N_F,ND)	!LTE population of FULL atom				   |		REAL*8 HNST_F_ON_S(N_F,ND)	!LTE population of FULL atom
	REAL(10) W_F(N_F,ND)		!Occupation probability					   |		REAL*8 W_F(N_F,ND)		!Occupation probability
	REAL(10) AHYD_F(N_F,N_F)		!Einstein A coefficient				   |		REAL*8 AHYD_F(N_F,N_F)		!Einstein A coefficient
	REAL(10) EDGE_F(N_F)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE_F(N_F)		!Ionization frequency (10^15 Hz)
	REAL(10) GHYD_F(N_F)		!Statistical weight.					   |		REAL*8 GHYD_F(N_F)		!Statistical weight.
	REAL(10) ZION			!Charge on ion (i.e. 1 for H)				   |		REAL*8 ZION			!Charge on ion (i.e. 1 for H)
	REAL(10) T(ND)			!Temperature (10^4 K)					   |		REAL*8 T(ND)			!Temperature (10^4 K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) I_COOL,K_COOL									   |		REAL*8 I_COOL,K_COOL
	REAL(10) COOL(ND)			!Net collisional cooling			   |		REAL*8 COOL(ND)			!Net collisional cooling
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X										   |		REAL*8 X
	REAL(10) BRAT										   |		REAL*8 BRAT
	REAL(10) CIJ,CJI,CII									   |		REAL*8 CIJ,CJI,CII
./newsubs/sub_phot_gen.f
												   >	! Altered 20-Aug-2023 : Error check added for Type 8 cross-section.
	REAL(10) PHOT(NLEVS)		!Cross-section						   |		REAL*8 PHOT(NLEVS)		!Cross-section
	REAL(10) GS_EDGE(NLEVS)		!Energy for ionization to Ground State!			   |		REAL*8 GS_EDGE(NLEVS)		!Energy for ionization to Ground State!
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) VOIGT,HYDCROSSL,XCROSS_V2,GBF							   |		REAL*8 VOIGT,HYDCROSSL,XCROSS_V2,GBF
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) FREQ_VEC(NLEVS)								   |		REAL*8 FREQ_VEC(NLEVS)
	REAL(10) INDX(NLEVS)									   |		REAL*8 INDX(NLEVS)
	REAL(10) U			!Defined as FREQ/EDGE					   |		REAL*8 U			!Defined as FREQ/EDGE
	REAL(10) RU			!Defined as EDGE/FREQ					   |		REAL*8 RU			!Defined as EDGE/FREQ
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) DOP_NU										   |		REAL*8 DOP_NU
	REAL(10) EDGE			!Ionization energy					   |		REAL*8 EDGE			!Ionization energy
	REAL(10) A_VOIGT									   |		REAL*8 A_VOIGT
	REAL(10) V_VOIGT									   |		REAL*8 V_VOIGT
	REAL(10) X										   |		REAL*8 X
	REAL(10) RJ										   |		REAL*8 RJ
	REAL(10) SUM										   |		REAL*8 SUM
	REAL(10), PARAMETER :: EV_TO_HZ=0.241798840766D0					   |		REAL*8, PARAMETER :: EV_TO_HZ=0.241798840766D0
	REAL(10), PARAMETER :: EQUAL_COR_FAC=1.0D0+1.0D-14					   |		REAL*8, PARAMETER :: EQUAL_COR_FAC=1.0D0+1.0D-14
												   >		            IF(N .GT. MAX_N_PQN)THEN
												   >		              WRITE(6,*)'Error in SUB_PHOT_GEN -- invalid N value for cross-section type
												   >		              WRITE(6,*)'Maximum N value is ',MAX_N_PQN
												   >		              WRITE(6,*)'N,LST,LEND=',N,LST,LEND
												   >		              WRITE(6,*)'ID=',ID,'NLEVS=',NLEVS
												   >		              WRITE(6,*)'PHOT_ID=',PHOT_ID,'SET_TO_EDGE=',SET_TO_EDGE
												   >		              WRITE(6,*)'TERM=',TERM,K,PD(ID)%CROSS_TYPE(TERM,K)
												   >		              FLUSH(UNIT=6)
												   >		              STOP
												   >		            END IF
												   >	!
												   >		            IF(LST .GT. MAX_L_PQN .OR. LEND .GT. MAX_L_PQN)THEN
												   >		              WRITE(6,*)'Error in SUB_PHOT_GEN -- invalid L value for cross-section type
												   >		              WRITE(6,*)'Maximum L value is ',MAX_L_PQN
												   >		              WRITE(6,*)'N,LST,LEND=',N,LST,LEND
												   >		              WRITE(6,*)'ID=',ID,'NLEVS=',NLEVS
												   >		              WRITE(6,*)'PHOT_ID=',PHOT_ID,'SET_TO_EDGE=',SET_TO_EDGE
												   >		              WRITE(6,*)'TERM=',TERM,K,PD(ID)%CROSS_TYPE(TERM,K)
												   >		              FLUSH(UNIT=6)
												   >		              STOP
												   >		            END IF
												   >	!
	          X=LOG10(X)									   |		          X=DLOG10(X)
./newsubs/var_op_v6.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)				   |		REAL*8 VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)
	REAL(10) VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)				   |		REAL*8 VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) DI_S(N_DI,ND)									   |		REAL*8 DI_S(N_DI,ND)
	REAL(10) DIST_S(N_DI,ND)								   |		REAL*8 DIST_S(N_DI,ND)
	REAL(10) dlnDIST_S_dlnT(N_DI,ND)							   |		REAL*8 dlnDIST_S_dlnT(N_DI,ND)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) Z			!Charge on ion						   |		REAL*8 Z			!Charge on ion
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperatuure (10^4 K)					   |		REAL*8 T(ND)			!Temperatuure (10^4 K)
	REAL(10) EMHNUKT(ND)		!exp(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!exp(-hv/kT)
	REAL(10) GFF_VAL(ND)		!Used as work vector					   |		REAL*8 GFF_VAL(ND)		!Used as work vector
	REAL(10) DI_RAT(ND)		!Used as work vector					   |		REAL*8 DI_RAT(ND)		!Used as work vector
	REAL(10) DT_TERM(ND)		!Used as work vector					   |		REAL*8 DT_TERM(ND)		!Used as work vector
	REAL(10) HDKT_ON_T(ND)		!Used as work vector					   |		REAL*8 HDKT_ON_T(ND)		!Used as work vector
C												   |	C
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N_F)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N_F)		!Photionization cross-section
	REAL(10) VCHI_ION(N_F)									   |		REAL*8 VCHI_ION(N_F)
	REAL(10) VCHI_T1(N_F)									   |		REAL*8 VCHI_T1(N_F)
	REAL(10) VCHI_T2(N_F)									   |		REAL*8 VCHI_T2(N_F)
	REAL(10) VCHI_TMP(N_F,ND)								   |		REAL*8 VCHI_TMP(N_F,ND)
	REAL(10) SUM_ION									   |		REAL*8 SUM_ION
	REAL(10) SUM_T1										   |		REAL*8 SUM_T1
	REAL(10) SUM_T2										   |		REAL*8 SUM_T2
	REAL(10) NEFF,ZION_CUBED,T1,T2								   |		REAL*8 NEFF,ZION_CUBED,T1,T2
	REAL(10) TCHI1,TCHI2,TETA1,TETA2,TETA3							   |		REAL*8 TCHI1,TCHI2,TETA1,TETA2,TETA3
	REAL(10) HNUONK,ALPHA									   |		REAL*8 HNUONK,ALPHA
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
./newsubs/xcross_v2.f
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) ZCORE										   |		REAL*8 ZCORE
	REAL(10) NUM_ELEC									   |		REAL*8 NUM_ELEC
	REAL(10) CON_FAC									   |		REAL*8 CON_FAC
	REAL(10) NU_EV										   |		REAL*8 NU_EV
	REAL(10) Y										   |		REAL*8 Y
	REAL(10) Q										   |		REAL*8 Q
./newsubs/xray_data_mod.f
	REAL(10) E_THRESH_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)			   |		REAL*8 E_THRESH_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)
	REAL(10) E_0_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)				   |		REAL*8 E_0_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)
	REAL(10) SIG_0_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)				   |		REAL*8 SIG_0_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)
	REAL(10) y_a_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)				   |		REAL*8 y_a_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)
	REAL(10) y_w_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)				   |		REAL*8 y_w_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)
	REAL(10) P_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)				   |		REAL*8 P_X(ATNO_MAX_X,ATNO_MAX_X,PQN_MAX_X,0:ANG_MAX_X)
 
Comparing files in ./obs with those in  /home/hillier/wnode04/cmf_testing_real8//obs
 
./obs/Makefile
./obs/check_cmf_flux_param_consis.f
./obs/cmf_flux_cntrl_var_mod.f
	REAL(10), PARAMETER :: RZERO=0.0D0							   |		REAL*8, PARAMETER :: RZERO=0.0D0
	REAL(10), PARAMETER :: RONE=1.0D0							   |		REAL*8, PARAMETER :: RONE=1.0D0
	REAL(10), PARAMETER :: RTWO=2.0D0							   |		REAL*8, PARAMETER :: RTWO=2.0D0
	REAL(10) MIN_CONT_FREQ            !Minimum continuum frequency.				   |		REAL*8 MIN_CONT_FREQ            !Minimum continuum frequency.
	REAL(10) MAX_CONT_FREQ            !Maximum continuum frequency.				   |		REAL*8 MAX_CONT_FREQ            !Maximum continuum frequency.
	REAL(10) SMALL_FREQ_RAT           !Fractional spacing for small frequencies'		   |		REAL*8 SMALL_FREQ_RAT           !Fractional spacing for small frequencies'
	REAL(10) dFREQ_bf_MAX             !Maximum spacing close to bf edge.			   |		REAL*8 dFREQ_bf_MAX             !Maximum spacing close to bf edge.
	REAL(10) BIG_FREQ_AMP             !Amplification factor					   |		REAL*8 BIG_FREQ_AMP             !Amplification factor
	REAL(10) dV_LEV_DIS               !dV on low side of bound-free edge.			   |		REAL*8 dV_LEV_DIS               !dV on low side of bound-free edge.
	REAL(10) AMP_DIS                  !Amplification factor					   |		REAL*8 AMP_DIS                  !Amplification factor
	REAL(10) MIN_FREQ_LEV_DIS         !Minimum frequency for lev d				   |		REAL*8 MIN_FREQ_LEV_DIS         !Minimum frequency for lev d
	REAL(10) V_DOP			!Variable						   |		REAL*8 V_DOP			!Variable
	REAL(10) MAX_DOP			!Maximum half-width of resonance zone (in Dopple   |		REAL*8 MAX_DOP			!Maximum half-width of resonance zone (in Doppler widths
	REAL(10) FRAC_DOP			!Spacing in resonance zone (in Doppler widths)	   |		REAL*8 FRAC_DOP			!Spacing in resonance zone (in Doppler widths)
	REAL(10) dV_CMF_PROF		!Spacing across cmf profile (in km/s)			   |		REAL*8 dV_CMF_PROF		!Spacing across cmf profile (in km/s)
	REAL(10) dV_CMF_WING		!Spacing across e.s. wings of cmf profile (in km/s)	   |		REAL*8 dV_CMF_WING		!Spacing across e.s. wings of cmf profile (in km/s)
	REAL(10) ES_WING_EXT		!Extent of BLUE e.s. wings from resonance core (in km/s)   |		REAL*8 ES_WING_EXT		!Extent of BLUE e.s. wings from resonance core (in km/s)
	REAL(10) R_CMF_WING_EXT		!Extent of RED e.s. wings from RESONANCE core (in Vinf)	   |		REAL*8 R_CMF_WING_EXT		!Extent of RED e.s. wings from RESONANCE core (in Vinf)
        REAL(10) OBS_PRO_EXT_RAT		!Used to set maximum extent of line profile (in    |	        REAL*8 OBS_PRO_EXT_RAT		!Used to set maximum extent of line profile (in units of
	REAL(10) FRAC_DOP_OBS		!Spacing to apply across intrinsic profile zone (in Dopp   |		REAL*8 FRAC_DOP_OBS		!Spacing to apply across intrinsic profile zone (in Dopp
	REAL(10) dV_OBS_PROF		!Spacing to apply across observed profile (in km/s)	   |		REAL*8 dV_OBS_PROF		!Spacing to apply across observed profile (in km/s)
	REAL(10) dV_OBS_WING		!Spacing to apply across e.s. wings of observed profile(   |		REAL*8 dV_OBS_WING		!Spacing to apply across e.s. wings of observed profile(
	REAL(10) dV_OBS_BIG		!Frequency spacing to apply between lines (in km/s)	   |		REAL*8 dV_OBS_BIG		!Frequency spacing to apply between lines (in km/s)
	REAL(10)    GF_CUT									   |		REAL*8    GF_CUT
	REAL(10) SIG_GAU_KMS		!Sigma of Gaussian used to smooth photoionization data	   |		REAL*8 SIG_GAU_KMS		!Sigma of Gaussian used to smooth photoionization data
	REAL(10) FRAC_SIG_GAU		!Fractional spacing a across smoothing Gauusian (use 0.2   |		REAL*8 FRAC_SIG_GAU		!Fractional spacing a across smoothing Gauusian (use 0.2
	REAL(10) CUT_ACCURACY		!Accuracy to retain data when omitting data points to sa   |		REAL*8 CUT_ACCURACY		!Accuracy to retain data when omitting data points to sa
	REAL(10) VSM_DIE_KMS		!Sigma of Gaussian used for dielectronic lines that are    |		REAL*8 VSM_DIE_KMS		!Sigma of Gaussian used for dielectronic lines that are 
	REAL(10) DELV_CONT									   |		REAL*8 DELV_CONT
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) AMASS_DOP									   |		REAL*8 AMASS_DOP
	REAL(10) DOP_PROF_LIMIT									   |		REAL*8 DOP_PROF_LIMIT
	REAL(10) VOIGT_PROF_LIMIT								   |		REAL*8 VOIGT_PROF_LIMIT
	REAL(10) MAX_PROF_ED									   |		REAL*8 MAX_PROF_ED
	REAL(10) V_PROF_LIMIT									   |		REAL*8 V_PROF_LIMIT
	REAL(10) FLUX_CAL_LAM_BEG								   |		REAL*8 FLUX_CAL_LAM_BEG
	REAL(10) FLUX_CAL_LAM_END								   |		REAL*8 FLUX_CAL_LAM_END
	REAL(10) SOB_EW_LAM_BEG									   |		REAL*8 SOB_EW_LAM_BEG
	REAL(10) SOB_EW_LAM_END									   |		REAL*8 SOB_EW_LAM_END
	REAL(10) VTURB_FIX		!Turbelent velocity used with fixed DOPPLER profile.	   |		REAL*8 VTURB_FIX		!Turbelent velocity used with fixed DOPPLER profile.
	REAL(10) VTURB_MIN		!Minimum turbuleb velocity				   |		REAL*8 VTURB_MIN		!Minimum turbuleb velocity
	REAL(10) VTURB_MAX		!Maximum turbulent velocity (VTURB = VTURB_MIN + (VTURB_   |		REAL*8 VTURB_MAX		!Maximum turbulent velocity (VTURB = VTURB_MIN + (VTURB_
	REAL(10) EW_CUT_OFF									   |		REAL*8 EW_CUT_OFF
	REAL(10) TAU_REF									   |		REAL*8 TAU_REF
	REAL(10) DJDt_RELAX_PARAM								   |		REAL*8 DJDt_RELAX_PARAM
	REAL(10) ACC_EDD_FAC									   |		REAL*8 ACC_EDD_FAC
	REAL(10) REXT_FAC									   |		REAL*8 REXT_FAC
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) DELV_FRAC_FG									   |		REAL*8 DELV_FRAC_FG
	REAL(10) DELV_FRAC_MOM									   |		REAL*8 DELV_FRAC_MOM
	REAL(10) RD_NU_MAX_OBS			!To restrict the range of observer's frame integ   |		REAL*8 RD_NU_MAX_OBS			!To restrict the range of observer's frame integ
	REAL(10) RD_NU_MIN_OBS									   |		REAL*8 RD_NU_MIN_OBS
	REAL(10) OBS_TAU_MAX			!Cut integration off when TAU > OBS_TAU_MAX	   |		REAL*8 OBS_TAU_MAX			!Cut integration off when TAU > OBS_TAU_MAX
	REAL(10) OBS_ES_DTAU			!Maximum grid spacing, in e.s. optical depth, al   |		REAL*8 OBS_ES_DTAU			!Maximum grid spacing, in e.s. optical depth, al
	REAL(10) FILL_FAC_XRAYS_1,T_SHOCK_1,V_SHOCK_1						   |		REAL*8 FILL_FAC_XRAYS_1,T_SHOCK_1,V_SHOCK_1
	REAL(10) FILL_FAC_XRAYS_2,T_SHOCK_2,V_SHOCK_2						   |		REAL*8 FILL_FAC_XRAYS_2,T_SHOCK_2,V_SHOCK_2
	REAL(10) XRAY_EMISS_1,XRAY_EMISS_2							   |		REAL*8 XRAY_EMISS_1,XRAY_EMISS_2
	REAL(10) VSMOOTH_XRAYS									   |		REAL*8 VSMOOTH_XRAYS
	REAL(10) ACC_FREQ_END									   |		REAL*8 ACC_FREQ_END
./obs/cmf_flux_sub_v5.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) DTDR,BNUE,DBB,DDBBDT								   |		REAL*8 DTDR,BNUE,DBB,DDBBDT
	REAL(10) MEAN_ATOMIC_WEIGHT								   |		REAL*8 MEAN_ATOMIC_WEIGHT
	REAL(10) TSTAR,S1,IC,MAXCH								   |		REAL*8 TSTAR,S1,IC,MAXCH
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) FL,FL_OLD									   |		REAL*8 FL,FL_OLD
	REAL(10) FG_COUNT									   |		REAL*8 FG_COUNT
	REAL(10) LAMVACAIR									   |		REAL*8 LAMVACAIR
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) AMASS_ALL(NT)									   |		REAL*8 AMASS_ALL(NT)
	REAL(10), ALLOCATABLE :: EINA(:)							   |		REAL*8, ALLOCATABLE :: EINA(:)
	REAL(10), ALLOCATABLE :: OSCIL(:)							   |		REAL*8, ALLOCATABLE :: OSCIL(:)
	REAL(10), ALLOCATABLE :: GLDGU(:)							   |		REAL*8, ALLOCATABLE :: GLDGU(:)
	REAL(10), ALLOCATABLE :: AMASS_SIM(:)							   |		REAL*8, ALLOCATABLE :: AMASS_SIM(:)
	REAL(10), ALLOCATABLE :: FL_SIM(:)							   |		REAL*8, ALLOCATABLE :: FL_SIM(:)
	REAL(10), ALLOCATABLE :: CHIL_MAT(:,:)							   |		REAL*8, ALLOCATABLE :: CHIL_MAT(:,:)
	REAL(10), ALLOCATABLE :: ETAL_MAT(:,:)							   |		REAL*8, ALLOCATABLE :: ETAL_MAT(:,:)
	REAL(10), ALLOCATABLE :: BB_COR(:,:)							   |		REAL*8, ALLOCATABLE :: BB_COR(:,:)
	REAL(10) OVER_FREQ_DIF									   |		REAL*8 OVER_FREQ_DIF
	REAL(10) EW,ABS_EW									   |		REAL*8 EW,ABS_EW
	REAL(10) CONT_INT									   |		REAL*8 CONT_INT
	REAL(10), ALLOCATABLE :: L_STAR_RATIO(:,:)   !ND,MAX_SIM)				   |		REAL*8, ALLOCATABLE :: L_STAR_RATIO(:,:)   !ND,MAX_SIM)
	REAL(10), ALLOCATABLE :: U_STAR_RATIO(:,:)   !ND,MAX_SIM)				   |		REAL*8, ALLOCATABLE :: U_STAR_RATIO(:,:)   !ND,MAX_SIM)
	REAL(10), ALLOCATABLE :: ETA_CMF_ST(:,:)						   |		REAL*8, ALLOCATABLE :: ETA_CMF_ST(:,:)
	REAL(10), ALLOCATABLE :: CHI_CMF_ST(:,:)						   |		REAL*8, ALLOCATABLE :: CHI_CMF_ST(:,:)
	REAL(10), ALLOCATABLE :: RJ_CMF_ST(:,:)							   |		REAL*8, ALLOCATABLE :: RJ_CMF_ST(:,:)
	REAL(10), ALLOCATABLE :: RAY_CMF_ST(:,:)			!Rayleigh scattering opa   |		REAL*8, ALLOCATABLE :: RAY_CMF_ST(:,:)			!Rayleigh scattering opacity
	REAL(10), ALLOCATABLE :: ION_LINE_FORCE(:,:)						   |		REAL*8, ALLOCATABLE :: ION_LINE_FORCE(:,:)
	REAL(10), ALLOCATABLE :: LINE_PROF_SIM(:,:)   !ND,MAX_SIM)				   |		REAL*8, ALLOCATABLE :: LINE_PROF_SIM(:,:)   !ND,MAX_SIM)
	REAL(10) NU_MAX_OBS									   |		REAL*8 NU_MAX_OBS
	REAL(10) NU_MIN_OBS									   |		REAL*8 NU_MIN_OBS
	REAL(10) CONT_FREQ									   |		REAL*8 CONT_FREQ
	REAL(10) CHI(ND)			!Continuum opacity (all sources)		   |		REAL*8 CHI(ND)			!Continuum opacity (all sources)
	REAL(10) CHI_RAY(ND)									   |		REAL*8 CHI_RAY(ND)
	REAL(10) CHI_SCAT(ND)									   |		REAL*8 CHI_SCAT(ND)
	REAL(10) ETA(ND)			!Continuum emissivity (all sources)		   |		REAL*8 ETA(ND)			!Continuum emissivity (all sources)
	REAL(10) CHIL(ND)			!Line opacity (without prof.)			   |		REAL*8 CHIL(ND)			!Line opacity (without prof.)
	REAL(10) ETAL(ND)			!Line emissivity (without prof.)		   |		REAL*8 ETAL(ND)			!Line emissivity (without prof.)
	REAL(10) ESEC(ND)			!Continuum electron scattering coef.		   |		REAL*8 ESEC(ND)			!Continuum electron scattering coef.
	REAL(10) ZETA(ND)			!Source func. (all except elec. scat.)		   |		REAL*8 ZETA(ND)			!Source func. (all except elec. scat.)
	REAL(10) THETA(ND)		!Elec. scat. source coef.				   |		REAL*8 THETA(ND)		!Elec. scat. source coef.
	REAL(10) SOURCE(ND)		!Complete source function.				   |		REAL*8 SOURCE(ND)		!Complete source function.
	REAL(10) DTAU(NDMAX)		!Optical depth (used in error calcs)			   |		REAL*8 DTAU(NDMAX)		!Optical depth (used in error calcs)
	REAL(10) dCHIdR(NDMAX) 		!Derivative of opacity.					   |		REAL*8 dCHIdR(NDMAX) 		!Derivative of opacity.
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ETA_CONT(ND)									   |		REAL*8 ETA_CONT(ND)
	REAL(10) CHI_SCAT_CLUMP(ND)								   |		REAL*8 CHI_SCAT_CLUMP(ND)
	REAL(10) CHI_RAY_CLUMP(ND)								   |		REAL*8 CHI_RAY_CLUMP(ND)
	REAL(10) CHI_CLUMP(ND)		!==CHI(I)*CLUMP_FAC(I)					   |		REAL*8 CHI_CLUMP(ND)		!==CHI(I)*CLUMP_FAC(I)
	REAL(10) ETA_CLUMP(ND)		!==ETA(I)*CLUMP_FAC(I)					   |		REAL*8 ETA_CLUMP(ND)		!==ETA(I)*CLUMP_FAC(I)
	REAL(10) ESEC_CLUMP(ND)		!==ESEC(I)*CLUMP_FAC(I)					   |		REAL*8 ESEC_CLUMP(ND)		!==ESEC(I)*CLUMP_FAC(I)
	REAL(10) EMHNUKT_CONT(ND)								   |		REAL*8 EMHNUKT_CONT(ND)
	REAL(10) ETA_C_EVAL(ND)									   |		REAL*8 ETA_C_EVAL(ND)
	REAL(10) CHI_C_EVAL(ND)									   |		REAL*8 CHI_C_EVAL(ND)
	REAL(10) Z_POP(NT)		!Ionic charge for each species				   |		REAL*8 Z_POP(NT)		!Ionic charge for each species
	REAL(10) dLOG_NU			!Step in frequency in Log plane			   |		REAL*8 dLOG_NU			!Step in frequency in Log plane
	REAL(10) FEDD_PREV(NDMAX)								   |		REAL*8 FEDD_PREV(NDMAX)
	REAL(10) GEDD_PREV(NDMAX)								   |		REAL*8 GEDD_PREV(NDMAX)
	REAL(10) H_ON_J(NDMAX)									   |		REAL*8 H_ON_J(NDMAX)
	REAL(10) N_ON_J_NODE(NDMAX)								   |		REAL*8 N_ON_J_NODE(NDMAX)
	REAL(10) dlnJdlnR(NDMAX)								   |		REAL*8 dlnJdlnR(NDMAX)
	REAL(10) KMID_ON_J(NDMAX)								   |		REAL*8 KMID_ON_J(NDMAX)
	REAL(10) N_ON_J(NDMAX)									   |		REAL*8 N_ON_J(NDMAX)
	REAL(10) N_ON_J_PREV(NDMAX)								   |		REAL*8 N_ON_J_PREV(NDMAX)
	REAL(10) JNU_PREV(NDMAX)								   |		REAL*8 JNU_PREV(NDMAX)
	REAL(10) RSQHNU_PREV(NDMAX)								   |		REAL*8 RSQHNU_PREV(NDMAX)
	REAL(10) GEDD(NDMAX)									   |		REAL*8 GEDD(NDMAX)
	REAL(10) RSQHNU(NDMAX)									   |		REAL*8 RSQHNU(NDMAX)
	REAL(10) CHI_PREV(ND)									   |		REAL*8 CHI_PREV(ND)
	REAL(10) ETA_PREV(ND)									   |		REAL*8 ETA_PREV(ND)
	REAL(10) HBC_CMF(3),HBC_PREV(3)								   |		REAL*8 HBC_CMF(3),HBC_PREV(3)
	REAL(10) NBC_CMF(3),NBC_PREV(3),INBC_PREV						   |		REAL*8 NBC_CMF(3),NBC_PREV(3),INBC_PREV
	REAL(10) HFLUX_AT_IB,HFLUX_AT_OB							   |		REAL*8 HFLUX_AT_IB,HFLUX_AT_OB
	REAL(10) AQW(ND,NP)		!Angular quad. weights. (indep. of v)			   |		REAL*8 AQW(ND,NP)		!Angular quad. weights. (indep. of v)
	REAL(10) HQW(ND,NP)		!Angular quad. weights. (indep. of v) for flux integrati   |		REAL*8 HQW(ND,NP)		!Angular quad. weights. (indep. of v) for flux integrati
	REAL(10) KQW(ND,NP)		!Angular quad. weights for K integration.		   |		REAL*8 KQW(ND,NP)		!Angular quad. weights for K integration.
	REAL(10) NQW(ND,NP)		!Angular quad. weights. (indep. of v) for N integration.   |		REAL*8 NQW(ND,NP)		!Angular quad. weights. (indep. of v) for N integration.
	REAL(10) HMIDQW(ND,NP)		!Angular quad. weights. (indep. of v)			   |		REAL*8 HMIDQW(ND,NP)		!Angular quad. weights. (indep. of v)
	REAL(10) NMIDQW(ND,NP)		!Angular quad. weights. (indep. of v)			   |		REAL*8 NMIDQW(ND,NP)		!Angular quad. weights. (indep. of v)
	REAL(10) WM(ND,ND)		!Coef. matrix of J & %J vector				   |		REAL*8 WM(ND,ND)		!Coef. matrix of J & %J vector
	REAL(10) FB(ND,ND)		!Coef. of J & %J vects in angular equ.			   |		REAL*8 FB(ND,ND)		!Coef. of J & %J vects in angular equ.
	REAL(10) TA(NDMAX)									   |		REAL*8 TA(NDMAX)
	REAL(10) TB(NDMAX)									   |		REAL*8 TB(NDMAX)
	REAL(10) TC(NDMAX)									   |		REAL*8 TC(NDMAX)
	REAL(10) XM(NDMAX)		!R.H.S. (SOURCE VECTOR)					   |		REAL*8 XM(NDMAX)		!R.H.S. (SOURCE VECTOR)
	REAL(10) TCHI(ND)									   |		REAL*8 TCHI(ND)
	REAL(10) FEDD(NDMAX)									   |		REAL*8 FEDD(NDMAX)
	REAL(10) QEDD(NDMAX)									   |		REAL*8 QEDD(NDMAX)
	REAL(10) FILL_VEC_SQ(ND)								   |		REAL*8 FILL_VEC_SQ(ND)
	REAL(10) XRAY_LUM(ND)									   |		REAL*8 XRAY_LUM(ND)
	REAL(10) GFF,XCROSS_V2									   |		REAL*8 GFF,XCROSS_V2
	REAL(10) COEF(0:3,NDMAX)								   |		REAL*8 COEF(0:3,NDMAX)
	REAL(10) INBC,HBC_J,HBC_S			!Bound. Cond. for JFEAU			   |		REAL*8 INBC,HBC_J,HBC_S			!Bound. Cond. for JFEAU
	REAL(10) REXT(NDMAX),PEXT(NPMAX),VEXT(NDMAX),LANG_COORDEXT(NDMAX)			   |		REAL*8 REXT(NDMAX),PEXT(NPMAX),VEXT(NDMAX),LANG_COORDEXT(NDMAX)
	REAL(10) TEXT(NDMAX),SIGMAEXT(NDMAX)							   |		REAL*8 TEXT(NDMAX),SIGMAEXT(NDMAX)
	REAL(10) CHIEXT(NDMAX),ESECEXT(NDMAX),ETAEXT(NDMAX)					   |		REAL*8 CHIEXT(NDMAX),ESECEXT(NDMAX),ETAEXT(NDMAX)
	REAL(10) CHI_RAY_EXT(NDMAX),CHI_SCAT_EXT(NDMAX)						   |		REAL*8 CHI_RAY_EXT(NDMAX),CHI_SCAT_EXT(NDMAX)
	REAL(10) ZETAEXT(NDMAX),THETAEXT(NDMAX)							   |		REAL*8 ZETAEXT(NDMAX),THETAEXT(NDMAX)
	REAL(10) RJEXT(NDMAX),RJEXT_ES(NDMAX)							   |		REAL*8 RJEXT(NDMAX),RJEXT_ES(NDMAX)
	REAL(10) FOLD(NDMAX),FEXT(NDMAX),QEXT(NDMAX),SOURCEEXT(NDMAX)				   |		REAL*8 FOLD(NDMAX),FEXT(NDMAX),QEXT(NDMAX),SOURCEEXT(NDMAX)
	REAL(10) VDOP_VEC_EXT(NDMAX)								   |		REAL*8 VDOP_VEC_EXT(NDMAX)
	REAL(10) F2DAEXT(NDMAX,NDMAX)     !These arrays don't need to be			   |		REAL*8 F2DAEXT(NDMAX,NDMAX)     !These arrays don't need to be
	REAL(10), ALLOCATABLE :: AQWEXT(:,:)	!Angular quad. weights. (indep. of v)		   |		REAL*8, ALLOCATABLE :: AQWEXT(:,:)	!Angular quad. weights. (indep. of v)
	REAL(10), ALLOCATABLE :: HQWEXT(:,:)	!Angular quad. weights for flux integration.	   |		REAL*8, ALLOCATABLE :: HQWEXT(:,:)	!Angular quad. weights for flux integration.
	REAL(10), ALLOCATABLE :: KQWEXT(:,:)	!Angular quad. weights for K integration.	   |		REAL*8, ALLOCATABLE :: KQWEXT(:,:)	!Angular quad. weights for K integration.
	REAL(10), ALLOCATABLE :: NQWEXT(:,:)	!Angular quad. weights for N integration.	   |		REAL*8, ALLOCATABLE :: NQWEXT(:,:)	!Angular quad. weights for N integration.
	REAL(10), ALLOCATABLE :: HMIDQWEXT(:,:)	!Angular quad. weights for flux integration.	   |		REAL*8, ALLOCATABLE :: HMIDQWEXT(:,:)	!Angular quad. weights for flux integration.
	REAL(10), ALLOCATABLE :: NMIDQWEXT(:,:)	!Angular quad. weights for flux integration.	   |		REAL*8, ALLOCATABLE :: NMIDQWEXT(:,:)	!Angular quad. weights for flux integration.
	REAL(10) FLUXMEAN(ND) 		!Flux mean opacity					   |		REAL*8 FLUXMEAN(ND) 		!Flux mean opacity
	REAL(10) LINE_FLUXMEAN(ND) 	!Flux mean opacity due to lines.			   |		REAL*8 LINE_FLUXMEAN(ND) 	!Flux mean opacity due to lines.
	REAL(10) ROSSMEAN(ND)  		!Rosseland mean opacity					   |		REAL*8 ROSSMEAN(ND)  		!Rosseland mean opacity
	REAL(10) PLANCKMEAN(ND)  	!Planck mean opacity					   |		REAL*8 PLANCKMEAN(ND)  	!Planck mean opacity
	REAL(10) INT_dBdT(ND)  		!Integral of dB/dT over nu (to calculate ROSSMEAN)	   |		REAL*8 INT_dBdT(ND)  		!Integral of dB/dT over nu (to calculate ROSSMEAN)
	REAL(10) FORCE_MULT(ND)									   |		REAL*8 FORCE_MULT(ND)
	REAL(10) NU_FORCE									   |		REAL*8 NU_FORCE
	REAL(10) NU_FORCE_FAC									   |		REAL*8 NU_FORCE_FAC
	REAL(10) Z(NDMAX)			!Z displacement along a given array		   |		REAL*8 Z(NDMAX)			!Z displacement along a given array
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) RLUMST(ND)		!Luminosity as a function of depth			   |		REAL*8 RLUMST(ND)		!Luminosity as a function of depth
	REAL(10) J_INT(ND)		!Frequency integrated J					   |		REAL*8 J_INT(ND)		!Frequency integrated J
	REAL(10) K_INT(ND)		!Frequency integrated K					   |		REAL*8 K_INT(ND)		!Frequency integrated K
	REAL(10) K_MOM(ND)		!Frequency dependent K moment				   |		REAL*8 K_MOM(ND)		!Frequency dependent K moment
	REAL(10) SOB(ND)   	    	!Used in computing continuum flux			   |		REAL*8 SOB(ND)   	    	!Used in computing continuum flux
	REAL(10) RJ(ND)			!Mean intensity						   |		REAL*8 RJ(ND)			!Mean intensity
	REAL(10) RJ_ES(ND)		!Convolution of RJ with e.s. R(v'v')			   |		REAL*8 RJ_ES(ND)		!Convolution of RJ with e.s. R(v'v')
	REAL(10) VAL_DO_NG									   |		REAL*8 VAL_DO_NG
	REAL(10) RP										   |		REAL*8 RP
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) VTURB_VEC(ND)									   |		REAL*8 VTURB_VEC(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10)  NU_STORE(NST_CMF)								   |		REAL*8  NU_STORE(NST_CMF)
	REAL(10) V_AT_RMAX		!Used if we extend the atmosphere.			   |		REAL*8 V_AT_RMAX		!Used if we extend the atmosphere.
	REAL(10) RMAX_OBS									   |		REAL*8 RMAX_OBS
	REAL(10) H_OUT,H_IN									   |		REAL*8 H_OUT,H_IN
	REAL(10), ALLOCATABLE :: IPLUS_STORE(:,:)						   |		REAL*8, ALLOCATABLE :: IPLUS_STORE(:,:)
	REAL(10), ALLOCATABLE :: P_OBS(:)							   |		REAL*8, ALLOCATABLE :: P_OBS(:)
	REAL(10), ALLOCATABLE :: IPLUS(:)							   |		REAL*8, ALLOCATABLE :: IPLUS(:)
	REAL(10), ALLOCATABLE :: MU_AT_RMAX(:)							   |		REAL*8, ALLOCATABLE :: MU_AT_RMAX(:)
	REAL(10), ALLOCATABLE :: dMU_AT_RMAX(:)							   |		REAL*8, ALLOCATABLE :: dMU_AT_RMAX(:)
	REAL(10), ALLOCATABLE :: HQW_AT_RMAX(:)							   |		REAL*8, ALLOCATABLE :: HQW_AT_RMAX(:)
	REAL(10) TAU_EDGE(N_TAU_EDGE)								   |		REAL*8 TAU_EDGE(N_TAU_EDGE)
	N_FORCE=LOG(NU(NCF)/NU(1))/LOG(1.0D0-500.0D0/C_KMS)					   |		N_FORCE=DLOG(NU(NCF)/NU(1))/DLOG(1.0D0-500.0D0/C_KMS)
	N_FORCE=LOG(NU(NCF)/NU(1))/LOG(1.0D0- 500.0D0/C_KMS)					   |		N_FORCE=DLOG(NU(NCF)/NU(1))/DLOG(1.0D0- 500.0D0/C_KMS)
./obs/cmf_flux_v5.f
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./obs/comp_ew_abs_ew.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JCONT(ND)									   |		REAL*8 JCONT(ND)
	REAL(10) JQW(ND,NP)									   |		REAL*8 JQW(ND,NP)
	REAL(10) HQW(ND,NP)									   |		REAL*8 HQW(ND,NP)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,AMASS,FL								   |		REAL*8 DBB,IC,AMASS,FL
	REAL(10) EW		!Returned: in Angstroms						   |		REAL*8 EW		!Returned: in Angstroms
	REAL(10) ABS_EW   	!Returned: in Anstroms						   |		REAL*8 ABS_EW   	!Returned: in Anstroms
	REAL(10) FLUX_EW		!Anstroms						   |		REAL*8 FLUX_EW		!Anstroms
	REAL(10) EW_CUT		!EW only roughly computed (no ES iteration).			   |		REAL*8 EW_CUT		!EW only roughly computed (no ES iteration).
	REAL(10) CONT_INT		!Returned: in Jy.					   |		REAL*8 CONT_INT		!Returned: in Jy.
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)
	REAL(10) TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)					   |		REAL*8 TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)
	REAL(10) GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)					   |		REAL*8 GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)
	REAL(10) HCONT(ND)									   |		REAL*8 HCONT(ND)
	REAL(10) CVCONT(ND)									   |		REAL*8 CVCONT(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) AVM1(ND),CVM1(ND)								   |		REAL*8 AVM1(ND),CVM1(ND)
	REAL(10) WM(ND,ND),FB(ND,ND)								   |		REAL*8 WM(ND,ND),FB(ND,ND)
!												   |	!
	REAL(10) OLD_JCONT(ND)									   |		REAL*8 OLD_JCONT(ND)
	REAL(10) JNU(ND,NLF)									   |		REAL*8 JNU(ND,NLF)
	REAL(10) HNU(NLF)									   |		REAL*8 HNU(NLF)
	REAL(10) OLD_JNU(ND,NLF)								   |		REAL*8 OLD_JNU(ND,NLF)
	REAL(10) FLUX_PROF(NLF)									   |		REAL*8 FLUX_PROF(NLF)
	REAL(10) OLD_ABS_EW									   |		REAL*8 OLD_ABS_EW
	REAL(10) OLDCHI,T1									   |		REAL*8 OLDCHI,T1
	REAL(10) DBC,TOR,IBOUND,WERF_EXP							   |		REAL*8 DBC,TOR,IBOUND,WERF_EXP
	REAL(10), PARAMETER :: EW_ACC=0.005            !i.e., 0.5%				   |		REAL*8, PARAMETER :: EW_ACC=0.005            !i.e., 0.5%
	        DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)				   |		        DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)
	        DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		        DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
	      DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)				   |		      DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)
./obs/form_ew.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JBAR(ND),ZNET(ND)								   |		REAL*8 JBAR(ND),ZNET(ND)
	REAL(10) JCONT(ND),JBLANK(ND),HBLANK(ND),JINT(ND)					   |		REAL*8 JCONT(ND),JBLANK(ND),HBLANK(ND),JINT(ND)
	REAL(10) LAMLINE(ND),dZdCHIL(ND),dZdETAL(ND)						   |		REAL*8 LAMLINE(ND),dZdCHIL(ND),dZdETAL(ND)
	REAL(10) JQW(ND,NP),HQW(ND,NP)								   |		REAL*8 JQW(ND,NP),HQW(ND,NP)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,AMASS,FL,EW,ABS_EW,CONT_INT						   |		REAL*8 DBB,IC,AMASS,FL,EW,ABS_EW,CONT_INT
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)
	REAL(10) TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)					   |		REAL*8 TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)
	REAL(10) GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)					   |		REAL*8 GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)
	REAL(10) JEX_SCAT(ND),BAR_WTS(ND),DEPTH_PRO(ND)						   |		REAL*8 JEX_SCAT(ND),BAR_WTS(ND),DEPTH_PRO(ND)
	REAL(10) NEW_JCONT(ND),HCONT(ND),JINT_PREV(ND),HINT(ND)					   |		REAL*8 NEW_JCONT(ND),HCONT(ND),JINT_PREV(ND),HINT(ND)
	REAL(10) AVCONT(ND),CVCONT(ND),dCHIdR(ND)						   |		REAL*8 AVCONT(ND),CVCONT(ND),dCHIdR(ND)
	REAL(10) AVM1(ND),CVM1(ND),dJBARdKI(ND),DIAG(ND)					   |		REAL*8 AVM1(ND),CVM1(ND),dJBARdKI(ND),DIAG(ND)
	REAL(10) VSRCE(ND),dUdS(ND),dVdS_UP(ND),dVdS_LOW(ND),dJINTdS(ND)			   |		REAL*8 VSRCE(ND),dUdS(ND),dVdS_UP(ND),dVdS_LOW(ND),dJINTdS(ND)
	REAL(10) VKI(ND),RKB(ND),dUdKI(ND),dVdKI_UP(ND),dVdKI_LOW(ND)				   |		REAL*8 VKI(ND),RKB(ND),dUdKI(ND),dVdKI_UP(ND),dVdKI_LOW(ND)
	REAL(10) OLDCHI,T1,T2,DBC,DNU,TOR,IBOUND,WERF_EXP,SCALE					   |		REAL*8 OLDCHI,T1,T2,DBC,DNU,TOR,IBOUND,WERF_EXP,SCALE
	      DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		      DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
	      DBC=DBB*DNU*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)				   |		      DBC=DBB*DNU*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/CHI(ND)
./obs/ins_line_obs_v4.f
	REAL(10) FREQ(NFREQ_MAX)			!New observers frequencies		   |		REAL*8 FREQ(NFREQ_MAX)			!New observers frequencies
	REAL(10) NU_LINE(N_LINES)		!Line frequencies				   |		REAL*8 NU_LINE(N_LINES)		!Line frequencies
	REAL(10) NU_STRT_LINE(N_LINES)	!Frequencies of start of res. zone.			   |		REAL*8 NU_STRT_LINE(N_LINES)	!Frequencies of start of res. zone.
	REAL(10) VEC_VMIN_VDOP(N_LINES)	!Minium Doppler velocity in km/s.			   |		REAL*8 VEC_VMIN_VDOP(N_LINES)	!Minium Doppler velocity in km/s.
	REAL(10) VINF		!Terminal velocity of wind.					   |		REAL*8 VINF		!Terminal velocity of wind.
	REAL(10) dV_OBS_PROF									   |		REAL*8 dV_OBS_PROF
	REAL(10) dV_OBS_WING									   |		REAL*8 dV_OBS_WING
	REAL(10) dV_OBS_BIG									   |		REAL*8 dV_OBS_BIG
	REAL(10) NU_MIN										   |		REAL*8 NU_MIN
	REAL(10) NU_MAX										   |		REAL*8 NU_MAX
	REAL(10) OBS_PRO_EXT_RAT								   |		REAL*8 OBS_PRO_EXT_RAT
	REAL(10) ES_WING_EXT									   |		REAL*8 ES_WING_EXT
	REAL(10) V_DOP										   |		REAL*8 V_DOP
	REAL(10) FRAC_DOP_OBS									   |		REAL*8 FRAC_DOP_OBS
	REAL(10) MAX_B_EXTENT		!Maximum blueward extent of line profile		   |		REAL*8 MAX_B_EXTENT		!Maximum blueward extent of line profile
	REAL(10) MAX_R_EXTENT		!Maximum  redward extent of line profile		   |		REAL*8 MAX_R_EXTENT		!Maximum  redward extent of line profile
	REAL(10) MAX_BW_EXTENT		!Maximum blueward extent of e.s. wings			   |		REAL*8 MAX_BW_EXTENT		!Maximum blueward extent of e.s. wings
	REAL(10) MAX_RW_EXTENT		!Maximum  redward extent of e.s. wings			   |		REAL*8 MAX_RW_EXTENT		!Maximum  redward extent of e.s. wings
!												   |	!
	REAL(10) PROF_SPACING									   |		REAL*8 PROF_SPACING
	REAL(10) WING_SPACING									   |		REAL*8 WING_SPACING
	REAL(10) BIG_SPACING									   |		REAL*8 BIG_SPACING
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) NU_END_LINE									   |		REAL*8 NU_END_LINE
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./obs/ins_line_v5.f
	REAL(10) FREQ(NFREQ_MAX)			!Continuum frequencies			   |		REAL*8 FREQ(NFREQ_MAX)			!Continuum frequencies
	REAL(10) NU_CONT(NCF)		!Continuum frequencies					   |		REAL*8 NU_CONT(NCF)		!Continuum frequencies
	REAL(10) NU_LINE(N_LINES)		!Line frequencies				   |		REAL*8 NU_LINE(N_LINES)		!Line frequencies
	REAL(10) NU_STRT_LINE(N_LINES)	!Start frequency of resoance zone.			   |		REAL*8 NU_STRT_LINE(N_LINES)	!Start frequency of resoance zone.
	REAL(10) VEC_MIN_VDOP(N_LINES)	!Minimum doppler velocity for line.			   |		REAL*8 VEC_MIN_VDOP(N_LINES)	!Minimum doppler velocity for line.
	REAL(10) VINF		!Terminal velocity of wind.					   |		REAL*8 VINF		!Terminal velocity of wind.
	REAL(10) FRAC_DOP		!Indicates dNU across line in Doppler widths.		   |		REAL*8 FRAC_DOP		!Indicates dNU across line in Doppler widths.
	REAL(10) dV_CMF_PROF	!Indicate spacing in profile but outside			   |		REAL*8 dV_CMF_PROF	!Indicate spacing in profile but outside
	REAL(10) dV_CMF_WING	!Indicate spacing in wings (i.e. outside 			   |		REAL*8 dV_CMF_WING	!Indicate spacing in wings (i.e. outside 
	REAL(10) ES_WING_EXT									   |		REAL*8 ES_WING_EXT
	REAL(10) R_CMF_WING_EXT									   |		REAL*8 R_CMF_WING_EXT
	REAL(10) NU_END_LINE(N_LINES)								   |		REAL*8 NU_END_LINE(N_LINES)
	REAL(10) dNU_on_NU	!Actual spacing used across intrinsic line 			   |		REAL*8 dNU_on_NU	!Actual spacing used across intrinsic line 
	REAL(10) ES_BLUE_WING_EXT		!In km/s					   |		REAL*8 ES_BLUE_WING_EXT		!In km/s
	REAL(10) ES_RED_WING_EXT								   |		REAL*8 ES_RED_WING_EXT
	REAL(10) CUR_RED_PROF_EXT		!10^15 Hz					   |		REAL*8 CUR_RED_PROF_EXT		!10^15 Hz
	REAL(10) EDGE_SEP_FAC									   |		REAL*8 EDGE_SEP_FAC
	REAL(10) MIN_FREQ_RAT									   |		REAL*8 MIN_FREQ_RAT
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) dNU_NEXT									   |		REAL*8 dNU_NEXT
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./obs/mod_cmf_obs.f
	REAL(10) AT_MASS(NUM_SPECIES)		!Atomic mass in amu				   |		REAL*8 AT_MASS(NUM_SPECIES)		!Atomic mass in amu
	REAL(10) AT_NO(NUM_SPECIES)		!Atomic number of species			   |		REAL*8 AT_NO(NUM_SPECIES)		!Atomic number of species
	REAL(10) AT_ABUND(NUM_SPECIES)		!Fractional species abundance			   |		REAL*8 AT_ABUND(NUM_SPECIES)		!Fractional species abundance
	REAL(10) ABUND_SCALE_FAC(NUM_SPECIES)	!To scale species abundance			   |		REAL*8 ABUND_SCALE_FAC(NUM_SPECIES)	!To scale species abundance
	REAL(10) SOL_MASS_FRAC(NUM_SPECIES)	!Solar mass fraction				   |		REAL*8 SOL_MASS_FRAC(NUM_SPECIES)	!Solar mass fraction
	REAL(10) SOL_ABUND_HSCL(NUM_SPECIES)	!Solar abundance with H=12.0			   |		REAL*8 SOL_ABUND_HSCL(NUM_SPECIES)	!Solar abundance with H=12.0
	REAL(10), ALLOCATABLE :: POP_SPECIES(:,:)						   |		REAL*8, ALLOCATABLE :: POP_SPECIES(:,:)
	  REAL(10), ALLOCATABLE :: XzV_F(:,:)		!Level populations in FULL atom		   |		  REAL*8, ALLOCATABLE :: XzV_F(:,:)		!Level populations in FULL atom
	  REAL(10), ALLOCATABLE :: XzVLTE_F(:,:)		!LTE level populations in FULL a   |		  REAL*8, ALLOCATABLE :: XzVLTE_F(:,:)		!LTE level populations in FULL atom
	  REAL(10), ALLOCATABLE :: LOG_XzVLTE_F(:,:)      !Log(LTE level populations in FULL ato   |		  REAL*8, ALLOCATABLE :: LOG_XzVLTE_F(:,:)      !Log(LTE level populations in FULL atom)
	  REAL(10), ALLOCATABLE :: XzVLTE_F_ON_S(:,:)     !Log(LTE level populations in FULL ato   |		  REAL*8, ALLOCATABLE :: XzVLTE_F_ON_S(:,:)     !Log(LTE level populations in FULL atom
	  REAL(10), ALLOCATABLE :: W_XzV_F(:,:)		!Level dissolution factors		   |		  REAL*8, ALLOCATABLE :: W_XzV_F(:,:)		!Level dissolution factors
	  REAL(10), ALLOCATABLE :: DXzV_F(:)		!Ion population for full atom		   |		  REAL*8, ALLOCATABLE :: DXzV_F(:)		!Ion population for full atom
	  REAL(10), ALLOCATABLE :: AXzV_F(:,:)		!Oscillator strength (A(I,j), i<j)	   |		  REAL*8, ALLOCATABLE :: AXzV_F(:,:)		!Oscillator strength (A(I,j), i<j)
	  REAL(10), ALLOCATABLE :: EDGEXzV_F(:)		!Ionization energy to g.s. (10^15 Hz)	   |		  REAL*8, ALLOCATABLE :: EDGEXzV_F(:)		!Ionization energy to g.s. (10^15 Hz)
	  REAL(10), ALLOCATABLE :: GXzV_F(:)		!Level statistical weights in full atom	   |		  REAL*8, ALLOCATABLE :: GXzV_F(:)		!Level statistical weights in full atom
	  REAL(10), ALLOCATABLE :: ARAD(:)		!Inverse radiative lifetime of level	   |		  REAL*8, ALLOCATABLE :: ARAD(:)		!Inverse radiative lifetime of level
	  REAL(10), ALLOCATABLE :: C4(:)  		!Collisional profile parameter.		   |		  REAL*8, ALLOCATABLE :: C4(:)  		!Collisional profile parameter.
	  REAL(10), ALLOCATABLE :: C6(:)	 		!Collisional profile parameter.	   |		  REAL*8, ALLOCATABLE :: C6(:)	 		!Collisional profile parameter.
!												   |	!
	  REAL(10), ALLOCATABLE :: DXzV(:)		!Ion population for super level		   |		  REAL*8, ALLOCATABLE :: DXzV(:)		!Ion population for super level
	  REAL(10), ALLOCATABLE :: XzV(:,:)		!Level population in SL atom		   |		  REAL*8, ALLOCATABLE :: XzV(:,:)		!Level population in SL atom
	  REAL(10), ALLOCATABLE :: XzVLTE(:,:)		!LTE populations in SL atom		   |		  REAL*8, ALLOCATABLE :: XzVLTE(:,:)		!LTE populations in SL atom
	  REAL(10), ALLOCATABLE :: LOG_XzVLTE(:,:)        !LOG(LTE populations in SL at		   |		  REAL*8, ALLOCATABLE :: LOG_XzVLTE(:,:)        !LOG(LTE populations in SL at
	  REAL(10), ALLOCATABLE :: dlnXzVLTE_dlnT(:,:)						   |		  REAL*8, ALLOCATABLE :: dlnXzVLTE_dlnT(:,:)
	  REAL(10) ZXzV			!Charge on ion (=1 for HI)				   |		  REAL*8 ZXzV			!Charge on ion (=1 for HI)
	  REAL(10) GIONXzV_F		!Statistical weight of ion				   |		  REAL*8 GIONXzV_F		!Statistical weight of ion
	REAL(10), ALLOCATABLE :: R(:)		!Radius in units of 10^10 cm			   |		REAL*8, ALLOCATABLE :: R(:)		!Radius in units of 10^10 cm
	REAL(10), ALLOCATABLE :: V(:)		!V in units of km/s				   |		REAL*8, ALLOCATABLE :: V(:)		!V in units of km/s
	REAL(10), ALLOCATABLE :: SIGMA(:)		!dlnV/dlnR-1				   |		REAL*8, ALLOCATABLE :: SIGMA(:)		!dlnV/dlnR-1
	REAL(10), ALLOCATABLE :: T(:)		!Temperature in units of 10^4 K			   |		REAL*8, ALLOCATABLE :: T(:)		!Temperature in units of 10^4 K
	REAL(10), ALLOCATABLE :: ED(:)		!Electron density (#/cm^3)			   |		REAL*8, ALLOCATABLE :: ED(:)		!Electron density (#/cm^3)
	REAL(10), ALLOCATABLE :: LANG_COORD(:)	!Langrangian coordinate				   |		REAL*8, ALLOCATABLE :: LANG_COORD(:)	!Langrangian coordinate
!												   |	!
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)	!Rosseland mean opacity.			   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)	!Rosseland mean opacity.
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)	!Flux mean opacity				   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)	!Flux mean opacity
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)	!Flux mean opacity				   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)	!Flux mean opacity
	REAL(10), ALLOCATABLE :: POP_ATOM(:)	!Total atom density (#/cm^3)			   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)	!Total atom density (#/cm^3)
	REAL(10), ALLOCATABLE :: DENSITY(:)	!Mass density (gm/cm^3)				   |		REAL*8, ALLOCATABLE :: DENSITY(:)	!Mass density (gm/cm^3)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)	!Volume filling factor for clumps		   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)	!Volume filling factor for clumps
	REAL(10), ALLOCATABLE :: POPION(:)	!Ion density					   |		REAL*8, ALLOCATABLE :: POPION(:)	!Ion density
	REAL(10), ALLOCATABLE :: CMFGEN_TGREY(:)	!Computed by CMFGEN (named consistently    |		REAL*8, ALLOCATABLE :: CMFGEN_TGREY(:)	!Computed by CMFGEN (named consistently with DIS
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)	!Computed by CMFGEN			   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)	!Computed by CMFGEN
!												   |	!
	REAL(10) STARS_MASS			!In Msun					   |		REAL*8 STARS_MASS			!In Msun
	REAL(10) STARS_LUM			!In Lsun					   |		REAL*8 STARS_LUM			!In Lsun
	REAL(10) PRESSURE_VTURB			!In km/s					   |		REAL*8 PRESSURE_VTURB			!In km/s
./obs/mod_freq_obs.f
	REAL(10) FQW(NCF_MAX)			!Frequency weights				   |		REAL*8 FQW(NCF_MAX)			!Frequency weights
        REAL(10) NU(NCF_MAX)              	!Continuum and line frequencies			   |	        REAL*8 NU(NCF_MAX)              	!Continuum and line frequencies
        REAL(10) NU_EVAL_CONT(NCF_MAX)    	!Frequencies to evaluate continuum		   |	        REAL*8 NU_EVAL_CONT(NCF_MAX)    	!Frequencies to evaluate continuum
        REAL(10) OBS(NCF_MAX)             	!Observers spectrum				   |	        REAL*8 OBS(NCF_MAX)             	!Observers spectrum
        REAL(10) OBS_FREQ(NCF_MAX)                !Since N_OBS < NCF =< NCF_MAX			   |	        REAL*8 OBS_FREQ(NCF_MAX)                !Since N_OBS < NCF =< NCF_MAX
        REAL(10) OBS_FLUX(NCF_MAX)								   |	        REAL*8 OBS_FLUX(NCF_MAX)
        REAL(10), ALLOCATABLE :: VEC_FREQ(:)							   |	        REAL*8, ALLOCATABLE :: VEC_FREQ(:)
        REAL(10), ALLOCATABLE :: VEC_STRT_FREQ(:)						   |	        REAL*8, ALLOCATABLE :: VEC_STRT_FREQ(:)
        REAL(10), ALLOCATABLE :: VEC_OSCIL(:)							   |	        REAL*8, ALLOCATABLE :: VEC_OSCIL(:)
        REAL(10), ALLOCATABLE :: VEC_EINA(:)							   |	        REAL*8, ALLOCATABLE :: VEC_EINA(:)
        REAL(10), ALLOCATABLE :: VEC_ARAD(:)							   |	        REAL*8, ALLOCATABLE :: VEC_ARAD(:)
        REAL(10), ALLOCATABLE :: VEC_C4(:)							   |	        REAL*8, ALLOCATABLE :: VEC_C4(:)
        REAL(10), ALLOCATABLE :: VEC_DP_WRK(:)							   |	        REAL*8, ALLOCATABLE :: VEC_DP_WRK(:)
        REAL(10), ALLOCATABLE :: VEC_VDOP_MIN(:)						   |	        REAL*8, ALLOCATABLE :: VEC_VDOP_MIN(:)
./obs/obs_frame.f
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: TGREY(:)							   |		REAL*8, ALLOCATABLE :: TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: VTURB(:)							   |		REAL*8, ALLOCATABLE :: VTURB(:)
	REAL(10), ALLOCATABLE :: MAX_DEL_V_RES_ZONE(:)						   |		REAL*8, ALLOCATABLE :: MAX_DEL_V_RES_ZONE(:)
	REAL(10), ALLOCATABLE :: P(:)								   |		REAL*8, ALLOCATABLE :: P(:)
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
	REAL(10), ALLOCATABLE :: HQW_AT_RMAX(:)							   |		REAL*8, ALLOCATABLE :: HQW_AT_RMAX(:)
C												   |	C
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10), ALLOCATABLE :: FREQ_CMF(:)							   |		REAL*8, ALLOCATABLE :: FREQ_CMF(:)
	REAL(10), ALLOCATABLE :: CHI_CMF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_CMF(:,:)
	REAL(10), ALLOCATABLE :: ETA_CMF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_CMF(:,:)
	REAL(10), ALLOCATABLE :: NEW_RJ_CMF(:,:)						   |		REAL*8, ALLOCATABLE :: NEW_RJ_CMF(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: FREQ_RJ(:)							   |		REAL*8, ALLOCATABLE :: FREQ_RJ(:)
	REAL(10), ALLOCATABLE :: RJ_CMF(:,:)							   |		REAL*8, ALLOCATABLE :: RJ_CMF(:,:)
	REAL(10), ALLOCATABLE :: RJ_VEC(:)							   |		REAL*8, ALLOCATABLE :: RJ_VEC(:)
	REAL(10), ALLOCATABLE :: NEW_RJ_VEC(:)							   |		REAL*8, ALLOCATABLE :: NEW_RJ_VEC(:)
	REAL(10), ALLOCATABLE :: OBS_FREQ(:)							   |		REAL*8, ALLOCATABLE :: OBS_FREQ(:)
	REAL(10), ALLOCATABLE :: OBS_FLUX(:)							   |		REAL*8, ALLOCATABLE :: OBS_FLUX(:)
	REAL(10) SPEED_OF_LIGHT,C_KMS								   |		REAL*8 SPEED_OF_LIGHT,C_KMS
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) FRAC_DOP									   |		REAL*8 FRAC_DOP
	REAL(10) DEL_V_OBS									   |		REAL*8 DEL_V_OBS
	REAL(10) VTURB_MIN									   |		REAL*8 VTURB_MIN
	REAL(10) VTURB_MAX									   |		REAL*8 VTURB_MAX
	REAL(10) MIN_FREQ									   |		REAL*8 MIN_FREQ
	REAL(10) MAX_FREQ									   |		REAL*8 MAX_FREQ
	REAL(10) MIN_WAVE									   |		REAL*8 MIN_WAVE
	REAL(10) MAX_WAVE									   |		REAL*8 MAX_WAVE
	REAL(10) T1										   |		REAL*8 T1
	NOS=LOG(MAX_FREQ/MIN_FREQ)/LOG(1.0D0+DEL_V_OBS/C_KMS)-1					   |		NOS=DLOG(MAX_FREQ/MIN_FREQ)/DLOG(1.0D0+DEL_V_OBS/C_KMS)-1
./obs/obs_frame_sub_v2.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_sub_v3.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  IP_OBS(:,:)							   |		REAL*8, ALLOCATABLE ::  IP_OBS(:,:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_sub_v4.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  IP_OBS(:,:)							   |		REAL*8, ALLOCATABLE ::  IP_OBS(:,:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_sub_v5.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  IP_OBS(:,:)							   |		REAL*8, ALLOCATABLE ::  IP_OBS(:,:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  GAM_RAY(:)							   |		REAL*8, ALLOCATABLE ::  GAM_RAY(:)
	REAL(10), ALLOCATABLE ::  NU_ON_NU0_RAY(:)						   |		REAL*8, ALLOCATABLE ::  NU_ON_NU0_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_sub_v6.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) MU_AT_RMAX(NP)									   |		REAL*8 MU_AT_RMAX(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  IP_OBS(:,:)							   |		REAL*8, ALLOCATABLE ::  IP_OBS(:,:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  GAM_RAY(:)							   |		REAL*8, ALLOCATABLE ::  GAM_RAY(:)
	REAL(10), ALLOCATABLE ::  NU_ON_NU0_RAY(:)						   |		REAL*8, ALLOCATABLE ::  NU_ON_NU0_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_sub_v7.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) MU_AT_RMAX(NP)									   |		REAL*8 MU_AT_RMAX(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  IP_OBS(:,:)							   |		REAL*8, ALLOCATABLE ::  IP_OBS(:,:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  GAM_RAY(:)							   |		REAL*8, ALLOCATABLE ::  GAM_RAY(:)
	REAL(10), ALLOCATABLE ::  NU_ON_NU0_RAY(:)						   |		REAL*8, ALLOCATABLE ::  NU_ON_NU0_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_sub_v8.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) MU_AT_RMAX(NP)									   |		REAL*8 MU_AT_RMAX(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  IP_OBS(:,:)							   |		REAL*8, ALLOCATABLE ::  IP_OBS(:,:)
        REAL(10) TAU_REF									   |	        REAL*8 TAU_REF
        REAL(10), ALLOCATABLE ::  RTAU(:,:)							   |	        REAL*8, ALLOCATABLE ::  RTAU(:,:)
        REAL(10), ALLOCATABLE ::  ZTAU(:,:)							   |	        REAL*8, ALLOCATABLE ::  ZTAU(:,:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  GAM_RAY(:)							   |		REAL*8, ALLOCATABLE ::  GAM_RAY(:)
	REAL(10), ALLOCATABLE ::  NU_ON_NU0_RAY(:)						   |		REAL*8, ALLOCATABLE ::  NU_ON_NU0_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_sub_v9.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) CHI_CMF(ND,NCF)								   |		REAL*8 CHI_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
!												   |	!
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) MU_AT_RMAX(NP)									   |		REAL*8 MU_AT_RMAX(NP)
	REAL(10) HQW_AT_RMAX(NP)								   |		REAL*8 HQW_AT_RMAX(NP)
	REAL(10) OBS_FREQ(NOS)									   |		REAL*8 OBS_FREQ(NOS)
	REAL(10) OBS_FLUX(NOS)									   |		REAL*8 OBS_FLUX(NOS)
	REAL(10) MAX_DEL_V_RES_ZONE(ND)								   |		REAL*8 MAX_DEL_V_RES_ZONE(ND)
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) VMU(ND)		!Velocity*(Z/R) on R grid.				   |		REAL*8 VMU(ND)		!Velocity*(Z/R) on R grid.
	REAL(10) Z(ND)		!Distance along ray on R grid.					   |		REAL*8 Z(ND)		!Distance along ray on R grid.
	REAL(10) ESEC(ND)		!Electron scattering opacity				   |		REAL*8 ESEC(ND)		!Electron scattering opacity
	REAL(10) TAU_ES(ND)	!Rough TAU_ES along ray						   |		REAL*8 TAU_ES(ND)	!Rough TAU_ES along ray
	REAL(10) DTAU_ES(ND)	!Rough DTAU_ES along ray					   |		REAL*8 DTAU_ES(ND)	!Rough DTAU_ES along ray
	REAL(10), ALLOCATABLE ::  ETA_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  ETA_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  CHI_CMF_RAY(:,:)						   |		REAL*8, ALLOCATABLE ::  CHI_CMF_RAY(:,:)
	REAL(10), ALLOCATABLE ::  SM_FREQ_CMF(:)						   |		REAL*8, ALLOCATABLE ::  SM_FREQ_CMF(:)
	REAL(10), ALLOCATABLE ::  IP_OBS(:,:)							   |		REAL*8, ALLOCATABLE ::  IP_OBS(:,:)
        REAL(10) TAU_REF									   |	        REAL*8 TAU_REF
        REAL(10), ALLOCATABLE ::  RTAU(:,:)							   |	        REAL*8, ALLOCATABLE ::  RTAU(:,:)
        REAL(10), ALLOCATABLE ::  ZTAU(:,:)							   |	        REAL*8, ALLOCATABLE ::  ZTAU(:,:)
        REAL(10), ALLOCATABLE ::  dI_R(:,:)							   |	        REAL*8, ALLOCATABLE ::  dI_R(:,:)
	REAL(10), ALLOCATABLE ::  ETA_VEC(:)							   |		REAL*8, ALLOCATABLE ::  ETA_VEC(:)
	REAL(10), ALLOCATABLE ::  CHI_VEC(:)							   |		REAL*8, ALLOCATABLE ::  CHI_VEC(:)
	REAL(10), ALLOCATABLE ::  R_RAY(:)							   |		REAL*8, ALLOCATABLE ::  R_RAY(:)
	REAL(10), ALLOCATABLE ::  V_RAY(:)							   |		REAL*8, ALLOCATABLE ::  V_RAY(:)
	REAL(10), ALLOCATABLE ::  VMU_RAY(:)							   |		REAL*8, ALLOCATABLE ::  VMU_RAY(:)
	REAL(10), ALLOCATABLE ::  GAM_RAY(:)							   |		REAL*8, ALLOCATABLE ::  GAM_RAY(:)
	REAL(10), ALLOCATABLE ::  NU_ON_NU0_RAY(:)						   |		REAL*8, ALLOCATABLE ::  NU_ON_NU0_RAY(:)
	REAL(10), ALLOCATABLE ::  Z_RAY(:)							   |		REAL*8, ALLOCATABLE ::  Z_RAY(:)
	REAL(10), ALLOCATABLE ::  TAU(:)							   |		REAL*8, ALLOCATABLE ::  TAU(:)
	REAL(10), ALLOCATABLE ::  dZ(:)								   |		REAL*8, ALLOCATABLE ::  dZ(:)
	REAL(10), ALLOCATABLE ::  HALF_DZ(:)							   |		REAL*8, ALLOCATABLE ::  HALF_DZ(:)
	REAL(10), ALLOCATABLE ::  DZSQ_ON_12(:)							   |		REAL*8, ALLOCATABLE ::  DZSQ_ON_12(:)
	REAL(10), ALLOCATABLE ::  RECIP_DEL_Z(:)						   |		REAL*8, ALLOCATABLE ::  RECIP_DEL_Z(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  A0(:)								   |		REAL*8, ALLOCATABLE ::  A0(:)
	REAL(10), ALLOCATABLE ::  A1(:)								   |		REAL*8, ALLOCATABLE ::  A1(:)
	REAL(10), ALLOCATABLE ::  A2(:)								   |		REAL*8, ALLOCATABLE ::  A2(:)
	REAL(10), ALLOCATABLE ::  A3(:)								   |		REAL*8, ALLOCATABLE ::  A3(:)
	REAL(10), ALLOCATABLE ::  A4(:)								   |		REAL*8, ALLOCATABLE ::  A4(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  EE(:)								   |		REAL*8, ALLOCATABLE ::  EE(:)
	REAL(10), ALLOCATABLE ::  E0(:)								   |		REAL*8, ALLOCATABLE ::  E0(:)
	REAL(10), ALLOCATABLE ::  E1(:)								   |		REAL*8, ALLOCATABLE ::  E1(:)
	REAL(10), ALLOCATABLE ::  E2(:)								   |		REAL*8, ALLOCATABLE ::  E2(:)
	REAL(10), ALLOCATABLE ::  E3(:)								   |		REAL*8, ALLOCATABLE ::  E3(:)
!												   |	!
	REAL(10), ALLOCATABLE ::  DTAU(:)							   |		REAL*8, ALLOCATABLE ::  DTAU(:)
	REAL(10), ALLOCATABLE ::  S(:)								   |		REAL*8, ALLOCATABLE ::  S(:)
	REAL(10), ALLOCATABLE ::  dS(:)								   |		REAL*8, ALLOCATABLE ::  dS(:)
	REAL(10), ALLOCATABLE ::  dI_RAY(:)							   |		REAL*8, ALLOCATABLE ::  dI_RAY(:)
	REAL(10) MAX_VMU									   |		REAL*8 MAX_VMU
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) RPHOT										   |		REAL*8 RPHOT
	REAL(10) VPHOT										   |		REAL*8 VPHOT
	REAL(10) PSQ										   |		REAL*8 PSQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PAR_FLUX									   |		REAL*8 PAR_FLUX
	REAL(10) SPEED_OF_LIGHT,FUN_PI,PI							   |		REAL*8 SPEED_OF_LIGHT,FUN_PI,PI
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	        ETA_VEC(I)=ETA_VEC(I)*EXP(-TAU(I))						   |		        ETA_VEC(I)=ETA_VEC(I)*DEXP(-TAU(I))
./obs/obs_frame_v2.f
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: TGREY(:)							   |		REAL*8, ALLOCATABLE :: TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: VTURB(:)							   |		REAL*8, ALLOCATABLE :: VTURB(:)
	REAL(10), ALLOCATABLE :: MAX_DEL_V_RES_ZONE(:)						   |		REAL*8, ALLOCATABLE :: MAX_DEL_V_RES_ZONE(:)
	REAL(10), ALLOCATABLE :: P(:)								   |		REAL*8, ALLOCATABLE :: P(:)
	REAL(10), ALLOCATABLE :: MU_AT_RMAX(:)							   |		REAL*8, ALLOCATABLE :: MU_AT_RMAX(:)
	REAL(10), ALLOCATABLE :: HQW_AT_RMAX(:)							   |		REAL*8, ALLOCATABLE :: HQW_AT_RMAX(:)
!												   |	!
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10), ALLOCATABLE :: FREQ_CMF(:)							   |		REAL*8, ALLOCATABLE :: FREQ_CMF(:)
	REAL(10), ALLOCATABLE :: CHI_CMF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_CMF(:,:)
	REAL(10), ALLOCATABLE :: ETA_CMF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_CMF(:,:)
	REAL(10), ALLOCATABLE :: RAY_CMF(:,:)							   |		REAL*8, ALLOCATABLE :: RAY_CMF(:,:)
	REAL(10), ALLOCATABLE :: NEW_RJ_CMF(:,:)						   |		REAL*8, ALLOCATABLE :: NEW_RJ_CMF(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: FREQ_RJ(:)							   |		REAL*8, ALLOCATABLE :: FREQ_RJ(:)
	REAL(10), ALLOCATABLE :: RJ_CMF(:,:)							   |		REAL*8, ALLOCATABLE :: RJ_CMF(:,:)
	REAL(10), ALLOCATABLE :: RJ_VEC(:)							   |		REAL*8, ALLOCATABLE :: RJ_VEC(:)
	REAL(10), ALLOCATABLE :: NEW_RJ_VEC(:)							   |		REAL*8, ALLOCATABLE :: NEW_RJ_VEC(:)
	REAL(10), ALLOCATABLE :: OBS_FREQ(:)							   |		REAL*8, ALLOCATABLE :: OBS_FREQ(:)
	REAL(10), ALLOCATABLE :: OBS_FLUX(:)							   |		REAL*8, ALLOCATABLE :: OBS_FLUX(:)
	REAL(10) SPEED_OF_LIGHT,C_KMS								   |		REAL*8 SPEED_OF_LIGHT,C_KMS
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) TAU_MAX									   |		REAL*8 TAU_MAX
	REAL(10) ES_DTAU									   |		REAL*8 ES_DTAU
	REAL(10) FRAC_DOP									   |		REAL*8 FRAC_DOP
	REAL(10) DEL_V_OBS									   |		REAL*8 DEL_V_OBS
	REAL(10) VTURB_MIN									   |		REAL*8 VTURB_MIN
	REAL(10) VTURB_MAX									   |		REAL*8 VTURB_MAX
	REAL(10) MIN_FREQ									   |		REAL*8 MIN_FREQ
	REAL(10) MAX_FREQ									   |		REAL*8 MAX_FREQ
	REAL(10) MIN_WAVE									   |		REAL*8 MIN_WAVE
	REAL(10) MAX_WAVE									   |		REAL*8 MAX_WAVE
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) OBS_TAU_MAX									   |		REAL*8 OBS_TAU_MAX
	REAL(10) OBS_ES_DTAU									   |		REAL*8 OBS_ES_DTAU
	REAL(10) TAU_REF									   |		REAL*8 TAU_REF
	NOS=LOG(MAX_FREQ/MIN_FREQ)/LOG(1.0D0+DEL_V_OBS/C_KMS)-1					   |		NOS=DLOG(MAX_FREQ/MIN_FREQ)/DLOG(1.0D0+DEL_V_OBS/C_KMS)-1
./obs/rd_cmf_flux_controls.f
./obs/rd_cont_j_obs.f
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) FL										   |		REAL*8 FL
	REAL(10), SAVE :: LOW_FREQ, HIGH_FREQ							   |		REAL*8, SAVE :: LOW_FREQ, HIGH_FREQ
	REAL(10), ALLOCATABLE :: RJ_LOW(:)							   |		REAL*8, ALLOCATABLE :: RJ_LOW(:)
	REAL(10), ALLOCATABLE :: RJ_HIGH(:)							   |		REAL*8, ALLOCATABLE :: RJ_HIGH(:)
	REAL(10) T1										   |		REAL*8 T1
./obs/rd_model_file.f
	REAL(10) VAR										   |		REAL*8 VAR
./obs/revise_obs_p.f
												   >	! Altered: 24-Sep-2023. Cleand up option messaging.
												   >	!
	REAL(10) P_OBS(NP_OBS_MAX)								   |		REAL*8 P_OBS(NP_OBS_MAX)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) dR										   |		REAL*8 dR
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	  CALL RD_STORE_INT(NC_INS,'NC_INS',L_FALSE,'Number of hydro iterations remaining')	   |		  CALL RD_STORE_INT(NC_INS,'NC_INS',L_FALSE,'Number of ray to be insert inside core.')
            CALL RD_STORE_INT(NP_INS,'NP_INS',L_TRUE,'Number of extra rays to insert')		   |	            CALL RD_STORE_INT(NP_INS,'NP_INS',L_TRUE,'Number of extra rays to insert outside cor
            CALL RD_STORE_DBLE(dR,'dR_FRAC',L_TRUE,'Fraction change in R befre inserting new ray   |	            CALL RD_STORE_DBLE(dR,'dR_FRAC',L_TRUE,'Fractional change in R befre inserting new r
./obs/set_forbid_zero.f
./obs/ABS_EW.INC
./obs/CMF_ABS_EW.INC
./obs/COMP_JCONT_V4.INC
./obs/EVAL_LTE_INC_V4.INC
./obs/EVAL_LTE_INC_V5.INC
./obs/OPACITIES_V4.INC
./obs/OPACITIES_V5.INC
./obs/XOPAC_V4.INC
 
Comparing files in ./pgplt with those in  /home/hillier/wnode04/cmf_testing_real8//pgplt
 
./pgplt/Makefile
												   >	      $(LIB)(change_xaxis_gridding.o)\
./pgplt/adjust_id_waves.f
./pgplt/amoeba.f
      REAL(10) FTOL										   |	      REAL*8 FTOL
      REAL(10) P(MP,NP)										   |	      REAL*8 P(MP,NP)
      REAL(10) Y(MP)										   |	      REAL*8 Y(MP)
      REAL(10) FUNK										   |	      REAL*8 FUNK
      REAL(10) RTOL,SUM,SWAP,YSAVE,YTRY								   |	      REAL*8 RTOL,SUM,SWAP,YSAVE,YTRY
      REAL(10) PSUM(NDIM)									   |	      REAL*8 PSUM(NDIM)
      REAL(10) AMOTRY										   |	      REAL*8 AMOTRY
./pgplt/amotry.f
      REAL(10) AMOTRY,FAC,P(MP,NP),PSUM(NP),Y(MP),FUNK						   |	      REAL*8 AMOTRY,FAC,P(MP,NP),PSUM(NP),Y(MP),FUNK
      REAL(10) FAC1,FAC2,YTRY									   |	      REAL*8 FAC1,FAC2,YTRY
      REAL(10) PTRY(NDIM)									   |	      REAL*8 PTRY(NDIM)
./pgplt/arrange_pg_curve_ids.f
./pgplt/change_color.f
./pgplt/change_pen.f
./pgplt/cursor_gaus_fit.f
	REAL(10) LINE_CENTER(NL_MAX)								   |		REAL*8 LINE_CENTER(NL_MAX)
	REAL(10) TOLERANCE									   |		REAL*8 TOLERANCE
	REAL(10) GAUS_FIT_FUNC									   |		REAL*8 GAUS_FIT_FUNC
	REAL(10) YST,YEND									   |		REAL*8 YST,YEND
	REAL(10) TOL										   |		REAL*8 TOL
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) FWHM										   |		REAL*8 FWHM
	REAL(10) CONT_FLUX									   |		REAL*8 CONT_FLUX
	REAL(10), SAVE :: XST=0.0D0								   |		REAL*8, SAVE :: XST=0.0D0
	REAL(10), SAVE :: XEND=1.0D0								   |		REAL*8, SAVE :: XEND=1.0D0
	        FWHM=2.0D0*T1*(LOG(2.0D0))**(1.0D0/PAR(K+3))					   |		        FWHM=2.0D0*T1*(DLOG(2.0D0))**(1.0D0/PAR(K+3))
	   FWHM=2.0D0*T1*(LOG(2.0D0))**(1.0D0/SIM(I,K+3))					   |		   FWHM=2.0D0*T1*(DLOG(2.0D0))**(1.0D0/SIM(I,K+3))
	REAL(10) GAUS_FIT_FUNC									   |		REAL*8 GAUS_FIT_FUNC
	REAL(10) T1										   |		REAL*8 T1
./pgplt/curve.f
	REAL(10) X(NUM),Y(NUM)									   |		REAL*8 X(NUM),Y(NUM)
	REAL(10) X(NUM),Y(NUM),SIGMA(NUM)							   |		REAL*8 X(NUM),Y(NUM),SIGMA(NUM)
./pgplt/curve_lab.f
	REAL(10) X(NUM),Y(NUM)									   |		REAL*8 X(NUM),Y(NUM)
	REAL(10) X(NUM),Y(NUM),SIGMA(NUM)							   |		REAL*8 X(NUM),Y(NUM),SIGMA(NUM)
./pgplt/cut_points_from_plot.f
./pgplt/define_more_pens.f
./pgplt/do_cursor_balmer.f
	REAL(10) LAM_CENT									   |		REAL*8 LAM_CENT
	REAL(10) LAM_WAVE									   |		REAL*8 LAM_WAVE
	REAL(10) MEAN 										   |		REAL*8 MEAN 
	REAL(10) SUM_OSQ, SUM_LOSQ, SUM_LSQ_OSQ							   |		REAL*8 SUM_OSQ, SUM_LOSQ, SUM_LSQ_OSQ
	REAL(10) SUM_MO, SUM_LMO								   |		REAL*8 SUM_MO, SUM_LMO
	REAL(10) A, B										   |		REAL*8 A, B
	REAL(10) DET, DA, DB									   |		REAL*8 DET, DA, DB
	REAL(10) CHISQ,RAW_CHISQ,RED_CHISQ							   |		REAL*8 CHISQ,RAW_CHISQ,RED_CHISQ
	REAL(10) EW_OBS,EW_MOD									   |		REAL*8 EW_OBS,EW_MOD
	REAL(10) EW_OBS_OMIT,EW_MOD_OMIT							   |		REAL*8 EW_OBS_OMIT,EW_MOD_OMIT
	REAL(10) SLOPE,INTER,CONT								   |		REAL*8 SLOPE,INTER,CONT
./pgplt/do_cursor_ew.f
./pgplt/do_cursor_ew_v2.f
./pgplt/do_cursor_ew_v3.f
./pgplt/do_file_balmer_v1.f
	REAL(10) LAM_CENT			!Line centroid					   |		REAL*8 LAM_CENT			!Line centroid
	REAL(10) MEAN 			!Used computing line centroid				   |		REAL*8 MEAN 			!Used computing line centroid
	REAL(10) EW_MOD,EW_OBS									   |		REAL*8 EW_MOD,EW_OBS
        REAL(10) EW_OBS_OMIT,EW_MOD_OMIT							   |	        REAL*8 EW_OBS_OMIT,EW_MOD_OMIT
	REAL(10) SUM_OSQ, SUM_LOSQ, SUM_LSQ_OSQ							   |		REAL*8 SUM_OSQ, SUM_LOSQ, SUM_LSQ_OSQ
	REAL(10) SUM_MO, SUM_LMO								   |		REAL*8 SUM_MO, SUM_LMO
	REAL(10) A, B										   |		REAL*8 A, B
	REAL(10) DET, DA, DB									   |		REAL*8 DET, DA, DB
	REAL(10) CHISQ,RAW_CHISQ,RED_CHISQ							   |		REAL*8 CHISQ,RAW_CHISQ,RED_CHISQ
./pgplt/do_file_ew_v1.f
./pgplt/do_fill.f
./pgplt/do_gaus_fit.f
	REAL(10) LINE_HEIGHT(NL_MAX)								   |		REAL*8 LINE_HEIGHT(NL_MAX)
	REAL(10) LINE_CENTER(NL_MAX)								   |		REAL*8 LINE_CENTER(NL_MAX)
	REAL(10) LINE_SIGMA(NL_MAX)								   |		REAL*8 LINE_SIGMA(NL_MAX)
	REAL(10) TOLERANCE									   |		REAL*8 TOLERANCE
	REAL(10) GAUS_FIT_FUNC									   |		REAL*8 GAUS_FIT_FUNC
	REAL(10) YST,YEND									   |		REAL*8 YST,YEND
	REAL(10) TOL										   |		REAL*8 TOL
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FWHM										   |		REAL*8 FWHM
	REAL(10), SAVE :: XST=0.0D0								   |		REAL*8, SAVE :: XST=0.0D0
	REAL(10), SAVE :: XEND=1.0D0								   |		REAL*8, SAVE :: XEND=1.0D0
	  FWHM=2.0D0*T1*(LOG(2.0D0))**(1.0D0/PAR(K+3))						   |		  FWHM=2.0D0*T1*(DLOG(2.0D0))**(1.0D0/PAR(K+3))
	     FWHM=2.0D0*T1*(LOG(2.0D0))**(1.0D0/SIM(I,K+3))					   |		     FWHM=2.0D0*T1*(DLOG(2.0D0))**(1.0D0/SIM(I,K+3))
	REAL(10) GAUS_FIT_FUNC									   |		REAL*8 GAUS_FIT_FUNC
	REAL(10) T1										   |		REAL*8 T1
./pgplt/do_gauss_smooth.f
	REAL(10) XMIN,XMAX									   |		REAL*8 XMIN,XMAX
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10) INST_RES									   |		REAL*8 INST_RES
	REAL(10) RESOLUTION									   |		REAL*8 RESOLUTION
	REAL(10) WAVE_MIN									   |		REAL*8 WAVE_MIN
	REAL(10) WAVE_MAX									   |		REAL*8 WAVE_MAX
	REAL(10) MIN_RES_KMS 									   |		REAL*8 MIN_RES_KMS 
	REAL(10) NUM_RES									   |		REAL*8 NUM_RES
	REAL(10) VSINI										   |		REAL*8 VSINI
	REAL(10) EPSILON									   |		REAL*8 EPSILON
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) XOFFSET									   |		REAL*8 XOFFSET
./pgplt/do_many_ew.f
	REAL(10) TAU_CUT									   |		REAL*8 TAU_CUT
./pgplt/do_mult_gf.f
	REAL(10) LINE_HEIGHT(NL_MAX)								   |		REAL*8 LINE_HEIGHT(NL_MAX)
	REAL(10) LINE_CENTER(NL_MAX)								   |		REAL*8 LINE_CENTER(NL_MAX)
	REAL(10) LINE_SIGMA(NL_MAX)								   |		REAL*8 LINE_SIGMA(NL_MAX)
	REAL(10) TOLERANCE									   |		REAL*8 TOLERANCE
	REAL(10) GAUS_FIT_FUNC									   |		REAL*8 GAUS_FIT_FUNC
	REAL(10) XST,XEND									   |		REAL*8 XST,XEND
	REAL(10) YST,YEND									   |		REAL*8 YST,YEND
	REAL(10) TOL										   |		REAL*8 TOL
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) FWHM										   |		REAL*8 FWHM
./pgplt/do_pg_deriv.f
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
./pgplt/do_pg_regrid.f
./pgplt/do_vec_op.f
C I & J are temporary variables for the callt o MON_INTERP. I denotes the 			   |	C I & J are temporary variables for the call to MON_INTERP. I denotes the 
./pgplt/draw_ew_ids.f
./pgplt/draw_ew_lines.f
	REAL(10), ALLOCATABLE :: DP_VEC(:)							   |		REAL*8, ALLOCATABLE :: DP_VEC(:)
./pgplt/draw_line_ids.f
./pgplt/draw_line_ids_v2.f
./pgplt/draw_right_y_axis.f
./pgplt/ed_gaus_fit.f
	REAL(10), ALLOCATABLE :: TMP_PAR(:)							   |		REAL*8, ALLOCATABLE :: TMP_PAR(:)
./pgplt/ed_gauss_fit.f
	REAL(10), ALLOCATABLE :: TMP_PAR(:)							   |		REAL*8, ALLOCATABLE :: TMP_PAR(:)
./pgplt/ew_group.f
./pgplt/find_lines.f
	REAL(10) LINE_CENTER(NL_MAX)								   |		REAL*8 LINE_CENTER(NL_MAX)
	REAL(10) LINE_HEIGHT(NL_MAX)								   |		REAL*8 LINE_HEIGHT(NL_MAX)
	REAL(10) LINE_SIGMA(NL_MAX)								   |		REAL*8 LINE_SIGMA(NL_MAX)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: CONT(:)							   |		REAL*8, ALLOCATABLE :: CONT(:)
	REAL(10), ALLOCATABLE :: DERIV(:)							   |		REAL*8, ALLOCATABLE :: DERIV(:)
	REAL(10), ALLOCATABLE :: COEF(:,:)							   |		REAL*8, ALLOCATABLE :: COEF(:,:)
	REAL(10) SUM,LAM									   |		REAL*8 SUM,LAM
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) MEAN,SLOPE									   |		REAL*8 MEAN,SLOPE
./pgplt/fntick.f
./pgplt/gaus_fit_data.f
	REAL(10), ALLOCATABLE :: X_GAUS(:)	!Absica data as stored in module		   |		REAL*8, ALLOCATABLE :: X_GAUS(:)	!Absica data as stored in module
	REAL(10), ALLOCATABLE :: Y_GAUS(:)	!Data to be fitted				   |		REAL*8, ALLOCATABLE :: Y_GAUS(:)	!Data to be fitted
	REAL(10), ALLOCATABLE :: SIM(:,:)		!Simplex (NG_PAR+1 parameter set estimat   |		REAL*8, ALLOCATABLE :: SIM(:,:)		!Simplex (NG_PAR+1 parameter set estimates)
	REAL(10), ALLOCATABLE :: PAR(:)		!Single parameter set				   |		REAL*8, ALLOCATABLE :: PAR(:)		!Single parameter set
	REAL(10), ALLOCATABLE :: SUM_SQ(:)							   |		REAL*8, ALLOCATABLE :: SUM_SQ(:)
	REAL(10), ALLOCATABLE :: SCALE(:)							   |		REAL*8, ALLOCATABLE :: SCALE(:)
	REAL(10), ALLOCATABLE :: EW_TABLE(:,:)							   |		REAL*8, ALLOCATABLE :: EW_TABLE(:,:)
	REAL(10), ALLOCATABLE :: LAM_TABLE(:,:)							   |		REAL*8, ALLOCATABLE :: LAM_TABLE(:,:)
	REAL(10), ALLOCATABLE :: EW(:)								   |		REAL*8, ALLOCATABLE :: EW(:)
	REAL(10), ALLOCATABLE :: EW_CONT(:)							   |		REAL*8, ALLOCATABLE :: EW_CONT(:)
	REAL(10), ALLOCATABLE :: EW_ERROR(:)							   |		REAL*8, ALLOCATABLE :: EW_ERROR(:)
	REAL(10), ALLOCATABLE :: ALT_ERROR(:)							   |		REAL*8, ALLOCATABLE :: ALT_ERROR(:)
	REAL(10), ALLOCATABLE :: MIN_ERROR(:)							   |		REAL*8, ALLOCATABLE :: MIN_ERROR(:)
	REAL(10) XST,XEND									   |		REAL*8 XST,XEND
	REAL(10) YST,YEND									   |		REAL*8 YST,YEND
./pgplt/gaus_fit_er.f
	REAL(10) PARAMS(NG_PAR)									   |		REAL*8 PARAMS(NG_PAR)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SUM										   |		REAL*8 SUM
./pgplt/gaus_fit_func.f
	REAL(10) FUNCTION GAUS_FIT_FUNC(PARAMS)							   |		REAL*8 FUNCTION GAUS_FIT_FUNC(PARAMS)
	REAL(10) PARAMS(NG_PAR)									   |		REAL*8 PARAMS(NG_PAR)
	REAL(10) SUM										   |		REAL*8 SUM
	REAL(10) T1										   |		REAL*8 T1
./pgplt/gaus_romb.f
	REAL(10) ANSWER										   |		REAL*8 ANSWER
	REAL(10) HEIGHT										   |		REAL*8 HEIGHT
	REAL(10) SCALE										   |		REAL*8 SCALE
	REAL(10) EXPONENT									   |		REAL*8 EXPONENT
	REAL(10) TOLERANCE									   |		REAL*8 TOLERANCE
	REAL(10) R(M,M)										   |		REAL*8 R(M,M)
	REAL(10) H		!Step size							   |		REAL*8 H		!Step size
	REAL(10) HMAX		!Maximumstep size adopted					   |		REAL*8 HMAX		!Maximumstep size adopted
	REAL(10) RANGE		!Range of integration						   |		REAL*8 RANGE		!Range of integration
./pgplt/gauss_fit_data.f
	REAL(10), ALLOCATABLE :: X_GAUSS(:)	!Absica data as stored in module		   |		REAL*8, ALLOCATABLE :: X_GAUSS(:)	!Absica data as stored in module
	REAL(10), ALLOCATABLE :: Y_GAUSS(:)	!Data to be fitted				   |		REAL*8, ALLOCATABLE :: Y_GAUSS(:)	!Data to be fitted
	REAL(10), ALLOCATABLE :: SIM(:,:)		!Simplex (NG_PAR+1 parameter set estimat   |		REAL*8, ALLOCATABLE :: SIM(:,:)		!Simplex (NG_PAR+1 parameter set estimates)
	REAL(10), ALLOCATABLE :: PAR(:)		!Single parameter set				   |		REAL*8, ALLOCATABLE :: PAR(:)		!Single parameter set
	REAL(10), ALLOCATABLE :: SUM_SQ(:)							   |		REAL*8, ALLOCATABLE :: SUM_SQ(:)
	REAL(10), ALLOCATABLE :: SCALE(:)							   |		REAL*8, ALLOCATABLE :: SCALE(:)
	REAL(10), ALLOCATABLE :: EW_TABLE(:,:)							   |		REAL*8, ALLOCATABLE :: EW_TABLE(:,:)
	REAL(10), ALLOCATABLE :: LAM_TABLE(:,:)							   |		REAL*8, ALLOCATABLE :: LAM_TABLE(:,:)
	REAL(10), ALLOCATABLE :: EW(:)								   |		REAL*8, ALLOCATABLE :: EW(:)
	REAL(10), ALLOCATABLE :: EW_CONT(:)							   |		REAL*8, ALLOCATABLE :: EW_CONT(:)
	REAL(10), ALLOCATABLE :: EW_ERROR(:)							   |		REAL*8, ALLOCATABLE :: EW_ERROR(:)
	REAL(10), ALLOCATABLE :: ALT_ERROR(:)							   |		REAL*8, ALLOCATABLE :: ALT_ERROR(:)
	REAL(10), ALLOCATABLE :: MIN_ERROR(:)							   |		REAL*8, ALLOCATABLE :: MIN_ERROR(:)
	REAL(10) XST,XEND									   |		REAL*8 XST,XEND
	REAL(10) YST,YEND									   |		REAL*8 YST,YEND
./pgplt/gauss_fit_er.f
	REAL(10) PARAMS(NG_PAR)									   |		REAL*8 PARAMS(NG_PAR)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SUM										   |		REAL*8 SUM
./pgplt/gauss_fit.f
	REAL(10) LINE_CENTER(NL_MAX)								   |		REAL*8 LINE_CENTER(NL_MAX)
	REAL(10) TOLERANCE									   |		REAL*8 TOLERANCE
	REAL(10) GAUSS_FIT_FUNC									   |		REAL*8 GAUSS_FIT_FUNC
	REAL(10) WAVE_SCALE									   |		REAL*8 WAVE_SCALE
	REAL(10) EXPONENT_SCALE									   |		REAL*8 EXPONENT_SCALE
	REAL(10) YST,YEND									   |		REAL*8 YST,YEND
	REAL(10) TOL										   |		REAL*8 TOL
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) FWHM										   |		REAL*8 FWHM
	REAL(10) CONT_FLUX									   |		REAL*8 CONT_FLUX
	REAL(10), SAVE :: XST=0.0D0								   |		REAL*8, SAVE :: XST=0.0D0
	REAL(10), SAVE :: XEND=1.0D0								   |		REAL*8, SAVE :: XEND=1.0D0
	        FWHM=2.0D0*T1*(2.0D0*LOG(2.0D0))**(1.0D0/PAR(K+3))        !Sigma in km/s	   |		        FWHM=2.0D0*T1*(2.0D0*DLOG(2.0D0))**(1.0D0/PAR(K+3))        !Sigma in km/s
	   FWHM=2.0D0*T1*(LOG(2.0D0))**(1.0D0/SIM(I,K+3))					   |		   FWHM=2.0D0*T1*(DLOG(2.0D0))**(1.0D0/SIM(I,K+3))
	REAL(10) GAUSS_FIT_FUNC									   |		REAL*8 GAUSS_FIT_FUNC
	REAL(10) T1										   |		REAL*8 T1
./pgplt/gauss_fit_func.f
	REAL(10) FUNCTION GAUSS_FIT_FUNC(PARAMS)						   |		REAL*8 FUNCTION GAUSS_FIT_FUNC(PARAMS)
	REAL(10) PARAMS(NG_PAR)									   |		REAL*8 PARAMS(NG_PAR)
	REAL(10) SUM										   |		REAL*8 SUM
	REAL(10) T1										   |		REAL*8 T1
./pgplt/gauss_romb_v2.f
	REAL(10) ANSWER		!Returned EW							   |		REAL*8 ANSWER		!Returned EW
	REAL(10) A		!Continuum is defoned by A+B(X-X0)				   |		REAL*8 A		!Continuum is defoned by A+B(X-X0)
	REAL(10) B										   |		REAL*8 B
	REAL(10) X0										   |		REAL*8 X0
	REAL(10) POS		!Line center							   |		REAL*8 POS		!Line center	
	REAL(10) HEIGHT		!								   |		REAL*8 HEIGHT		!
	REAL(10) SCALE		!Scale factor descibing eponential -- similar to sigma		   |		REAL*8 SCALE		!Scale factor descibing eponential -- similar to sigma
	REAL(10) EXPONENT									   |		REAL*8 EXPONENT
	REAL(10) TOLERANCE	!Tolerence for final answer.					   |		REAL*8 TOLERANCE	!Tolerence for final answer.
	REAL(10) X 		!X coordinate (as in original data)				   |		REAL*8 X 		!X coordinate (as in original data)
	REAL(10) W		!Scaled and offset coodrinate: w=(X-POS)/SIGMA			   |		REAL*8 W		!Scaled and offset coodrinate: w=(X-POS)/SIGMA
	REAL(10) R(M,M)										   |		REAL*8 R(M,M)
	REAL(10) H		!Step size							   |		REAL*8 H		!Step size
	REAL(10) HMAX		!Maximumstep size adopted					   |		REAL*8 HMAX		!Maximumstep size adopted
	REAL(10) RANGE		!Range of integration						   |		REAL*8 RANGE		!Range of integration
./pgplt/get_gramon_min_max.f
./pgplt/get_line_id_pg.f
./pgplt/get_pgi_file_info.f
./pgplt/get_titles.f
./pgplt/gramon_pgplot.f
												   >	! Altered:  24-Sep-2023 : Added abillity to disallow data initialiazation using PASSED_OPT (05-S
	REAL(10) VB_BASE(MAX_PLTS)								   |		REAL*8 VB_BASE(MAX_PLTS)
	REAL(10) YMIN_SAV,YMAX_SAV								   |		REAL*8 YMIN_SAV,YMAX_SAV
	REAL(10) LAM_AIR									   |		REAL*8 LAM_AIR
	REAL(10) DP_T1										   |		REAL*8 DP_T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) LAM_VAC									   |		REAL*8 LAM_VAC
	REAL(10) LAM_ST,LAM_END									   |		REAL*8 LAM_ST,LAM_END
!												   |	!
	REAL(10) DP_CUT_ACC									   |		REAL*8 DP_CUT_ACC
	REAL(10) SIG_GAU_KMS									   |		REAL*8 SIG_GAU_KMS
	REAL(10) FRAC_SIG_GAU									   |		REAL*8 FRAC_SIG_GAU
	REAL(10), ALLOCATABLE :: WRK1(:)							   |		REAL*8, ALLOCATABLE :: WRK1(:)
	REAL(10), ALLOCATABLE :: WRK2(:)							   |		REAL*8, ALLOCATABLE :: WRK2(:)
! CENTRAL_LAM must be REAL(10) as LAM_VAC is REAL(10) function.					   |	! CENTRAL_LAM must be REAL*8 as LAM_VAC is REAL*8 function.
	REAL(10) CENTRAL_LAM									   |		REAL*8 CENTRAL_LAM
	REAL(10) OLD_CENTRAL_LAM								   |		REAL*8 OLD_CENTRAL_LAM
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) C_VAL										   |		REAL*8 C_VAL
	INITIALIZE_ON_EXIT=.TRUE.								   <
												   >		IF(OPTION(1:3) .EQ. 'NOI')THEN  !Don't initialize plots on exit
												   >		  INITIALIZE_ON_EXIT=.FALSE.
												   >		ELSE
												   >		  INITIALIZE_ON_EXIT=.TRUE.
												   >		END IF
	  CALL NEW_GEN_IN(NPTS(IP),'Number of data points')					   |		  IF(CNT .EQ. 0)THEN
												   >		    CALL NEW_GEN_IN(NPTS(IP),'Number of data points')
												   >		    FILNAME='Skip this record: '//TRIM(FILNAME)
												   >		    CALL NEW_GEN_IN(TMP_LOG,FILNAME)
												   >		    IF(TMP_LOG)READ(30,'(A200)',IOSTAT=IOS)FILNAME
												   >		  END IF
./pgplt/hist_adj.f
./pgplt/justify_convert_v2.f
./pgplt/line_id_mod.f
./pgplt/mod_curve_data.f
./pgplt/mod_ew_variables.f
./pgplt/modify_curve.f
./pgplt/modify_pgi_ps.f
./pgplt/mod_smear_pg.f
	REAL(10), parameter :: c_kms=2.99792458d5            !km/s				   |		real*8, parameter :: c_kms=2.99792458d5            !km/s
	REAL(10), parameter :: jimpi=3.141592653589793d0					   |		real*8, parameter :: jimpi=3.141592653589793d0
	REAL(10), parameter :: zero=0d0								   |		real*8, parameter :: zero=0d0
	REAL(10), parameter :: one=1d0								   |		real*8, parameter :: one=1d0
	REAL(10), parameter :: two=2d0								   |		real*8, parameter :: two=2d0
	REAL(10), parameter :: onehalf=0.5d0							   |		real*8, parameter :: onehalf=0.5d0
	REAL(10) origwave(Norig),origflux(Norig)						   |		real*8 origwave(Norig),origflux(Norig)
	REAL(10) wave_max,wave_min								   |		real*8 wave_max,wave_min
	REAL(10) inst_res     	! the instrumental resolution (dlambda)				   |		real*8 inst_res     	! the instrumental resolution (dlambda)
	REAL(10) Resolution   	! resolving power (R = lambda/dlambda)				   |		real*8 Resolution   	! resolving power (R = lambda/dlambda)
	REAL(10) min_res_kms  	! minimum resolution to work with				   |		real*8 min_res_kms  	! minimum resolution to work with
	REAL(10) num_res      	! num resolution elements to consider beyond			   |		real*8 num_res      	! num resolution elements to consider beyond
	REAL(10) vsini		! Projected rotational velocity in km/s				   |		real*8 vsini		! Projected rotational velocity in km/s
	REAL(10) epsilon		! Limb darkenin parameter: 				   |		real*8 epsilon		! Limb darkenin parameter: 
	REAL(10) origfreq(Norig)								   |		real*8 origfreq(Norig)
	REAL(10), allocatable :: modwave(:)							   |		real*8, allocatable :: modwave(:)
	REAL(10), allocatable :: modflux(:)							   |		real*8, allocatable :: modflux(:)
	REAL(10), allocatable :: tempwave(:)							   |		real*8, allocatable :: tempwave(:)
	REAL(10), allocatable :: tempflux(:)							   |		real*8, allocatable :: tempflux(:)
	REAL(10) cwave_max,cwave_min								   |		real*8 cwave_max,cwave_min
	REAL(10) model_res    ! the model resolution						   |		real*8 model_res    ! the model resolution
	REAL(10) min_dlam     ! the model resolution						   |		real*8 min_dlam     ! the model resolution
	REAL(10) kernal_sig   ! the corresponding sigma (fwhm = 2.354sig)			   |		real*8 kernal_sig   ! the corresponding sigma (fwhm = 2.354sig)
	REAL(10) extend       ! wavelength extension to consider				   |		real*8 extend       ! wavelength extension to consider
	REAL(10) t1										   |		real*8 t1
	 inst_res = log((two*resolution+one)/(two*resolution-one))				   |		 inst_res = dlog((two*resolution+one)/(two*resolution-one))
	REAL(10) wave(Nmod)									   |		real*8 wave(Nmod)
	REAL(10) flux(Nmod)									   |		real*8 flux(Nmod)
	REAL(10) sigma										   |		real*8 sigma
	REAL(10) vsini										   |		real*8 vsini
	REAL(10) epsilon									   |		real*8 epsilon
	REAL(10) answer(Nmod)									   |		real*8 answer(Nmod)
	REAL(10) response(Nmod)									   |		real*8 response(Nmod)
	REAL(10) wave(Nmod)        ! wavelength array						   |		real*8 wave(Nmod)        ! wavelength array
	REAL(10) response(Nmod)    ! response array						   |		real*8 response(Nmod)    ! response array
	REAL(10) sigma             ! sigma of gaussian 						   |		real*8 sigma             ! sigma of gaussian 
	REAL(10) lambda,dlam,cutoff,mu								   |		real*8 lambda,dlam,cutoff,mu
	REAL(10) response_area									   |		real*8 response_area
	REAL(10) wave(Nmod)     	! wavelength array					   |		real*8 wave(Nmod)     	! wavelength array
	REAL(10) response(Nmod) 	! response array					   |		real*8 response(Nmod) 	! response array
	REAL(10) vsini										   |		real*8 vsini
	REAL(10) epsilon									   |		real*8 epsilon
	REAL(10) lambda,dlam,cutoff,mu								   |		real*8 lambda,dlam,cutoff,mu
	REAL(10) response_area									   |		real*8 response_area
	REAL(10) t1,dlam_rot,a1,a2								   |		real*8 t1,dlam_rot,a1,a2
	REAL(10) sigma,x,mu									   |		real*8 sigma,x,mu
	REAL(10) gauss										   |		real*8 gauss
	REAL(10) wave(NMAX),flux(NMAX)								   |		real*8 wave(NMAX),flux(NMAX)
	REAL(10) dlam 				! even spacing in wavelength			   |		real*8 dlam 				! even spacing in wavelength
	REAL(10) tempwave(N),tempflux(N)							   |		real*8 tempwave(N),tempflux(N)
	REAL(10) dlamover2									   |		real*8 dlamover2
	REAL(10) freq(n)									   |		real*8 freq(n)
	REAL(10) wave(n)									   |		real*8 wave(n)
	REAL(10) wave(n)									   |		real*8 wave(n)
	  wave(i) = log(wave(i))								   |		  wave(i) = dlog(wave(i))
	  wave(i) = exp(wave(i))								   |		  wave(i) = dexp(wave(i))
	REAL(10) Awave(AN),Aflux(AN)								   |		real*8 Awave(AN),Aflux(AN)
	REAL(10) Bwave(BN),Bflux(BN)								   |		real*8 Bwave(BN),Bflux(BN)
	REAL(10) Awave(AN),Aflux(AN)								   |		real*8 Awave(AN),Aflux(AN)
	REAL(10) Bwave(BN),Bflux(BN)								   |		real*8 Bwave(BN),Bflux(BN)
	REAL(10) dlam,dlamover2									   |		real*8 dlam,dlamover2
	REAL(10) fluxsum									   |		real*8 fluxsum
	REAL(10) dlamsum									   |		real*8 dlamsum
	REAL(10) t1										   |		real*8 t1
	REAL(10) list(n),value									   |		real*8 list(n),value
	REAL(10) list(n),value									   |		real*8 list(n),value
./pgplt/monbord_v3.f
	REAL(10) LST_X_VAL									   |		REAL*8 LST_X_VAL
	REAL(10) SCED,XED									   |		REAL*8 SCED,XED
./pgplt/monbord_v4.f
	REAL(10) LST_X_VAL									   |		REAL*8 LST_X_VAL
	REAL(10) SCED,XED									   |		REAL*8 SCED,XED
./pgplt/moninside.f
./pgplt/mon_interp_sp.f
./pgplt/mon_num.f
./pgplt/pg_add_noise.f
	  REAL(10) LAM										   |		  REAL*8 LAM
	  REAL(10) POIDEV									   |		  REAL*8 POIDEV
./pgplt/pg_def_continuum.f
./pgplt/pg_mod_cont_nodes.f
./pgplt/pg_regrid.f
./pgplt/pg_replace_data_int.f
./pgplt/pg_set_curve_tit_length.f
./pgplt/put_text.f
./pgplt/rd_ew_id.f
	REAL(10) LINE_FLUX									   |		REAL*8 LINE_FLUX
	REAL(10) DP_T1										   |		REAL*8 DP_T1
	REAL(10) T1,T2										   |		REAL*8 T1,T2
        REAL(10) LAM_AIR									   |	        REAL*8 LAM_AIR
./pgplt/rd_line_ids.f
	REAL(10) DP_T1										   |		REAL*8 DP_T1
	REAL(10), EXTERNAL :: LAM_AIR								   |		REAL*8, EXTERNAL :: LAM_AIR
./pgplt/set_pg_titles.f
./pgplt/set_upper_axis.f
	REAL(10) XV(ND)										   |		REAL*8 XV(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) TA(ND),TB(ND)									   |		REAL*8 TA(ND),TB(ND)
	REAL(10) SCED,XED									   |		REAL*8 SCED,XED
	  TB(I)=LOG10(ED(I))									   |		  TB(I)=DLOG10(ED(I))
./pgplt/shrink_vectors.f
./pgplt/simp_ew.f
	REAL(10) SUM,LAM									   |		REAL*8 SUM,LAM
./pgplt/smooth_plt.f
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10) WT(NHAN_MAX)									   |		REAL*8 WT(NHAN_MAX)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./pgplt/spacing.f
./pgplt/step_plot_v1.f
./pgplt/strip_slash_p.f
./pgplt/tst_pg.f
./pgplt/vectorpen.f
./pgplt/wr_gaus_fit.f
	REAL(10) LINE_CENTER(NL_MAX)								   |		REAL*8 LINE_CENTER(NL_MAX)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FWHM										   |		REAL*8 FWHM
	   FWHM=2.0D0*T1*(LOG(2.0D0))**(1.0D0/SIM(I,K+3))					   |		   FWHM=2.0D0*T1*(DLOG(2.0D0))**(1.0D0/SIM(I,K+3))
./pgplt/write_line_lambdas.f
 
Comparing files in ./plane with those in  /home/hillier/wnode04/cmf_testing_real8//plane
 
./plane/Makefile
./plane/characteristics_v2.f
      REAL(10), DIMENSION(ND) :: R_GRID								   |	      REAL*8, DIMENSION(ND) :: R_GRID
      REAL(10), DIMENSION(NP) :: P								   |	      REAL*8, DIMENSION(NP) :: P
      REAL(10), DIMENSION(ND) :: V_GRID								   |	      REAL*8, DIMENSION(ND) :: V_GRID
      REAL(10), DIMENSION(ND) :: VDOP_VEC(ND)							   |	      REAL*8, DIMENSION(ND) :: VDOP_VEC(ND)
      REAL(10)  VDOP_FRAC									   |	      REAL*8  VDOP_FRAC
      REAL(10), PARAMETER ::  MU_STEP=0.005D0							   |	      REAL*8, PARAMETER ::  MU_STEP=0.005D0
      REAL(10) :: DIRECTION									   |	      REAL*8 :: DIRECTION
      REAL(10) dZ,dV,dR										   |	      REAL*8 dZ,dV,dR
      REAL(10) :: RMIN,RMAX,DS,SS,RR,VEL,A_OLD,DR_OLD,DS_1,DR_1					   |	      REAL*8 :: RMIN,RMAX,DS,SS,RR,VEL,A_OLD,DR_OLD,DS_1,DR_1
      REAL(10) :: MU_E,MU_H									   |	      REAL*8 :: MU_E,MU_H
      REAL(10) :: BETAMAX,BETA,DBETADR,GAMMA							   |	      REAL*8 :: BETAMAX,BETA,DBETADR,GAMMA
      REAL(10), DIMENSION(EQU) :: A,DADS,DADR							   |	      REAL*8, DIMENSION(EQU) :: A,DADS,DADR
	REAL(10), ALLOCATABLE :: Z(:)								   |		REAL*8, ALLOCATABLE :: Z(:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: S(:)								   |		REAL*8, ALLOCATABLE :: S(:)
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
	REAL(10), ALLOCATABLE :: B(:)								   |		REAL*8, ALLOCATABLE :: B(:)
./plane/characteristics_v2_gam.f
      REAL(10), DIMENSION(ND) :: R_GRID								   |	      REAL*8, DIMENSION(ND) :: R_GRID
      REAL(10), DIMENSION(NP) :: P								   |	      REAL*8, DIMENSION(NP) :: P
      REAL(10), DIMENSION(ND) :: V_GRID								   |	      REAL*8, DIMENSION(ND) :: V_GRID
      REAL(10), DIMENSION(ND) :: VDOP_VEC(ND)							   |	      REAL*8, DIMENSION(ND) :: VDOP_VEC(ND)
      REAL(10)  VDOP_FRAC									   |	      REAL*8  VDOP_FRAC
      REAL(10), PARAMETER ::  MU_STEP=0.005D0							   |	      REAL*8, PARAMETER ::  MU_STEP=0.005D0
      REAL(10) :: DIRECTION									   |	      REAL*8 :: DIRECTION
      REAL(10) dZ,dV,dR										   |	      REAL*8 dZ,dV,dR
      REAL(10) :: RMIN,RMAX,DS,SS,RR,VEL,A_OLD,DR_OLD,DS_1,DR_1					   |	      REAL*8 :: RMIN,RMAX,DS,SS,RR,VEL,A_OLD,DR_OLD,DS_1,DR_1
      REAL(10) :: MU_E,MU_H									   |	      REAL*8 :: MU_E,MU_H
      REAL(10) :: BETAMAX,BETA,DBETADR,GAMMA							   |	      REAL*8 :: BETAMAX,BETA,DBETADR,GAMMA
      REAL(10), DIMENSION(EQU) :: A,DADS,DADR							   |	      REAL*8, DIMENSION(EQU) :: A,DADS,DADR
	REAL(10), ALLOCATABLE :: Z(:)								   |		REAL*8, ALLOCATABLE :: Z(:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: S(:)								   |		REAL*8, ALLOCATABLE :: S(:)
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
	REAL(10), ALLOCATABLE :: B(:)								   |		REAL*8, ALLOCATABLE :: B(:)
./plane/cmf_formal_rel.f
	  REAL(10), ALLOCATABLE :: R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: R_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	  REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		  REAL*8, ALLOCATABLE :: Z_EXT(:)
	  REAL(10), ALLOCATABLE :: V_EXT(:)							   |		  REAL*8, ALLOCATABLE :: V_EXT(:)
	  REAL(10), ALLOCATABLE :: VDOP_VEC_EXT(:)						   |		  REAL*8, ALLOCATABLE :: VDOP_VEC_EXT(:)
	  REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	  REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		  REAL*8, ALLOCATABLE :: CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: TMP_VEC(:)							   |		  REAL*8, ALLOCATABLE :: TMP_VEC(:)
!												   |	!
	  REAL(10), ALLOCATABLE :: JNU_MID(:)							   |		  REAL*8, ALLOCATABLE :: JNU_MID(:)
	  REAL(10), ALLOCATABLE :: HNU_MID(:)							   |		  REAL*8, ALLOCATABLE :: HNU_MID(:)
	  REAL(10), ALLOCATABLE :: KNU_MID(:)							   |		  REAL*8, ALLOCATABLE :: KNU_MID(:)
	  REAL(10), ALLOCATABLE :: NNU_MID(:)							   |		  REAL*8, ALLOCATABLE :: NNU_MID(:)
	  REAL(10), ALLOCATABLE :: MIDR(:)							   |		  REAL*8, ALLOCATABLE :: MIDR(:)
	  REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		  REAL*8, ALLOCATABLE :: GAM_REL(:)
	  REAL(10), ALLOCATABLE :: CHI_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	  REAL(10), ALLOCATABLE :: ETA_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	  REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		  REAL*8, ALLOCATABLE :: CHI_RAY(:)
	  REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		  REAL*8, ALLOCATABLE :: ETA_RAY(:)
	1                  FREQ,LOG_NU,DIF,B_PLANCK,DBB,IC,THICK_OB,				   |		1                  FREQ,dLOG_NU,DIF,B_PLANCK,DBB,IC,THICK_OB,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
        REAL(10) V(ND)										   |	        REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)	
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DELV_FRAC_FG									   |		REAL*8 DELV_FRAC_FG
        REAL(10) JNU(ND)									   |	        REAL*8 JNU(ND)
	REAL(10) HNU(ND)									   |		REAL*8 HNU(ND)
	REAL(10) KNU(ND)									   |		REAL*8 KNU(ND)
	REAL(10) NNU(ND)									   |		REAL*8 NNU(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) K_ON_J(ND)									   |		REAL*8 K_ON_J(ND)
	REAL(10) N_ON_J(ND)									   |		REAL*8 N_ON_J(ND)
!												   |	!
	REAL(10) K_ON_J_MID(ND)									   |		REAL*8 K_ON_J_MID(ND)
	REAL(10) N_ON_H_MID(ND)									   |		REAL*8 N_ON_H_MID(ND)
	REAL(10) RSQN_MID_ON_RSQJ(ND)								   |		REAL*8 RSQN_MID_ON_RSQJ(ND)
!												   |	!
        REAL(10) IPLUS(NP)									   |	        REAL*8 IPLUS(NP)
        REAL(10) MU_AT_RMAX(NP)									   |	        REAL*8 MU_AT_RMAX(NP)
        REAL(10) HQW_AT_RMAX(NP)								   |	        REAL*8 HQW_AT_RMAX(NP)
        REAL(10) IN_HBC										   |	        REAL*8 IN_HBC
	REAL(10) HBC										   |		REAL*8 HBC
	REAL(10) NBC										   |		REAL*8 NBC
!												   |	!
	REAL(10) B_PLANCK									   |		REAL*8 B_PLANCK
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) DEL_R_FAC									   |		REAL*8 DEL_R_FAC
	REAL(10) NU_ON_dNU									   |		REAL*8 NU_ON_dNU
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  NU_ON_dNU=1.0D0/LOG_NU								   |		  NU_ON_dNU=1.0D0/dLOG_NU
!	IF(LOG_NU .NE. 0.0D0)NU_ON_dNU=1.0D0/LOG_NU						   |	!	IF(dLOG_NU .NE. 0.0D0)NU_ON_dNU=1.0D0/dLOG_NU
	      WRITE(145,'(4ES14.4)')FREQ,LOG_NU,B_PLANCK,DBB					   |		      WRITE(145,'(4ES14.4)')FREQ,dLOG_NU,B_PLANCK,DBB
./plane/cmf_formal_rel_v2.f
	  REAL(10), ALLOCATABLE :: R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: R_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	  REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		  REAL*8, ALLOCATABLE :: Z_EXT(:)
	  REAL(10), ALLOCATABLE :: V_EXT(:)							   |		  REAL*8, ALLOCATABLE :: V_EXT(:)
	  REAL(10), ALLOCATABLE :: VDOP_VEC_EXT(:)						   |		  REAL*8, ALLOCATABLE :: VDOP_VEC_EXT(:)
	  REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	  REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		  REAL*8, ALLOCATABLE :: CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: TMP_VEC(:)							   |		  REAL*8, ALLOCATABLE :: TMP_VEC(:)
	  REAL(10), ALLOCATABLE :: CHI_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	  REAL(10), ALLOCATABLE :: ETA_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	  REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		  REAL*8, ALLOCATABLE :: CHI_RAY(:)
	  REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		  REAL*8, ALLOCATABLE :: ETA_RAY(:)
	1            FREQ,LOG_NU,DIF,B_PLANCK,DBB,IC,THICK_OB,					   |		1            FREQ,dLOG_NU,DIF,B_PLANCK,DBB,IC,THICK_OB,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
        REAL(10) V(ND)										   |	        REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)	
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DELV_FRAC_FG									   |		REAL*8 DELV_FRAC_FG
	REAL(10) RETURNED_IN_HBC								   |		REAL*8 RETURNED_IN_HBC
	REAL(10) RETURNED_OUT_HBC								   |		REAL*8 RETURNED_OUT_HBC
        REAL(10) JNU(ND)									   |	        REAL*8 JNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
        REAL(10) IPLUS(NP)									   |	        REAL*8 IPLUS(NP)
!												   |	!
	REAL(10) B_PLANCK									   |		REAL*8 B_PLANCK
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) DEL_R_FAC									   |		REAL*8 DEL_R_FAC
	REAL(10) NU_ON_dNU									   |		REAL*8 NU_ON_dNU
	REAL(10) MU_AT_RMAX									   |		REAL*8 MU_AT_RMAX
	REAL(10) HQW_AT_RMAX									   |		REAL*8 HQW_AT_RMAX
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  NU_ON_dNU=1.0D0/LOG_NU								   |		  NU_ON_dNU=1.0D0/dLOG_NU
	        WRITE(7,'(6ES14.4)')FREQ,LOG_NU,NU_ON_dNU,B_PLANCK,DBB,IC			   |		        WRITE(7,'(6ES14.4)')FREQ,dLOG_NU,NU_ON_dNU,B_PLANCK,DBB,IC
./plane/cmf_formal_rel_v3.f
	  REAL(10), ALLOCATABLE :: R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: R_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	  REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		  REAL*8, ALLOCATABLE :: Z_EXT(:)
	  REAL(10), ALLOCATABLE :: V_EXT(:)							   |		  REAL*8, ALLOCATABLE :: V_EXT(:)
	  REAL(10), ALLOCATABLE :: VDOP_VEC_EXT(:)						   |		  REAL*8, ALLOCATABLE :: VDOP_VEC_EXT(:)
	  REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	  REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		  REAL*8, ALLOCATABLE :: CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: TMP_VEC(:)							   |		  REAL*8, ALLOCATABLE :: TMP_VEC(:)
	  REAL(10), ALLOCATABLE :: CHI_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	  REAL(10), ALLOCATABLE :: ETA_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	  REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		  REAL*8, ALLOCATABLE :: CHI_RAY(:)
	  REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		  REAL*8, ALLOCATABLE :: ETA_RAY(:)
	1            FREQ,LOG_NU,B_PLANCK,DBB,							   |		1            FREQ,dLOG_NU,B_PLANCK,DBB,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
        REAL(10) V(ND)										   |	        REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)	
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DELV_FRAC_FG									   |		REAL*8 DELV_FRAC_FG
	REAL(10) RET_HNU_AT_IB									   |		REAL*8 RET_HNU_AT_IB
	REAL(10) RET_HNU_AT_OB									   |		REAL*8 RET_HNU_AT_OB
        REAL(10) JNU(ND)									   |	        REAL*8 JNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
        REAL(10) IPLUS(NP)									   |	        REAL*8 IPLUS(NP)
!												   |	!
	REAL(10) B_PLANCK									   |		REAL*8 B_PLANCK
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dBdTAU										   |		REAL*8 dBdTAU
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) DEL_R_FAC									   |		REAL*8 DEL_R_FAC
	REAL(10) NU_ON_dNU									   |		REAL*8 NU_ON_dNU
	REAL(10) MU_AT_RMAX									   |		REAL*8 MU_AT_RMAX
	REAL(10) HQW_AT_RMAX									   |		REAL*8 HQW_AT_RMAX
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  NU_ON_dNU=1.0D0/LOG_NU								   |		  NU_ON_dNU=1.0D0/dLOG_NU
	        WRITE(7,'(6ES14.4)')FREQ,LOG_NU,NU_ON_dNU,B_PLANCK,DBB				   |		        WRITE(7,'(6ES14.4)')FREQ,dLOG_NU,NU_ON_dNU,B_PLANCK,DBB
./plane/cmf_formal_rel_v4.f
	  REAL(10), ALLOCATABLE :: R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: R_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	  REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		  REAL*8, ALLOCATABLE :: Z_EXT(:)
	  REAL(10), ALLOCATABLE :: V_EXT(:)							   |		  REAL*8, ALLOCATABLE :: V_EXT(:)
	  REAL(10), ALLOCATABLE :: VDOP_VEC_EXT(:)						   |		  REAL*8, ALLOCATABLE :: VDOP_VEC_EXT(:)
	  REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	  REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		  REAL*8, ALLOCATABLE :: CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: TMP_VEC(:)							   |		  REAL*8, ALLOCATABLE :: TMP_VEC(:)
	  REAL(10), ALLOCATABLE :: CHI_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	  REAL(10), ALLOCATABLE :: ETA_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	  REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		  REAL*8, ALLOCATABLE :: CHI_RAY(:)
	  REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		  REAL*8, ALLOCATABLE :: ETA_RAY(:)
	1            FREQ,LOG_NU,B_PLANCK,DBB,							   |		1            FREQ,dLOG_NU,B_PLANCK,DBB,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
        REAL(10) V(ND)										   |	        REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)	
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DELV_FRAC_FG									   |		REAL*8 DELV_FRAC_FG
	REAL(10) REXT_FAC									   |		REAL*8 REXT_FAC
	REAL(10) RET_HNU_AT_IB									   |		REAL*8 RET_HNU_AT_IB
	REAL(10) RET_HNU_AT_OB									   |		REAL*8 RET_HNU_AT_OB
        REAL(10) JNU(ND)									   |	        REAL*8 JNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
        REAL(10) IPLUS(NP)									   |	        REAL*8 IPLUS(NP)
!												   |	!
	REAL(10) B_PLANCK									   |		REAL*8 B_PLANCK
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) dBdTAU										   |		REAL*8 dBdTAU
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) DEL_R_FAC									   |		REAL*8 DEL_R_FAC
	REAL(10) NU_ON_dNU									   |		REAL*8 NU_ON_dNU
	REAL(10) MU_AT_RMAX									   |		REAL*8 MU_AT_RMAX
	REAL(10) HQW_AT_RMAX									   |		REAL*8 HQW_AT_RMAX
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  NU_ON_dNU=1.0D0/LOG_NU								   |		  NU_ON_dNU=1.0D0/dLOG_NU
!	        WRITE(7,'(6ES14.4)')FREQ,LOG_NU,NU_ON_dNU,B_PLANCK,DBB				   |	!	        WRITE(7,'(6ES14.4)')FREQ,dLOG_NU,NU_ON_dNU,B_PLANCK,DBB
./plane/cmf_formal_rel_v4_gam.f
	  REAL(10), ALLOCATABLE :: R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: R_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		  REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	  REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		  REAL*8, ALLOCATABLE :: Z_EXT(:)
	  REAL(10), ALLOCATABLE :: V_EXT(:)							   |		  REAL*8, ALLOCATABLE :: V_EXT(:)
	  REAL(10), ALLOCATABLE :: VDOP_VEC_EXT(:)						   |		  REAL*8, ALLOCATABLE :: VDOP_VEC_EXT(:)
	  REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	  REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		  REAL*8, ALLOCATABLE :: ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		  REAL*8, ALLOCATABLE :: CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	  REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)						   |		  REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	  REAL(10), ALLOCATABLE :: TMP_VEC(:)							   |		  REAL*8, ALLOCATABLE :: TMP_VEC(:)
	  REAL(10), ALLOCATABLE :: CHI_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	  REAL(10), ALLOCATABLE :: ETA_COEF(:,:)						   |		  REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	  REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		  REAL*8, ALLOCATABLE :: CHI_RAY(:)
	  REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		  REAL*8, ALLOCATABLE :: ETA_RAY(:)
	1            FREQ,LOG_NU,B_PLANCK,DBB,							   |		1            FREQ,dLOG_NU,B_PLANCK,DBB,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
        REAL(10) V(ND)										   |	        REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)	
	REAL(10) GAM_ETA(ND,NA)									   |		REAL*8 GAM_ETA(ND,NA)
	REAL(10) GAM_INT(ND,NA)									   |		REAL*8 GAM_INT(ND,NA)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DELV_FRAC_FG									   |		REAL*8 DELV_FRAC_FG
	REAL(10) REXT_FAC									   |		REAL*8 REXT_FAC
	REAL(10) RET_HNU_AT_IB									   |		REAL*8 RET_HNU_AT_IB
	REAL(10) RET_HNU_AT_OB									   |		REAL*8 RET_HNU_AT_OB
        REAL(10) JNU(ND)									   |	        REAL*8 JNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
        REAL(10) IPLUS(NP)									   |	        REAL*8 IPLUS(NP)
!												   |	!
	REAL(10) B_PLANCK									   |		REAL*8 B_PLANCK
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) T5,T6										   |		REAL*8 T5,T6
	REAL(10) dBdTAU										   |		REAL*8 dBdTAU
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) DEL_R_FAC									   |		REAL*8 DEL_R_FAC
	REAL(10) NU_ON_dNU									   |		REAL*8 NU_ON_dNU
	REAL(10) MU_AT_RMAX									   |		REAL*8 MU_AT_RMAX
	REAL(10) HQW_AT_RMAX									   |		REAL*8 HQW_AT_RMAX
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10), DIMENSION(:), ALLOCATABLE :: ZRAY						   |		REAL*8, DIMENSION(:), ALLOCATABLE :: ZRAY
	REAL(10), DIMENSION(:), ALLOCATABLE :: TEMPINT_M,TEMPINT_P				   |		REAL*8, DIMENSION(:), ALLOCATABLE :: TEMPINT_M,TEMPINT_P
	  NU_ON_dNU=1.0D0/LOG_NU								   |		  NU_ON_dNU=1.0D0/dLOG_NU
!	        WRITE(7,'(6ES14.4)')FREQ,LOG_NU,NU_ON_dNU,B_PLANCK,DBB				   |	!	        WRITE(7,'(6ES14.4)')FREQ,dLOG_NU,NU_ON_dNU,B_PLANCK,DBB
./plane/comp_add_edd_facs.f
	REAL(10) H_ON_J(ND)		!H/J at note						   |		REAL*8 H_ON_J(ND)		!H/J at note
	REAL(10) N_ON_J_NODE(ND)		!N/J at node					   |		REAL*8 N_ON_J_NODE(ND)		!N/J at node
	REAL(10) KMID_ON_J(ND)		!K/J at center of interval				   |		REAL*8 KMID_ON_J(ND)		!K/J at center of interval
	REAL(10) RJ(ND)			!Mean intensity (on node)				   |		REAL*8 RJ(ND)			!Mean intensity (on node)
	REAL(10) HNU(ND)			!Eddington flux					   |		REAL*8 HNU(ND)			!Eddington flux
	REAL(10) FEDD(ND)			!K/J at node					   |		REAL*8 FEDD(ND)			!K/J at node
	REAL(10) GEDD(ND)			!N/H at center of interval			   |		REAL*8 GEDD(ND)			!N/H at center of interval
	REAL(10) N_ON_J(ND)		!Ni/(Ji+Jk)						   |		REAL*8 N_ON_J(ND)		!Ni/(Ji+Jk)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) HBC_CMF			!H/J at outerboundar				   |		REAL*8 HBC_CMF			!H/J at outerboundar
	REAL(10) NBC_CMF			!N/J at outer boundary				   |		REAL*8 NBC_CMF			!N/J at outer boundary
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) INBC										   |		REAL*8 INBC
	REAL(10) RN_MOM(ND)		!N moment at mid points					   |		REAL*8 RN_MOM(ND)		!N moment at mid points
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) MIDR(ND)									   |		REAL*8 MIDR(ND)
	REAL(10) GAM_REL(ND)									   |		REAL*8 GAM_REL(ND)
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/create_incid_inten.f
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
	REAL(10), ALLOCATABLE :: DIST(:)							   |		REAL*8, ALLOCATABLE :: DIST(:)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) BNU										   |		REAL*8 BNU
	REAL(10) TEFF_STAR									   |		REAL*8 TEFF_STAR
	REAL(10) TEFF_INCID									   |		REAL*8 TEFF_INCID
	REAL(10) REL_LUM									   |		REAL*8 REL_LUM
	REAL(10) DILUTION_FACTOR								   |		REAL*8 DILUTION_FACTOR
	REAL(10), PARAMETER :: HDKT=4.7994145D0							   |		REAL*8, PARAMETER :: HDKT=4.7994145D0
	REAL(10), PARAMETER :: TWOHCSQ=0.0147452575D0						   |		REAL*8, PARAMETER :: TWOHCSQ=0.0147452575D0
	REAL(10), PARAMETER :: NU_MAX=100.0D0							   |		REAL*8, PARAMETER :: NU_MAX=100.0D0
	REAL(10), PARAMETER :: NU_MIN=0.0001D0							   |		REAL*8, PARAMETER :: NU_MIN=0.0001D0
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FLUX										   |		REAL*8 FLUX
	REAL(10) X										   |		REAL*8 X
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) NORMALIZED_ANGLE_INTEGRAL							   |		REAL*8 NORMALIZED_ANGLE_INTEGRAL
./plane/define_grid_v2.f
      REAL(10) R_EXT(ND_EXT)									   |	      REAL*8 R_EXT(ND_EXT)
      REAL(10) V_EXT(ND_EXT)									   |	      REAL*8 V_EXT(ND_EXT)
      REAL(10) VDOP_VEC(ND_EXT)									   |	      REAL*8 VDOP_VEC(ND_EXT)
      REAL(10) VDOP_FRAC									   |	      REAL*8 VDOP_FRAC
      REAL(10) R(ND)										   |	      REAL*8 R(ND)
      REAL(10) V(ND)										   |	      REAL*8 V(ND)
      REAL(10) P(NP)										   |	      REAL*8 P(NP)
      REAL(10) MU(NP)										   |	      REAL*8 MU(NP)
      REAL(10) TEMP_VEC(NP)									   |	      REAL*8 TEMP_VEC(NP)
./plane/define_grid_v2_gam.f
      REAL(10) R_EXT(ND_EXT)									   |	      REAL*8 R_EXT(ND_EXT)
      REAL(10) V_EXT(ND_EXT)									   |	      REAL*8 V_EXT(ND_EXT)
      REAL(10) VDOP_VEC(ND_EXT)									   |	      REAL*8 VDOP_VEC(ND_EXT)
      REAL(10) VDOP_FRAC									   |	      REAL*8 VDOP_FRAC
      REAL(10) R(ND)										   |	      REAL*8 R(ND)
      REAL(10) V(ND)										   |	      REAL*8 V(ND)
      REAL(10) P(NP)										   |	      REAL*8 P(NP)
      REAL(10) MU(NP)										   |	      REAL*8 MU(NP)
      REAL(10) TEMP_VEC(NP)									   |	      REAL*8 TEMP_VEC(NP)
./plane/derivr.f
      REAL(10), dimension(2) :: j,djdr								   |	      real*8, dimension(2) :: j,djdr
      REAL(10) x,r,mu,beta,dbetadr,gamma							   |	      real*8 x,r,mu,beta,dbetadr,gamma
./plane/derivs.f
      REAL(10), dimension(2) :: j,djds								   |	      real*8, dimension(2) :: j,djds
      REAL(10) x,r,mu,beta,dbetadr,gamma							   |	      real*8 x,r,mu,beta,dbetadr,gamma
./plane/drhsdchi_pp.f
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) COH_VEC(ND)									   |		REAL*8 COH_VEC(ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) W(ND,ND)									   |		REAL*8 W(ND,ND)
	REAL(10) dTAU_dCHI(ND,ND)								   |		REAL*8 dTAU_dCHI(ND,ND)
	REAL(10) ALPHA,BETA,T1									   |		REAL*8 ALPHA,BETA,T1
	REAL(10) UIJ,UII									   |		REAL*8 UIJ,UII
./plane/edd_j_hub_var_v1.f
	REAL(10) VK(ND,ND,NM)									   |		REAL*8 VK(ND,ND,NM)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ES_COH_VEC(ND)									   |		REAL*8 ES_COH_VEC(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) EDDF(ND)									   |		REAL*8 EDDF(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) HU(ND),HL(ND),HS(ND),HT(ND)							   |		REAL*8 HU(ND),HL(ND),HS(ND),HT(ND)
	REAL(10) RSQ_DTAUONQ(ND)								   |		REAL*8 RSQ_DTAUONQ(ND)
	REAL(10) W(ND),WPREV(ND)								   |		REAL*8 W(ND),WPREV(ND)
	REAL(10) DJDt(ND),DJDt_OLDT(ND)								   |		REAL*8 DJDt(ND),DJDt_OLDT(ND)
	REAL(10) PSI(ND),PSIPREV(ND)								   |		REAL*8 PSI(ND),PSIPREV(ND)
	REAL(10) JNU(ND),JNUM1(ND),JNU_OLDT(ND)							   |		REAL*8 JNU(ND),JNUM1(ND),JNU_OLDT(ND)
	REAL(10) RSQ_HNUM1(ND),RSQ_HNU_OLDT(ND)							   |		REAL*8 RSQ_HNUM1(ND),RSQ_HNU_OLDT(ND)
	REAL(10) dRHSdCHI_DIF_BC								   |		REAL*8 dRHSdCHI_DIF_BC
	REAL(10) dHUdCHI(ND),dHLdCHI(ND)							   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND)
	REAL(10) dHSdCHI(ND),dHTdCHI(ND)							   |		REAL*8 dHSdCHI(ND),dHTdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND)							   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND)
	REAL(10) dRHSdI(ND),dRHSdJ(ND)								   |		REAL*8 dRHSdI(ND),dRHSdJ(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
./plane/edd_j_hub_var_v2.f
	REAL(10) VK(ND,ND,NM)									   |		REAL*8 VK(ND,ND,NM)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ES_COH_VEC(ND)									   |		REAL*8 ES_COH_VEC(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) EDDF(ND)									   |		REAL*8 EDDF(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) HU(ND),HL(ND),HS(ND),HT(ND)							   |		REAL*8 HU(ND),HL(ND),HS(ND),HT(ND)
	REAL(10) RSQ_DTAUONQ(ND)								   |		REAL*8 RSQ_DTAUONQ(ND)
	REAL(10) W(ND),WPREV(ND)								   |		REAL*8 W(ND),WPREV(ND)
	REAL(10) DJDt(ND),DJDt_OLDt(ND)								   |		REAL*8 DJDt(ND),DJDt_OLDt(ND)
	REAL(10) PSI(ND),PSIPREV(ND)								   |		REAL*8 PSI(ND),PSIPREV(ND)
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) JNUM1(ND)									   |		REAL*8 JNUM1(ND)
	REAL(10) JNU_OLDt(ND)									   |		REAL*8 JNU_OLDt(ND)
	REAL(10) JNU_MOD(ND)									   |		REAL*8 JNU_MOD(ND)
	REAL(10) RSQ_HNUM1(ND),RSQ_HNU_OLDt(ND)							   |		REAL*8 RSQ_HNUM1(ND),RSQ_HNU_OLDt(ND)
	REAL(10) dRHSdCHI_IB									   |		REAL*8 dRHSdCHI_IB
	REAL(10) dRHSdCHI_OB									   |		REAL*8 dRHSdCHI_OB
	REAL(10) JMIN_IB,KMIN_IB,JPLUS_IB,KPLUS_IB						   |		REAL*8 JMIN_IB,KMIN_IB,JPLUS_IB,KPLUS_IB
	REAL(10) JMIN_OB,KMIN_OB,JPLUS_OB,KPLUS_OB						   |		REAL*8 JMIN_OB,KMIN_OB,JPLUS_OB,KPLUS_OB
	REAL(10) dHUdCHI(ND),dHLdCHI(ND)							   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND)
	REAL(10) dHSdCHI(ND),dHTdCHI(ND)							   |		REAL*8 dHSdCHI(ND),dHTdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND)							   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND)
	REAL(10) dRHSdI(ND),dRHSdJ(ND)								   |		REAL*8 dRHSdI(ND),dRHSdJ(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
./plane/edd_j_hub_var_v3.f
	REAL(10) VK(ND,ND,NM)									   |		REAL*8 VK(ND,ND,NM)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ES_COH_VEC(ND)									   |		REAL*8 ES_COH_VEC(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) EDDF(ND)									   |		REAL*8 EDDF(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) HU(ND),HL(ND),HS(ND),HT(ND)							   |		REAL*8 HU(ND),HL(ND),HS(ND),HT(ND)
	REAL(10) RSQ_DTAUONQ(ND)								   |		REAL*8 RSQ_DTAUONQ(ND)
	REAL(10) DERIV_SCL_FAC(ND)								   |		REAL*8 DERIV_SCL_FAC(ND)
	REAL(10) W(ND),WPREV(ND)								   |		REAL*8 W(ND),WPREV(ND)
	REAL(10) DJDt(ND),DJDt_OLDt(ND)								   |		REAL*8 DJDt(ND),DJDt_OLDt(ND)
	REAL(10) PSI(ND),PSIPREV(ND)								   |		REAL*8 PSI(ND),PSIPREV(ND)
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) JNUM1(ND)									   |		REAL*8 JNUM1(ND)
	REAL(10) JNU_OLDt(ND)									   |		REAL*8 JNU_OLDt(ND)
	REAL(10) JNU_MOD(ND)									   |		REAL*8 JNU_MOD(ND)
	REAL(10) RSQ_HNUM1(ND),RSQ_HNU_OLDt(ND)							   |		REAL*8 RSQ_HNUM1(ND),RSQ_HNU_OLDt(ND)
	REAL(10) dRHSdCHI_IB									   |		REAL*8 dRHSdCHI_IB
	REAL(10) dRHSdCHI_OB									   |		REAL*8 dRHSdCHI_OB
	REAL(10) JMIN_IB,KMIN_IB,JPLUS_IB,KPLUS_IB						   |		REAL*8 JMIN_IB,KMIN_IB,JPLUS_IB,KPLUS_IB
	REAL(10) JMIN_OB,KMIN_OB,JPLUS_OB,KPLUS_OB						   |		REAL*8 JMIN_OB,KMIN_OB,JPLUS_OB,KPLUS_OB
	REAL(10) dHUdCHI(ND),dHLdCHI(ND)							   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND)
	REAL(10) dHSdCHI(ND),dHTdCHI(ND)							   |		REAL*8 dHSdCHI(ND),dHTdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND)							   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND)
	REAL(10) dRHSdI(ND),dRHSdJ(ND)								   |		REAL*8 dRHSdI(ND),dRHSdJ(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
./plane/edd_jrel_var_v1.f
	REAL(10) VK(ND,ND,NM)									   |		REAL*8 VK(ND,ND,NM)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
	REAL(10) dXM_EPS_J,dXM_EPS_I,dXM_EPS_K							   |		REAL*8 dXM_EPS_J,dXM_EPS_I,dXM_EPS_K
	REAL(10) T1										   |		REAL*8 T1
./plane/edd_jrel_var_v2.f
	REAL(10) VK(ND,ND,NM)									   |		REAL*8 VK(ND,ND,NM)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
	REAL(10) dXM_EPS_J,dXM_EPS_I,dXM_EPS_K							   |		REAL*8 dXM_EPS_J,dXM_EPS_I,dXM_EPS_K
	REAL(10) T1										   |		REAL*8 T1
./plane/edd_jrel_var_v3.f
	REAL(10) VK(ND,ND,NM)									   |		REAL*8 VK(ND,ND,NM)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) RHS_JNU									   |		REAL*8 RHS_JNU
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) dIBCHI_A,dIBCHI_B								   |		REAL*8 dIBCHI_A,dIBCHI_B
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
	REAL(10) dXM_EPS_J,dXM_EPS_I,dXM_EPS_K							   |		REAL*8 dXM_EPS_J,dXM_EPS_I,dXM_EPS_K
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/expint.f
      REAL(10)  expint,x,EPS,FPMIN,EULER												   |	      REAL*8  expint,x,EPS,FPMIN,EULER													
      REAL(10) a,b,c,d,del,fact,h,psi												   |	      REAL*8 a,b,c,d,del,fact,h,psi													
./plane/expn_approx.f
	REAL(10) EXPN,EXPI,X,Z									   |		REAL*8 EXPN,EXPI,X,Z
./plane/expn.f
	REAL(10) X										   |		REAL*8 X
	REAL(10) EXPN 										   |		REAL*8 EXPN 
	REAL(10), PARAMETER :: EULER=0.5772156649015328606D0					   |		REAL*8, PARAMETER :: EULER=0.5772156649015328606D0
	REAL(10), PARAMETER :: EPS=1.0D-10							   |		REAL*8, PARAMETER :: EPS=1.0D-10
	REAL(10) Y,FAC,ANS,VAL,T1,OLD_ANS							   |		REAL*8 Y,FAC,ANS,VAL,T1,OLD_ANS
	REAL(10) A0,A1,A2									   |		REAL*8 A0,A1,A2
	REAL(10) B0,B1,B2									   |		REAL*8 B0,B1,B2
./plane/fcomp_pp_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) NEWRJ(ND)									   |		REAL*8 NEWRJ(ND)
	REAL(10) NEWRK(ND)									   |		REAL*8 NEWRK(ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) IPLUS(NP)									   |		REAL*8 IPLUS(NP)
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND)							   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND)
	REAL(10) DTAU(ND),DTAU_RAD(ND)								   |		REAL*8 DTAU(ND),DTAU_RAD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10), SAVE, ALLOCATABLE :: MU(:)							   |		REAL*8, SAVE, ALLOCATABLE :: MU(:)
	REAL(10), SAVE, ALLOCATABLE :: JQW(:)							   |		REAL*8, SAVE, ALLOCATABLE :: JQW(:)
	REAL(10), SAVE, ALLOCATABLE :: KQW(:)							   |		REAL*8, SAVE, ALLOCATABLE :: KQW(:)
	REAL(10), PARAMETER :: RZERO=0.0D0							   |		REAL*8, PARAMETER :: RZERO=0.0D0
	REAL(10), PARAMETER :: RONE=1.0D0							   |		REAL*8, PARAMETER :: RONE=1.0D0
	REAL(10) DBB,DBC,IBOUND,TOR,HBC_J,HBC_S,INBCNEW,IC,E1,E2,E3				   |		REAL*8 DBB,DBC,IBOUND,TOR,HBC_J,HBC_S,INBCNEW,IC,E1,E2,E3
./plane/fg_j_cmf_v11.f
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: DTAU(:,:)							   |		REAL*8, ALLOCATABLE :: DTAU(:,:)
	REAL(10), ALLOCATABLE :: AV(:,:)							   |		REAL*8, ALLOCATABLE :: AV(:,:)
	REAL(10), ALLOCATABLE :: CV(:,:)							   |		REAL*8, ALLOCATABLE :: CV(:,:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		REAL*8, ALLOCATABLE :: Z_EXT(:)
	REAL(10), ALLOCATABLE :: V_EXT(:)							   |		REAL*8, ALLOCATABLE :: V_EXT(:)
	REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: ETA_EXT(:)
	REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: CHI_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	REAL(10), ALLOCATABLE :: dCHIdR(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: QH(:)								   |		REAL*8, ALLOCATABLE :: QH(:)
	REAL(10), ALLOCATABLE :: V_RAY(:)							   |		REAL*8, ALLOCATABLE :: V_RAY(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SIGMA_RAY(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_RAY(:)
	REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		REAL*8, ALLOCATABLE :: ETA_RAY(:)
	REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		REAL*8, ALLOCATABLE :: CHI_RAY(:)
	REAL(10), ALLOCATABLE :: dCHIdR_RAY(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_RAY(:)
	REAL(10), ALLOCATABLE :: SOURCE_RAY(:)							   |		REAL*8, ALLOCATABLE :: SOURCE_RAY(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: AV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: AV_STORE(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: CV_STORE(:,:)
	REAL(10), ALLOCATABLE :: PAR_AV(:,:)							   |		REAL*8, ALLOCATABLE :: PAR_AV(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: TA(:,:)							   |		REAL*8, ALLOCATABLE :: TA(:,:)
	REAL(10), ALLOCATABLE :: TB(:,:)							   |		REAL*8, ALLOCATABLE :: TB(:,:)
	REAL(10), ALLOCATABLE :: TC(:,:)							   |		REAL*8, ALLOCATABLE :: TC(:,:)
	REAL(10), ALLOCATABLE :: GB(:,:)							   |		REAL*8, ALLOCATABLE :: GB(:,:)
	REAL(10), ALLOCATABLE :: H(:,:)								   |		REAL*8, ALLOCATABLE :: H(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: U(:)								   |		REAL*8, ALLOCATABLE :: U(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: DIV(:)								   |		REAL*8, ALLOCATABLE :: DIV(:)
	REAL(10), ALLOCATABLE :: OLDCHI(:)							   |		REAL*8, ALLOCATABLE :: OLDCHI(:)
	REAL(10), ALLOCATABLE :: OLDCHI_STORE(:)						   |		REAL*8, ALLOCATABLE :: OLDCHI_STORE(:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_STORE(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_STORE(:,:)
	REAL(10), ALLOCATABLE :: dGAMdR(:,:)							   |		REAL*8, ALLOCATABLE :: dGAMdR(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: A0(:,:)							   |		REAL*8, ALLOCATABLE :: A0(:,:)
	REAL(10), ALLOCATABLE :: A1(:,:)							   |		REAL*8, ALLOCATABLE :: A1(:,:)
	REAL(10), ALLOCATABLE :: A2(:,:)							   |		REAL*8, ALLOCATABLE :: A2(:,:)
	REAL(10), ALLOCATABLE :: A3(:,:)							   |		REAL*8, ALLOCATABLE :: A3(:,:)
	REAL(10), ALLOCATABLE :: A4(:,:)							   |		REAL*8, ALLOCATABLE :: A4(:,:)
	REAL(10), ALLOCATABLE :: I_P(:,:)							   |		REAL*8, ALLOCATABLE :: I_P(:,:)
	REAL(10), ALLOCATABLE :: I_M(:,:)							   |		REAL*8, ALLOCATABLE :: I_M(:,:)
	REAL(10), ALLOCATABLE :: EE(:)								   |		REAL*8, ALLOCATABLE :: EE(:)
	REAL(10), ALLOCATABLE :: E0(:)								   |		REAL*8, ALLOCATABLE :: E0(:)
	REAL(10), ALLOCATABLE :: E1(:)								   |		REAL*8, ALLOCATABLE :: E1(:)
	REAL(10), ALLOCATABLE :: E2(:)								   |		REAL*8, ALLOCATABLE :: E2(:)
	REAL(10), ALLOCATABLE :: E3(:)								   |		REAL*8, ALLOCATABLE :: E3(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SOURCE_PRIME(:)						   |		REAL*8, ALLOCATABLE :: SOURCE_PRIME(:)
	REAL(10), ALLOCATABLE :: S(:)								   |		REAL*8, ALLOCATABLE :: S(:)
	REAL(10), ALLOCATABLE :: dS(:)								   |		REAL*8, ALLOCATABLE :: dS(:)
	REAL(10) PREVIOUS_FREQ									   |		REAL*8 PREVIOUS_FREQ
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	1                  FREQ,LOG_NU,DIF,DBB,IC,						   |		1                  FREQ,dLOG_NU,DIF,DBB,IC,
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP)									   |		REAL*8 JQW(ND,NP)
	REAL(10) HQW(ND,NP)									   |		REAL*8 HQW(ND,NP)
	REAL(10) KQW(ND,NP)									   |		REAL*8 KQW(ND,NP)
	REAL(10) NQW(ND,NP)									   |		REAL*8 NQW(ND,NP)
!												   |	!
	REAL(10) HMIDQW(ND,NP)									   |		REAL*8 HMIDQW(ND,NP)
	REAL(10) NMIDQW(ND,NP)									   |		REAL*8 NMIDQW(ND,NP)
!												   |	!
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) IPLUS_P(NP)									   |		REAL*8 IPLUS_P(NP)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) RETURNED_IN_HBC								   |		REAL*8 RETURNED_IN_HBC
	REAL(10) RETURNED_OUT_HBC								   |		REAL*8 RETURNED_OUT_HBC
!												   |	!
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) CV_BOUND(NP)		!Outer boundary V					   |		REAL*8 CV_BOUND(NP)		!Outer boundary V
	REAL(10) I_M_IN_BND(NP)		!Inner boundary						   |		REAL*8 I_M_IN_BND(NP)		!Inner boundary
	REAL(10) IBOUND(NP)		!Incident intensity on outer boundary.			   |		REAL*8 IBOUND(NP)		!Incident intensity on outer boundary.
	REAL(10) FG_ERR_ON_FREQ									   |		REAL*8 FG_ERR_ON_FREQ
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELTA_Z									   |		REAL*8 DELTA_Z
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX,DEL_R_FAC									   |		REAL*8 RMAX,DEL_R_FAC
	REAL(10) MU,dZ,PSQ									   |		REAL*8 MU,dZ,PSQ
	REAL(10) DEL_R										   |		REAL*8 DEL_R
! NB: dCHIdR = LOG(CHI)/LOG(R) * CHI/R								   |	! NB: dCHIdR = dLOG(CHI)/dLOG(R) * CHI/R
	        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*LOG_NU)			   |		        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*dLOG_NU)
	        Q(I)=GAM(I,LS)/(CHI_RAY(I)*LOG_NU)						   |		        Q(I)=GAM(I,LS)/(CHI_RAY(I)*dLOG_NU)
	      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)						   |		      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)
	      IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)	     !Q(NI)			   |		      IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)	     !Q(NI)
! NB: dCHIdR = LOG(CHI)/LOG(R) * CHI/R								   |	! NB: dCHIdR = dLOG(CHI)/dLOG(R) * CHI/R
	      Q(1:NI)=GAM(1:NI,LS)/LOG_NU							   |		      Q(1:NI)=GAM(1:NI,LS)/dLOG_NU
	      dCHIdR_RAY(1:NI)=dCHIdR_RAY(1:NI)+dGAMdR(1:NI,LS)/LOG_NU				   |		      dCHIdR_RAY(1:NI)=dCHIdR_RAY(1:NI)+dGAMdR(1:NI,LS)/dLOG_NU
./plane/fg_j_cmf_v12.f
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: DTAU(:,:)							   |		REAL*8, ALLOCATABLE :: DTAU(:,:)
	REAL(10), ALLOCATABLE :: AV(:,:)							   |		REAL*8, ALLOCATABLE :: AV(:,:)
	REAL(10), ALLOCATABLE :: CV(:,:)							   |		REAL*8, ALLOCATABLE :: CV(:,:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		REAL*8, ALLOCATABLE :: Z_EXT(:)
	REAL(10), ALLOCATABLE :: V_EXT(:)							   |		REAL*8, ALLOCATABLE :: V_EXT(:)
	REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: ETA_EXT(:)
	REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: CHI_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	REAL(10), ALLOCATABLE :: dCHIdR(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: QH(:)								   |		REAL*8, ALLOCATABLE :: QH(:)
	REAL(10), ALLOCATABLE :: V_RAY(:)							   |		REAL*8, ALLOCATABLE :: V_RAY(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SIGMA_RAY(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_RAY(:)
	REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		REAL*8, ALLOCATABLE :: ETA_RAY(:)
	REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		REAL*8, ALLOCATABLE :: CHI_RAY(:)
	REAL(10), ALLOCATABLE :: dCHIdR_RAY(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_RAY(:)
	REAL(10), ALLOCATABLE :: SOURCE_RAY(:)							   |		REAL*8, ALLOCATABLE :: SOURCE_RAY(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: AV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: AV_STORE(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: CV_STORE(:,:)
	REAL(10), ALLOCATABLE :: PAR_AV(:,:)							   |		REAL*8, ALLOCATABLE :: PAR_AV(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: TA(:,:)							   |		REAL*8, ALLOCATABLE :: TA(:,:)
	REAL(10), ALLOCATABLE :: TB(:,:)							   |		REAL*8, ALLOCATABLE :: TB(:,:)
	REAL(10), ALLOCATABLE :: TC(:,:)							   |		REAL*8, ALLOCATABLE :: TC(:,:)
	REAL(10), ALLOCATABLE :: GB(:,:)							   |		REAL*8, ALLOCATABLE :: GB(:,:)
	REAL(10), ALLOCATABLE :: H(:,:)								   |		REAL*8, ALLOCATABLE :: H(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: U(:)								   |		REAL*8, ALLOCATABLE :: U(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: DIV(:)								   |		REAL*8, ALLOCATABLE :: DIV(:)
	REAL(10), ALLOCATABLE :: OLDCHI(:)							   |		REAL*8, ALLOCATABLE :: OLDCHI(:)
	REAL(10), ALLOCATABLE :: OLDCHI_STORE(:)						   |		REAL*8, ALLOCATABLE :: OLDCHI_STORE(:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_STORE(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_STORE(:,:)
	REAL(10), ALLOCATABLE :: dGAMdR(:,:)							   |		REAL*8, ALLOCATABLE :: dGAMdR(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: A0(:,:)							   |		REAL*8, ALLOCATABLE :: A0(:,:)
	REAL(10), ALLOCATABLE :: A1(:,:)							   |		REAL*8, ALLOCATABLE :: A1(:,:)
	REAL(10), ALLOCATABLE :: A2(:,:)							   |		REAL*8, ALLOCATABLE :: A2(:,:)
	REAL(10), ALLOCATABLE :: A3(:,:)							   |		REAL*8, ALLOCATABLE :: A3(:,:)
	REAL(10), ALLOCATABLE :: A4(:,:)							   |		REAL*8, ALLOCATABLE :: A4(:,:)
	REAL(10), ALLOCATABLE :: I_P(:,:)							   |		REAL*8, ALLOCATABLE :: I_P(:,:)
	REAL(10), ALLOCATABLE :: I_M(:,:)							   |		REAL*8, ALLOCATABLE :: I_M(:,:)
	REAL(10), ALLOCATABLE :: EE(:)								   |		REAL*8, ALLOCATABLE :: EE(:)
	REAL(10), ALLOCATABLE :: E0(:)								   |		REAL*8, ALLOCATABLE :: E0(:)
	REAL(10), ALLOCATABLE :: E1(:)								   |		REAL*8, ALLOCATABLE :: E1(:)
	REAL(10), ALLOCATABLE :: E2(:)								   |		REAL*8, ALLOCATABLE :: E2(:)
	REAL(10), ALLOCATABLE :: E3(:)								   |		REAL*8, ALLOCATABLE :: E3(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SOURCE_PRIME(:)						   |		REAL*8, ALLOCATABLE :: SOURCE_PRIME(:)
	REAL(10), ALLOCATABLE :: S(:)								   |		REAL*8, ALLOCATABLE :: S(:)
	REAL(10), ALLOCATABLE :: dS(:)								   |		REAL*8, ALLOCATABLE :: dS(:)
	REAL(10) PREVIOUS_FREQ									   |		REAL*8 PREVIOUS_FREQ
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	1                  FREQ,LOG_NU,DIF,DBB,IC,						   |		1                  FREQ,dLOG_NU,DIF,DBB,IC,
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP)									   |		REAL*8 JQW(ND,NP)
	REAL(10) HQW(ND,NP)									   |		REAL*8 HQW(ND,NP)
	REAL(10) KQW(ND,NP)									   |		REAL*8 KQW(ND,NP)
	REAL(10) NQW(ND,NP)									   |		REAL*8 NQW(ND,NP)
!												   |	!
	REAL(10) HMIDQW(ND,NP)									   |		REAL*8 HMIDQW(ND,NP)
	REAL(10) NMIDQW(ND,NP)									   |		REAL*8 NMIDQW(ND,NP)
!												   |	!
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) IPLUS_P(NP)									   |		REAL*8 IPLUS_P(NP)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) REXT_FAC		!Factor to scale RMAX by if thick atmosphere.		   |		REAL*8 REXT_FAC		!Factor to scale RMAX by if thick atmosphere.
	REAL(10) RETURNED_IN_HBC								   |		REAL*8 RETURNED_IN_HBC
	REAL(10) RETURNED_OUT_HBC								   |		REAL*8 RETURNED_OUT_HBC
!												   |	!
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) CV_BOUND(NP)		!Outer boundary V					   |		REAL*8 CV_BOUND(NP)		!Outer boundary V
	REAL(10) I_M_IN_BND(NP)		!Inner boundary						   |		REAL*8 I_M_IN_BND(NP)		!Inner boundary
	REAL(10) IBOUND(NP)		!Incident intensity on outer boundary.			   |		REAL*8 IBOUND(NP)		!Incident intensity on outer boundary.
	REAL(10) FG_ERR_ON_FREQ									   |		REAL*8 FG_ERR_ON_FREQ
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELTA_Z									   |		REAL*8 DELTA_Z
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX,DEL_R_FAC									   |		REAL*8 RMAX,DEL_R_FAC
	REAL(10) MU,dZ,PSQ									   |		REAL*8 MU,dZ,PSQ
	REAL(10) DEL_R										   |		REAL*8 DEL_R
! NB: dCHIdR = LOG(CHI)/LOG(R) * CHI/R								   |	! NB: dCHIdR = dLOG(CHI)/dLOG(R) * CHI/R
	        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*LOG_NU)			   |		        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*dLOG_NU)
	        Q(I)=GAM(I,LS)/(CHI_RAY(I)*LOG_NU)						   |		        Q(I)=GAM(I,LS)/(CHI_RAY(I)*dLOG_NU)
	      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)						   |		      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)
	      IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)	     !Q(NI)			   |		      IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)	     !Q(NI)
! NB: dCHIdR = LOG(CHI)/LOG(R) * CHI/R								   |	! NB: dCHIdR = dLOG(CHI)/dLOG(R) * CHI/R
	      Q(1:NI)=GAM(1:NI,LS)/LOG_NU							   |		      Q(1:NI)=GAM(1:NI,LS)/dLOG_NU
	      dCHIdR_RAY(1:NI)=dCHIdR_RAY(1:NI)+dGAMdR(1:NI,LS)/LOG_NU				   |		      dCHIdR_RAY(1:NI)=dCHIdR_RAY(1:NI)+dGAMdR(1:NI,LS)/dLOG_NU
./plane/fg_j_cmf_v13.f
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: DTAU(:,:)							   |		REAL*8, ALLOCATABLE :: DTAU(:,:)
	REAL(10), ALLOCATABLE :: AV(:,:)							   |		REAL*8, ALLOCATABLE :: AV(:,:)
	REAL(10), ALLOCATABLE :: CV(:,:)							   |		REAL*8, ALLOCATABLE :: CV(:,:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		REAL*8, ALLOCATABLE :: Z_EXT(:)
	REAL(10), ALLOCATABLE :: V_EXT(:)							   |		REAL*8, ALLOCATABLE :: V_EXT(:)
	REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: ETA_EXT(:)
	REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: CHI_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	REAL(10), ALLOCATABLE :: dCHIdR(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: QH(:)								   |		REAL*8, ALLOCATABLE :: QH(:)
	REAL(10), ALLOCATABLE :: V_RAY(:)							   |		REAL*8, ALLOCATABLE :: V_RAY(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SIGMA_RAY(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_RAY(:)
	REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		REAL*8, ALLOCATABLE :: ETA_RAY(:)
	REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		REAL*8, ALLOCATABLE :: CHI_RAY(:)
	REAL(10), ALLOCATABLE :: dCHIdR_RAY(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_RAY(:)
	REAL(10), ALLOCATABLE :: SOURCE_RAY(:)							   |		REAL*8, ALLOCATABLE :: SOURCE_RAY(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: AV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: AV_STORE(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: CV_STORE(:,:)
	REAL(10), ALLOCATABLE :: PAR_AV(:,:)							   |		REAL*8, ALLOCATABLE :: PAR_AV(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: TA(:,:)							   |		REAL*8, ALLOCATABLE :: TA(:,:)
	REAL(10), ALLOCATABLE :: TB(:,:)							   |		REAL*8, ALLOCATABLE :: TB(:,:)
	REAL(10), ALLOCATABLE :: TC(:,:)							   |		REAL*8, ALLOCATABLE :: TC(:,:)
	REAL(10), ALLOCATABLE :: GB(:,:)							   |		REAL*8, ALLOCATABLE :: GB(:,:)
	REAL(10), ALLOCATABLE :: H(:,:)								   |		REAL*8, ALLOCATABLE :: H(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: U(:)								   |		REAL*8, ALLOCATABLE :: U(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: DIV(:)								   |		REAL*8, ALLOCATABLE :: DIV(:)
	REAL(10), ALLOCATABLE :: OLDCHI(:)							   |		REAL*8, ALLOCATABLE :: OLDCHI(:)
	REAL(10), ALLOCATABLE :: OLDCHI_STORE(:)						   |		REAL*8, ALLOCATABLE :: OLDCHI_STORE(:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_STORE(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_STORE(:,:)
	REAL(10), ALLOCATABLE :: dGAMdR(:,:)							   |		REAL*8, ALLOCATABLE :: dGAMdR(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: A0(:,:)							   |		REAL*8, ALLOCATABLE :: A0(:,:)
	REAL(10), ALLOCATABLE :: A1(:,:)							   |		REAL*8, ALLOCATABLE :: A1(:,:)
	REAL(10), ALLOCATABLE :: A2(:,:)							   |		REAL*8, ALLOCATABLE :: A2(:,:)
	REAL(10), ALLOCATABLE :: A3(:,:)							   |		REAL*8, ALLOCATABLE :: A3(:,:)
	REAL(10), ALLOCATABLE :: A4(:,:)							   |		REAL*8, ALLOCATABLE :: A4(:,:)
	REAL(10), ALLOCATABLE :: I_P(:,:)							   |		REAL*8, ALLOCATABLE :: I_P(:,:)
	REAL(10), ALLOCATABLE :: I_M(:,:)							   |		REAL*8, ALLOCATABLE :: I_M(:,:)
	REAL(10), ALLOCATABLE :: EE(:)								   |		REAL*8, ALLOCATABLE :: EE(:)
	REAL(10), ALLOCATABLE :: E0(:)								   |		REAL*8, ALLOCATABLE :: E0(:)
	REAL(10), ALLOCATABLE :: E1(:)								   |		REAL*8, ALLOCATABLE :: E1(:)
	REAL(10), ALLOCATABLE :: E2(:)								   |		REAL*8, ALLOCATABLE :: E2(:)
	REAL(10), ALLOCATABLE :: E3(:)								   |		REAL*8, ALLOCATABLE :: E3(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SOURCE_PRIME(:)						   |		REAL*8, ALLOCATABLE :: SOURCE_PRIME(:)
	REAL(10), ALLOCATABLE :: S(:)								   |		REAL*8, ALLOCATABLE :: S(:)
	REAL(10), ALLOCATABLE :: dS(:)								   |		REAL*8, ALLOCATABLE :: dS(:)
	REAL(10) PREVIOUS_FREQ									   |		REAL*8 PREVIOUS_FREQ
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	1                  FREQ,LOG_NU,INNER_BND_METH,DBB,IC,					   |		1                  FREQ,dLOG_NU,INNER_BND_METH,DBB,IC,
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP)									   |		REAL*8 JQW(ND,NP)
	REAL(10) HQW(ND,NP)									   |		REAL*8 HQW(ND,NP)
	REAL(10) KQW(ND,NP)									   |		REAL*8 KQW(ND,NP)
	REAL(10) NQW(ND,NP)									   |		REAL*8 NQW(ND,NP)
!												   |	!
	REAL(10) HMIDQW(ND,NP)									   |		REAL*8 HMIDQW(ND,NP)
	REAL(10) NMIDQW(ND,NP)									   |		REAL*8 NMIDQW(ND,NP)
!												   |	!
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) IPLUS_P(NP)									   |		REAL*8 IPLUS_P(NP)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) REXT_FAC		!Factor to scale RMAX by if thick atmosphere.		   |		REAL*8 REXT_FAC		!Factor to scale RMAX by if thick atmosphere.
	REAL(10) RETURNED_IN_HBC								   |		REAL*8 RETURNED_IN_HBC
	REAL(10) RETURNED_OUT_HBC								   |		REAL*8 RETURNED_OUT_HBC
!												   |	!
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) CV_BOUND(NP)		!Outer boundary V					   |		REAL*8 CV_BOUND(NP)		!Outer boundary V
	REAL(10) I_M_IN_BND(NP)		!Inner boundary						   |		REAL*8 I_M_IN_BND(NP)		!Inner boundary
	REAL(10) IBOUND(NP)		!Incident intensity on outer boundary.			   |		REAL*8 IBOUND(NP)		!Incident intensity on outer boundary.
	REAL(10) FG_ERR_ON_FREQ									   |		REAL*8 FG_ERR_ON_FREQ
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELTA_Z									   |		REAL*8 DELTA_Z
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX,DEL_R_FAC									   |		REAL*8 RMAX,DEL_R_FAC
	REAL(10) MU,dZ,PSQ									   |		REAL*8 MU,dZ,PSQ
	REAL(10) DEL_R										   |		REAL*8 DEL_R
! NB: dCHIdR = LOG(CHI)/LOG(R) * CHI/R								   |	! NB: dCHIdR = dLOG(CHI)/dLOG(R) * CHI/R
	        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*LOG_NU)			   |		        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*dLOG_NU)
	        Q(I)=GAM(I,LS)/(CHI_RAY(I)*LOG_NU)						   |		        Q(I)=GAM(I,LS)/(CHI_RAY(I)*dLOG_NU)
	      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)						   |		      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)
	        IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)	     !Q(NI)		   |		        IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)	     !Q(NI)
! NB: dCHIdR = LOG(CHI)/LOG(R) * CHI/R								   |	! NB: dCHIdR = dLOG(CHI)/dLOG(R) * CHI/R
	      Q(1:NI)=GAM(1:NI,LS)/LOG_NU							   |		      Q(1:NI)=GAM(1:NI,LS)/dLOG_NU
	      dCHIdR_RAY(1:NI)=dCHIdR_RAY(1:NI)+dGAMdR(1:NI,LS)/LOG_NU				   |		      dCHIdR_RAY(1:NI)=dCHIdR_RAY(1:NI)+dGAMdR(1:NI,LS)/dLOG_NU
./plane/fgrey_norel_v1.f
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) R(ND)			!Radius grid (in units of 10^10 cm)			   |		REAL*8 R(ND)			!Radius grid (in units of 10^10 cm)
	REAL(10) RJ(ND)			!Mean opacity						   |		REAL*8 RJ(ND)			!Mean opacity
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) VEL(ND)			!Velocity (in km/s)				   |		REAL*8 VEL(ND)			!Velocity (in km/s)
	REAL(10) SIGMA(ND)		!dlnV/dlnr-1						   |		REAL*8 SIGMA(ND)		!dlnV/dlnr-1
!												   |	!
	REAL(10) P(NP)			!Impact parameters					   |		REAL*8 P(NP)			!Impact parameters
	REAL(10) JQW(ND,NP)		!Quadrature weight for J (on grid)			   |		REAL*8 JQW(ND,NP)		!Quadrature weight for J (on grid)
	REAL(10) KQW(ND,NP) 		!Quadrature weight for K (on grid)			   |		REAL*8 KQW(ND,NP) 		!Quadrature weight for K (on grid)
	REAL(10) HQW(ND,NP)		!Quadrature weight for H (at midpoints)			   |		REAL*8 HQW(ND,NP)		!Quadrature weight for H (at midpoints)
	REAL(10) LUMINOSITY               !Luminosity at inner boundary in Lsun.		   |		REAL*8 LUMINOSITY               !Luminosity at inner boundary in Lsun.
	REAL(10) IC                       !Not used						   |		REAL*8 IC                       !Not used
	REAL(10) H_OUTBC		!Eddington factor for H at outer boundary.		   |		REAL*8 H_OUTBC		!Eddington factor for H at outer boundary.
	REAL(10) H_INBC										   |		REAL*8 H_INBC
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) CHI_MOD(ND)									   |		REAL*8 CHI_MOD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) dCHI_MODdR(ND)									   |		REAL*8 dCHI_MODdR(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) VU(ND)										   |		REAL*8 VU(ND)
	REAL(10) CV(ND)										   |		REAL*8 CV(ND)
	REAL(10) FS_J(ND)									   |		REAL*8 FS_J(ND)
	REAL(10) FS_H(ND)									   |		REAL*8 FS_H(ND)
	REAL(10) FS_K(ND)									   |		REAL*8 FS_K(ND)
!												   |	!
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) C_KMS										   |		REAL*8 C_KMS
!												   |	!
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)						   |		    DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./plane/fine_chi_grid.f
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) TA(ND_SM)									   |		REAL*8 TA(ND_SM)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/fine_r_grid.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: R_MID_SM(:)							   |		REAL*8, ALLOCATABLE :: R_MID_SM(:)
	REAL(10), ALLOCATABLE :: RSQ_GAM_SM(:)							   |		REAL*8, ALLOCATABLE :: RSQ_GAM_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
!												   |	!
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: H_ON_J(:)							   |		REAL*8, ALLOCATABLE :: H_ON_J(:)
	REAL(10), ALLOCATABLE :: K_ON_J(:)							   |		REAL*8, ALLOCATABLE :: K_ON_J(:)
	REAL(10), ALLOCATABLE :: N_ON_J(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J(:)
!												   |	!
	REAL(10), ALLOCATABLE :: JNU_MID(:)							   |		REAL*8, ALLOCATABLE :: JNU_MID(:)
	REAL(10), ALLOCATABLE :: HNU_MID(:)							   |		REAL*8, ALLOCATABLE :: HNU_MID(:)
	REAL(10), ALLOCATABLE :: KNU_MID(:)							   |		REAL*8, ALLOCATABLE :: KNU_MID(:)
	REAL(10), ALLOCATABLE :: NNU_MID(:)							   |		REAL*8, ALLOCATABLE :: NNU_MID(:)
	REAL(10), ALLOCATABLE :: N_ON_H_MID(:)							   |		REAL*8, ALLOCATABLE :: N_ON_H_MID(:)
	REAL(10), ALLOCATABLE :: RSQN_MID_ON_RSQJ(:)						   |		REAL*8, ALLOCATABLE :: RSQN_MID_ON_RSQJ(:)
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) SIGMA_SM(ND_SM)								   |		REAL*8 SIGMA_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
./plane/gauleg.f
	REAL(10) X1,X2,X(N),W(N)								   |		REAL*8 X1,X2,X(N),W(N)
	REAL(10), PARAMETER :: EPS=3.0D-14							   |		REAL*8, PARAMETER :: EPS=3.0D-14
	REAL(10) XM,XL										   |		REAL*8 XM,XL
	REAL(10) P1,P2,P3,dP									   |		REAL*8 P1,P2,P3,dP
	REAL(10) Z,Z1										   |		REAL*8 Z,Z1
	REAL(10) ANS,SUM									   |		REAL*8 ANS,SUM
./plane/get_ibound.f
	REAL(10) MU(NP)										   |		REAL*8 MU(NP)
	REAL(10) IBOUND(NP)									   |		REAL*8 IBOUND(NP)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10), SAVE, ALLOCATABLE :: INTENSITY(:)						   |		REAL*8, SAVE, ALLOCATABLE :: INTENSITY(:)
	REAL(10), SAVE, ALLOCATABLE :: NU_GRID(:)						   |		REAL*8, SAVE, ALLOCATABLE :: NU_GRID(:)
	REAL(10), SAVE, ALLOCATABLE :: ANG_GRID(:)						   |		REAL*8, SAVE, ALLOCATABLE :: ANG_GRID(:)
	REAL(10), SAVE, ALLOCATABLE :: ANG_VARIATION(:)						   |		REAL*8, SAVE, ALLOCATABLE :: ANG_VARIATION(:)
	REAL(10), SAVE, ALLOCATABLE :: DIST(:)							   |		REAL*8, SAVE, ALLOCATABLE :: DIST(:)
	REAL(10), SAVE:: FREQ_SAV=0.0D0           !Previous frequency				   |		REAL*8, SAVE:: FREQ_SAV=0.0D0           !Previous frequency
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DILUTION_FACTOR								   |		REAL*8 DILUTION_FACTOR
./plane/get_ibound_old.f
	REAL(10) MU(NP)										   |		REAL*8 MU(NP)
	REAL(10) IBOUND(NP)									   |		REAL*8 IBOUND(NP)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10), SAVE, ALLOCATABLE :: INTENSITY(:,:)						   |		REAL*8, SAVE, ALLOCATABLE :: INTENSITY(:,:)
	REAL(10), SAVE, ALLOCATABLE :: NU_GRID(:)						   |		REAL*8, SAVE, ALLOCATABLE :: NU_GRID(:)
	REAL(10), SAVE, ALLOCATABLE :: ANG_GRID(:)						   |		REAL*8, SAVE, ALLOCATABLE :: ANG_GRID(:)
	REAL(10) IMU1,IMU2 									   |		REAL*8 IMU1,IMU2 
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/get_jh_at_prev_time_step.f
	REAL(10), ALLOCATABLE :: OLD_R(:)							   |		REAL*8, ALLOCATABLE :: OLD_R(:)
	REAL(10), ALLOCATABLE :: OLD_V(:)							   |		REAL*8, ALLOCATABLE :: OLD_V(:)
	REAL(10), ALLOCATABLE :: OLD_J(:)							   |		REAL*8, ALLOCATABLE :: OLD_J(:)
	REAL(10), ALLOCATABLE :: OLD_H(:)							   |		REAL*8, ALLOCATABLE :: OLD_H(:)
!												   |	!
	REAL(10), ALLOCATABLE :: NUST(:)							   |		REAL*8, ALLOCATABLE :: NUST(:)
	REAL(10), ALLOCATABLE :: JST(:,:)							   |		REAL*8, ALLOCATABLE :: JST(:,:)
	REAL(10), ALLOCATABLE :: HST(:,:)							   |		REAL*8, ALLOCATABLE :: HST(:,:)
	REAL(10), ALLOCATABLE :: H_INBC_ST(:)							   |		REAL*8, ALLOCATABLE :: H_INBC_ST(:)
	REAL(10), ALLOCATABLE :: H_OUTBC_ST(:)							   |		REAL*8, ALLOCATABLE :: H_OUTBC_ST(:)
!												   |	!
	REAL(10), ALLOCATABLE :: NEW_J_SAV(:)							   |		REAL*8, ALLOCATABLE :: NEW_J_SAV(:)
	REAL(10), ALLOCATABLE :: NEW_H_SAV(:)							   |		REAL*8, ALLOCATABLE :: NEW_H_SAV(:)
	REAL(10), ALLOCATABLE :: LOG_V(:)							   |		REAL*8, ALLOCATABLE :: LOG_V(:)
	REAL(10), ALLOCATABLE :: LOG_MIDV(:)							   |		REAL*8, ALLOCATABLE :: LOG_MIDV(:)
	REAL(10), ALLOCATABLE :: WRK_NEW_H(:)							   |		REAL*8, ALLOCATABLE :: WRK_NEW_H(:)
!												   |	!
	REAL(10), ALLOCATABLE :: LOG_OLD_V(:)							   |		REAL*8, ALLOCATABLE :: LOG_OLD_V(:)
	REAL(10), ALLOCATABLE :: LOG_OLD_MIDV(:)						   |		REAL*8, ALLOCATABLE :: LOG_OLD_MIDV(:)
	REAL(10), ALLOCATABLE :: WRK_OLD_H(:)							   |		REAL*8, ALLOCATABLE :: WRK_OLD_H(:)
!												   |	!
	REAL(10) H_INBC_OLDT_SAV								   |		REAL*8 H_INBC_OLDT_SAV
	REAL(10) H_OUTBC_OLDT_SAV								   |		REAL*8 H_OUTBC_OLDT_SAV
	REAL(10), SAVE :: NU_SAV=0.0D0								   |		REAL*8, SAVE :: NU_SAV=0.0D0
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
        REAL(10) NEW_J(ND)									   |	        REAL*8 NEW_J(ND)
	REAL(10) NEW_H(ND-1)									   |		REAL*8 NEW_H(ND-1)
	REAL(10) H_INBC_OLDT									   |		REAL*8 H_INBC_OLDT
	REAL(10) H_OUTBC_OLDT									   |		REAL*8 H_OUTBC_OLDT
	REAL(10)  T1										   |		REAL*8  T1
./plane/get_moms_ddt.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) RSQ_JNU(1:ND)									   |		REAL*8 RSQ_JNU(1:ND)
	REAL(10) RSQ_HNU_MID(1:ND)								   |		REAL*8 RSQ_HNU_MID(1:ND)
	REAL(10) RSQ(ND_STORE)									   |		REAL*8 RSQ(ND_STORE)
	REAL(10) TMP_VEC(1:ND+1)								   |		REAL*8 TMP_VEC(1:ND+1)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/get_moms_non_rel.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) TMP_VEC(1:ND)									   |		REAL*8 TMP_VEC(1:ND)
	REAL(10) RSQ_JNU(1:ND)									   |		REAL*8 RSQ_JNU(1:ND)
	REAL(10) RSQ_JNU_MID(1:ND)								   |		REAL*8 RSQ_JNU_MID(1:ND)
	REAL(10) RSQ_HNU_MID(1:ND)								   |		REAL*8 RSQ_HNU_MID(1:ND)
	REAL(10) RSQ_NNU_MID(1:ND)								   |		REAL*8 RSQ_NNU_MID(1:ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/get_moms_rel.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) GRSQ(ND_STORE)									   |		REAL*8 GRSQ(ND_STORE)
	REAL(10) TMP_VEC(1:ND+1)								   |		REAL*8 TMP_VEC(1:ND+1)
	REAL(10) RSQ_JNU(1:ND)									   |		REAL*8 RSQ_JNU(1:ND)
	REAL(10) RSQ_HNU_MID(1:ND)								   |		REAL*8 RSQ_HNU_MID(1:ND)
	REAL(10) RSQ_NNU_MID(1:ND)								   |		REAL*8 RSQ_NNU_MID(1:ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/get_rsqh_rel.f
	REAL(10) RSQH(ND)									   |		REAL*8 RSQH(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) TMP_VEC(1:ND+1)								   |		REAL*8 TMP_VEC(1:ND+1)
	REAL(10) RSQ_JNU(1:ND)									   |		REAL*8 RSQ_JNU(1:ND)
	REAL(10) RSQ_HNU_MID(1:ND)								   |		REAL*8 RSQ_HNU_MID(1:ND)
	REAL(10) RSQ_NNU_MID(1:ND)								   |		REAL*8 RSQ_NNU_MID(1:ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/get_rsqj_from_j.f
	REAL(10) JNU(NW)  	!								   |		REAL*8 JNU(NW)  	!
	REAL(10) R(NW)		!Independent variable						   |		REAL*8 R(NW)		!Independent variable
	REAL(10) RVAL		!Value at which function is to be interp. to.			   |		REAL*8 RVAL		!Value at which function is to be interp. to.
	REAL(10) GET_RSQJ_FROM_J								   |		REAL*8 GET_RSQJ_FROM_J
	REAL(10) FRAC										   |		REAL*8 FRAC
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/h_weight.f
      REAL(10) :: a1,a2,sum,check								   |	      real*8 :: a1,a2,sum,check
      REAL(10), dimension(nw) :: temp								   |	      real*8, dimension(nw) :: temp
      REAL(10), dimension(nw) :: angle								   |	      real*8, dimension(nw) :: angle
./plane/jgrey_hub_ddt.f
	REAL(10) RJ(ND)			!Mean intensity (computed and returned)			   |		REAL*8 RJ(ND)			!Mean intensity (computed and returned)
	REAL(10) RSQ_HFLUX(ND)            !r^2 . Flux						   |		REAL*8 RSQ_HFLUX(ND)            !r^2 . Flux
	REAL(10) R(ND)			!Radius grid (in units of 10^10 cm)			   |		REAL*8 R(ND)			!Radius grid (in units of 10^10 cm)
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) VEL(ND)			!Velocity (in km/s)				   |		REAL*8 VEL(ND)			!Velocity (in km/s)
	REAL(10) SIGMA(ND)		!dlnV/dlnr-1						   |		REAL*8 SIGMA(ND)		!dlnV/dlnr-1
!												   |	!
	REAL(10) P(NP)			!Impact parameters					   |		REAL*8 P(NP)			!Impact parameters
	REAL(10) JQW(ND,NP)		!Quadrature weight for J (on grid)			   |		REAL*8 JQW(ND,NP)		!Quadrature weight for J (on grid)
	REAL(10) KQW(ND,NP) 		!Quadrature weight for K (on grid)			   |		REAL*8 KQW(ND,NP) 		!Quadrature weight for K (on grid)
	REAL(10) HQW(ND,NP)		!Quadrature weight for H (at midpoints)			   |		REAL*8 HQW(ND,NP)		!Quadrature weight for H (at midpoints)
!												   |	!
	REAL(10) LUMINOSITY               !Luminosity at inner boundary in Lsun.		   |		REAL*8 LUMINOSITY               !Luminosity at inner boundary in Lsun.
	REAL(10) IC                       !Not used						   |		REAL*8 IC                       !Not used
	REAL(10) ACCURACY			!Convergence accuracy for computing f.		   |		REAL*8 ACCURACY			!Convergence accuracy for computing f.
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) HU(ND)										   |		REAL*8 HU(ND)
	REAL(10) HL(ND)										   |		REAL*8 HL(ND)
	REAL(10) HT(ND)										   |		REAL*8 HT(ND)
	REAL(10) JFAC(ND)									   |		REAL*8 JFAC(ND)
	REAL(10) JT(ND)										   |		REAL*8 JT(ND)
	REAL(10) WMID(ND)									   |		REAL*8 WMID(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI_MOD(ND)									   |		REAL*8 CHI_MOD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) dCHI_MODdR(ND)									   |		REAL*8 dCHI_MODdR(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) VU(ND)										   |		REAL*8 VU(ND)
	REAL(10) CV(ND)										   |		REAL*8 CV(ND)
	REAL(10) AVE_DTAU_ON_Q(ND)								   |		REAL*8 AVE_DTAU_ON_Q(ND)
	REAL(10) RAD_DECAY_TERM(ND)								   |		REAL*8 RAD_DECAY_TERM(ND)
	REAL(10) E_RAD_DECAY(ND)								   |		REAL*8 E_RAD_DECAY(ND)
	REAL(10) RSQ_J_OLDT(ND)									   |		REAL*8 RSQ_J_OLDT(ND)
	REAL(10) RSQ_H_OLDT(ND)									   |		REAL*8 RSQ_H_OLDT(ND)
	REAL(10) FS_RSQJ(ND)									   |		REAL*8 FS_RSQJ(ND)
	REAL(10) FS_RSQH(ND)									   |		REAL*8 FS_RSQH(ND)
	REAL(10) FS_RSQK(ND)									   |		REAL*8 FS_RSQK(ND)
!												   |	!
	REAL(10) H_OUTBC		!Eddington factor for H at outer boundary.		   |		REAL*8 H_OUTBC		!Eddington factor for H at outer boundary.
	REAL(10) H_INBC										   |		REAL*8 H_INBC
	REAL(10) H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).	   |		REAL*8 H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).
	REAL(10) H_INBC_OLDT									   |		REAL*8 H_INBC_OLDT
	REAL(10) DTAU_INB_SAVE									   |		REAL*8 DTAU_INB_SAVE
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)						   |		    DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./plane/jgrey_hub_ddt_v2.f
	REAL(10) RJ(ND)			!Mean intensity (computed and returned)			   |		REAL*8 RJ(ND)			!Mean intensity (computed and returned)
	REAL(10) RSQ_HFLUX(ND)            !r^2 . Flux						   |		REAL*8 RSQ_HFLUX(ND)            !r^2 . Flux
	REAL(10) R(ND)			!Radius grid (in units of 10^10 cm)			   |		REAL*8 R(ND)			!Radius grid (in units of 10^10 cm)
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) VEL(ND)			!Velocity (in km/s)				   |		REAL*8 VEL(ND)			!Velocity (in km/s)
	REAL(10) SIGMA(ND)		!dlnV/dlnr-1						   |		REAL*8 SIGMA(ND)		!dlnV/dlnr-1
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
!												   |	!
	REAL(10) P(NP)			!Impact parameters					   |		REAL*8 P(NP)			!Impact parameters
	REAL(10) JQW(ND,NP)		!Quadrature weight for J (on grid)			   |		REAL*8 JQW(ND,NP)		!Quadrature weight for J (on grid)
	REAL(10) KQW(ND,NP) 		!Quadrature weight for K (on grid)			   |		REAL*8 KQW(ND,NP) 		!Quadrature weight for K (on grid)
	REAL(10) HQW(ND,NP)		!Quadrature weight for H (at midpoints)			   |		REAL*8 HQW(ND,NP)		!Quadrature weight for H (at midpoints)
!												   |	!
	REAL(10) LUMINOSITY               !Luminosity at inner boundary in Lsun.		   |		REAL*8 LUMINOSITY               !Luminosity at inner boundary in Lsun.
	REAL(10) IC                       !Not used						   |		REAL*8 IC                       !Not used
	REAL(10) ACCURACY			!Convergence accuracy for computing f.		   |		REAL*8 ACCURACY			!Convergence accuracy for computing f.
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) HU(ND)										   |		REAL*8 HU(ND)
	REAL(10) HL(ND)										   |		REAL*8 HL(ND)
	REAL(10) HT(ND)										   |		REAL*8 HT(ND)
	REAL(10) JFAC(ND)									   |		REAL*8 JFAC(ND)
	REAL(10) JT(ND)										   |		REAL*8 JT(ND)
	REAL(10) WMID(ND)									   |		REAL*8 WMID(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI_MOD(ND)									   |		REAL*8 CHI_MOD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) dCHI_MODdR(ND)									   |		REAL*8 dCHI_MODdR(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) VU(ND)										   |		REAL*8 VU(ND)
	REAL(10) CV(ND)										   |		REAL*8 CV(ND)
	REAL(10) AVE_DTAU_ON_Q(ND)								   |		REAL*8 AVE_DTAU_ON_Q(ND)
	REAL(10) RAD_DECAY_TERM(ND)								   |		REAL*8 RAD_DECAY_TERM(ND)
	REAL(10) E_RAD_DECAY(ND)								   |		REAL*8 E_RAD_DECAY(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) T_FROM_J(ND)									   |		REAL*8 T_FROM_J(ND)
	REAL(10) TSTORE(ND)									   |		REAL*8 TSTORE(ND)
	REAL(10) RSQ_J_OLDT(ND)									   |		REAL*8 RSQ_J_OLDT(ND)
	REAL(10) RSQ_H_OLDT(ND)									   |		REAL*8 RSQ_H_OLDT(ND)
	REAL(10) FS_RSQJ(ND)									   |		REAL*8 FS_RSQJ(ND)
	REAL(10) FS_RSQH(ND)									   |		REAL*8 FS_RSQH(ND)
	REAL(10) FS_RSQK(ND)									   |		REAL*8 FS_RSQK(ND)
!												   |	!
	REAL(10) H_OUTBC		!Eddington factor for H at outer boundary.		   |		REAL*8 H_OUTBC		!Eddington factor for H at outer boundary.
	REAL(10) H_INBC										   |		REAL*8 H_INBC
	REAL(10) H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).	   |		REAL*8 H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).
	REAL(10) H_INBC_OLDT									   |		REAL*8 H_INBC_OLDT
	REAL(10) DTAU_INB_SAVE									   |		REAL*8 DTAU_INB_SAVE
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) REDUCTION_FACTOR								   |		REAL*8 REDUCTION_FACTOR
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)						   |		    DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./plane/jgrey_hub_ddt_v3.f
	REAL(10) RJ(ND)			!Mean intensity (computed and returned)			   |		REAL*8 RJ(ND)			!Mean intensity (computed and returned)
	REAL(10) RSQ_HFLUX(ND)            !r^2 . Flux						   |		REAL*8 RSQ_HFLUX(ND)            !r^2 . Flux
	REAL(10) R(ND)			!Radius grid (in units of 10^10 cm)			   |		REAL*8 R(ND)			!Radius grid (in units of 10^10 cm)
	REAL(10) CHI_PLANCK(ND)									   |		REAL*8 CHI_PLANCK(ND)
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) VEL(ND)			!Velocity (in km/s)				   |		REAL*8 VEL(ND)			!Velocity (in km/s)
	REAL(10) SIGMA(ND)		!dlnV/dlnr-1						   |		REAL*8 SIGMA(ND)		!dlnV/dlnr-1
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
!												   |	!
	REAL(10) P(NP)			!Impact parameters					   |		REAL*8 P(NP)			!Impact parameters
	REAL(10) JQW(ND,NP)		!Quadrature weight for J (on grid)			   |		REAL*8 JQW(ND,NP)		!Quadrature weight for J (on grid)
	REAL(10) KQW(ND,NP) 		!Quadrature weight for K (on grid)			   |		REAL*8 KQW(ND,NP) 		!Quadrature weight for K (on grid)
	REAL(10) HQW(ND,NP)		!Quadrature weight for H (at midpoints)			   |		REAL*8 HQW(ND,NP)		!Quadrature weight for H (at midpoints)
!												   |	!
	REAL(10) LUMINOSITY               !Luminosity at inner boundary in Lsun.		   |		REAL*8 LUMINOSITY               !Luminosity at inner boundary in Lsun.
	REAL(10) IC                       !Not used						   |		REAL*8 IC                       !Not used
	REAL(10) ACCURACY			!Convergence accuracy for computing f.		   |		REAL*8 ACCURACY			!Convergence accuracy for computing f.
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) HU(ND)										   |		REAL*8 HU(ND)
	REAL(10) HL(ND)										   |		REAL*8 HL(ND)
	REAL(10) HT(ND)										   |		REAL*8 HT(ND)
	REAL(10) JFAC(ND)									   |		REAL*8 JFAC(ND)
	REAL(10) JT(ND)										   |		REAL*8 JT(ND)
	REAL(10) WMID(ND)									   |		REAL*8 WMID(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI_MOD(ND)									   |		REAL*8 CHI_MOD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) dCHI_MODdR(ND)									   |		REAL*8 dCHI_MODdR(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) VU(ND)										   |		REAL*8 VU(ND)
	REAL(10) CV(ND)										   |		REAL*8 CV(ND)
	REAL(10) AVE_DTAU_ON_Q(ND)								   |		REAL*8 AVE_DTAU_ON_Q(ND)
	REAL(10) RAD_DECAY_TERM(ND)								   |		REAL*8 RAD_DECAY_TERM(ND)
	REAL(10) E_RAD_DECAY(ND)								   |		REAL*8 E_RAD_DECAY(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) T_FROM_J(ND)									   |		REAL*8 T_FROM_J(ND)
	REAL(10) TSTORE(ND)									   |		REAL*8 TSTORE(ND)
	REAL(10) RSQ_J_OLDT(ND)									   |		REAL*8 RSQ_J_OLDT(ND)
	REAL(10) RSQ_H_OLDT(ND)									   |		REAL*8 RSQ_H_OLDT(ND)
	REAL(10) FS_RSQJ(ND)									   |		REAL*8 FS_RSQJ(ND)
	REAL(10) FS_RSQH(ND)									   |		REAL*8 FS_RSQH(ND)
	REAL(10) FS_RSQK(ND)									   |		REAL*8 FS_RSQK(ND)
!												   |	!
	REAL(10) H_OUTBC		!Eddington factor for H at outer boundary.		   |		REAL*8 H_OUTBC		!Eddington factor for H at outer boundary.
	REAL(10) H_INBC										   |		REAL*8 H_INBC
	REAL(10) H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).	   |		REAL*8 H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).
	REAL(10) H_INBC_OLDT									   |		REAL*8 H_INBC_OLDT
	REAL(10) DTAU_INB_SAVE									   |		REAL*8 DTAU_INB_SAVE
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) REDUCTION_FACTOR								   |		REAL*8 REDUCTION_FACTOR
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)						   |		    DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./plane/jgrey_hub_ddt_v4.f
	REAL(10) RJ(ND)			!Mean intensity (computed and returned)			   |		REAL*8 RJ(ND)			!Mean intensity (computed and returned)
	REAL(10) RSQ_HFLUX(ND)            !r^2 . Flux						   |		REAL*8 RSQ_HFLUX(ND)            !r^2 . Flux
	REAL(10) R(ND)			!Radius grid (in units of 10^10 cm)			   |		REAL*8 R(ND)			!Radius grid (in units of 10^10 cm)
	REAL(10) CHI_PLANCK(ND)									   |		REAL*8 CHI_PLANCK(ND)
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) VEL(ND)			!Velocity (in km/s)				   |		REAL*8 VEL(ND)			!Velocity (in km/s)
	REAL(10) SIGMA(ND)		!dlnV/dlnr-1						   |		REAL*8 SIGMA(ND)		!dlnV/dlnr-1
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
!												   |	!
	REAL(10) P(NP)			!Impact parameters					   |		REAL*8 P(NP)			!Impact parameters
	REAL(10) JQW(ND,NP)		!Quadrature weight for J (on grid)			   |		REAL*8 JQW(ND,NP)		!Quadrature weight for J (on grid)
	REAL(10) KQW(ND,NP) 		!Quadrature weight for K (on grid)			   |		REAL*8 KQW(ND,NP) 		!Quadrature weight for K (on grid)
	REAL(10) HQW(ND,NP)		!Quadrature weight for H (at midpoints)			   |		REAL*8 HQW(ND,NP)		!Quadrature weight for H (at midpoints)
!												   |	!
	REAL(10) LUMINOSITY               !Luminosity at inner boundary in Lsun.		   |		REAL*8 LUMINOSITY               !Luminosity at inner boundary in Lsun.
	REAL(10) IC                       !Not used						   |		REAL*8 IC                       !Not used
	REAL(10) ACCURACY			!Convergence accuracy for computing f.		   |		REAL*8 ACCURACY			!Convergence accuracy for computing f.
	REAL(10) TIME_SEQ_NO              !Does not need to be an integer			   |		REAL*8 TIME_SEQ_NO              !Does not need to be an integer
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) HU(ND)										   |		REAL*8 HU(ND)
	REAL(10) HL(ND)										   |		REAL*8 HL(ND)
	REAL(10) HT(ND)										   |		REAL*8 HT(ND)
	REAL(10) JFAC(ND)									   |		REAL*8 JFAC(ND)
	REAL(10) JT(ND)										   |		REAL*8 JT(ND)
	REAL(10) WMID(ND)									   |		REAL*8 WMID(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI_MOD(ND)									   |		REAL*8 CHI_MOD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) dCHI_MODdR(ND)									   |		REAL*8 dCHI_MODdR(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) VU(ND)										   |		REAL*8 VU(ND)
	REAL(10) CV(ND)										   |		REAL*8 CV(ND)
	REAL(10) AVE_DTAU_ON_Q(ND)								   |		REAL*8 AVE_DTAU_ON_Q(ND)
	REAL(10) RAD_DECAY_TERM(ND)								   |		REAL*8 RAD_DECAY_TERM(ND)
	REAL(10) E_RAD_DECAY(ND)								   |		REAL*8 E_RAD_DECAY(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) T_FROM_J(ND)									   |		REAL*8 T_FROM_J(ND)
	REAL(10) TSTORE(ND)									   |		REAL*8 TSTORE(ND)
	REAL(10) RSQ_J_OLDT(ND)									   |		REAL*8 RSQ_J_OLDT(ND)
	REAL(10) RSQ_H_OLDT(ND)									   |		REAL*8 RSQ_H_OLDT(ND)
	REAL(10) FS_RSQJ(ND)									   |		REAL*8 FS_RSQJ(ND)
	REAL(10) FS_RSQH(ND)									   |		REAL*8 FS_RSQH(ND)
	REAL(10) FS_RSQK(ND)									   |		REAL*8 FS_RSQK(ND)
!												   |	!
	REAL(10) H_OUTBC		!Eddington factor for H at outer boundary.		   |		REAL*8 H_OUTBC		!Eddington factor for H at outer boundary.
	REAL(10) H_INBC										   |		REAL*8 H_INBC
	REAL(10) H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).	   |		REAL*8 H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).
	REAL(10) H_INBC_OLDT									   |		REAL*8 H_INBC_OLDT
	REAL(10) DTAU_INB_SAVE									   |		REAL*8 DTAU_INB_SAVE
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) REDUCTION_FACTOR								   |		REAL*8 REDUCTION_FACTOR
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)						   |		    DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./plane/jgrey_hub_ddt_v5.f
	REAL(10) RJ(ND)			!Mean intensity (computed and returned)			   |		REAL*8 RJ(ND)			!Mean intensity (computed and returned)
	REAL(10) RSQ_HFLUX(ND)            !r^2 . Flux						   |		REAL*8 RSQ_HFLUX(ND)            !r^2 . Flux
	REAL(10) R(ND)			!Radius grid (in units of 10^10 cm)			   |		REAL*8 R(ND)			!Radius grid (in units of 10^10 cm)
	REAL(10) CLUMP_FAC(ND)		!Clumping factor					   |		REAL*8 CLUMP_FAC(ND)		!Clumping factor
	REAL(10) CHI_PLANCK(ND)									   |		REAL*8 CHI_PLANCK(ND)
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) VEL(ND)			!Velocity (in km/s)				   |		REAL*8 VEL(ND)			!Velocity (in km/s)
	REAL(10) SIGMA(ND)		!dlnV/dlnr-1						   |		REAL*8 SIGMA(ND)		!dlnV/dlnr-1
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
!												   |	!
	REAL(10) P(NP)			!Impact parameters					   |		REAL*8 P(NP)			!Impact parameters
	REAL(10) JQW(ND,NP)		!Quadrature weight for J (on grid)			   |		REAL*8 JQW(ND,NP)		!Quadrature weight for J (on grid)
	REAL(10) KQW(ND,NP) 		!Quadrature weight for K (on grid)			   |		REAL*8 KQW(ND,NP) 		!Quadrature weight for K (on grid)
	REAL(10) HQW(ND,NP)		!Quadrature weight for H (at midpoints)			   |		REAL*8 HQW(ND,NP)		!Quadrature weight for H (at midpoints)
!												   |	!
	REAL(10) LUMINOSITY               !Luminosity at inner boundary in Lsun.		   |		REAL*8 LUMINOSITY               !Luminosity at inner boundary in Lsun.
	REAL(10) IC                       !Not used						   |		REAL*8 IC                       !Not used
	REAL(10) ACCURACY			!Convergence accuracy for computing f.		   |		REAL*8 ACCURACY			!Convergence accuracy for computing f.
	REAL(10) TIME_SEQ_NO              !Does not need to be an integer			   |		REAL*8 TIME_SEQ_NO              !Does not need to be an integer
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) HU(ND)										   |		REAL*8 HU(ND)
	REAL(10) HL(ND)										   |		REAL*8 HL(ND)
	REAL(10) HT(ND)										   |		REAL*8 HT(ND)
	REAL(10) JFAC(ND)									   |		REAL*8 JFAC(ND)
	REAL(10) JT(ND)										   |		REAL*8 JT(ND)
	REAL(10) WMID(ND)									   |		REAL*8 WMID(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI_MOD(ND)									   |		REAL*8 CHI_MOD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) dCHI_MODdR(ND)									   |		REAL*8 dCHI_MODdR(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) VU(ND)										   |		REAL*8 VU(ND)
	REAL(10) CV(ND)										   |		REAL*8 CV(ND)
	REAL(10) AVE_DTAU_ON_Q(ND)								   |		REAL*8 AVE_DTAU_ON_Q(ND)
	REAL(10) RAD_DECAY_TERM(ND)								   |		REAL*8 RAD_DECAY_TERM(ND)
	REAL(10) E_RAD_DECAY(ND)								   |		REAL*8 E_RAD_DECAY(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) T_FROM_J(ND)									   |		REAL*8 T_FROM_J(ND)
	REAL(10) TSTORE(ND)									   |		REAL*8 TSTORE(ND)
	REAL(10) RSQ_J_OLDT(ND)									   |		REAL*8 RSQ_J_OLDT(ND)
	REAL(10) RSQ_H_OLDT(ND)									   |		REAL*8 RSQ_H_OLDT(ND)
	REAL(10) FS_RSQJ(ND)									   |		REAL*8 FS_RSQJ(ND)
	REAL(10) FS_RSQH(ND)									   |		REAL*8 FS_RSQH(ND)
	REAL(10) FS_RSQK(ND)									   |		REAL*8 FS_RSQK(ND)
!												   |	!
	REAL(10) H_OUTBC		!Eddington factor for H at outer boundary.		   |		REAL*8 H_OUTBC		!Eddington factor for H at outer boundary.
	REAL(10) H_INBC										   |		REAL*8 H_INBC
	REAL(10) H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).	   |		REAL*8 H_OUTBC_OLDT	!Eddington factor for H at outer boundary (prev. time step).
	REAL(10) H_INBC_OLDT									   |		REAL*8 H_INBC_OLDT
	REAL(10) DTAU_INB_SAVE									   |		REAL*8 DTAU_INB_SAVE
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) REDUCTION_FACTOR								   |		REAL*8 REDUCTION_FACTOR
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)						   |		    DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./plane/j_weight.f
      REAL(10) :: a,sum,check									   |	      real*8 :: a,sum,check
      REAL(10), dimension(nw) :: temp								   |	      real*8, dimension(nw) :: temp
      REAL(10), dimension(nw) :: angle								   |	      real*8, dimension(nw) :: angle
./plane/k_weight.f
      REAL(10) :: a1,a2,sum,check								   |	      real*8 :: a1,a2,sum,check
      REAL(10), dimension(nw) :: temp(nw)							   |	      real*8, dimension(nw) :: temp(nw)
      REAL(10), dimension(nw) :: angle								   |	      real*8, dimension(nw) :: angle
./plane/mod_ray_mom_store.f
	REAL(10), ALLOCATABLE :: R_STORE(:)							   |		REAL*8, ALLOCATABLE :: R_STORE(:)
	REAL(10), ALLOCATABLE :: RMID_STORE(:) 							   |		REAL*8, ALLOCATABLE :: RMID_STORE(:) 
	REAL(10), ALLOCATABLE :: EXT_RMID_STORE(:) 						   |		REAL*8, ALLOCATABLE :: EXT_RMID_STORE(:) 
	REAL(10), ALLOCATABLE :: JNU_STORE(:)							   |		REAL*8, ALLOCATABLE :: JNU_STORE(:)
	REAL(10), ALLOCATABLE :: HNU_STORE(:)							   |		REAL*8, ALLOCATABLE :: HNU_STORE(:)
	REAL(10), ALLOCATABLE :: NNU_STORE(:)							   |		REAL*8, ALLOCATABLE :: NNU_STORE(:)
	REAL(10), ALLOCATABLE :: KNU_STORE(:)							   |		REAL*8, ALLOCATABLE :: KNU_STORE(:)
	REAL(10), ALLOCATABLE :: GAM_REL_STORE(:)						   |		REAL*8, ALLOCATABLE :: GAM_REL_STORE(:)
	REAL(10) JPLUS_IB,JMIN_IB								   |		REAL*8 JPLUS_IB,JMIN_IB
	REAL(10) HPLUS_IB,HMIN_IB								   |		REAL*8 HPLUS_IB,HMIN_IB
	REAL(10) KPLUS_IB,KMIN_IB								   |		REAL*8 KPLUS_IB,KMIN_IB
	REAL(10) NPLUS_IB,NMIN_IB								   |		REAL*8 NPLUS_IB,NMIN_IB
	REAL(10) JPLUS_OB,JMIN_OB								   |		REAL*8 JPLUS_OB,JMIN_OB
	REAL(10) HPLUS_OB,HMIN_OB								   |		REAL*8 HPLUS_OB,HMIN_OB
	REAL(10) KPLUS_OB,KMIN_OB								   |		REAL*8 KPLUS_OB,KMIN_OB
	REAL(10) NPLUS_OB,NMIN_OB								   |		REAL*8 NPLUS_OB,NMIN_OB
!												   |	!
	REAL(10) HNU_AT_OB, NNU_AT_OB								   |		REAL*8 HNU_AT_OB, NNU_AT_OB
	REAL(10) HNU_AT_IB, NNU_AT_IB								   |		REAL*8 HNU_AT_IB, NNU_AT_IB
	REAL(10) HNU_AT_OB_PREV, NNU_AT_OB_PREV							   |		REAL*8 HNU_AT_OB_PREV, NNU_AT_OB_PREV
	REAL(10) HNU_AT_IB_PREV, NNU_AT_IB_PREV							   |		REAL*8 HNU_AT_IB_PREV, NNU_AT_IB_PREV
!												   |	!
	REAL(10) HBC,HBC_PREV,HBC_SAVE								   |		REAL*8 HBC,HBC_PREV,HBC_SAVE
	REAL(10) NBC,NBC_PREV,NBC_SAVE								   |		REAL*8 NBC,NBC_PREV,NBC_SAVE
	REAL(10) IN_HBC,IN_HBC_PREV,IN_HBC_SAVE							   |		REAL*8 IN_HBC,IN_HBC_PREV,IN_HBC_SAVE
!												   |	!
	REAL(10), ALLOCATABLE :: RMID(:)							   |		REAL*8, ALLOCATABLE :: RMID(:)
	REAL(10), ALLOCATABLE :: H_ON_J(:)							   |		REAL*8, ALLOCATABLE :: H_ON_J(:)
	REAL(10), ALLOCATABLE :: N_ON_J(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J(:)
	REAL(10), ALLOCATABLE :: K_ON_J(:)							   |		REAL*8, ALLOCATABLE :: K_ON_J(:)
	REAL(10), ALLOCATABLE :: KMID_ON_J(:)							   |		REAL*8, ALLOCATABLE :: KMID_ON_J(:)
	REAL(10), ALLOCATABLE :: NMID_ON_J(:)							   |		REAL*8, ALLOCATABLE :: NMID_ON_J(:)
	REAL(10), ALLOCATABLE :: NMID_ON_HMID(:)						   |		REAL*8, ALLOCATABLE :: NMID_ON_HMID(:)
	REAL(10), ALLOCATABLE :: dlnGRSQJdlnR(:)						   |		REAL*8, ALLOCATABLE :: dlnGRSQJdlnR(:)
!												   |	!
	REAL(10), ALLOCATABLE :: H_ON_J_PREV(:)							   |		REAL*8, ALLOCATABLE :: H_ON_J_PREV(:)
	REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)
	REAL(10), ALLOCATABLE :: K_ON_J_PREV(:)							   |		REAL*8, ALLOCATABLE :: K_ON_J_PREV(:)
	REAL(10), ALLOCATABLE :: KMID_ON_J_PREV(:)						   |		REAL*8, ALLOCATABLE :: KMID_ON_J_PREV(:)
	REAL(10), ALLOCATABLE :: NMID_ON_J_PREV(:)						   |		REAL*8, ALLOCATABLE :: NMID_ON_J_PREV(:)
	REAL(10), ALLOCATABLE :: NMID_ON_HMID_PREV(:)						   |		REAL*8, ALLOCATABLE :: NMID_ON_HMID_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: H_ON_J_SAVE(:)							   |		REAL*8, ALLOCATABLE :: H_ON_J_SAVE(:)
	REAL(10), ALLOCATABLE :: N_ON_J_SAVE(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J_SAVE(:)
	REAL(10), ALLOCATABLE :: K_ON_J_SAVE(:)							   |		REAL*8, ALLOCATABLE :: K_ON_J_SAVE(:)
	REAL(10), ALLOCATABLE :: KMID_ON_J_SAVE(:)						   |		REAL*8, ALLOCATABLE :: KMID_ON_J_SAVE(:)
	REAL(10), ALLOCATABLE :: NMID_ON_J_SAVE(:)						   |		REAL*8, ALLOCATABLE :: NMID_ON_J_SAVE(:)
	REAL(10), ALLOCATABLE :: NMID_ON_HMID_SAVE(:)						   |		REAL*8, ALLOCATABLE :: NMID_ON_HMID_SAVE(:)
./plane/mod_space_grid_v2.f
	  REAL(10), ALLOCATABLE :: MU(:)							   |		  REAL*8, ALLOCATABLE :: MU(:)
	  REAL(10), ALLOCATABLE :: Z(:)								   |		  REAL*8, ALLOCATABLE :: Z(:)
	  REAL(10), ALLOCATABLE :: R_RAY(:)							   |		  REAL*8, ALLOCATABLE :: R_RAY(:)
	  REAL(10), ALLOCATABLE :: S_P(:)                    !Path Length in positive direction	   |		  REAL*8, ALLOCATABLE :: S_P(:)                    !Path Length in positive direction
	  REAL(10), ALLOCATABLE :: S_M(:)                    !Path Length in negative direction	   |		  REAL*8, ALLOCATABLE :: S_M(:)                    !Path Length in negative direction
	  REAL(10), ALLOCATABLE :: MU_P(:)                   !Angle [cos(theta)] in positive dir   |		  REAL*8, ALLOCATABLE :: MU_P(:)                   !Angle [cos(theta)] in positive direc
	  REAL(10), ALLOCATABLE :: MU_M(:)                   !Angle [cos(theta)] in negative dir   |		  REAL*8, ALLOCATABLE :: MU_M(:)                   !Angle [cos(theta)] in negative direc
	  REAL(10), ALLOCATABLE :: B_P(:)                    !positive direction		   |		  REAL*8, ALLOCATABLE :: B_P(:)                    !positive direction
	  REAL(10), ALLOCATABLE :: B_M(:)                    !negative direction		   |		  REAL*8, ALLOCATABLE :: B_M(:)                    !negative direction
	  REAL(10), ALLOCATABLE :: I_P(:)							   |		  REAL*8, ALLOCATABLE :: I_P(:)
	  REAL(10), ALLOCATABLE :: I_P_PREV(:)							   |		  REAL*8, ALLOCATABLE :: I_P_PREV(:)
	  REAL(10), ALLOCATABLE :: I_P_SAVE(:)							   |		  REAL*8, ALLOCATABLE :: I_P_SAVE(:)
	  REAL(10), ALLOCATABLE :: I_M(:)							   |		  REAL*8, ALLOCATABLE :: I_M(:)
	  REAL(10), ALLOCATABLE :: I_M_PREV(:)							   |		  REAL*8, ALLOCATABLE :: I_M_PREV(:)
	  REAL(10), ALLOCATABLE :: I_M_SAVE(:)							   |		  REAL*8, ALLOCATABLE :: I_M_SAVE(:)
	  REAL(10), ALLOCATABLE :: I_IN_BND_STORE(:) 						   |		  REAL*8, ALLOCATABLE :: I_IN_BND_STORE(:) 
	  REAL(10) P_RAY				      	!P for ray			   |		  REAL*8 P_RAY				      	!P for ray
	  REAL(10) FREQ_CONV_FAC				!Frequency conversion factor for   |		  REAL*8 FREQ_CONV_FAC				!Frequency conversion factor for hollow 
	REAL(10), ALLOCATABLE :: TAU(:)								   |		REAL*8, ALLOCATABLE :: TAU(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: I_P_GRID(:)							   |		REAL*8, ALLOCATABLE :: I_P_GRID(:)
	REAL(10), ALLOCATABLE :: I_M_GRID(:)							   |		REAL*8, ALLOCATABLE :: I_M_GRID(:)
	REAL(10), ALLOCATABLE :: JQW_P(:,:)                  !Positive mu			   |		REAL*8, ALLOCATABLE :: JQW_P(:,:)                  !Positive mu
	REAL(10), ALLOCATABLE :: HQW_P(:,:)							   |		REAL*8, ALLOCATABLE :: HQW_P(:,:)
	REAL(10), ALLOCATABLE :: KQW_P(:,:)							   |		REAL*8, ALLOCATABLE :: KQW_P(:,:)
	REAL(10), ALLOCATABLE :: NQW_P(:,:)							   |		REAL*8, ALLOCATABLE :: NQW_P(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: JQW_M(:,:)                  !NEGATIVE MU			   |		REAL*8, ALLOCATABLE :: JQW_M(:,:)                  !NEGATIVE MU
	REAL(10), ALLOCATABLE :: HQW_M(:,:)							   |		REAL*8, ALLOCATABLE :: HQW_M(:,:)
	REAL(10), ALLOCATABLE :: KQW_M(:,:)							   |		REAL*8, ALLOCATABLE :: KQW_M(:,:)
	REAL(10), ALLOCATABLE :: NQW_M(:,:)							   |		REAL*8, ALLOCATABLE :: NQW_M(:,:)
	REAL(10), ALLOCATABLE :: R_EXT_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_EXT_SAV(:)
	REAL(10), ALLOCATABLE :: FREQ_STORE(:)							   |		REAL*8, ALLOCATABLE :: FREQ_STORE(:)
./plane/mod_space_grid_v2_gam.f
	  REAL(10), ALLOCATABLE :: MU(:)							   |		  REAL*8, ALLOCATABLE :: MU(:)
	  REAL(10), ALLOCATABLE :: Z(:)								   |		  REAL*8, ALLOCATABLE :: Z(:)
	  REAL(10), ALLOCATABLE :: R_RAY(:)							   |		  REAL*8, ALLOCATABLE :: R_RAY(:)
	  REAL(10), ALLOCATABLE :: S_P(:)                    !Path Length in positive direction	   |		  REAL*8, ALLOCATABLE :: S_P(:)                    !Path Length in positive direction
	  REAL(10), ALLOCATABLE :: S_M(:)                    !Path Length in negative direction	   |		  REAL*8, ALLOCATABLE :: S_M(:)                    !Path Length in negative direction
	  REAL(10), ALLOCATABLE :: MU_P(:)                   !Angle [cos(theta)] in positive dir   |		  REAL*8, ALLOCATABLE :: MU_P(:)                   !Angle [cos(theta)] in positive direc
	  REAL(10), ALLOCATABLE :: MU_M(:)                   !Angle [cos(theta)] in negative dir   |		  REAL*8, ALLOCATABLE :: MU_M(:)                   !Angle [cos(theta)] in negative direc
	  REAL(10), ALLOCATABLE :: B_P(:)                    !positive direction		   |		  REAL*8, ALLOCATABLE :: B_P(:)                    !positive direction
	  REAL(10), ALLOCATABLE :: B_M(:)                    !negative direction		   |		  REAL*8, ALLOCATABLE :: B_M(:)                    !negative direction
	  REAL(10), ALLOCATABLE :: I_P(:)							   |		  REAL*8, ALLOCATABLE :: I_P(:)
	  REAL(10), ALLOCATABLE :: I_P_PREV(:)							   |		  REAL*8, ALLOCATABLE :: I_P_PREV(:)
	  REAL(10), ALLOCATABLE :: I_P_SAVE(:)							   |		  REAL*8, ALLOCATABLE :: I_P_SAVE(:)
	  REAL(10), ALLOCATABLE :: I_M(:)							   |		  REAL*8, ALLOCATABLE :: I_M(:)
	  REAL(10), ALLOCATABLE :: I_M_PREV(:)							   |		  REAL*8, ALLOCATABLE :: I_M_PREV(:)
	  REAL(10), ALLOCATABLE :: I_M_SAVE(:)							   |		  REAL*8, ALLOCATABLE :: I_M_SAVE(:)
	  REAL(10), ALLOCATABLE :: ETA_M(:)							   |		  REAL*8, ALLOCATABLE :: ETA_M(:)
	  REAL(10), ALLOCATABLE :: ETA_P(:)							   |		  REAL*8, ALLOCATABLE :: ETA_P(:)
	  REAL(10), ALLOCATABLE :: I_IN_BND_STORE(:) 						   |		  REAL*8, ALLOCATABLE :: I_IN_BND_STORE(:) 
	  REAL(10) P_RAY				      	!P for ray			   |		  REAL*8 P_RAY				      	!P for ray
	  REAL(10) FREQ_CONV_FAC				!Frequency conversion factor for   |		  REAL*8 FREQ_CONV_FAC				!Frequency conversion factor for hollow 
!	  REAL(10), ALLOCATABLE :: Z_SM(:)							   |	!	  REAL*8, ALLOCATABLE :: Z_SM(:)
!	  REAL(10), ALLOCATABLE :: Z_LG(:)							   |	!	  REAL*8, ALLOCATABLE :: Z_LG(:)
	REAL(10), ALLOCATABLE :: TAU(:)								   |		REAL*8, ALLOCATABLE :: TAU(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: I_P_GRID(:)							   |		REAL*8, ALLOCATABLE :: I_P_GRID(:)
	REAL(10), ALLOCATABLE :: I_M_GRID(:)							   |		REAL*8, ALLOCATABLE :: I_M_GRID(:)
	REAL(10), ALLOCATABLE :: JQW_P(:,:)                  !Positive mu			   |		REAL*8, ALLOCATABLE :: JQW_P(:,:)                  !Positive mu
	REAL(10), ALLOCATABLE :: HQW_P(:,:)							   |		REAL*8, ALLOCATABLE :: HQW_P(:,:)
	REAL(10), ALLOCATABLE :: KQW_P(:,:)							   |		REAL*8, ALLOCATABLE :: KQW_P(:,:)
	REAL(10), ALLOCATABLE :: NQW_P(:,:)							   |		REAL*8, ALLOCATABLE :: NQW_P(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: JQW_M(:,:)                  !NEGATIVE MU			   |		REAL*8, ALLOCATABLE :: JQW_M(:,:)                  !NEGATIVE MU
	REAL(10), ALLOCATABLE :: HQW_M(:,:)							   |		REAL*8, ALLOCATABLE :: HQW_M(:,:)
	REAL(10), ALLOCATABLE :: KQW_M(:,:)							   |		REAL*8, ALLOCATABLE :: KQW_M(:,:)
	REAL(10), ALLOCATABLE :: NQW_M(:,:)							   |		REAL*8, ALLOCATABLE :: NQW_M(:,:)
	REAL(10), ALLOCATABLE :: R_EXT_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_EXT_SAV(:)
	REAL(10), ALLOCATABLE :: FREQ_STORE(:)							   |		REAL*8, ALLOCATABLE :: FREQ_STORE(:)
./plane/mod_var_jrel.f
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_RSQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: FEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: FEDD_PREV(:)
        REAL(10), ALLOCATABLE :: GEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: GEDD_PREV(:)
        REAL(10), ALLOCATABLE :: H_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: H_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)						   |	        REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)
        REAL(10), ALLOCATABLE :: KMID_ON_J_PREV(:)						   |	        REAL*8, ALLOCATABLE :: KMID_ON_J_PREV(:)
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: JNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:)						   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:)
	REAL(10), ALLOCATABLE :: GAM_RSQ_DTAUONQ(:)						   |		REAL*8, ALLOCATABLE :: GAM_RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:)							   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:)						   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:)
	REAL(10), ALLOCATABLE :: W(:),WPREV(:)							   |		REAL*8, ALLOCATABLE :: W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:),PSIPREV_MOD(:)				   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:),PSIPREV_MOD(:)
	REAL(10), ALLOCATABLE :: EPS_A(:),EPS_B(:)						   |		REAL*8, ALLOCATABLE :: EPS_A(:),EPS_B(:)
	REAL(10), ALLOCATABLE :: EPS_PREV_A(:),EPS_PREV_B(:)					   |		REAL*8, ALLOCATABLE :: EPS_PREV_A(:),EPS_PREV_B(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: TA_SAV(:),TB_SAV(:),TC_SAV(:),XM_SAV(:)			   |		REAL*8, ALLOCATABLE :: TA_SAV(:),TB_SAV(:),TC_SAV(:),XM_SAV(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: dTAUdCHI_H(:,:)						   |		REAL*8, ALLOCATABLE :: dTAUdCHI_H(:,:)
	REAL(10), ALLOCATABLE :: dTAUdCHI_J(:,:)						   |		REAL*8, ALLOCATABLE :: dTAUdCHI_J(:,:)
	REAL(10), ALLOCATABLE :: dHUdCHI(:)							   |		REAL*8, ALLOCATABLE :: dHUdCHI(:)
	REAL(10), ALLOCATABLE :: dHLdCHI(:)							   |		REAL*8, ALLOCATABLE :: dHLdCHI(:)
	REAL(10), ALLOCATABLE :: dHSdCHI(:)							   |		REAL*8, ALLOCATABLE :: dHSdCHI(:)
	REAL(10), ALLOCATABLE :: dHUdTAU(:)							   |		REAL*8, ALLOCATABLE :: dHUdTAU(:)
	REAL(10), ALLOCATABLE :: dHLdTAU(:)							   |		REAL*8, ALLOCATABLE :: dHLdTAU(:)
	REAL(10), ALLOCATABLE :: EPS_FAC(:)							   |		REAL*8, ALLOCATABLE :: EPS_FAC(:)
	REAL(10), ALLOCATABLE :: dRHSdI(:)							   |		REAL*8, ALLOCATABLE :: dRHSdI(:)
	REAL(10), ALLOCATABLE :: dRHSdJ(:)							   |		REAL*8, ALLOCATABLE :: dRHSdJ(:)
!												   |	!
	REAL(10) HBC_PREV									   |		REAL*8 HBC_PREV
	REAL(10) NBC_PREV									   |		REAL*8 NBC_PREV
	REAL(10) IN_HBC_PREV									   |		REAL*8 IN_HBC_PREV
./plane/mod_var_jrel_v2.f
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_RSQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: JNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:)						   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:)
	REAL(10), ALLOCATABLE :: GAM_RSQ_DTAUONQ(:)						   |		REAL*8, ALLOCATABLE :: GAM_RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:)							   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:)						   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:)
	REAL(10), ALLOCATABLE :: W(:),WPREV(:)							   |		REAL*8, ALLOCATABLE :: W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:),PSIPREV_MOD(:)				   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:),PSIPREV_MOD(:)
	REAL(10), ALLOCATABLE :: EPS_A(:),EPS_B(:)						   |		REAL*8, ALLOCATABLE :: EPS_A(:),EPS_B(:)
	REAL(10), ALLOCATABLE :: EPS_PREV_A(:),EPS_PREV_B(:)					   |		REAL*8, ALLOCATABLE :: EPS_PREV_A(:),EPS_PREV_B(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: TA_SAV(:),TB_SAV(:),TC_SAV(:),XM_SAV(:)			   |		REAL*8, ALLOCATABLE :: TA_SAV(:),TB_SAV(:),TC_SAV(:),XM_SAV(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: dTAUdCHI_H(:,:)						   |		REAL*8, ALLOCATABLE :: dTAUdCHI_H(:,:)
	REAL(10), ALLOCATABLE :: dTAUdCHI_J(:,:)						   |		REAL*8, ALLOCATABLE :: dTAUdCHI_J(:,:)
	REAL(10), ALLOCATABLE :: dHUdCHI(:)							   |		REAL*8, ALLOCATABLE :: dHUdCHI(:)
	REAL(10), ALLOCATABLE :: dHLdCHI(:)							   |		REAL*8, ALLOCATABLE :: dHLdCHI(:)
	REAL(10), ALLOCATABLE :: dHSdCHI(:)							   |		REAL*8, ALLOCATABLE :: dHSdCHI(:)
	REAL(10), ALLOCATABLE :: dHUdTAU(:)							   |		REAL*8, ALLOCATABLE :: dHUdTAU(:)
	REAL(10), ALLOCATABLE :: dHLdTAU(:)							   |		REAL*8, ALLOCATABLE :: dHLdTAU(:)
	REAL(10), ALLOCATABLE :: EPS_FAC(:)							   |		REAL*8, ALLOCATABLE :: EPS_FAC(:)
	REAL(10), ALLOCATABLE :: dRHSdI(:)							   |		REAL*8, ALLOCATABLE :: dRHSdI(:)
	REAL(10), ALLOCATABLE :: dRHSdJ(:)							   |		REAL*8, ALLOCATABLE :: dRHSdJ(:)
	REAL(10), ALLOCATABLE :: DERIV_SCL_FAC(:)						   |		REAL*8, ALLOCATABLE :: DERIV_SCL_FAC(:)
./plane/mod_var_mom_j_cmf.f
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: RSQ_DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNU(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV_MOD(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV_MOD(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS_A(:)							   |		REAL*8, ALLOCATABLE :: EPS_A(:)
	REAL(10), ALLOCATABLE :: EPS_B(:)							   |		REAL*8, ALLOCATABLE :: EPS_B(:)
	REAL(10), ALLOCATABLE :: EPS_PREV_A(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV_A(:)
	REAL(10), ALLOCATABLE :: EPS_PREV_B(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV_B(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: RSQ_HNUM1(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNUM1(:)
./plane/mom_j_cmf_v10.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:)								   |		REAL*8, ALLOCATABLE :: EPS(:)
	REAL(10), ALLOCATABLE :: EPS_PREV(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV(:)
	REAL(10) VDOP_FRAC_SAVE									   |		REAL*8 VDOP_FRAC_SAVE
	1                  FREQ,LOG_NU,								   |		1                  FREQ,dLOG_NU,
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)					   |		REAL*8 V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)
	REAL(10) JNU(ND_SM),RSQHNU_SM(ND_SM)							   |		REAL*8 JNU(ND_SM),RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM),VDOP_FRAC							   |		REAL*8 VDOP_VEC(ND_SM),VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) DBB,IC,FREQ,LOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=CON_GAM(I)/CHI(I)/LOG_NU							   |		    GAM(I)=CON_GAM(I)/CHI(I)/dLOG_NU
./plane/mom_j_cmf_v11.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: XM_SAVE(:)							   |		REAL*8, ALLOCATABLE :: XM_SAVE(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:)								   |		REAL*8, ALLOCATABLE :: EPS(:)
	REAL(10), ALLOCATABLE :: EPS_PREV(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV(:)
	REAL(10) VDOP_FRAC_SAVE									   |		REAL*8 VDOP_FRAC_SAVE
	1                  FREQ,LOG_NU,								   |		1                  FREQ,dLOG_NU,
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)					   |		REAL*8 V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)
	REAL(10) JNU(ND_SM),RSQHNU_SM(ND_SM)							   |		REAL*8 JNU(ND_SM),RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM),VDOP_FRAC							   |		REAL*8 VDOP_VEC(ND_SM),VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) DBB,IC,FREQ,LOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=CON_GAM(I)/CHI(I)/LOG_NU							   |		    GAM(I)=CON_GAM(I)/CHI(I)/dLOG_NU
./plane/mom_j_cmf_v8.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:)								   |		REAL*8, ALLOCATABLE :: EPS(:)
	REAL(10), ALLOCATABLE :: EPS_PREV(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV(:)
	REAL(10) VDOP_FRAC_SAVE									   |		REAL*8 VDOP_FRAC_SAVE
	1                  FREQ,LOG_NU,DIF,DBB,IC,						   |		1                  FREQ,dLOG_NU,DIF,DBB,IC,
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)					   |		REAL*8 V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)
	REAL(10) JNU(ND_SM),RSQHNU_SM(ND_SM)							   |		REAL*8 JNU(ND_SM),RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM),VDOP_FRAC							   |		REAL*8 VDOP_VEC(ND_SM),VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) DBB,IC,FREQ,LOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=CON_GAM(I)/CHI(I)/LOG_NU							   |		    GAM(I)=CON_GAM(I)/CHI(I)/dLOG_NU
./plane/mom_j_cmf_v9.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:)								   |		REAL*8, ALLOCATABLE :: EPS(:)
	REAL(10), ALLOCATABLE :: EPS_PREV(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV(:)
	REAL(10) VDOP_FRAC_SAVE									   |		REAL*8 VDOP_FRAC_SAVE
	1                  FREQ,LOG_NU,DIF,DBB,IC,						   |		1                  FREQ,dLOG_NU,DIF,DBB,IC,
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)					   |		REAL*8 V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)
	REAL(10) JNU(ND_SM),RSQHNU_SM(ND_SM)							   |		REAL*8 JNU(ND_SM),RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM),VDOP_FRAC							   |		REAL*8 VDOP_VEC(ND_SM),VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) DBB,IC,FREQ,LOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=CON_GAM(I)/CHI(I)/LOG_NU							   |		    GAM(I)=CON_GAM(I)/CHI(I)/dLOG_NU
./plane/mom_j_ddt_v1.f
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQJNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_OLDT(:)
	REAL(10), ALLOCATABLE :: RSQHNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
!												   |	!
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: DJDT(:)							   |		REAL*8, ALLOCATABLE :: DJDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
        REAL(10) HONJ_OUTBC_PREV								   |	        REAL*8 HONJ_OUTBC_PREV
	REAL(10) HFLUX_AT_INB_PREV								   |		REAL*8 HFLUX_AT_INB_PREV
	REAL(10) HONJ_OUTBC_SAV									   |		REAL*8 HONJ_OUTBC_SAV
	REAL(10) HFLUX_AT_INB_SAV								   |		REAL*8 HFLUX_AT_INB_SAV
	REAL(10) HFLUX_AT_INB_OLDT								   |		REAL*8 HFLUX_AT_INB_OLDT
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
!												   |	!
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10), ALLOCATABLE :: R_SM_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_SM_SAV(:)
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	1                  FREQ,LOG_NU,DIF,DBB,IC,						   |		1                  FREQ,dLOG_NU,DIF,DBB,IC,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) DJDt_TERM(ND_SM)								   |		REAL*8 DJDt_TERM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) HFLUX_AT_INB									   |		REAL*8 HFLUX_AT_INB
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	    GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		    GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	  GAM(:)=CON_GAM(:)/CHI(:)/LOG_NU							   |		  GAM(:)=CON_GAM(:)/CHI(:)/dLOG_NU
	1        V(I)*(XM(I)-RSQJNU_PREV(I))/R(I)/LOG_NU/C_KMS/T2,				   |		1        V(I)*(XM(I)-RSQJNU_PREV(I))/R(I)/dLOG_NU/C_KMS/T2,
	1        V(I)*(XM(I)-RSQJNU_PREV(I))/R(I)/LOG_NU/C_KMS/CHI(I)/T2,			   |		1        V(I)*(XM(I)-RSQJNU_PREV(I))/R(I)/dLOG_NU/C_KMS/CHI(I)/T2,
./plane/mom_j_ddt_v2.f
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQJNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_OLDT(:)
	REAL(10), ALLOCATABLE :: RSQHNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
!												   |	!
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: DJDT(:)							   |		REAL*8, ALLOCATABLE :: DJDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
        REAL(10) HONJ_OUTBC_PREV								   |	        REAL*8 HONJ_OUTBC_PREV
	REAL(10) RSQH_AT_OB_PREV								   |		REAL*8 RSQH_AT_OB_PREV
	REAL(10) RSQH_AT_OB_SAV									   |		REAL*8 RSQH_AT_OB_SAV
	REAL(10) HONJ_OUTBC_SAV									   |		REAL*8 HONJ_OUTBC_SAV
!												   |	!
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
	REAL(10) RSQH_AT_IB_SAV									   |		REAL*8 RSQH_AT_IB_SAV
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
!												   |	!
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10), ALLOCATABLE :: R_SM_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_SM_SAV(:)
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	1            VDOP_VEC,VDOP_FRAC,FREQ,LOG_NU,DBB,					   |		1            VDOP_VEC,VDOP_FRAC,FREQ,dLOG_NU,DBB,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) DJDt_TERM(ND_SM)								   |		REAL*8 DJDt_TERM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) HPLUS,HMIN									   |		REAL*8 HPLUS,HMIN
	REAL(10) FMIN,FPLUS									   |		REAL*8 FMIN,FPLUS
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	    GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		    GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	  GAM(:)=CON_GAM(:)/CHI(:)/LOG_NU							   |		  GAM(:)=CON_GAM(:)/CHI(:)/dLOG_NU
./plane/mom_j_ddt_v3.f
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQJNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_OLDT(:)
	REAL(10), ALLOCATABLE :: RSQHNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
!												   |	!
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: DJDT(:)							   |		REAL*8, ALLOCATABLE :: DJDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
        REAL(10) HONJ_OUTBC_PREV								   |	        REAL*8 HONJ_OUTBC_PREV
	REAL(10) RSQH_AT_OB_PREV								   |		REAL*8 RSQH_AT_OB_PREV
	REAL(10) RSQH_AT_OB_SAV									   |		REAL*8 RSQH_AT_OB_SAV
	REAL(10) HONJ_OUTBC_SAV									   |		REAL*8 HONJ_OUTBC_SAV
!												   |	!
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
	REAL(10) RSQH_AT_IB_SAV									   |		REAL*8 RSQH_AT_IB_SAV
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
!												   |	!
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_RAT_FOR_J									   |		REAL*8 R_RAT_FOR_J
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10), ALLOCATABLE :: R_SM_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_SM_SAV(:)
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	1            VDOP_VEC,VDOP_FRAC,FREQ,LOG_NU,DBB,					   |		1            VDOP_VEC,VDOP_FRAC,FREQ,dLOG_NU,DBB,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) DJDt_TERM(ND_SM)								   |		REAL*8 DJDt_TERM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) HPLUS,HMIN									   |		REAL*8 HPLUS,HMIN
	REAL(10) FMIN,FPLUS									   |		REAL*8 FMIN,FPLUS
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	    GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		    GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	  GAM(:)=CON_GAM(:)/CHI(:)/LOG_NU							   |		  GAM(:)=CON_GAM(:)/CHI(:)/dLOG_NU
./plane/mom_j_ddt_v4.f
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQJNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_OLDT(:)
	REAL(10), ALLOCATABLE :: RSQHNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
!												   |	!
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: DJDT(:)							   |		REAL*8, ALLOCATABLE :: DJDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
        REAL(10) HONJ_OUTBC_PREV								   |	        REAL*8 HONJ_OUTBC_PREV
	REAL(10) RSQH_AT_OB_PREV								   |		REAL*8 RSQH_AT_OB_PREV
	REAL(10) RSQH_AT_OB_SAV									   |		REAL*8 RSQH_AT_OB_SAV
	REAL(10) HONJ_OUTBC_SAV									   |		REAL*8 HONJ_OUTBC_SAV
!												   |	!
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
	REAL(10) RSQH_AT_IB_SAV									   |		REAL*8 RSQH_AT_IB_SAV
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
!												   |	!
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_RAT_FOR_J									   |		REAL*8 R_RAT_FOR_J
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10), ALLOCATABLE :: R_SM_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_SM_SAV(:)
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	1            VDOP_VEC,VDOP_FRAC,FREQ,LOG_NU,DBB,					   |		1            VDOP_VEC,VDOP_FRAC,FREQ,dLOG_NU,DBB,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) DJDt_TERM(ND_SM)								   |		REAL*8 DJDt_TERM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) HPLUS,HMIN									   |		REAL*8 HPLUS,HMIN
	REAL(10) FMIN,FPLUS									   |		REAL*8 FMIN,FPLUS
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	    GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		    GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	  GAM(:)=CON_GAM(:)/CHI(:)/LOG_NU							   |		  GAM(:)=CON_GAM(:)/CHI(:)/dLOG_NU
./plane/mom_j_ddt_v5.f
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQJNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_OLDT(:)
	REAL(10), ALLOCATABLE :: RSQHNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
!												   |	!
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: DJDT(:)							   |		REAL*8, ALLOCATABLE :: DJDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: XM_SAV(:)							   |		REAL*8, ALLOCATABLE :: XM_SAV(:)
        REAL(10) HONJ_OUTBC_PREV								   |	        REAL*8 HONJ_OUTBC_PREV
	REAL(10) RSQH_AT_OB_PREV								   |		REAL*8 RSQH_AT_OB_PREV
	REAL(10) RSQH_AT_OB_SAV									   |		REAL*8 RSQH_AT_OB_SAV
	REAL(10) HONJ_OUTBC_SAV									   |		REAL*8 HONJ_OUTBC_SAV
!												   |	!
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
	REAL(10) RSQH_AT_IB_SAV									   |		REAL*8 RSQH_AT_IB_SAV
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
!												   |	!
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_RAT_FOR_J									   |		REAL*8 R_RAT_FOR_J
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10), ALLOCATABLE :: R_SM_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_SM_SAV(:)
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	1            VDOP_VEC,VDOP_FRAC,FREQ,LOG_NU,DBB,					   |		1            VDOP_VEC,VDOP_FRAC,FREQ,dLOG_NU,DBB,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) DJDt_TERM(ND_SM)								   |		REAL*8 DJDt_TERM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) HPLUS,HMIN									   |		REAL*8 HPLUS,HMIN
	REAL(10) FMIN,FPLUS									   |		REAL*8 FMIN,FPLUS
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	    GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		    GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	  GAM(:)=CON_GAM(:)/CHI(:)/LOG_NU							   |		  GAM(:)=CON_GAM(:)/CHI(:)/dLOG_NU
./plane/mom_j_ddt_v6.f
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQJNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_OLDT(:)
	REAL(10), ALLOCATABLE :: RSQHNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
!												   |	!
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: DJDT(:)							   |		REAL*8, ALLOCATABLE :: DJDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: XM_SAV(:)							   |		REAL*8, ALLOCATABLE :: XM_SAV(:)
        REAL(10) HONJ_OUTBC_PREV								   |	        REAL*8 HONJ_OUTBC_PREV
	REAL(10) RSQH_AT_OB_PREV								   |		REAL*8 RSQH_AT_OB_PREV
	REAL(10) RSQH_AT_OB_SAV									   |		REAL*8 RSQH_AT_OB_SAV
	REAL(10) HONJ_OUTBC_SAV									   |		REAL*8 HONJ_OUTBC_SAV
!												   |	!
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
	REAL(10) RSQH_AT_IB_SAV									   |		REAL*8 RSQH_AT_IB_SAV
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
!												   |	!
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_RAT_FOR_J									   |		REAL*8 R_RAT_FOR_J
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10), ALLOCATABLE :: R_SM_SAV(:)							   |		REAL*8, ALLOCATABLE :: R_SM_SAV(:)
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	1            VDOP_VEC,VDOP_FRAC,FREQ,LOG_NU,DBB,					   |		1            VDOP_VEC,VDOP_FRAC,FREQ,dLOG_NU,DBB,
												   >	! Altered: 20-Aug-2023 : Fixed out-of bound issue with MOM_ERR_ON_FREQ in first error.
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) DJDt_TERM(ND_SM)								   |		REAL*8 DJDt_TERM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) GET_RSQJ_FROM_J								   |		REAL*8 GET_RSQJ_FROM_J
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) HPLUS,HMIN									   |		REAL*8 HPLUS,HMIN
	REAL(10) FMIN,FPLUS									   |		REAL*8 FMIN,FPLUS
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	    GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		    GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	  GAM(:)=CON_GAM(:)/CHI(:)/LOG_NU							   |		  GAM(:)=CON_GAM(:)/CHI(:)/dLOG_NU
	      IF(MOM_ERR_CNT .GT. N_ERR_MAX)THEN						   |		      IF(MOM_ERR_CNT .EQ. 0)THEN
												   >		        MOM_ERR_CNT=MOM_ERR_CNT+1
												   >		        MOM_ERR_ON_FREQ(MOM_ERR_CNT)=FREQ
												   >		      ELSE IF(MOM_ERR_CNT .GT. N_ERR_MAX)THEN
./plane/mom_j_pp_v1.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: HNU(:)								   |		REAL*8, ALLOCATABLE :: HNU(:)
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: MID_DTAU(:)							   |		REAL*8, ALLOCATABLE :: MID_DTAU(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: DD(:)		!TB=-DD-TA-TC					   |		REAL*8, ALLOCATABLE :: DD(:)		!TB=-DD-TA-TC
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) HNU_SM(ND_SM)									   |		REAL*8 HNU_SM(ND_SM)
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HBC_J,HBC_S,IN_HBC								   |		REAL*8 HBC_J,HBC_S,IN_HBC
	REAL(10) DBB,IC,FREQ									   |		REAL*8 DBB,IC,FREQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
./plane/mom_jrel_grey_v1.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) HBC			!H/J at outer boundary					   |		REAL*8 HBC			!H/J at outer boundary
	REAL(10) IN_HBC			!H/J at inner boundary					   |		REAL*8 IN_HBC			!H/J at inner boundary
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) CHI_H(ND),CHI_J(ND)								   |		REAL*8 CHI_H(ND),CHI_J(ND)
	REAL(10) DTAU_H(ND),DTAU_J(ND),DTAUONQ(ND)						   |		REAL*8 DTAU_H(ND),DTAU_J(ND),DTAUONQ(ND)
	REAL(10) Q(ND),XM(ND),SOURCE(ND)							   |		REAL*8 Q(ND),XM(ND),SOURCE(ND)
	REAL(10) HU(ND),HL(ND)									   |		REAL*8 HU(ND),HL(ND)
	REAL(10) BETA(ND),H_ADV_FAC(ND),GAM_REL(ND)						   |		REAL*8 BETA(ND),H_ADV_FAC(ND),GAM_REL(ND)
	REAL(10) GAM_REL_SQ(ND),CON_DELTA(ND)							   |		REAL*8 GAM_REL_SQ(ND),CON_DELTA(ND)
	REAL(10) JOLD(ND),P_H(ND),P_J(ND)							   |		REAL*8 JOLD(ND),P_H(ND),P_J(ND)
	REAL(10) COH_VEC(ND)									   |		REAL*8 COH_VEC(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DAMP_FAC									   |		REAL*8 DAMP_FAC
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
	REAL(10) MAX_ER_LST_IT									   |		REAL*8 MAX_ER_LST_IT
./plane/mom_jrel_grey_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) HBC			!H/J at outer boundary					   |		REAL*8 HBC			!H/J at outer boundary
	REAL(10) IN_HBC			!H/J at inner boundary					   |		REAL*8 IN_HBC			!H/J at inner boundary
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) CHI_H(ND),CHI_J(ND)								   |		REAL*8 CHI_H(ND),CHI_J(ND)
	REAL(10) DTAU_H(ND),DTAU_J(ND),DTAUONQ(ND)						   |		REAL*8 DTAU_H(ND),DTAU_J(ND),DTAUONQ(ND)
	REAL(10) Q(ND),XM(ND),SOURCE(ND)							   |		REAL*8 Q(ND),XM(ND),SOURCE(ND)
	REAL(10) HU(ND),HL(ND)									   |		REAL*8 HU(ND),HL(ND)
	REAL(10) BETA(ND),H_ADV_FAC(ND),GAM_REL(ND)						   |		REAL*8 BETA(ND),H_ADV_FAC(ND),GAM_REL(ND)
	REAL(10) GAM_REL_SQ(ND),CON_DELTA(ND)							   |		REAL*8 GAM_REL_SQ(ND),CON_DELTA(ND)
	REAL(10) JOLD(ND),P_H(ND),P_J(ND)							   |		REAL*8 JOLD(ND),P_H(ND),P_J(ND)
	REAL(10) COH_VEC(ND)									   |		REAL*8 COH_VEC(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DAMP_FAC									   |		REAL*8 DAMP_FAC
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
	REAL(10) MAX_ER_LST_IT									   |		REAL*8 MAX_ER_LST_IT
./plane/mom_j_rel_v2.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: FEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: FEDD_PREV(:)
        REAL(10), ALLOCATABLE :: GEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: GEDD_PREV(:)
        REAL(10), ALLOCATABLE :: H_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: H_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)						   |	        REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)
        REAL(10), ALLOCATABLE :: KMID_ON_J_PREV(:)						   |	        REAL*8, ALLOCATABLE :: KMID_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: JNU_PREV(:)							   |	        REAL*8, ALLOCATABLE :: JNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: FEDD_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: FEDD_SAVE(:)
        REAL(10), ALLOCATABLE :: GEDD_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: GEDD_SAVE(:)
        REAL(10), ALLOCATABLE :: H_ON_J_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: H_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: N_ON_J_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: N_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_SAVE(:)
        REAL(10), ALLOCATABLE :: KMID_ON_J_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: KMID_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: JNU_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: JNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:),JOLD(:)						   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:),JOLD(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
!												   |	!
	REAL(10) HBC_PREV,HBC_SAVE								   |		REAL*8 HBC_PREV,HBC_SAVE
	REAL(10) NBC_PREV,NBC_SAVE								   |		REAL*8 NBC_PREV,NBC_SAVE
	REAL(10) IN_HBC_PREV,IN_HBC_SAVE							   |		REAL*8 IN_HBC_PREV,IN_HBC_SAVE
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	1                  HBC,IN_HBC,NBC,FREQ,LOG_NU,						   |		1                  HBC,IN_HBC,NBC,FREQ,dLOG_NU,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) V(ND)			!in km/s						   |		REAL*8 V(ND)			!in km/s
	REAL(10) SIGMA(ND)		!dlnV/dlnR						   |		REAL*8 SIGMA(ND)		!dlnV/dlnR
	REAL(10) R(ND)			!in units of 10^10 cm					   |		REAL*8 R(ND)			!in units of 10^10 cm
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) GEDD(ND)									   |		REAL*8 GEDD(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) N_ON_J(ND)									   |		REAL*8 N_ON_J(ND)
	REAL(10) RSQN_ON_RSQJ(ND)								   |		REAL*8 RSQN_ON_RSQJ(ND)
	REAL(10) KMID_ON_J(ND)									   |		REAL*8 KMID_ON_J(ND)
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) GAM_RSQHNU(ND)									   |		REAL*8 GAM_RSQHNU(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) DBB,IC										   |		REAL*8 DBB,IC
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
./plane/mom_jrel_v3.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: FEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: FEDD_PREV(:)
        REAL(10), ALLOCATABLE :: GEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: GEDD_PREV(:)
        REAL(10), ALLOCATABLE :: H_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: H_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)						   |	        REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)
        REAL(10), ALLOCATABLE :: KMID_ON_J_PREV(:)						   |	        REAL*8, ALLOCATABLE :: KMID_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: JNU_PREV(:)							   |	        REAL*8, ALLOCATABLE :: JNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: FEDD_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: FEDD_SAVE(:)
        REAL(10), ALLOCATABLE :: GEDD_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: GEDD_SAVE(:)
        REAL(10), ALLOCATABLE :: H_ON_J_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: H_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: N_ON_J_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: N_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_SAVE(:)
        REAL(10), ALLOCATABLE :: KMID_ON_J_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: KMID_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: JNU_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: JNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:),JOLD(:)						   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:),JOLD(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
!												   |	!
	REAL(10) HBC_PREV,HBC_SAVE								   |		REAL*8 HBC_PREV,HBC_SAVE
	REAL(10) NBC_PREV,NBC_SAVE								   |		REAL*8 NBC_PREV,NBC_SAVE
	REAL(10) IN_HBC_PREV,IN_HBC_SAVE							   |		REAL*8 IN_HBC_PREV,IN_HBC_SAVE
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	1               HBC,IN_HBC,NBC,FREQ,LOG_NU,						   |		1               HBC,IN_HBC,NBC,FREQ,dLOG_NU,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) V(ND)			!in km/s						   |		REAL*8 V(ND)			!in km/s
	REAL(10) SIGMA(ND)		!dlnV/dlnR						   |		REAL*8 SIGMA(ND)		!dlnV/dlnR
	REAL(10) R(ND)			!in units of 10^10 cm					   |		REAL*8 R(ND)			!in units of 10^10 cm
	REAL(10) FEDD(ND)			!J/K at nodes					   |		REAL*8 FEDD(ND)			!J/K at nodes
	REAL(10) GEDD(ND)			!N/G at midpoints				   |		REAL*8 GEDD(ND)			!N/G at midpoints
	REAL(10) H_ON_J(ND)		!H/J at nodes						   |		REAL*8 H_ON_J(ND)		!H/J at nodes
	REAL(10) N_ON_J(ND)		!N/J at nodes						   |		REAL*8 N_ON_J(ND)		!N/J at nodes
	REAL(10) RSQN_ON_RSQJ(ND)		!N/J at nodes					   |		REAL*8 RSQN_ON_RSQJ(ND)		!N/J at nodes
	REAL(10) KMID_ON_J(ND)		!							   |		REAL*8 KMID_ON_J(ND)		!
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) RSQHNU(ND)									   |		REAL*8 RSQHNU(ND)
	REAL(10) dlnJdlnR(ND)									   |		REAL*8 dlnJdlnR(ND)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) DBB,IC										   |		REAL*8 DBB,IC
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
./plane/mom_jrel_v4.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE ::  ETA(:)							   |		REAL*8, ALLOCATABLE ::  ETA(:)
	REAL(10), ALLOCATABLE ::  CHI(:)							   |		REAL*8, ALLOCATABLE ::  CHI(:)
	REAL(10), ALLOCATABLE ::  ESEC(:)							   |		REAL*8, ALLOCATABLE ::  ESEC(:)
	REAL(10), ALLOCATABLE ::  V(:)			!in km/s				   |		REAL*8, ALLOCATABLE ::  V(:)			!in km/s
	REAL(10), ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR				   |		REAL*8, ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR
	REAL(10), ALLOCATABLE ::  R(:)			!in units of 10^10 cm			   |		REAL*8, ALLOCATABLE ::  R(:)			!in units of 10^10 cm
!												   |	!
	REAL(10), ALLOCATABLE ::  FEDD(:)			!J/K at nodes			   |		REAL*8, ALLOCATABLE ::  FEDD(:)			!J/K at nodes
	REAL(10), ALLOCATABLE ::  GEDD(:)			!N/G at midpoints		   |		REAL*8, ALLOCATABLE ::  GEDD(:)			!N/G at midpoints
	REAL(10), ALLOCATABLE ::  H_ON_J(:)		!H/J at nodes				   |		REAL*8, ALLOCATABLE ::  H_ON_J(:)		!H/J at nodes
	REAL(10), ALLOCATABLE ::  N_ON_J(:)		!N/J at nodes				   |		REAL*8, ALLOCATABLE ::  N_ON_J(:)		!N/J at nodes
	REAL(10), ALLOCATABLE ::  RSQN_ON_RSQJ(:)		!N/J at nodes			   |		REAL*8, ALLOCATABLE ::  RSQN_ON_RSQJ(:)		!N/J at nodes
	REAL(10), ALLOCATABLE ::  KMID_ON_J(:)		!					   |		REAL*8, ALLOCATABLE ::  KMID_ON_J(:)		!
	REAL(10), ALLOCATABLE ::  JNU(:)							   |		REAL*8, ALLOCATABLE ::  JNU(:)
	REAL(10), ALLOCATABLE ::  RSQHNU(:)							   |		REAL*8, ALLOCATABLE ::  RSQHNU(:)
	REAL(10), ALLOCATABLE ::  dlnJdlnR(:)							   |		REAL*8, ALLOCATABLE ::  dlnJdlnR(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: FEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: FEDD_PREV(:)
        REAL(10), ALLOCATABLE :: GEDD_PREV(:)							   |	        REAL*8, ALLOCATABLE :: GEDD_PREV(:)
        REAL(10), ALLOCATABLE :: H_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: H_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)							   |	        REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)						   |	        REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)
        REAL(10), ALLOCATABLE :: KMID_ON_J_PREV(:)						   |	        REAL*8, ALLOCATABLE :: KMID_ON_J_PREV(:)
        REAL(10), ALLOCATABLE :: JNU_PREV(:)							   |	        REAL*8, ALLOCATABLE :: JNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: FEDD_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: FEDD_SAVE(:)
        REAL(10), ALLOCATABLE :: GEDD_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: GEDD_SAVE(:)
        REAL(10), ALLOCATABLE :: H_ON_J_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: H_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: N_ON_J_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: N_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_SAVE(:)
        REAL(10), ALLOCATABLE :: KMID_ON_J_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: KMID_ON_J_SAVE(:)
        REAL(10), ALLOCATABLE :: JNU_SAVE(:)							   |	        REAL*8, ALLOCATABLE :: JNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:),JOLD(:)						   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:),JOLD(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
!												   |	!
	REAL(10) HBC_PREV,HBC_SAVE								   |		REAL*8 HBC_PREV,HBC_SAVE
	REAL(10) NBC_PREV,NBC_SAVE								   |		REAL*8 NBC_PREV,NBC_SAVE
	REAL(10) IN_HBC_PREV,IN_HBC_SAVE							   |		REAL*8 IN_HBC_PREV,IN_HBC_SAVE
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	1               HBC,IN_HBC,NBC,FREQ,LOG_NU,						   |		1               HBC,IN_HBC,NBC,FREQ,dLOG_NU,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)			!in km/s					   |		REAL*8 V_SM(ND_SM)			!in km/s
	REAL(10) SIGMA_SM(ND_SM)		!dlnV/dlnR					   |		REAL*8 SIGMA_SM(ND_SM)		!dlnV/dlnR
	REAL(10) R_SM(ND_SM)			!in units of 10^10 cm				   |		REAL*8 R_SM(ND_SM)			!in units of 10^10 cm
	REAL(10) FEDD_SM(ND_SM)			!J/K at nodes					   |		REAL*8 FEDD_SM(ND_SM)			!J/K at nodes
	REAL(10) GEDD_SM(ND_SM)			!N/G at midpoints				   |		REAL*8 GEDD_SM(ND_SM)			!N/G at midpoints
	REAL(10) H_ON_J_SM(ND_SM)		!H/J at nodes					   |		REAL*8 H_ON_J_SM(ND_SM)		!H/J at nodes
	REAL(10) N_ON_J_SM(ND_SM)		!N/J at nodes					   |		REAL*8 N_ON_J_SM(ND_SM)		!N/J at nodes
	REAL(10) RSQN_ON_RSQJ_SM(ND_SM)		!N/J at nodes					   |		REAL*8 RSQN_ON_RSQJ_SM(ND_SM)		!N/J at nodes
	REAL(10) KMID_ON_J_SM(ND_SM)		!						   |		REAL*8 KMID_ON_J_SM(ND_SM)		!
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) dlnJdlnR_SM(ND_SM)								   |		REAL*8 dlnJdlnR_SM(ND_SM)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) DBB,IC										   |		REAL*8 DBB,IC
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
./plane/mom_jrel_v5.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE ::  ETA(:)							   |		REAL*8, ALLOCATABLE ::  ETA(:)
	REAL(10), ALLOCATABLE ::  CHI(:)							   |		REAL*8, ALLOCATABLE ::  CHI(:)
	REAL(10), ALLOCATABLE ::  ESEC(:)							   |		REAL*8, ALLOCATABLE ::  ESEC(:)
	REAL(10), ALLOCATABLE ::  V(:)			!in km/s				   |		REAL*8, ALLOCATABLE ::  V(:)			!in km/s
	REAL(10), ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR				   |		REAL*8, ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR
	REAL(10), ALLOCATABLE ::  R(:)			!in units of 10^10 cm			   |		REAL*8, ALLOCATABLE ::  R(:)			!in units of 10^10 cm
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJOLD(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJOLD(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:)							   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	1               FREQ,LOG_NU,DIF,DBB,IC,METHOD,COHERENT,N_TYPE,				   |		1               FREQ,dLOG_NU,DIF,DBB,IC,METHOD,COHERENT,N_TYPE,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)			!in km/s					   |		REAL*8 V_SM(ND_SM)			!in km/s
	REAL(10) SIGMA_SM(ND_SM)			!dlnV/dlnR				   |		REAL*8 SIGMA_SM(ND_SM)			!dlnV/dlnR
	REAL(10) R_SM(ND_SM)			!in units of 10^10 cm				   |		REAL*8 R_SM(ND_SM)			!in units of 10^10 cm
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DBB,IC										   |		REAL*8 DBB,IC
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
	REAL(10) VDOP_MIN									   |		REAL*8 VDOP_MIN
	REAL(10) TA_SAV,TB_SAV,XM_SAV								   |		REAL*8 TA_SAV,TB_SAV,XM_SAV
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
	      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/LOG_NU	   |		      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/DLOG_NU
	      XM(ND)=XM(ND)+GAM_REL(ND)*R(ND)*BETA(ND)*( (HNU_AT_IB-HNU_AT_IB_PREV) + T1*(NNU_AT   |		      XM(ND)=XM(ND)+GAM_REL(ND)*R(ND)*BETA(ND)*( (HNU_AT_IB-HNU_AT_IB_PREV) + T1*(NNU_AT
./plane/mom_jrel_v6.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE ::  ETA(:)							   |		REAL*8, ALLOCATABLE ::  ETA(:)
	REAL(10), ALLOCATABLE ::  CHI(:)							   |		REAL*8, ALLOCATABLE ::  CHI(:)
	REAL(10), ALLOCATABLE ::  ESEC(:)							   |		REAL*8, ALLOCATABLE ::  ESEC(:)
	REAL(10), ALLOCATABLE ::  V(:)			!in km/s				   |		REAL*8, ALLOCATABLE ::  V(:)			!in km/s
	REAL(10), ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR				   |		REAL*8, ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR
	REAL(10), ALLOCATABLE ::  R(:)			!in units of 10^10 cm			   |		REAL*8, ALLOCATABLE ::  R(:)			!in units of 10^10 cm
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJOLD(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJOLD(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:)							   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
!												   |	!
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	REAL(10) IN_NBC_SAVE									   |		REAL*8 IN_NBC_SAVE
	REAL(10) IN_NBC_PREV									   |		REAL*8 IN_NBC_PREV
	1               FREQ,LOG_NU,DBB,INNER_BND_METH,OUTER_BND_METH,METHOD,COHERENT,N_TYPE,	   |		1               FREQ,dLOG_NU,DBB,INNER_BND_METH,OUTER_BND_METH,METHOD,COHERENT,N_TYPE,
! Altered: 28-Jan-2012 : Minor bug fix. LOG_NU was being used with HOLLOW option when INIT was t   |	! Altered: 28-Jan-2012 : Minor bug fix. dLOG_NU was being used with HOLLOW option when INIT was 
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)			!in km/s					   |		REAL*8 V_SM(ND_SM)			!in km/s
	REAL(10) SIGMA_SM(ND_SM)			!dlnV/dlnR				   |		REAL*8 SIGMA_SM(ND_SM)			!dlnV/dlnR
	REAL(10) R_SM(ND_SM)			!in units of 10^10 cm				   |		REAL*8 R_SM(ND_SM)			!in units of 10^10 cm
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) RSQ_JP,RSQ_HP,RSQ_NP								   |		REAL*8 RSQ_JP,RSQ_HP,RSQ_NP
	REAL(10) FMIN,FPLUS,HMIN,NMIN								   |		REAL*8 FMIN,FPLUS,HMIN,NMIN
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
	REAL(10) VDOP_MIN									   |		REAL*8 VDOP_MIN
	REAL(10) TA_SAV,TB_SAV,XM_SAV								   |		REAL*8 TA_SAV,TB_SAV,XM_SAV
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
	      T1=CON_DELTA(ND)/LOG_NU/CHI(ND)							   |		      T1=CON_DELTA(ND)/dLOG_NU/CHI(ND)
	      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/LOG_NU	   |		      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/DLOG_NU
	1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/LOG_NU			   |		1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/DLOG_NU
./plane/mom_jrel_v7.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE ::  ETA(:)							   |		REAL*8, ALLOCATABLE ::  ETA(:)
	REAL(10), ALLOCATABLE ::  CHI(:)							   |		REAL*8, ALLOCATABLE ::  CHI(:)
	REAL(10), ALLOCATABLE ::  ESEC(:)							   |		REAL*8, ALLOCATABLE ::  ESEC(:)
	REAL(10), ALLOCATABLE ::  V(:)			!in km/s				   |		REAL*8, ALLOCATABLE ::  V(:)			!in km/s
	REAL(10), ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR				   |		REAL*8, ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR
	REAL(10), ALLOCATABLE ::  R(:)			!in units of 10^10 cm			   |		REAL*8, ALLOCATABLE ::  R(:)			!in units of 10^10 cm
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJOLD(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJOLD(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:)							   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
!												   |	!
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	REAL(10) IN_NBC_SAVE									   |		REAL*8 IN_NBC_SAVE
	REAL(10) IN_NBC_PREV									   |		REAL*8 IN_NBC_PREV
	1               FREQ,LOG_NU,DBB,IB_STAB_FACTOR,						   |		1               FREQ,dLOG_NU,DBB,IB_STAB_FACTOR,
! Altered: 28-Jan-2012 : Minor bug fix. LOG_NU was being used with HOLLOW option when INIT was t   |	! Altered: 28-Jan-2012 : Minor bug fix. dLOG_NU was being used with HOLLOW option when INIT was 
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)			!in km/s					   |		REAL*8 V_SM(ND_SM)			!in km/s
	REAL(10) SIGMA_SM(ND_SM)			!dlnV/dlnR				   |		REAL*8 SIGMA_SM(ND_SM)			!dlnV/dlnR
	REAL(10) R_SM(ND_SM)			!in units of 10^10 cm				   |		REAL*8 R_SM(ND_SM)			!in units of 10^10 cm
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) RSQ_JP,RSQ_HP,RSQ_NP								   |		REAL*8 RSQ_JP,RSQ_HP,RSQ_NP
	REAL(10) FMIN,FPLUS,HMIN,NMIN								   |		REAL*8 FMIN,FPLUS,HMIN,NMIN
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
	REAL(10) VDOP_MIN									   |		REAL*8 VDOP_MIN
	REAL(10) TA_SAV,TB_SAV,XM_SAV								   |		REAL*8 TA_SAV,TB_SAV,XM_SAV
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
	      T1=CON_DELTA(ND)/LOG_NU/CHI(ND)							   |		      T1=CON_DELTA(ND)/dLOG_NU/CHI(ND)
	      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/LOG_NU	   |		      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/DLOG_NU
	1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/LOG_NU			   |		1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/DLOG_NU
./plane/mom_jrel_v8.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE ::  ETA(:)							   |		REAL*8, ALLOCATABLE ::  ETA(:)
	REAL(10), ALLOCATABLE ::  CHI(:)							   |		REAL*8, ALLOCATABLE ::  CHI(:)
	REAL(10), ALLOCATABLE ::  ESEC(:)							   |		REAL*8, ALLOCATABLE ::  ESEC(:)
	REAL(10), ALLOCATABLE ::  V(:)			!in km/s				   |		REAL*8, ALLOCATABLE ::  V(:)			!in km/s
	REAL(10), ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR				   |		REAL*8, ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR
	REAL(10), ALLOCATABLE ::  R(:)			!in units of 10^10 cm			   |		REAL*8, ALLOCATABLE ::  R(:)			!in units of 10^10 cm
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJOLD(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJOLD(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:)							   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
!												   |	!
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	REAL(10) IN_NBC_SAVE									   |		REAL*8 IN_NBC_SAVE
	REAL(10) IN_NBC_PREV									   |		REAL*8 IN_NBC_PREV
	1               FREQ,LOG_NU,DBB,H_CHK_OPTION,IB_STAB_FACTOR,				   |		1               FREQ,dLOG_NU,DBB,H_CHK_OPTION,IB_STAB_FACTOR,
! Altered: 28-Jan-2012 : Minor bug fix. LOG_NU was being used with HOLLOW option when INIT was t   |	! Altered: 28-Jan-2012 : Minor bug fix. dLOG_NU was being used with HOLLOW option when INIT was 
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)			!in km/s					   |		REAL*8 V_SM(ND_SM)			!in km/s
	REAL(10) SIGMA_SM(ND_SM)			!dlnV/dlnR				   |		REAL*8 SIGMA_SM(ND_SM)			!dlnV/dlnR
	REAL(10) R_SM(ND_SM)			!in units of 10^10 cm				   |		REAL*8 R_SM(ND_SM)			!in units of 10^10 cm
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) RSQ_JP,RSQ_HP,RSQ_NP								   |		REAL*8 RSQ_JP,RSQ_HP,RSQ_NP
	REAL(10) FMIN,FPLUS,HMIN,NMIN								   |		REAL*8 FMIN,FPLUS,HMIN,NMIN
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
	REAL(10) VDOP_MIN									   |		REAL*8 VDOP_MIN
	REAL(10) TA_SAV,TB_SAV,XM_SAV								   |		REAL*8 TA_SAV,TB_SAV,XM_SAV
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
	      T1=CON_DELTA(ND)/LOG_NU/CHI(ND)							   |		      T1=CON_DELTA(ND)/dLOG_NU/CHI(ND)
	      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/LOG_NU	   |		      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/DLOG_NU
	1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/LOG_NU			   |		1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/DLOG_NU
./plane/mom_jrel_v9.f
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10), ALLOCATABLE ::  ETA(:)							   |		REAL*8, ALLOCATABLE ::  ETA(:)
	REAL(10), ALLOCATABLE ::  CHI(:)							   |		REAL*8, ALLOCATABLE ::  CHI(:)
	REAL(10), ALLOCATABLE ::  ESEC(:)							   |		REAL*8, ALLOCATABLE ::  ESEC(:)
	REAL(10), ALLOCATABLE ::  V(:)			!in km/s				   |		REAL*8, ALLOCATABLE ::  V(:)			!in km/s
	REAL(10), ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR				   |		REAL*8, ALLOCATABLE ::  SIGMA(:)		!dlnV/dlnR
	REAL(10), ALLOCATABLE ::  R(:)			!in units of 10^10 cm			   |		REAL*8, ALLOCATABLE ::  R(:)			!in units of 10^10 cm
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
	REAL(10), ALLOCATABLE :: BETA(:)							   |		REAL*8, ALLOCATABLE :: BETA(:)
	REAL(10), ALLOCATABLE :: BETA_FREQ(:)							   |		REAL*8, ALLOCATABLE :: BETA_FREQ(:)
	REAL(10), ALLOCATABLE :: GAM_REL(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL(:)
	REAL(10), ALLOCATABLE :: GAM_REL_SQ(:)							   |		REAL*8, ALLOCATABLE :: GAM_REL_SQ(:)
	REAL(10), ALLOCATABLE :: CON_DELTA(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTA(:)
	REAL(10), ALLOCATABLE :: CON_DELTAH(:)							   |		REAL*8, ALLOCATABLE :: CON_DELTAH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dNdNUH(:)							   |		REAL*8, ALLOCATABLE :: CON_dNdNUH(:)
	REAL(10), ALLOCATABLE :: CON_dKdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dKdNU(:)
	REAL(10), ALLOCATABLE :: CON_dHdNU(:)							   |		REAL*8, ALLOCATABLE :: CON_dHdNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJNU(:)
	REAL(10), ALLOCATABLE :: GAM_RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQHNU(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_PREV(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_PREV(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_PREV(:)
!												   |	!
        REAL(10), ALLOCATABLE :: GAM_RSQJNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQJNU_SAVE(:)
        REAL(10), ALLOCATABLE :: GAM_RSQHNU_SAVE(:)						   |	        REAL*8, ALLOCATABLE :: GAM_RSQHNU_SAVE(:)
	REAL(10), ALLOCATABLE :: GAM_RSQJOLD(:)							   |		REAL*8, ALLOCATABLE :: GAM_RSQJOLD(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:)						   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:)
	REAL(10), ALLOCATABLE :: CHI_H(:),CHI_J(:)						   |		REAL*8, ALLOCATABLE :: CHI_H(:),CHI_J(:)
	REAL(10), ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)					   |		REAL*8, ALLOCATABLE :: DTAU_H(:),DTAU_J(:),DTAUONQ(:)
	REAL(10), ALLOCATABLE :: Q(:),XM(:),SOURCE(:)						   |		REAL*8, ALLOCATABLE :: Q(:),XM(:),SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)						   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),COH_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)					   |		REAL*8, ALLOCATABLE :: HU(:),HL(:),HS(:),HD(:)
	REAL(10), ALLOCATABLE :: P_H(:),P_J(:)							   |		REAL*8, ALLOCATABLE :: P_H(:),P_J(:)
	REAL(10), ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)					   |		REAL*8, ALLOCATABLE :: VdJdR_TERM(:),VdHdR_TERM(:)
	REAL(10), ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)				   |		REAL*8, ALLOCATABLE :: DELTA(:),DELTAH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV(:)						   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
!												   |	!
	REAL(10) FREQ_SAVE									   |		REAL*8 FREQ_SAVE
	REAL(10) IN_NBC_SAVE									   |		REAL*8 IN_NBC_SAVE
	REAL(10) IN_NBC_PREV									   |		REAL*8 IN_NBC_PREV
	REAL(10) GET_RSQJ_FROM_J								   |		REAL*8 GET_RSQJ_FROM_J
	1               FREQ,LOG_NU,DBB,							   |		1               FREQ,dLOG_NU,DBB,
! Altered: 28-Jan-2012 : Minor bug fix. LOG_NU was being used with HOLLOW option when INIT was t   |	! Altered: 28-Jan-2012 : Minor bug fix. dLOG_NU was being used with HOLLOW option when INIT was 
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)			!in km/s					   |		REAL*8 V_SM(ND_SM)			!in km/s
	REAL(10) SIGMA_SM(ND_SM)			!dlnV/dlnR				   |		REAL*8 SIGMA_SM(ND_SM)			!dlnV/dlnR
	REAL(10) R_SM(ND_SM)			!in units of 10^10 cm				   |		REAL*8 R_SM(ND_SM)			!in units of 10^10 cm
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) RSQHNU_SM(ND_SM)								   |		REAL*8 RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) HFLUX_AT_OB									   |		REAL*8 HFLUX_AT_OB
	REAL(10) HFLUX_AT_IB									   |		REAL*8 HFLUX_AT_IB
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) FREQ,LOG_NU									   |		REAL*8 FREQ,dLOG_NU
	REAL(10) DAMP_FAC 									   |		REAL*8 DAMP_FAC 
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) RSQ_JP,RSQ_HP,RSQ_NP								   |		REAL*8 RSQ_JP,RSQ_HP,RSQ_NP
	REAL(10) FMIN,FPLUS,HMIN,NMIN								   |		REAL*8 FMIN,FPLUS,HMIN,NMIN
	REAL(10) MAX_ER										   |		REAL*8 MAX_ER
	REAL(10) DELTA_R									   |		REAL*8 DELTA_R
	REAL(10) VDOP_MIN									   |		REAL*8 VDOP_MIN
	REAL(10) TA_SAV,TB_SAV,XM_SAV								   |		REAL*8 TA_SAV,TB_SAV,XM_SAV
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) GET_RSQJ_FROM_J								   |		REAL*8 GET_RSQJ_FROM_J
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
	      T1=CON_DELTA(ND)/LOG_NU/CHI(ND)							   |		      T1=CON_DELTA(ND)/dLOG_NU/CHI(ND)
	      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/LOG_NU	   |		      T1=BETA(ND)*BETA(ND)*GAM_REL_SQ(ND)*(SIGMA(ND)+1.0D0)/CHI_H(ND)/R(ND)/DLOG_NU
	1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/LOG_NU			   |		1                   T1*(NNU_AT_IB-NNU_AT_IB_PREV) )/CHI_H(ND)/DLOG_NU
./plane/n_weight.f
      REAL(10) a1,a2,sum,check									   |	      real*8 a1,a2,sum,check
      REAL(10), dimension(nw) :: temp(nw)							   |	      real*8, dimension(nw) :: temp(nw)
      REAL(10), dimension(nw) :: angle								   |	      real*8, dimension(nw) :: angle
./plane/optdepth_v2.f
      REAL(10) chi(nz)										   |	      real*8 chi(nz)
      REAL(10) dchidz(nz)									   |	      real*8 dchidz(nz)
./plane/optdepth_v3.f
      REAL(10) chi(nz)										   |	      real*8 chi(nz)
      REAL(10) tau_loc(nz)									   |	      real*8 tau_loc(nz)
      REAL(10) dtau_loc(nz)									   |	      real*8 dtau_loc(nz)
      REAL(10) dchidz(nz)									   |	      real*8 dchidz(nz)
./plane/optdepth_v4.f
      REAL(10) CHI(NZ)										   |	      REAL*8 CHI(NZ)
      REAL(10) DTAU_LOC(NZ)									   |	      REAL*8 DTAU_LOC(NZ)
      REAL(10) T1										   |	      REAL*8 T1
      REAL(10) DCHIDZ(NZ)									   |	      REAL*8 DCHIDZ(NZ)
./plane/optdepth_v4_gam.f
      REAL(10) CHI(NZ)										   |	      REAL*8 CHI(NZ)
      REAL(10) DTAU_LOC(NZ)									   |	      REAL*8 DTAU_LOC(NZ)
      REAL(10) T1										   |	      REAL*8 T1
      REAL(10) DCHIDZ(NZ)									   |	      REAL*8 DCHIDZ(NZ)
./plane/out_jh.f
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
        REAL(10) RSQ_J(ND)									   |	        REAL*8 RSQ_J(ND)
	REAL(10) RSQ_H(ND)									   |		REAL*8 RSQ_H(ND)
	REAL(10) H_INBC										   |		REAL*8 H_INBC
	REAL(10) H_OUTBC									   |		REAL*8 H_OUTBC
	REAL(10)  T1										   |		REAL*8  T1
	REAL(10),  SAVE :: NU_STORE=0.0D0							   |		REAL*8,  SAVE :: NU_STORE=0.0D0
./plane/pp_edd_var_cmf_v1.f
	REAL(10) VK(ND,ND,NM)									   |		REAL*8 VK(ND,ND,NM)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND),ES_COH_VEC(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND),ES_COH_VEC(ND)
	REAL(10) DTAU(ND),R(ND),SIGMA(ND)							   |		REAL*8 DTAU(ND),R(ND),SIGMA(ND)
	REAL(10) MIDF(ND),HU(ND),HL(ND),HS(ND),MID_DTAU(ND)					   |		REAL*8 MIDF(ND),HU(ND),HL(ND),HS(ND),MID_DTAU(ND)
	REAL(10) W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)						   |		REAL*8 W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)
	REAL(10) EPS(ND)									   |		REAL*8 EPS(ND)
	REAL(10) EPS_PREV(ND)									   |		REAL*8 EPS_PREV(ND)
	REAL(10) JNU(ND),JNUM1(ND),HNUM1(ND)							   |		REAL*8 JNU(ND),JNUM1(ND),HNUM1(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)						   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)						   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)
	REAL(10) dRHSdI(ND),dRHSdJ(ND)								   |		REAL*8 dRHSdI(ND),dRHSdJ(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
	REAL(10) dXM_EPS_J,dXM_EPS_I,dXM_EPS_K							   |		REAL*8 dXM_EPS_J,dXM_EPS_I,dXM_EPS_K
./plane/pp_form_cmf_v2.f
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: DTAU(:,:)							   |		REAL*8, ALLOCATABLE :: DTAU(:,:)
	REAL(10), ALLOCATABLE :: AV(:,:)							   |		REAL*8, ALLOCATABLE :: AV(:,:)
	REAL(10), ALLOCATABLE :: CV(:,:)							   |		REAL*8, ALLOCATABLE :: CV(:,:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	REAL(10), ALLOCATABLE :: V_EXT(:)							   |		REAL*8, ALLOCATABLE :: V_EXT(:)
	REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: ETA_EXT(:)
	REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: CHI_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	REAL(10), ALLOCATABLE :: R_RAY(:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:)
	REAL(10), ALLOCATABLE :: dCHIdR(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: QH(:)								   |		REAL*8, ALLOCATABLE :: QH(:)
	REAL(10), ALLOCATABLE :: V_RAY(:)							   |		REAL*8, ALLOCATABLE :: V_RAY(:)
	REAL(10), ALLOCATABLE :: TMPV(:)							   |		REAL*8, ALLOCATABLE :: TMPV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SIGMA_RAY(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_RAY(:)
	REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		REAL*8, ALLOCATABLE :: ETA_RAY(:)
	REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		REAL*8, ALLOCATABLE :: CHI_RAY(:)
	REAL(10), ALLOCATABLE :: dCHIdR_RAY(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_RAY(:)
	REAL(10), ALLOCATABLE :: SOURCE_RAY(:)							   |		REAL*8, ALLOCATABLE :: SOURCE_RAY(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: AV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: AV_STORE(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: CV_STORE(:,:)
	REAL(10), ALLOCATABLE :: PAR_AV(:,:)							   |		REAL*8, ALLOCATABLE :: PAR_AV(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: TA(:,:)							   |		REAL*8, ALLOCATABLE :: TA(:,:)
	REAL(10), ALLOCATABLE :: TB(:,:)							   |		REAL*8, ALLOCATABLE :: TB(:,:)
	REAL(10), ALLOCATABLE :: TC(:,:)							   |		REAL*8, ALLOCATABLE :: TC(:,:)
	REAL(10), ALLOCATABLE :: GB(:,:)							   |		REAL*8, ALLOCATABLE :: GB(:,:)
	REAL(10), ALLOCATABLE :: H(:,:)								   |		REAL*8, ALLOCATABLE :: H(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: U(:)								   |		REAL*8, ALLOCATABLE :: U(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: DIV(:)								   |		REAL*8, ALLOCATABLE :: DIV(:)
	REAL(10), ALLOCATABLE :: OLDCHI(:)							   |		REAL*8, ALLOCATABLE :: OLDCHI(:)
	REAL(10), ALLOCATABLE :: OLDCHI_STORE(:)						   |		REAL*8, ALLOCATABLE :: OLDCHI_STORE(:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_STORE(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_STORE(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: A0(:,:)							   |		REAL*8, ALLOCATABLE :: A0(:,:)
	REAL(10), ALLOCATABLE :: A1(:,:)							   |		REAL*8, ALLOCATABLE :: A1(:,:)
	REAL(10), ALLOCATABLE :: A2(:,:)							   |		REAL*8, ALLOCATABLE :: A2(:,:)
	REAL(10), ALLOCATABLE :: A3(:,:)							   |		REAL*8, ALLOCATABLE :: A3(:,:)
	REAL(10), ALLOCATABLE :: A4(:,:)							   |		REAL*8, ALLOCATABLE :: A4(:,:)
	REAL(10), ALLOCATABLE :: I_P(:,:)							   |		REAL*8, ALLOCATABLE :: I_P(:,:)
	REAL(10), ALLOCATABLE :: I_M(:,:)							   |		REAL*8, ALLOCATABLE :: I_M(:,:)
	REAL(10), ALLOCATABLE :: EE(:)								   |		REAL*8, ALLOCATABLE :: EE(:)
	REAL(10), ALLOCATABLE :: E0(:)								   |		REAL*8, ALLOCATABLE :: E0(:)
	REAL(10), ALLOCATABLE :: E1(:)								   |		REAL*8, ALLOCATABLE :: E1(:)
	REAL(10), ALLOCATABLE :: E2(:)								   |		REAL*8, ALLOCATABLE :: E2(:)
	REAL(10), ALLOCATABLE :: E3(:)								   |		REAL*8, ALLOCATABLE :: E3(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SOURCE_PRIME(:)						   |		REAL*8, ALLOCATABLE :: SOURCE_PRIME(:)
	REAL(10), ALLOCATABLE :: S(:)								   |		REAL*8, ALLOCATABLE :: S(:)
	REAL(10), ALLOCATABLE :: dS(:)								   |		REAL*8, ALLOCATABLE :: dS(:)
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
	REAL(10), ALLOCATABLE :: JQW(:)								   |		REAL*8, ALLOCATABLE :: JQW(:)
	REAL(10), ALLOCATABLE :: HQW(:)								   |		REAL*8, ALLOCATABLE :: HQW(:)
	REAL(10), ALLOCATABLE :: KQW(:)								   |		REAL*8, ALLOCATABLE :: KQW(:)
	REAL(10), ALLOCATABLE :: NQW(:)								   |		REAL*8, ALLOCATABLE :: NQW(:)
	REAL(10) PREVIOUS_FREQ									   |		REAL*8 PREVIOUS_FREQ
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	1               IPLUS_P,FREQ,LOG_NU,DIF,DBB,IC,						   |		1               IPLUS_P,FREQ,dLOG_NU,DIF,DBB,IC,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)				!In km/s					   |		REAL*8 V(ND)				!In km/s
	REAL(10) SIGMA(ND)			!dlnV/dlnR					   |		REAL*8 SIGMA(ND)			!dlnV/dlnR
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
!												   |	!
	REAL(10) JNU(ND),HNU(ND),KNU(ND),NNU(ND),N_ON_J(ND)					   |		REAL*8 JNU(ND),HNU(ND),KNU(ND),NNU(ND),N_ON_J(ND)
	REAL(10) IN_HBC,HBC,HBC_INCID,NBC,NBC_INCID						   |		REAL*8 IN_HBC,HBC,HBC_INCID,NBC,NBC_INCID
	REAL(10) IPLUS_P(NP)									   |		REAL*8 IPLUS_P(NP)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DBB,IC,FREQ,LOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) CV_BOUND(NP)		!Outer boundary V					   |		REAL*8 CV_BOUND(NP)		!Outer boundary V
	REAL(10) I_M_IN_BND(NP)		!Inner boundary						   |		REAL*8 I_M_IN_BND(NP)		!Inner boundary
	REAL(10) IBOUND(NP)		!Incident intensity on outer boundary.			   |		REAL*8 IBOUND(NP)		!Incident intensity on outer boundary.
	REAL(10) FG_ERR_ON_FREQ									   |		REAL*8 FG_ERR_ON_FREQ
	REAL(10), PARAMETER :: ZERO=0.0D0							   |		REAL*8, PARAMETER :: ZERO=0.0D0
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX,DEL_R_FAC									   |		REAL*8 RMAX,DEL_R_FAC
	REAL(10) dR										   |		REAL*8 dR
	REAL(10) DEL_R										   |		REAL*8 DEL_R
	        DTAU(I,LS)=TMPV(I)/MU(LS)+ 3.33564D-06*MU(LS)*(V_RAY(I)-V_RAY(I+1))/LOG_NU	   |		        DTAU(I,LS)=TMPV(I)/MU(LS)+ 3.33564D-06*MU(LS)*(V_RAY(I)-V_RAY(I+1))/dLOG_NU
	        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*LOG_NU)			   |		        QH(I)=GAMH(I,LS)*2.0D0/((CHI_RAY(I)+CHI_RAY(I+1))*dLOG_NU)
	        Q(I)=GAM(I,LS)/(CHI_RAY(I)*LOG_NU)						   |		        Q(I)=GAM(I,LS)/(CHI_RAY(I)*dLOG_NU)
	      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)						   |		      Q(NI)=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)
	      IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*LOG_NU)	     !Q(NI)			   |		      IF(.NOT. INIT)T1=GAM(NI,LS)/(CHI_RAY(NI)*dLOG_NU)	     !Q(NI)
	      Q(1:NI)=GAM(1:NI,LS)/LOG_NU							   |		      Q(1:NI)=GAM(1:NI,LS)/dLOG_NU
./plane/pp_mom_cmf_v1.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: G_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: G_COEF(:,:)
	REAL(10), ALLOCATABLE :: N_ON_J_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: N_ON_J_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: HNU(:)								   |		REAL*8, ALLOCATABLE :: HNU(:)
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: G(:)								   |		REAL*8, ALLOCATABLE :: G(:)
	REAL(10), ALLOCATABLE :: N_ON_J(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: G_SAV(:)							   |		REAL*8, ALLOCATABLE :: G_SAV(:)
	REAL(10), ALLOCATABLE :: N_ON_J_SAV(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J_SAV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: JNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: JNU_PREV(:)
	REAL(10), ALLOCATABLE :: HNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: HNU_PREV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
	REAL(10), ALLOCATABLE :: G_PREV(:)							   |		REAL*8, ALLOCATABLE :: G_PREV(:)
	REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAU_MID(:)							   |		REAL*8, ALLOCATABLE :: DTAU_MID(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:)								   |		REAL*8, ALLOCATABLE :: EPS(:)
	REAL(10), ALLOCATABLE :: EPS_PREV(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV(:)
        REAL(10) HBC_PREV									   |	        REAL*8 HBC_PREV
	REAL(10) IN_HBC_PREV									   |		REAL*8 IN_HBC_PREV
	REAL(10) NBC_PREV									   |		REAL*8 NBC_PREV
	REAL(10) NBC_INCID_PREV									   |		REAL*8 NBC_INCID_PREV
!												   |	!
	REAL(10) HBC_SAV									   |		REAL*8 HBC_SAV
	REAL(10) IN_HBC_SAV									   |		REAL*8 IN_HBC_SAV
	REAL(10) NBC_SAV									   |		REAL*8 NBC_SAV
	REAL(10) NBC_INCID_SAV									   |		REAL*8 NBC_INCID_SAV
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	1                  FREQ,LOG_NU,DIF,DBB,IC,						   |		1                  FREQ,dLOG_NU,DIF,DBB,IC,
	REAL(10) ETA_SM(ND_SM)									   |		REAL*8 ETA_SM(ND_SM)
	REAL(10) CHI_SM(ND_SM)									   |		REAL*8 CHI_SM(ND_SM)
	REAL(10) ESEC_SM(ND_SM)									   |		REAL*8 ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM)									   |		REAL*8 V_SM(ND_SM)
	REAL(10) SIGMA_SM(ND_SM)								   |		REAL*8 SIGMA_SM(ND_SM)
	REAL(10) R_SM(ND_SM)									   |		REAL*8 R_SM(ND_SM)
	REAL(10) F_SM(ND_SM)									   |		REAL*8 F_SM(ND_SM)
	REAL(10) G_SM(ND_SM)									   |		REAL*8 G_SM(ND_SM)
	REAL(10) N_ON_J_SM(ND_SM)								   |		REAL*8 N_ON_J_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM)									   |		REAL*8 JNU_SM(ND_SM)
	REAL(10) HNU_SM(ND_SM)									   |		REAL*8 HNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM)								   |		REAL*8 VDOP_VEC(ND_SM)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HBC,HBC_INCID									   |		REAL*8 HBC,HBC_INCID
	REAL(10) NBC,NBC_INCID									   |		REAL*8 NBC,NBC_INCID
	REAL(10) IN_HBC										   |		REAL*8 IN_HBC
	REAL(10) DBB,IC,FREQ,LOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
	REAL(10)  dNBC_INCID									   |		REAL*8  dNBC_INCID
! FL. LOG_NU is define as vd / dv which is the same as d / d ln v.				   |	! FL. dLOG_NU is define as vd / dv which is the same as d / d ln v.
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	      GAMH(I)=CON_GAMH(I)/LOG_NU/( CHI(I)+CHI(I+1) )					   |		      GAMH(I)=CON_GAMH(I)/dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=CON_GAM(I)/CHI(I)/LOG_NU							   |		    GAM(I)=CON_GAM(I)/CHI(I)/dLOG_NU
./plane/pp_var_mom_cmf_v1.f
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
	REAL(10), ALLOCATABLE :: G_PREV(:)							   |		REAL*8, ALLOCATABLE :: G_PREV(:)
	REAL(10), ALLOCATABLE :: N_ON_J_PREV(:)							   |		REAL*8, ALLOCATABLE :: N_ON_J_PREV(:)
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: HNU(:)								   |		REAL*8, ALLOCATABLE :: HNU(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: HNUM1(:)							   |		REAL*8, ALLOCATABLE :: HNUM1(:)
!												   |	!
	REAL(10), ALLOCATABLE :: KI(:,:,:)							   |		REAL*8, ALLOCATABLE :: KI(:,:,:)
	REAL(10), ALLOCATABLE :: WORKMAT(:,:)							   |		REAL*8, ALLOCATABLE :: WORKMAT(:,:)
	REAL(10), ALLOCATABLE :: RHS_dHdCHI(:,:)						   |		REAL*8, ALLOCATABLE :: RHS_dHdCHI(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:),TB(:),TC(:),DTAU(:),MID_DTAU(:)				   |		REAL*8, ALLOCATABLE :: TA(:),TB(:),TC(:),DTAU(:),MID_DTAU(:)
	REAL(10), ALLOCATABLE :: XM(:),SOURCE(:),THETA(:)					   |		REAL*8, ALLOCATABLE :: XM(:),SOURCE(:),THETA(:)
	REAL(10), ALLOCATABLE :: VB(:),VC(:),HU(:),HL(:),HS(:)					   |		REAL*8, ALLOCATABLE :: VB(:),VC(:),HU(:),HL(:),HS(:)
	REAL(10), ALLOCATABLE :: GAM(:),GAMH(:),W(:),WPREV(:)					   |		REAL*8, ALLOCATABLE :: GAM(:),GAMH(:),W(:),WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:),PSIPREV_MOD(:),PSIPREV(:)				   |		REAL*8, ALLOCATABLE :: PSI(:),PSIPREV_MOD(:),PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:),EPS_PREV(:)						   |		REAL*8, ALLOCATABLE :: EPS(:),EPS_PREV(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:),TX_OLD_d_dTdR(:)					   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:),TX_OLD_d_dTdR(:)
!												   |	!
	REAL(10) HBC_PREV									   |		REAL*8 HBC_PREV
	REAL(10) IN_HBC_PREV									   |		REAL*8 IN_HBC_PREV
	REAL(10) NBC_PREV									   |		REAL*8 NBC_PREV
	REAL(10) NBC_INCID_PREV									   |		REAL*8 NBC_INCID_PREV
	1              LOG_NU,DIF,dTdR,DBB,dDBBdT,IC,						   |		1              dLOG_NU,DIF,dTdR,DBB,dDBBdT,IC,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) TX_DIF_d_T(ND)									   |		REAL*8 TX_DIF_d_T(ND)
	REAL(10) TX_DIF_d_dTdR(ND)								   |		REAL*8 TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND)								   |		REAL*8 TVX_DIF_d_T(ND)
	REAL(10) TVX_DIF_d_dTdR(ND)								   |		REAL*8 TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND),G(ND),N_ON_J(ND)								   |		REAL*8 F(ND),G(ND),N_ON_J(ND)
	REAL(10) HBC,HBC_INCID									   |		REAL*8 HBC,HBC_INCID
	REAL(10) NBC,NBC_INCID									   |		REAL*8 NBC,NBC_INCID
	REAL(10) IN_HBC										   |		REAL*8 IN_HBC
!												   |	!
	REAL(10) LOG_NU										   |		REAL*8 dLOG_NU
	REAL(10) dTdR										   |		REAL*8 dTdR
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) dDBBdT										   |		REAL*8 dDBBdT
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) dN_INCID									   |		REAL*8 dN_INCID
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
	1         /LOG_NU/(CHI(I)+CHI(I+1))							   |		1         /dLOG_NU/(CHI(I)+CHI(I+1))
	    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/LOG_NU						   |		    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/dLOG_NU
./plane/rel_variables.f
      REAL(10), dimension(nd) :: chi,eta							   |	      real*8, dimension(nd) :: chi,eta
      REAL(10), dimension(nd) :: I_prev								   |	      real*8, dimension(nd) :: I_prev
      REAL(10) nu_dnu										   |	      real*8 nu_dnu
      REAL(10), dimension(nd) :: b								   |	      real*8, dimension(nd) :: b
      REAL(10), dimension(nd) :: chi_tau							   |	      real*8, dimension(nd) :: chi_tau
      REAL(10), dimension(nd) :: source_prime							   |	      real*8, dimension(nd) :: source_prime
./plane/rel_variables_gam.f
      REAL(10), dimension(nd) :: chi,eta							   |	      real*8, dimension(nd) :: chi,eta
      REAL(10), dimension(nd) :: I_prev								   |	      real*8, dimension(nd) :: I_prev
      REAL(10) nu_dnu										   |	      real*8 nu_dnu
      REAL(10), dimension(nd) :: b								   |	      real*8, dimension(nd) :: b
      REAL(10), dimension(nd) :: chi_tau							   |	      real*8, dimension(nd) :: chi_tau
      REAL(10), dimension(nd) :: source_prime							   |	      real*8, dimension(nd) :: source_prime
./plane/runge_kutta.f
      REAL(10), dimension(nmax) :: dym,dyt,yt							   |	      real*8, dimension(nmax) :: dym,dyt,yt
      REAL(10) h6,hh,xh										   |	      real*8 h6,hh,xh
      REAL(10),  dimension(n) :: dydx,y								   |	      real*8,  dimension(n) :: dydx,y
      REAL(10) h,x,beta,dbetadr,gamma								   |	      real*8 h,x,beta,dbetadr,gamma
./plane/solve_cmf_formal_v2.f
      REAL(10), dimension(nd) :: chi,eta							   |	      real*8, dimension(nd) :: chi,eta
      REAL(10) :: freq										   |	      real*8 :: freq
      REAL(10) :: nu_dnu									   |	      real*8 :: nu_dnu
      REAL(10) :: B_nue,dBdtau									   |	      real*8 :: B_nue,dBdtau
      REAL(10) ibound										   |	      real*8 ibound
      REAL(10) ee,e0,e1,e2,alpha,beta,gamma,t1							   |	      real*8 ee,e0,e1,e2,alpha,beta,gamma,t1
      REAL(10), dimension(nd) :: chi_tau							   |	      real*8, dimension(nd) :: chi_tau
      REAL(10), dimension(nd) :: source_prime							   |	      real*8, dimension(nd) :: source_prime
      REAL(10), dimension(nd) :: tau_loc							   |	      real*8, dimension(nd) :: tau_loc
      REAL(10), dimension(nd) :: dtau_loc							   |	      real*8, dimension(nd) :: dtau_loc
      REAL(10) new_freq										   |	      real*8 new_freq
./plane/solve_cmf_formal_v3_gam.f
      REAL(10), DIMENSION(ND,NA) :: GAM_ETA							   |	      REAL*8, DIMENSION(ND,NA) :: GAM_ETA
      REAL(10), DIMENSION(ND,NA) :: GAM_INT							   |	      REAL*8, DIMENSION(ND,NA) :: GAM_INT
      REAL(10), dimension(nray) :: chi								   |	      real*8, dimension(nray) :: chi
      REAL(10) :: freq										   |	      real*8 :: freq
      REAL(10) :: nu_dnu									   |	      real*8 :: nu_dnu
      REAL(10) :: B_nue,dBdtau									   |	      real*8 :: B_nue,dBdtau
      REAL(10) ibound										   |	      real*8 ibound
      REAL(10) ee,e0,e1,e2,alpha,beta,gamma,t1							   |	      real*8 ee,e0,e1,e2,alpha,beta,gamma,t1
      REAL(10), dimension(nray) :: chi_tau							   |	      real*8, dimension(nray) :: chi_tau
      REAL(10), dimension(nray) :: source_prime							   |	      real*8, dimension(nray) :: source_prime
      REAL(10), dimension(nray) :: tau_loc							   |	      real*8, dimension(nray) :: tau_loc
      REAL(10), dimension(nray) :: dtau_loc							   |	      real*8, dimension(nray) :: dtau_loc
      REAL(10) new_freq										   |	      real*8 new_freq
	REAL(10), PARAMETER :: PLANCK=4.135668D-21						   |		REAL*8, PARAMETER :: PLANCK=4.135668D-21
./plane/tst_exp.f
	REAL(10) EXPINT,EXPN,EXPI								   |		REAL*8 EXPINT,EXPN,EXPI
	REAL(10) X										   |		REAL*8 X
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./plane/tst_get_ib.f
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
	REAL(10), ALLOCATABLE :: IBOUND(:)							   |		REAL*8, ALLOCATABLE :: IBOUND(:)
	REAL(10) FREQ										   |		REAL*8 FREQ
./plane/var_jrel_v1.f
	1                  HBC,IN_HBC,NBC,INIT,FREQ,LOG_NU,					   |		1                  HBC,IN_HBC,NBC,INIT,FREQ,dLOG_NU,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) FEDD(ND)									   |		REAL*8 FEDD(ND)
	REAL(10) GEDD(ND)									   |		REAL*8 GEDD(ND)
	REAL(10) dlnGRSQJdlnR(ND)								   |		REAL*8 dlnGRSQJdlnR(ND)
	REAL(10) H_ON_J(ND)									   |		REAL*8 H_ON_J(ND)
	REAL(10) N_ON_J(ND)									   |		REAL*8 N_ON_J(ND)
	REAL(10) KMID_ON_J(ND)									   |		REAL*8 KMID_ON_J(ND)
	REAL(10) RSQN_ON_RSQJ(ND)								   |		REAL*8 RSQN_ON_RSQJ(ND)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FREQ										   |		REAL*8 FREQ
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
./plane/var_jrel_v2.f
	1                  INIT,FREQ,LOG_NU,DIF,dTdR,DBB,dDBBdT,IC,				   |		1                  INIT,FREQ,dLOG_NU,DIF,dTdR,DBB,dDBBdT,IC,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FREQ										   |		REAL*8 FREQ
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
./plane/var_jrel_v3.f
	1                  INIT,FREQ,LOG_NU,							   |		1                  INIT,FREQ,dLOG_NU,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dIBCHI_A,dIBCHI_B								   |		REAL*8 dIBCHI_A,dIBCHI_B
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) FREQ										   |		REAL*8 FREQ
        REAL(10) RSQ_JP,RSQ_HP,RSQ_NP								   |	        REAL*8 RSQ_JP,RSQ_HP,RSQ_NP
        REAL(10) FMIN,FPLUS,HMIN,NMIN								   |	        REAL*8 FMIN,FPLUS,HMIN,NMIN
	REAL(10) RHS_JNU									   |		REAL*8 RHS_JNU
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
            T1=CON_DELTA(ND)/LOG_NU/CHI(ND)							   |	            T1=CON_DELTA(ND)/dLOG_NU/CHI(ND)
./plane/var_jrel_v4.f
	1                  INIT,FREQ,LOG_NU,H_CHK_OPTION,					   |		1                  INIT,FREQ,dLOG_NU,H_CHK_OPTION,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dIBCHI_A,dIBCHI_B								   |		REAL*8 dIBCHI_A,dIBCHI_B
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) FREQ										   |		REAL*8 FREQ
        REAL(10) RSQ_JP,RSQ_HP,RSQ_NP								   |	        REAL*8 RSQ_JP,RSQ_HP,RSQ_NP
        REAL(10) FMIN,FPLUS,HMIN,NMIN								   |	        REAL*8 FMIN,FPLUS,HMIN,NMIN
	REAL(10) RHS_JNU									   |		REAL*8 RHS_JNU
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
            T1=CON_DELTA(ND)/LOG_NU/CHI(ND)							   |	            T1=CON_DELTA(ND)/dLOG_NU/CHI(ND)
./plane/var_jrel_v5.f
	1                  INIT,FREQ,LOG_NU,							   |		1                  INIT,FREQ,dLOG_NU,
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dIBCHI_A,dIBCHI_B								   |		REAL*8 dIBCHI_A,dIBCHI_B
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU										   |		REAL*8 DTAU
	REAL(10) FREQ										   |		REAL*8 FREQ
        REAL(10) RSQ_JP,RSQ_HP,RSQ_NP								   |	        REAL*8 RSQ_JP,RSQ_HP,RSQ_NP
        REAL(10) FMIN,FPLUS,HMIN,NMIN								   |	        REAL*8 FMIN,FPLUS,HMIN,NMIN
	REAL(10) RHS_JNU									   |		REAL*8 RHS_JNU
! We are integrating from blue to red. LOG_NU is define as vd / dv which is 			   |	! We are integrating from blue to red. dLOG_NU is define as vd / dv which is 
	    DELTAH(I)=CON_DELTAH(I)/LOG_NU/(CHI_H(I)+CHI_H(I+1))				   |		    DELTAH(I)=CON_DELTAH(I)/dLOG_NU/(CHI_H(I)+CHI_H(I+1))
	    DELTA(I)=CON_DELTA(I)/CHI_J(I)/LOG_NU						   |		    DELTA(I)=CON_DELTA(I)/CHI_J(I)/dLOG_NU
	  DELTA(1)=CON_DELTA(1)/CHI_H(1)/LOG_NU							   |		  DELTA(1)=CON_DELTA(1)/CHI_H(1)/dLOG_NU
            T1=CON_DELTA(ND)/LOG_NU/CHI(ND)							   |	            T1=CON_DELTA(ND)/dLOG_NU/CHI(ND)
./plane/var_mom_j_cmf_v10.f
	1               INIT,LOG_NU,DIF,dTdR,DBB,dDBBdT,IC,					   |		1               INIT,dLOG_NU,DIF,dTdR,DBB,dDBBdT,IC,
! Altered:   05-Dec-1996 : PROGDESC set to REAL(10) value, PROG_ID installed			   |	! Altered:   05-Dec-1996 : PROGDESC set to REAL*8 value, PROG_ID installed
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),THETA(ND)						   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),THETA(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU_BND									   |		REAL*8 DTAU_BND
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
	1         /LOG_NU/( CHI(I)+CHI(I+1) )							   |		1         /dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/LOG_NU						   |		    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/dLOG_NU
./plane/var_mom_j_cmf_v11.f
	1               INIT,LOG_NU,								   |		1               INIT,dLOG_NU,
! Altered:   05-Dec-1996 : PROGDESC set to REAL(10) value, PROG_ID installed			   |	! Altered:   05-Dec-1996 : PROGDESC set to REAL*8 value, PROG_ID installed
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),THETA(ND)						   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),THETA(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU_BND									   |		REAL*8 DTAU_BND
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
	REAL(10) LOCAL_DBB									   |		REAL*8 LOCAL_DBB
	1         /LOG_NU/( CHI(I)+CHI(I+1) )							   |		1         /dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/LOG_NU						   |		    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/dLOG_NU
./plane/var_mom_j_cmf_v12.f
	1               INIT,LOG_NU,								   |		1               INIT,dLOG_NU,
! Altered:   05-Dec-1996 : PROGDESC set to REAL(10) value, PROG_ID installed			   |	! Altered:   05-Dec-1996 : PROGDESC set to REAL*8 value, PROG_ID installed
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),THETA(ND)						   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),THETA(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) IB_STAB_FACTOR									   |		REAL*8 IB_STAB_FACTOR
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU_BND									   |		REAL*8 DTAU_BND
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
	REAL(10) LOCAL_DBB									   |		REAL*8 LOCAL_DBB
	1         /LOG_NU/( CHI(I)+CHI(I+1) )							   |		1         /dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/LOG_NU						   |		    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/dLOG_NU
./plane/var_mom_j_cmf_v9.f
	1               INIT,LOG_NU,DIF,dTdR,DBB,dDBBdT,IC,					   |		1               INIT,dLOG_NU,DIF,dTdR,DBB,dDBBdT,IC,
! Altered:   05-Dec-1996 : PROGDESC set to REAL(10) value, PROG_ID installed			   |	! Altered:   05-Dec-1996 : PROGDESC set to REAL*8 value, PROG_ID installed
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),THETA(ND)						   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),THETA(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU_BND									   |		REAL*8 DTAU_BND
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
	1         /LOG_NU/( CHI(I)+CHI(I+1) )							   |		1         /dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/LOG_NU						   |		    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/dLOG_NU
./plane/var_mom_j_ddt_v1.f
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: JNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: JNU_OLDT(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNU(:)
	REAL(10), ALLOCATABLE :: RSQ_HNUM1(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNUM1(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU_OLDT(:)						   |		REAL*8, ALLOCATABLE :: RSQ_HNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: DJDt(:)							   |		REAL*8, ALLOCATABLE :: DJDt(:)
	REAL(10), ALLOCATABLE :: DJDt_OLDT(:)							   |		REAL*8, ALLOCATABLE :: DJDt_OLDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DUMMY_VEC(:)							   |		REAL*8, ALLOCATABLE :: DUMMY_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: RSQ_DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
!												   |	!
	REAL(10) CHI_AT_INB_PREV								   |		REAL*8 CHI_AT_INB_PREV
	REAL(10) DBB_PREV									   |		REAL*8 DBB_PREV
	REAL(10) dDBBDT_PREV									   |		REAL*8 dDBBDT_PREV
!												   |	!
	REAL(10) HONJ_OUTBC_PREV								   |		REAL*8 HONJ_OUTBC_PREV
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
	REAL(10) HFLUX_AT_INB_OLDT								   |		REAL*8 HFLUX_AT_INB_OLDT
	REAL(10) HFLUX_AT_INB_PREV								   |		REAL*8 HFLUX_AT_INB_PREV
!												   |	!
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	1                  DO_TIME_VAR,RELAX_PARAM,INIT,FREQ,LOG_NU,				   |		1                  DO_TIME_VAR,RELAX_PARAM,INIT,FREQ,dLOG_NU,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND)									   |		REAL*8 TX_DIF_d_T(ND)
	REAL(10) TX_DIF_d_dTdR(ND)								   |		REAL*8 TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND)								   |		REAL*8 TVX_DIF_d_T(ND)
	REAL(10) TVX_DIF_d_dTdR(ND)								   |		REAL*8 TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) F_PREV(ND)									   |		REAL*8 F_PREV(ND)
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) HFLUX_AT_INB									   |		REAL*8 HFLUX_AT_INB
!												   |	!
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dNU_TERM_DIF_BC								   |		REAL*8 dNU_TERM_DIF_BC
	REAL(10) dRHSdCHI_DIF_BC								   |		REAL*8 dRHSdCHI_DIF_BC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/LOG_NU/( CHI(I)+CHI(I+1) )/C_KMS		   |		    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/dLOG_NU/( CHI(I)+CHI(I+1) )/C_KMS
	    GAM(I)=V(I)/R(I)/CHI(I)/LOG_NU/C_KMS						   |		    GAM(I)=V(I)/R(I)/CHI(I)/dLOG_NU/C_KMS
	1        V(I)*(XM(I)-JNUM1(I))/R(I)/LOG_NU/C_KMS,					   |		1        V(I)*(XM(I)-JNUM1(I))/R(I)/dLOG_NU/C_KMS,
	1        V(I)*(XM(I)-JNUM1(I))/R(I)/LOG_NU/C_KMS/CHI(I),				   |		1        V(I)*(XM(I)-JNUM1(I))/R(I)/dLOG_NU/C_KMS/CHI(I),
./plane/var_mom_j_ddt_v2.f
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: JNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: JNU_OLDT(:)
	REAL(10), ALLOCATABLE :: JNU_MOD(:)							   |		REAL*8, ALLOCATABLE :: JNU_MOD(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNU(:)
	REAL(10), ALLOCATABLE :: RSQ_HNUM1(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNUM1(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU_OLDT(:)						   |		REAL*8, ALLOCATABLE :: RSQ_HNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: DJDt(:)							   |		REAL*8, ALLOCATABLE :: DJDt(:)
	REAL(10), ALLOCATABLE :: DJDt_OLDT(:)							   |		REAL*8, ALLOCATABLE :: DJDt_OLDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DUMMY_VEC(:)							   |		REAL*8, ALLOCATABLE :: DUMMY_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: RSQ_DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
!												   |	!
	REAL(10) CHI_AT_INB_PREV								   |		REAL*8 CHI_AT_INB_PREV
	REAL(10) DBB_PREV									   |		REAL*8 DBB_PREV
	REAL(10) dDBBDT_PREV									   |		REAL*8 dDBBDT_PREV
!												   |	!
	REAL(10) HONJ_OUTBC_PREV								   |		REAL*8 HONJ_OUTBC_PREV
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
!												   |	!
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	1                  DO_TIME_VAR,RELAX_PARAM,INIT,FREQ,LOG_NU,				   |		1                  DO_TIME_VAR,RELAX_PARAM,INIT,FREQ,dLOG_NU,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND)									   |		REAL*8 TX_DIF_d_T(ND)
	REAL(10) TX_DIF_d_dTdR(ND)								   |		REAL*8 TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND)								   |		REAL*8 TVX_DIF_d_T(ND)
	REAL(10) TVX_DIF_d_dTdR(ND)								   |		REAL*8 TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
!												   |	!
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dNU_TERM_DIF_BC								   |		REAL*8 dNU_TERM_DIF_BC
	REAL(10) dRHSdCHI_IB									   |		REAL*8 dRHSdCHI_IB
	REAL(10) dRHSdCHI_OB									   |		REAL*8 dRHSdCHI_OB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) GAM_INB									   |		REAL*8 GAM_INB
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) HPLUS,FPLUS									   |		REAL*8 HPLUS,FPLUS
	REAL(10) HMIN,FMIN									   |		REAL*8 HMIN,FMIN
	REAL(10) RSQ										   |		REAL*8 RSQ
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/LOG_NU/( CHI(I)+CHI(I+1) )/C_KMS		   |		    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/dLOG_NU/( CHI(I)+CHI(I+1) )/C_KMS
	    GAM(I)=V(I)/R(I)/CHI(I)/LOG_NU/C_KMS						   |		    GAM(I)=V(I)/R(I)/CHI(I)/dLOG_NU/C_KMS
./plane/var_mom_j_ddt_v3.f
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: JNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: JNU_OLDT(:)
	REAL(10), ALLOCATABLE :: JNU_MOD(:)							   |		REAL*8, ALLOCATABLE :: JNU_MOD(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNU(:)
	REAL(10), ALLOCATABLE :: RSQ_HNUM1(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNUM1(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU_OLDT(:)						   |		REAL*8, ALLOCATABLE :: RSQ_HNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: DJDt(:)							   |		REAL*8, ALLOCATABLE :: DJDt(:)
	REAL(10), ALLOCATABLE :: DJDt_OLDT(:)							   |		REAL*8, ALLOCATABLE :: DJDt_OLDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DUMMY_VEC(:)							   |		REAL*8, ALLOCATABLE :: DUMMY_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: RSQ_DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
!												   |	!
	REAL(10) CHI_AT_INB_PREV								   |		REAL*8 CHI_AT_INB_PREV
	REAL(10) DBB_PREV									   |		REAL*8 DBB_PREV
	REAL(10) dDBBDT_PREV									   |		REAL*8 dDBBDT_PREV
!												   |	!
	REAL(10) HONJ_OUTBC_PREV								   |		REAL*8 HONJ_OUTBC_PREV
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
!												   |	!
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_FAC_FOR_J									   |		REAL*8 R_FAC_FOR_J
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,LOG_NU,			   |		1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,dLOG_NU,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND)									   |		REAL*8 TX_DIF_d_T(ND)
	REAL(10) TX_DIF_d_dTdR(ND)								   |		REAL*8 TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND)								   |		REAL*8 TVX_DIF_d_T(ND)
	REAL(10) TVX_DIF_d_dTdR(ND)								   |		REAL*8 TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
!												   |	!
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dNU_TERM_DIF_BC								   |		REAL*8 dNU_TERM_DIF_BC
	REAL(10) dRHSdCHI_IB									   |		REAL*8 dRHSdCHI_IB
	REAL(10) dRHSdCHI_OB									   |		REAL*8 dRHSdCHI_OB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) GAM_INB									   |		REAL*8 GAM_INB
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) HPLUS,FPLUS									   |		REAL*8 HPLUS,FPLUS
	REAL(10) HMIN,FMIN									   |		REAL*8 HMIN,FMIN
	REAL(10) RSQ										   |		REAL*8 RSQ
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/LOG_NU/( CHI(I)+CHI(I+1) )/C_KMS		   |		    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/dLOG_NU/( CHI(I)+CHI(I+1) )/C_KMS
	    GAM(I)=V(I)/R(I)/CHI(I)/LOG_NU/C_KMS						   |		    GAM(I)=V(I)/R(I)/CHI(I)/dLOG_NU/C_KMS
./plane/var_mom_j_ddt_v4.f
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: JNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: JNU_OLDT(:)
	REAL(10), ALLOCATABLE :: JNU_MOD(:)							   |		REAL*8, ALLOCATABLE :: JNU_MOD(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNU(:)
	REAL(10), ALLOCATABLE :: RSQ_HNUM1(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNUM1(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU_OLDT(:)						   |		REAL*8, ALLOCATABLE :: RSQ_HNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: DJDt(:)							   |		REAL*8, ALLOCATABLE :: DJDt(:)
	REAL(10), ALLOCATABLE :: DJDt_OLDT(:)							   |		REAL*8, ALLOCATABLE :: DJDt_OLDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DUMMY_VEC(:)							   |		REAL*8, ALLOCATABLE :: DUMMY_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: RSQ_DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
!												   |	!
	REAL(10) CHI_AT_INB_PREV								   |		REAL*8 CHI_AT_INB_PREV
	REAL(10) DBB_PREV									   |		REAL*8 DBB_PREV
	REAL(10) dDBBDT_PREV									   |		REAL*8 dDBBDT_PREV
!												   |	!
	REAL(10) HONJ_OUTBC_PREV								   |		REAL*8 HONJ_OUTBC_PREV
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
!												   |	!
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_FAC_FOR_J									   |		REAL*8 R_FAC_FOR_J
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,LOG_NU,			   |		1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,dLOG_NU,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND)									   |		REAL*8 TX_DIF_d_T(ND)
	REAL(10) TX_DIF_d_dTdR(ND)								   |		REAL*8 TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND)								   |		REAL*8 TVX_DIF_d_T(ND)
	REAL(10) TVX_DIF_d_dTdR(ND)								   |		REAL*8 TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
!												   |	!
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dNU_TERM_DIF_BC								   |		REAL*8 dNU_TERM_DIF_BC
	REAL(10) dRHSdCHI_IB									   |		REAL*8 dRHSdCHI_IB
	REAL(10) dRHSdCHI_OB									   |		REAL*8 dRHSdCHI_OB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) GAM_INB									   |		REAL*8 GAM_INB
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) HPLUS,FPLUS									   |		REAL*8 HPLUS,FPLUS
	REAL(10) HMIN,FMIN									   |		REAL*8 HMIN,FMIN
	REAL(10) RSQ										   |		REAL*8 RSQ
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/LOG_NU/( CHI(I)+CHI(I+1) )/C_KMS		   |		    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/dLOG_NU/( CHI(I)+CHI(I+1) )/C_KMS
	    GAM(I)=V(I)/R(I)/CHI(I)/LOG_NU/C_KMS						   |		    GAM(I)=V(I)/R(I)/CHI(I)/dLOG_NU/C_KMS
./plane/var_mom_j_ddt_v5.f
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: JNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: JNU_OLDT(:)
	REAL(10), ALLOCATABLE :: JNU_MOD(:)							   |		REAL*8, ALLOCATABLE :: JNU_MOD(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNU(:)
	REAL(10), ALLOCATABLE :: RSQ_HNUM1(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNUM1(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU_OLDT(:)						   |		REAL*8, ALLOCATABLE :: RSQ_HNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: DJDt(:)							   |		REAL*8, ALLOCATABLE :: DJDt(:)
	REAL(10), ALLOCATABLE :: DJDt_OLDT(:)							   |		REAL*8, ALLOCATABLE :: DJDt_OLDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DUMMY_VEC(:)							   |		REAL*8, ALLOCATABLE :: DUMMY_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: RSQ_DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: DERIV_SCL_FAC(:)						   |		REAL*8, ALLOCATABLE :: DERIV_SCL_FAC(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
!												   |	!
	REAL(10) CHI_AT_INB_PREV								   |		REAL*8 CHI_AT_INB_PREV
	REAL(10) DBB_PREV									   |		REAL*8 DBB_PREV
	REAL(10) dDBBDT_PREV									   |		REAL*8 dDBBDT_PREV
!												   |	!
	REAL(10) HONJ_OUTBC_PREV								   |		REAL*8 HONJ_OUTBC_PREV
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
!												   |	!
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_FAC_FOR_J									   |		REAL*8 R_FAC_FOR_J
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,LOG_NU,			   |		1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,dLOG_NU,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND)									   |		REAL*8 TX_DIF_d_T(ND)
	REAL(10) TX_DIF_d_dTdR(ND)								   |		REAL*8 TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND)								   |		REAL*8 TVX_DIF_d_T(ND)
	REAL(10) TVX_DIF_d_dTdR(ND)								   |		REAL*8 TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
!												   |	!
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dNU_TERM_DIF_BC								   |		REAL*8 dNU_TERM_DIF_BC
	REAL(10) dRHSdCHI_IB									   |		REAL*8 dRHSdCHI_IB
	REAL(10) dRHSdCHI_OB									   |		REAL*8 dRHSdCHI_OB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) GAM_INB									   |		REAL*8 GAM_INB
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) HPLUS,FPLUS									   |		REAL*8 HPLUS,FPLUS
	REAL(10) HMIN,FMIN									   |		REAL*8 HMIN,FMIN
	REAL(10) RSQ										   |		REAL*8 RSQ
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/LOG_NU/( CHI(I)+CHI(I+1) )/C_KMS		   |		    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/dLOG_NU/( CHI(I)+CHI(I+1) )/C_KMS
	    GAM(I)=V(I)/R(I)/CHI(I)/LOG_NU/C_KMS						   |		    GAM(I)=V(I)/R(I)/CHI(I)/dLOG_NU/C_KMS
./plane/var_mom_j_ddt_v6.f
	REAL(10), ALLOCATABLE :: JNU(:)								   |		REAL*8, ALLOCATABLE :: JNU(:)
	REAL(10), ALLOCATABLE :: JNUM1(:)							   |		REAL*8, ALLOCATABLE :: JNUM1(:)
	REAL(10), ALLOCATABLE :: JNU_OLDT(:)							   |		REAL*8, ALLOCATABLE :: JNU_OLDT(:)
	REAL(10), ALLOCATABLE :: JNU_MOD(:)							   |		REAL*8, ALLOCATABLE :: JNU_MOD(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNU(:)
	REAL(10), ALLOCATABLE :: RSQ_HNUM1(:)							   |		REAL*8, ALLOCATABLE :: RSQ_HNUM1(:)
	REAL(10), ALLOCATABLE :: RSQ_HNU_OLDT(:)						   |		REAL*8, ALLOCATABLE :: RSQ_HNU_OLDT(:)
!												   |	!
	REAL(10), ALLOCATABLE :: dH(:)								   |		REAL*8, ALLOCATABLE :: dH(:)
	REAL(10), ALLOCATABLE :: dH_OLDT(:)							   |		REAL*8, ALLOCATABLE :: dH_OLDT(:)
	REAL(10), ALLOCATABLE :: DJDt(:)							   |		REAL*8, ALLOCATABLE :: DJDt(:)
	REAL(10), ALLOCATABLE :: DJDt_OLDT(:)							   |		REAL*8, ALLOCATABLE :: DJDt_OLDT(:)
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DUMMY_VEC(:)							   |		REAL*8, ALLOCATABLE :: DUMMY_VEC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: HT(:)								   |		REAL*8, ALLOCATABLE :: HT(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: RSQ_DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: RSQ_DTAUONQ(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_T(:)							   |		REAL*8, ALLOCATABLE :: TX_OLD_d_T(:)
	REAL(10), ALLOCATABLE :: TX_OLD_d_dTdR(:)						   |		REAL*8, ALLOCATABLE :: TX_OLD_d_dTdR(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: DERIV_SCL_FAC(:)						   |		REAL*8, ALLOCATABLE :: DERIV_SCL_FAC(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
!												   |	!
	REAL(10) CHI_AT_INB_PREV								   |		REAL*8 CHI_AT_INB_PREV
	REAL(10) DBB_PREV									   |		REAL*8 DBB_PREV
	REAL(10) dDBBDT_PREV									   |		REAL*8 dDBBDT_PREV
!												   |	!
	REAL(10) HONJ_OUTBC_PREV								   |		REAL*8 HONJ_OUTBC_PREV
	REAL(10) HONJ_OUTBC_OLDT								   |		REAL*8 HONJ_OUTBC_OLDT
	REAL(10) RSQH_AT_IB_OLDT								   |		REAL*8 RSQH_AT_IB_OLDT
	REAL(10) RSQH_AT_IB_PREV								   |		REAL*8 RSQH_AT_IB_PREV
!												   |	!
	REAL(10) ROLD_ON_R									   |		REAL*8 ROLD_ON_R
	REAL(10) R_FAC_FOR_J									   |		REAL*8 R_FAC_FOR_J
	REAL(10) DELTA_TIME_SECS								   |		REAL*8 DELTA_TIME_SECS
	REAL(10) RECIP_CDELTAT									   |		REAL*8 RECIP_CDELTAT
	1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,LOG_NU,			   |		1                  DO_TIME_VAR,USE_DR4JDT,RELAX_PARAM,INIT,FREQ,dLOG_NU,
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) THETA(ND)									   |		REAL*8 THETA(ND)
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) TVX(ND-1,ND,NM)								   |		REAL*8 TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND)									   |		REAL*8 TX_DIF_d_T(ND)
	REAL(10) TX_DIF_d_dTdR(ND)								   |		REAL*8 TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND)								   |		REAL*8 TVX_DIF_d_T(ND)
	REAL(10) TVX_DIF_d_dTdR(ND)								   |		REAL*8 TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) HONJ_OUTBC									   |		REAL*8 HONJ_OUTBC
	REAL(10) RSQH_AT_IB									   |		REAL*8 RSQH_AT_IB
	REAL(10) RSQH_AT_OB									   |		REAL*8 RSQH_AT_OB
!												   |	!
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) dNU_TERM_DIF_BC								   |		REAL*8 dNU_TERM_DIF_BC
	REAL(10) dRHSdCHI_IB									   |		REAL*8 dRHSdCHI_IB
	REAL(10) dRHSdCHI_OB									   |		REAL*8 dRHSdCHI_OB
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) GAM_INB									   |		REAL*8 GAM_INB
	REAL(10) MOD_DTAU									   |		REAL*8 MOD_DTAU
	REAL(10) HPLUS,FPLUS									   |		REAL*8 HPLUS,FPLUS
	REAL(10) HMIN,FMIN									   |		REAL*8 HMIN,FMIN
	REAL(10) RSQ										   |		REAL*8 RSQ
	REAL(10) RELAX_PARAM									   |		REAL*8 RELAX_PARAM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/LOG_NU/( CHI(I)+CHI(I+1) )/C_KMS		   |		    GAMH(I)=2.0D0*(V(I)+V(I+1))/(R(I)+R(I+1))/dLOG_NU/( CHI(I)+CHI(I+1) )/C_KMS
	    GAM(I)=V(I)/R(I)/CHI(I)/LOG_NU/C_KMS						   |		    GAM(I)=V(I)/R(I)/CHI(I)/dLOG_NU/C_KMS
./plane/var_mom_jext_cmf_v3.f
	1                  INIT,LOG_NU,DIF,dTdR,DBB,dDBBdT,IC,					   |		1                  INIT,dLOG_NU,DIF,dTdR,DBB,dDBBdT,IC,
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) COEF(0:3,ND)									   |		REAL*8 COEF(0:3,ND)
	REAL(10) TX(ND,ND_SM,NM)								   |		REAL*8 TX(ND,ND_SM,NM)
	REAL(10) TVX(ND-1,ND_SM,NM)								   |		REAL*8 TVX(ND-1,ND_SM,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) LOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) JNUM1(NV),RSQ_HNUM1(NV)							   |		REAL*8 JNUM1(NV),RSQ_HNUM1(NV)
	REAL(10) KI_SM(ND,ND_SM,NM_KI)								   |		REAL*8 KI_SM(ND,ND_SM,NM_KI)
	REAL(10) RHS_dHdCHI_SM(ND-1,ND_SM)							   |		REAL*8 RHS_dHdCHI_SM(ND-1,ND_SM)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)					   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)
	REAL(10) XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)					   |		REAL*8 XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),THETA(NV)					   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),THETA(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)						   |		REAL*8 PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)
	REAL(10) EPS_A(NV),EPS_B(NV)								   |		REAL*8 EPS_A(NV),EPS_B(NV)
	REAL(10) EPS_PREV_A(NV),EPS_PREV_B(NV)							   |		REAL*8 EPS_PREV_A(NV),EPS_PREV_B(NV)
	REAL(10) TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)						   |		REAL*8 TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
	REAL(10), PARAMETER :: PROG_ID=3.4281463D+08  !Must be unique (VAR_MOM_)		   |		REAL*8, PARAMETER :: PROG_ID=3.4281463D+08  !Must be unique (VAR_MOM_)
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
	1         /LOG_NU/( CHI(I)+CHI(I+1) )							   |		1         /dLOG_NU/( CHI(I)+CHI(I+1) )
	    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/LOG_NU						   |		    GAM(I)=3.33564D-06*V(I)/R(I)/CHI(I)/dLOG_NU
./plane/var_mom_pp_v1.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) F(ND)		!F (=J/K) must be supplied.					   |		REAL*8 F(ND)		!F (=J/K) must be supplied.
	REAL(10) TX(ND,ND,NM)									   |		REAL*8 TX(ND,ND,NM)
	REAL(10) dJ_DIFF_dT(ND)									   |		REAL*8 dJ_DIFF_dT(ND)
	REAL(10) dJ_DIFF_ddTdR(ND)								   |		REAL*8 dJ_DIFF_ddTdR(ND)
	REAL(10) HBC_J		!H = HBC_J*J(1) + HBC_J*S(1) 					   |		REAL*8 HBC_J		!H = HBC_J*J(1) + HBC_J*S(1) 
	REAL(10) HBC_S										   |		REAL*8 HBC_S
	REAL(10) IN_HBC		!H = 0.25Ic - hJ -hIc/2 (inner boundary)			   |		REAL*8 IN_HBC		!H = 0.25Ic - hJ -hIc/2 (inner boundary)
!												   |	!
	REAL(10) DBB		!|dB/dR| -- for diffusion approximation.			   |		REAL*8 DBB		!|dB/dR| -- for diffusion approximation.
	REAL(10) dDBBdT										   |		REAL*8 dDBBdT
	REAL(10) dTdR										   |		REAL*8 dTdR
	REAL(10) IC		!Intensity at inner boundary (used if DIFF=.FALSE.)		   |		REAL*8 IC		!Intensity at inner boundary (used if DIFF=.FALSE.)
	REAL(10) dJ_dDBB(ND)									   |		REAL*8 dJ_dDBB(ND)
	REAL(10) JNU(ND)									   |		REAL*8 JNU(ND)
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) DD(ND)										   |		REAL*8 DD(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) RHS(ND)									   |		REAL*8 RHS(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) SOURCE(ND)									   |		REAL*8 SOURCE(ND)
	REAL(10) COH_VEC(ND)									   |		REAL*8 COH_VEC(ND)
	REAL(10) TOR,E2TOR,EXPN									   |		REAL*8 TOR,E2TOR,EXPN
./plane/velocity_law.f
      REAL(10) RVAL										   |	      REAL*8 RVAL
      REAL(10) R(ND)										   |	      REAL*8 R(ND)
      REAL(10) V(ND)										   |	      REAL*8 V(ND)
      REAL(10) VEL										   |	      REAL*8 VEL
      REAL(10) BETA										   |	      REAL*8 BETA
      REAL(10) DBETADR										   |	      REAL*8 DBETADR
      REAL(10) GAMMA										   |	      REAL*8 GAMMA
      REAL(10), PARAMETER :: C_KMS=2.99792458D+05						   |	      REAL*8, PARAMETER :: C_KMS=2.99792458D+05
      REAL(10) T1										   |	      REAL*8 T1
 
Comparing files in ./spec_plt with those in  /home/hillier/wnode04/cmf_testing_real8//spec_plt
 
./spec_plt/Makefile
#       $(EXE_DIR)plt_ip.exe\									   <
												   >	       $(EXE_DIR)plt_ip.exe\
												   >	       $(EXE_DIR)plt_spec.exe\
												   <
#       $(EXE_DIR)plt_spec.exe\									   <
./spec_plt/get_indx_dp.f
	REAL(10) R(NW),RVAL									   |		REAL*8 R(NW),RVAL
./spec_plt/new_plt_rj.f
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: RJ(:,:)							   |		REAL*8, ALLOCATABLE :: RJ(:,:)
	REAL(10), ALLOCATABLE :: RJ_ES_RD(:,:)							   |		REAL*8, ALLOCATABLE :: RJ_ES_RD(:,:)
	REAL(10), ALLOCATABLE :: FLUX_RJ(:)							   |		REAL*8, ALLOCATABLE :: FLUX_RJ(:)
	REAL(10), ALLOCATABLE :: FLUX_ES(:)							   |		REAL*8, ALLOCATABLE :: FLUX_ES(:)
	REAL(10), ALLOCATABLE :: PLANCK_FN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_FN(:)
C												   |	C
	REAL(10), ALLOCATABLE :: A(:)								   |		REAL*8, ALLOCATABLE :: A(:)
	REAL(10), ALLOCATABLE :: B(:)								   |		REAL*8, ALLOCATABLE :: B(:)
	REAL(10), ALLOCATABLE :: C(:)								   |		REAL*8, ALLOCATABLE :: C(:)
	REAL(10), ALLOCATABLE :: D(:)								   |		REAL*8, ALLOCATABLE :: D(:)
	REAL(10), ALLOCATABLE :: J_ES(:)							   |		REAL*8, ALLOCATABLE :: J_ES(:)
	REAL(10), ALLOCATABLE :: RJ_TMP(:)							   |		REAL*8, ALLOCATABLE :: RJ_TMP(:)
	REAL(10) RJ_FLUX,ES_FLUX,ES2_FLUX							   |		REAL*8 RJ_FLUX,ES_FLUX,ES2_FLUX
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) C_KMS,NU_0									   |		REAL*8 C_KMS,NU_0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) FUN_PI,SPEED_OF_LIGHT								   |		REAL*8 FUN_PI,SPEED_OF_LIGHT
	  YV(1:NCF)=LOG10(J_ES(1:NCF))								   |		  YV(1:NCF)=DLOG10(J_ES(1:NCF))
	  YV(1:NCF)=LOG10( RJ_ES_RD(K,1:NCF) )							   |		  YV(1:NCF)=DLOG10( RJ_ES_RD(K,1:NCF) )
	REAL(10) A(N1),H(N1),C(N1),D(N1,N2)							   |		REAL*8 A(N1),H(N1),C(N1),D(N1,N2)
	REAL(10) DIV(N1)									   |		REAL*8 DIV(N1)
./spec_plt/plt_delta.f
	REAL(10), ALLOCATABLE :: ID(:,:,:)		!I(delta,p,nu)				   |		REAL*8, ALLOCATABLE :: ID(:,:,:)		!I(delta,p,nu)
	REAL(10), ALLOCATABLE :: IP(:,:)			!I(p,nu)			   |		REAL*8, ALLOCATABLE :: IP(:,:)			!I(p,nu)
	REAL(10), ALLOCATABLE :: NU(:)			!Frequency (10^15 Hz)			   |		REAL*8, ALLOCATABLE :: NU(:)			!Frequency (10^15 Hz)
	REAL(10), ALLOCATABLE :: OBSF(:)			!Spectrum contained from ID	   |		REAL*8, ALLOCATABLE :: OBSF(:)			!Spectrum contained from ID
	REAL(10), ALLOCATABLE :: P(:)								   |		REAL*8, ALLOCATABLE :: P(:)
	REAL(10), ALLOCATABLE :: HQW(:)								   |		REAL*8, ALLOCATABLE :: HQW(:)
	REAL(10), ALLOCATABLE :: DELTA(:)							   |		REAL*8, ALLOCATABLE :: DELTA(:)
	REAL(10), ALLOCATABLE :: DELTA_QW(:)							   |		REAL*8, ALLOCATABLE :: DELTA_QW(:)
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TAU_ROSS(:)							   |		REAL*8, ALLOCATABLE :: TAU_ROSS(:)
	REAL(10), ALLOCATABLE :: TAU_ES(:)							   |		REAL*8, ALLOCATABLE :: TAU_ES(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TEMP_P(:)							   |		REAL*8, ALLOCATABLE :: TEMP_P(:)
	REAL(10), ALLOCATABLE :: TEMP_IP(:)							   |		REAL*8, ALLOCATABLE :: TEMP_IP(:)
!												   |	!
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10) LAMBDA										   |		REAL*8 LAMBDA
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: TGREY(:)							   |		REAL*8, ALLOCATABLE :: TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: POPTOM(:)							   |		REAL*8, ALLOCATABLE :: POPTOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) RAD_VEL									   |		REAL*8 RAD_VEL
	REAL(10) ADD_FAC									   |		REAL*8 ADD_FAC
	REAL(10) WT(30)										   |		REAL*8 WT(30)
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) KEV_TO_HZ									   |		REAL*8 KEV_TO_HZ
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) DISTANCE			!kpc						   |		REAL*8 DISTANCE			!kpc
	REAL(10) SLIT_WIDTH		!arcseconds						   |		REAL*8 SLIT_WIDTH		!arcseconds
	REAL(10) PIXEL_LENGTH		!arcseconds						   |		REAL*8 PIXEL_LENGTH		!arcseconds
!												   |	!
	REAL(10) X_CENT										   |		REAL*8 X_CENT
	REAL(10) Y_CENT										   |		REAL*8 Y_CENT
	REAL(10) S_WIDTH									   |		REAL*8 S_WIDTH
	REAL(10) S_LNGTH									   |		REAL*8 S_LNGTH
	REAL(10) APP_SIZE									   |		REAL*8 APP_SIZE
	REAL(10) TEL_FWHM									   |		REAL*8 TEL_FWHM
	REAL(10) MOD_RES									   |		REAL*8 MOD_RES
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) DELV										   |		REAL*8 DELV
	REAL(10) FRAC										   |		REAL*8 FRAC
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10), PARAMETER :: RZERO=0.0D0							   |		REAL*8, PARAMETER :: RZERO=0.0D0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,FAC,LAM_VAC,PARSEC						   |		REAL*8 SPEED_OF_LIGHT,FAC,LAM_VAC,PARSEC
	REAL(10) FAC										   |		REAL*8 FAC
./spec_plt/plt_dfr.f
	REAL(10), ALLOCATABLE :: dFR(:,:)							   |		REAL*8, ALLOCATABLE :: dFR(:,:)
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TAU_FLUX(:)							   |		REAL*8, ALLOCATABLE :: TAU_FLUX(:)
	REAL(10), ALLOCATABLE :: TAU_ROSS(:)							   |		REAL*8, ALLOCATABLE :: TAU_ROSS(:)
	REAL(10), ALLOCATABLE :: TAU_ES(:)							   |		REAL*8, ALLOCATABLE :: TAU_ES(:)
!												   |	!
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10) LAMBDA										   |		REAL*8 LAMBDA
	REAL(10), ALLOCATABLE :: R_RVTJ(:)							   |		REAL*8, ALLOCATABLE :: R_RVTJ(:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: TGREY(:)							   |		REAL*8, ALLOCATABLE :: TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: POPTOM(:)							   |		REAL*8, ALLOCATABLE :: POPTOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) RAD_VEL									   |		REAL*8 RAD_VEL
	REAL(10) ADD_FAC									   |		REAL*8 ADD_FAC
	REAL(10) WT(30)										   |		REAL*8 WT(30)
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) KEV_TO_HZ									   |		REAL*8 KEV_TO_HZ
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) DISTANCE			!kpc						   |		REAL*8 DISTANCE			!kpc
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) RPHOT_ROSS,RPHOT_ES								   |		REAL*8 RPHOT_ROSS,RPHOT_ES
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) RPHOT,VPHOT									   |		REAL*8 RPHOT,VPHOT
	REAL(10) FRAC										   |		REAL*8 FRAC
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10), PARAMETER :: RZERO=0.0D0							   |		REAL*8, PARAMETER :: RZERO=0.0D0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,FAC,LAM_VAC,PARSEC,LAMVACAIR					   |		REAL*8 SPEED_OF_LIGHT,FAC,LAM_VAC,PARSEC,LAMVACAIR
	REAL(10) FAC										   |		REAL*8 FAC
./spec_plt/plt_ip.f
! Altered 05-Feb-2021 : XV, YV etc now REAL(10) 						   |	! Altered 05-Feb-2021 : XV, YV etc now REAL*8 
!                         Tyring to make all non-PGPLOT routines REAL(10).			   |	!                         Tyring to make all non-PGPLOT routines REAL*8.
	REAL(10), ALLOCATABLE :: IP(:,:)							   |		REAL*8, ALLOCATABLE :: IP(:,:)
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: LAM(:)								   |		REAL*8, ALLOCATABLE :: LAM(:)
	REAL(10), ALLOCATABLE :: P(:)								   |		REAL*8, ALLOCATABLE :: P(:)
	REAL(10), ALLOCATABLE :: MU(:)								   |		REAL*8, ALLOCATABLE :: MU(:)
	REAL(10), ALLOCATABLE :: TMP_MU(:)							   |		REAL*8, ALLOCATABLE :: TMP_MU(:)
	REAL(10), ALLOCATABLE :: IP_NEW(:)							   |		REAL*8, ALLOCATABLE :: IP_NEW(:)
	REAL(10), ALLOCATABLE :: P_NEW(:)							   |		REAL*8, ALLOCATABLE :: P_NEW(:)
	REAL(10), ALLOCATABLE :: HQW_AT_RMAX(:)							   |		REAL*8, ALLOCATABLE :: HQW_AT_RMAX(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TAU_ROSS(:)							   |		REAL*8, ALLOCATABLE :: TAU_ROSS(:)
	REAL(10), ALLOCATABLE :: TAU_ES(:)							   |		REAL*8, ALLOCATABLE :: TAU_ES(:)
!												   |	!
	REAL(10), ALLOCATABLE :: TEMP_P(:)							   |		REAL*8, ALLOCATABLE :: TEMP_P(:)
	REAL(10), ALLOCATABLE :: TEMP_IP(:)							   |		REAL*8, ALLOCATABLE :: TEMP_IP(:)
	REAL(10), ALLOCATABLE :: COEF(:,:)							   |		REAL*8, ALLOCATABLE :: COEF(:,:)
!												   |	!
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10) LAMBDA										   |		REAL*8 LAMBDA
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: TGREY(:)							   |		REAL*8, ALLOCATABLE :: TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: POPTOM(:)							   |		REAL*8, ALLOCATABLE :: POPTOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: WV(:)								   |		REAL*8, ALLOCATABLE :: WV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) RAD_VEL									   |		REAL*8 RAD_VEL
	REAL(10) ADD_FAC									   |		REAL*8 ADD_FAC
	REAL(10) WT(30)										   |		REAL*8 WT(30)
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) KEV_TO_HZ									   |		REAL*8 KEV_TO_HZ
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) DISTANCE			!kpc						   |		REAL*8 DISTANCE			!kpc
	REAL(10) SLIT_WIDTH		!arcseconds						   |		REAL*8 SLIT_WIDTH		!arcseconds
	REAL(10) PIXEL_LENGTH		!arcseconds						   |		REAL*8 PIXEL_LENGTH		!arcseconds
!												   |	!
	REAL(10) X_CENT										   |		REAL*8 X_CENT
	REAL(10) Y_CENT										   |		REAL*8 Y_CENT
	REAL(10) S_WIDTH									   |		REAL*8 S_WIDTH
	REAL(10) S_LNGTH									   |		REAL*8 S_LNGTH
	REAL(10) APP_SIZE									   |		REAL*8 APP_SIZE
	REAL(10) TEL_FWHM									   |		REAL*8 TEL_FWHM
	REAL(10) MOD_RES									   |		REAL*8 MOD_RES
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) DELV										   |		REAL*8 DELV
	REAL(10) FRAC										   |		REAL*8 FRAC
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10),  PARAMETER :: RZERO=0.0D0							   |		REAL*8,  PARAMETER :: RZERO=0.0D0
	REAL(10),  PARAMETER :: RONE=1.0D0							   |		REAL*8,  PARAMETER :: RONE=1.0D0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,FAC,LAM_VAC,PARSEC						   |		REAL*8 SPEED_OF_LIGHT,FAC,LAM_VAC,PARSEC
	REAL(10) FAC										   |		REAL*8 FAC
./spec_plt/plt_jh_cur.f
	  REAL(10), POINTER :: RJ(:,:)								   |		  REAL*8, POINTER :: RJ(:,:)
	  REAL(10), POINTER :: HFLUX(:,:)							   |		  REAL*8, POINTER :: HFLUX(:,:)
	  REAL(10), POINTER :: JGREY(:)								   |		  REAL*8, POINTER :: JGREY(:)
	  REAL(10), POINTER :: HGREY(:)								   |		  REAL*8, POINTER :: HGREY(:)
	  REAL(10), POINTER :: NU(:)								   |		  REAL*8, POINTER :: NU(:)
	  REAL(10), POINTER :: R(:)								   |		  REAL*8, POINTER :: R(:)
	  REAL(10), POINTER :: V(:)								   |		  REAL*8, POINTER :: V(:)
	  REAL(10), POINTER :: H_INBC(:)							   |		  REAL*8, POINTER :: H_INBC(:)
	  REAL(10), POINTER :: H_OUTBC(:)							   |		  REAL*8, POINTER :: H_OUTBC(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TAU_ROSS(:)							   |		REAL*8, ALLOCATABLE :: TAU_ROSS(:)
	REAL(10), ALLOCATABLE :: TAU_ES(:)							   |		REAL*8, ALLOCATABLE :: TAU_ES(:)
!												   |	!
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: TGREY(:)							   |		REAL*8, ALLOCATABLE :: TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: XV_MID(:)							   |		REAL*8, ALLOCATABLE :: XV_MID(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) KEV_TO_HZ									   |		REAL*8 KEV_TO_HZ
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SN_AGE										   |		REAL*8 SN_AGE
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) RVAL										   |		REAL*8 RVAL
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) DTDR										   |		REAL*8 DTDR
	REAL(10) RADIUS										   |		REAL*8 RADIUS
	REAL(10) LAMBDA										   |		REAL*8 LAMBDA
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10), ALLOCATABLE :: NEW_R(:)							   |		REAL*8, ALLOCATABLE :: NEW_R(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,FAC,LAM_VAC							   |		REAL*8 SPEED_OF_LIGHT,FAC,LAM_VAC
              YV(I)=RVAL*RVAL*TWOHCSQ*(ZM(1)%NU(I)**3)*EXP(-T3)/(1.0D0-EXP(-T3))		   |	              YV(I)=RVAL*RVAL*TWOHCSQ*(ZM(1)%NU(I)**3)*DEXP(-T3)/(1.0D0-DEXP(-T3))
              YV(I)=RVAL*RVAL*TWOHCSQ*(ZM(1)%NU(I)**3)/(EXP(T3)-1.0D0)				   |	              YV(I)=RVAL*RVAL*TWOHCSQ*(ZM(1)%NU(I)**3)/(DEXP(T3)-1.0D0)
	    XV(1:ND)=LOG10(R(1:ND)/T2)								   |		    XV(1:ND)=DLOG10(R(1:ND)/T2)
	REAL(10) FAC										   |		REAL*8 FAC
	REAL(10) XV(ND)										   |		REAL*8 XV(ND)
	REAL(10) XV_MID(ND)									   |		REAL*8 XV_MID(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
./spec_plt/plt_jh.f
	  REAL(10), POINTER :: RJ(:,:)								   |		  REAL*8, POINTER :: RJ(:,:)
	  REAL(10), POINTER :: NU(:)								   |		  REAL*8, POINTER :: NU(:)
	  REAL(10), POINTER :: R(:)								   |		  REAL*8, POINTER :: R(:)
	  REAL(10), POINTER :: V(:)								   |		  REAL*8, POINTER :: V(:)
	  REAL(10), POINTER :: ED(:)								   |		  REAL*8, POINTER :: ED(:)
	  REAL(10), POINTER :: T(:)								   |		  REAL*8, POINTER :: T(:)
	  REAL(10), POINTER :: TAU_ES(:)							   |		  REAL*8, POINTER :: TAU_ES(:)
	  REAL(10), POINTER :: LANG_COORD(:)							   |		  REAL*8, POINTER :: LANG_COORD(:)
	  REAL(10), POINTER :: XV(:)								   |		  REAL*8, POINTER :: XV(:)
	REAL(10), ALLOCATABLE :: RJ_B(:,:)							   |		REAL*8, ALLOCATABLE :: RJ_B(:,:)
	REAL(10), ALLOCATABLE :: NU_B(:)							   |		REAL*8, ALLOCATABLE :: NU_B(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: TAU_ROSS(:)							   |		REAL*8, ALLOCATABLE :: TAU_ROSS(:)
	REAL(10), ALLOCATABLE :: TAU_ES(:)							   |		REAL*8, ALLOCATABLE :: TAU_ES(:)
!												   |	!
	REAL(10) RMDOT										   |		REAL*8 RMDOT
	REAL(10) RLUM										   |		REAL*8 RLUM
	REAL(10) ABUND_HYD									   |		REAL*8 ABUND_HYD
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: T(:)								   |		REAL*8, ALLOCATABLE :: T(:)
	REAL(10), ALLOCATABLE :: ED(:)								   |		REAL*8, ALLOCATABLE :: ED(:)
	REAL(10), ALLOCATABLE :: TGREY(:)							   |		REAL*8, ALLOCATABLE :: TGREY(:)
	REAL(10), ALLOCATABLE :: dE_RAD_DECAY(:)						   |		REAL*8, ALLOCATABLE :: dE_RAD_DECAY(:)
	REAL(10), ALLOCATABLE :: ROSS_MEAN(:)							   |		REAL*8, ALLOCATABLE :: ROSS_MEAN(:)
	REAL(10), ALLOCATABLE :: FLUX_MEAN(:)							   |		REAL*8, ALLOCATABLE :: FLUX_MEAN(:)
	REAL(10), ALLOCATABLE :: PLANCK_MEAN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_MEAN(:)
	REAL(10), ALLOCATABLE :: POP_ATOM(:)							   |		REAL*8, ALLOCATABLE :: POP_ATOM(:)
	REAL(10), ALLOCATABLE :: MASS_DENSITY(:)						   |		REAL*8, ALLOCATABLE :: MASS_DENSITY(:)
	REAL(10), ALLOCATABLE :: POPION(:)							   |		REAL*8, ALLOCATABLE :: POPION(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC(:)							   |		REAL*8, ALLOCATABLE :: CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: POPS(:,:)							   |		REAL*8, ALLOCATABLE :: POPS(:,:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) KEV_TO_HZ									   |		REAL*8 KEV_TO_HZ
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) DTDR										   |		REAL*8 DTDR
	REAL(10) RADIUS										   |		REAL*8 RADIUS
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) RVAL										   |		REAL*8 RVAL
	REAL(10) DELR										   |		REAL*8 DELR
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) VMIN										   |		REAL*8 VMIN
	REAL(10) dV_DOP										   |		REAL*8 dV_DOP
	REAL(10) LAM_ST,LAM_END									   |		REAL*8 LAM_ST,LAM_END
	REAL(10) FREQ_VAL									   |		REAL*8 FREQ_VAL
	REAL(10) EDGE_FREQ									   |		REAL*8 EDGE_FREQ
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10) SN_AGE										   |		REAL*8 SN_AGE
	REAL(10), ALLOCATABLE :: NEW_R(:)							   |		REAL*8, ALLOCATABLE :: NEW_R(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,FAC,LAM_VAC							   |		REAL*8 SPEED_OF_LIGHT,FAC,LAM_VAC
              YV(I)=TWOHCSQ*(ZM(1)%NU(I)**3)*EXP(-T3)/(1.0D0-EXP(-T3))				   |	              YV(I)=TWOHCSQ*(ZM(1)%NU(I)**3)*DEXP(-T3)/(1.0D0-DEXP(-T3))
              YV(I)=TWOHCSQ*(ZM(1)%NU(I)**3)/(EXP(T3)-1.0D0)					   |	              YV(I)=TWOHCSQ*(ZM(1)%NU(I)**3)/(DEXP(T3)-1.0D0)
	      YV(I)=YV(I)*EXP(-T3)/(1.0D0-EXP(-T3))/(1.0D0-EXP(-T3))				   |		      YV(I)=YV(I)*DEXP(-T3)/(1.0D0-DEXP(-T3))/(1.0D0-DEXP(-T3))
	      YV(I)=YV(I)*EXP(T3)/(EXP(T3)-1.0D0)/(EXP(T3)-1.0D0)				   |		      YV(I)=YV(I)*DEXP(T3)/(DEXP(T3)-1.0D0)/(DEXP(T3)-1.0D0)
	REAL(10) FAC										   |		REAL*8 FAC
./spec_plt/plt_many_mod.f
	  REAL(10), ALLOCATABLE :: POPS(:,:)							   |		  REAL*8, ALLOCATABLE :: POPS(:,:)
	  REAL(10), ALLOCATABLE :: R(:)			!ND					   |		  REAL*8, ALLOCATABLE :: R(:)			!ND
	  REAL(10), ALLOCATABLE :: V(:)			!ND					   |		  REAL*8, ALLOCATABLE :: V(:)			!ND
	  REAL(10), ALLOCATABLE :: SIGMA(:)		!ND					   |		  REAL*8, ALLOCATABLE :: SIGMA(:)		!ND
	  REAL(10), ALLOCATABLE :: X(:)			!ND					   |		  REAL*8, ALLOCATABLE :: X(:)			!ND
	  REAL(10), ALLOCATABLE :: Y(:)			!ND					   |		  REAL*8, ALLOCATABLE :: Y(:)			!ND
	  REAL(10), ALLOCATABLE :: Z(:)			!ND					   |		  REAL*8, ALLOCATABLE :: Z(:)			!ND
	  REAL(10), ALLOCATABLE :: ZION(:)							   |		  REAL*8, ALLOCATABLE :: ZION(:)
	  REAL(10), ALLOCATABLE :: AT_NO(:)							   |		  REAL*8, ALLOCATABLE :: AT_NO(:)
	REAL(10) RMAX,RMIN									   |		REAL*8 RMAX,RMIN
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) MAX_CHANGE									   |		REAL*8 MAX_CHANGE
	REAL(10) AVE_NEG_CHANGE, MIN_NEG_CHANGE							   |		REAL*8 AVE_NEG_CHANGE, MIN_NEG_CHANGE
	REAL(10) AVE_POS_CHANGE, MAX_POS_CHANGE							   |		REAL*8 AVE_POS_CHANGE, MAX_POS_CHANGE
./spec_plt/plt_many_sn_spec.f
	REAL(10) OBS_LUM(NMAX)									   |		REAL*8 OBS_LUM(NMAX)
	REAL(10) CMF_LUM(NMAX)									   |		REAL*8 CMF_LUM(NMAX)
	REAL(10) SN_AGE(NMAX)									   |		REAL*8 SN_AGE(NMAX)
	REAL(10) VINF(NMAX)									   |		REAL*8 VINF(NMAX)
	REAL(10) OBS_FREQ(NCF_MAX)								   |		REAL*8 OBS_FREQ(NCF_MAX)
	REAL(10) OBS_FLUX(NCF_MAX)								   |		REAL*8 OBS_FLUX(NCF_MAX)
	REAL(10) NU_CONT(NCF_MAX)								   |		REAL*8 NU_CONT(NCF_MAX)
	REAL(10) FLUX_CONT(NCF_MAX)								   |		REAL*8 FLUX_CONT(NCF_MAX)
	REAL(10) WORK(NCF_MAX)									   |		REAL*8 WORK(NCF_MAX)
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) LUM_CONV_FACTOR								   |		REAL*8 LUM_CONV_FACTOR
	REAL(10) QW										   |		REAL*8 QW
	REAL(10) MAXIMUM,MINIMUM								   |		REAL*8 MAXIMUM,MINIMUM
	REAL(10) XEMIS_MEAN									   |		REAL*8 XEMIS_MEAN
	REAL(10) HA_WAVE									   |		REAL*8 HA_WAVE
	REAL(10) C_Mms										   |		REAL*8 C_Mms
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) HA_VEL_EST									   |		REAL*8 HA_VEL_EST
	REAL(10) HB_VEL_EST									   |		REAL*8 HB_VEL_EST
	REAL(10) FeII_5170_VEL_EST								   |		REAL*8 FeII_5170_VEL_EST
	REAL(10) FeII_5020_VEL_EST								   |		REAL*8 FeII_5020_VEL_EST
	WRITE(6,'(A,T20,A,4X,A,3X,A)')'Model','Age(days)','logt','Vinf(kms)'			   |		WRITE(6,'(A,T20,A,4X,A,3X,A)')'Model','Age(days)','dlogt','Vinf(kms)'
./spec_plt/plt_phot_raw.f
	REAL(10), ALLOCATABLE :: NU_1(:)							   |		REAL*8, ALLOCATABLE :: NU_1(:)
	REAL(10), ALLOCATABLE :: CROSS_1(:)							   |		REAL*8, ALLOCATABLE :: CROSS_1(:)
	REAL(10), ALLOCATABLE :: ENERGY_1(:)							   |		REAL*8, ALLOCATABLE :: ENERGY_1(:)
	REAL(10), ALLOCATABLE :: STAT_WT_1(:)							   |		REAL*8, ALLOCATABLE :: STAT_WT_1(:)
	REAL(10) ZION_1										   |		REAL*8 ZION_1
	REAL(10) GION_1 									   |		REAL*8 GION_1 
	REAL(10) EXC_EN_1									   |		REAL*8 EXC_EN_1
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10), ALLOCATABLE :: NU_2(:)							   |		REAL*8, ALLOCATABLE :: NU_2(:)
	REAL(10), ALLOCATABLE :: CROSS_2(:)							   |		REAL*8, ALLOCATABLE :: CROSS_2(:)
	REAL(10) ZION_2										   |		REAL*8 ZION_2
	REAL(10) GION_2 									   |		REAL*8 GION_2 
	REAL(10) EXC_EN_2									   |		REAL*8 EXC_EN_2
	REAL(10), ALLOCATABLE :: ENERGY(:)							   |		REAL*8, ALLOCATABLE :: ENERGY(:)
	REAL(10), ALLOCATABLE :: G(:)								   |		REAL*8, ALLOCATABLE :: G(:)
	REAL(10) IONIZATION_ENERGY								   |		REAL*8 IONIZATION_ENERGY
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) FREQ_SCL_FAC									   |		REAL*8 FREQ_SCL_FAC
	REAL(10) XV(NCF_MAX),YV(NCF_MAX)							   |		REAL*8 XV(NCF_MAX),YV(NCF_MAX)
	REAL(10), ALLOCATABLE :: LEVEL_INDX(:)							   |		REAL*8, ALLOCATABLE :: LEVEL_INDX(:)
	REAL(10), ALLOCATABLE :: RECOM(:,:)							   |		REAL*8, ALLOCATABLE :: RECOM(:,:)
	REAL(10) TEMP_VEC(NREC_MAX)								   |		REAL*8 TEMP_VEC(NREC_MAX)
	REAL(10) TOTAL_REC_VEC(NREC_MAX)							   |		REAL*8 TOTAL_REC_VEC(NREC_MAX)
	REAL(10) LEVEL_REC_VEC(NREC_MAX)							   |		REAL*8 LEVEL_REC_VEC(NREC_MAX)
!												   |	!
	REAL(10) STAT_WEIGHT,GION,EDGE								   |		REAL*8 STAT_WEIGHT,GION,EDGE
	REAL(10) LEVEL_REC,TOTAL_REC,TEMP							   |		REAL*8 LEVEL_REC,TOTAL_REC,TEMP
	REAL(10) ANG_TO_HZ,SPEED_OF_LIGHT							   |		REAL*8 ANG_TO_HZ,SPEED_OF_LIGHT
	REAL(10), PARAMETER :: RONE=1.0D0							   |		REAL*8, PARAMETER :: RONE=1.0D0
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
./spec_plt/plt_rj.f
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: RJ(:,:)							   |		REAL*8, ALLOCATABLE :: RJ(:,:)
	REAL(10), ALLOCATABLE :: RJ_ES_RD(:,:)							   |		REAL*8, ALLOCATABLE :: RJ_ES_RD(:,:)
	REAL(10), ALLOCATABLE :: FLUX_RJ(:)							   |		REAL*8, ALLOCATABLE :: FLUX_RJ(:)
	REAL(10), ALLOCATABLE :: FLUX_ES(:)							   |		REAL*8, ALLOCATABLE :: FLUX_ES(:)
	REAL(10), ALLOCATABLE :: PLANCK_FN(:)							   |		REAL*8, ALLOCATABLE :: PLANCK_FN(:)
	REAL(10), ALLOCATABLE :: A(:)								   |		REAL*8, ALLOCATABLE :: A(:)
	REAL(10), ALLOCATABLE :: B(:)								   |		REAL*8, ALLOCATABLE :: B(:)
	REAL(10), ALLOCATABLE :: C(:)								   |		REAL*8, ALLOCATABLE :: C(:)
	REAL(10), ALLOCATABLE :: D(:)								   |		REAL*8, ALLOCATABLE :: D(:)
	REAL(10) RJ_FLUX,ES_FLUX,ES2_FLUX							   |		REAL*8 RJ_FLUX,ES_FLUX,ES2_FLUX
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) D1,D2,DH									   |		REAL*8 D1,D2,DH
	REAL(10) SPEED_OF_LIGHT,C_KMS,NU_0							   |		REAL*8 SPEED_OF_LIGHT,C_KMS,NU_0
	  YV(I)=LOG10(D(I))									   |		  YV(I)=DLOG10(D(I))
	REAL(10) A(N1),H(N1),C(N1),D(N1,N2)							   |		REAL*8 A(N1),H(N1),C(N1),D(N1,N2)
	REAL(10) DIV(N1)									   |		REAL*8 DIV(N1)
./spec_plt/plt_scr.f
												   >	! Altered 24-Sep-2023: Added SFDG option (needs work) - 7sep23.
												   >	!                      Added DREP option -- allows one depth to replace other depths.
												   >	!                      Added (modified) DNRG option -- designed to allow testing of subroutine.
												   >	!                      Added CNRG option -- designed to allow modification of R grid using curso
	REAL(10), ALLOCATABLE :: POPS(:,:,:)		!NT,ND,NIT				   |		REAL*8, ALLOCATABLE :: POPS(:,:,:)		!NT,ND,NIT
	REAL(10), ALLOCATABLE :: R_MAT(:,:)		!ND,NIT					   |		REAL*8, ALLOCATABLE :: R_MAT(:,:)		!ND,NIT
	REAL(10), ALLOCATABLE :: V_MAT(:,:)		!ND,NIT					   |		REAL*8, ALLOCATABLE :: V_MAT(:,:)		!ND,NIT
	REAL(10), ALLOCATABLE :: RAT(:,:)			!NT,ND				   |		REAL*8, ALLOCATABLE :: RAT(:,:)			!NT,ND
	REAL(10), ALLOCATABLE :: CORRECTIONS(:,:)			!NT,ND			   |		REAL*8, ALLOCATABLE :: CORRECTIONS(:,:)			!NT,ND
!												   |	!
	REAL(10), ALLOCATABLE :: R(:)			!ND					   |		REAL*8, ALLOCATABLE :: R(:)			!ND
	REAL(10), ALLOCATABLE :: V(:)			!ND					   |		REAL*8, ALLOCATABLE :: V(:)			!ND
	REAL(10), ALLOCATABLE :: SIGMA(:)			!ND				   |		REAL*8, ALLOCATABLE :: SIGMA(:)			!ND
C												   |	C
	REAL(10), ALLOCATABLE :: X(:)			!NIT					   |		REAL*8, ALLOCATABLE :: X(:)			!NIT
	REAL(10), ALLOCATABLE :: Y(:)			!NIT					   |		REAL*8, ALLOCATABLE :: Y(:)			!NIT
	REAL(10), ALLOCATABLE :: Z(:)			!NIT					   |		REAL*8, ALLOCATABLE :: Z(:)			!NIT
												   >		REAL*8, ALLOCATABLE :: TA(:)			!
												   >		REAL*8, ALLOCATABLE :: TB(:)			!
	REAL(10), ALLOCATABLE :: Z_BIG(:)			!NT				   |		REAL*8, ALLOCATABLE :: Z_BIG(:)			!NT
												   >	!
												   >		INTEGER, PARAMETER :: NLEV_MAX=10
												   >		INTEGER LEVELS(NLEV_MAX)
	REAL(10) RMAX,RMIN									   |		REAL*8 RMAX,RMIN
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) MAX_CHANGE									   |		REAL*8 MAX_CHANGE
	REAL(10) AVE_NEG_CHANGE, MIN_NEG_CHANGE							   |		REAL*8 AVE_NEG_CHANGE, MIN_NEG_CHANGE
	REAL(10) AVE_POS_CHANGE, MAX_POS_CHANGE							   |		REAL*8 AVE_POS_CHANGE, MAX_POS_CHANGE
												   >		LOGICAL TMP_LOG
												   >		ALLOCATE (TA(J))
												   >		ALLOCATE (TB(J))
												   >		ELSE IF(PLT_OPT(1:4) .EQ. 'SFDG')THEN
												   >		  FDG_COUNTER=FDG_COUNTER+1
												   >		  IT=NIT; ID=ND; IVAR=NT
												   >		  CALL GEN_IN(IT,'Iteration # (zero to exit) - default is last iteration',
												   >		1                   LOW_LIM=IZERO,UP_LIM=NIT)
												   >		  DO K=1,16
												   >		    DO J=1,26
												   >		       POPS(27,K,IT)=POPS(27,K,IT)+POPS(J,K,IT)
												   >		       POPS(J,K,IT)=POPS(J,K,IT)/100.0D0
												   >		    END DO
												   >		  END DO
												   >		  IREC=NIT			!IREC is updated on write
												   >	          IF(FDG_COUNTER .EQ. 1)NITSF=NITSF+1
												   >		  CALL SCR_RITE_V2(R,V,SIGMA,POPS(1,1,IT),IREC,NITSF,
												   >		1              RITE_N_TIMES,LST_NG,WRITE_RVSIG,
												   >		1              NT,ND,LUSCR,NEWMOD)
												   >	!
												   >		ELSE IF(PLT_OPT(1:4) .EQ. 'DREP')THEN
												   >		  FDG_COUNTER=FDG_COUNTER+1
												   >		  IT=NIT; ID=ND; IVAR=NT
												   >		  CALL GEN_IN(IT,'Iteration # (zero to exit) - default is last iteration',
												   >		1                   LOW_LIM=IZERO,UP_LIM=NIT)
												   >		  CALL GEN_IN(ID1,'Depth to be used for replacement')
												   >		  CALL GEN_IN(ID2,'ID2: Depths ID2 to ID1 pm 1 to be replaced')
												   >		  I=1
												   >		  IF(ID2 .LT. ID1)I=-1
												   >		  DO K=ID1+I,ID2,I
												   >		    DO J=1,NT
												   >		       POPS(J,K,IT)=POPS(J,ID1,IT)
												   >		    END DO
												   >		  END DO
												   >		  IREC=NIT			!IREC is updated on write
												   >	          IF(FDG_COUNTER .EQ. 1)NITSF=NITSF+1
												   >		  CALL SCR_RITE_V2(R,V,SIGMA,POPS(1,1,IT),IREC,NITSF,
												   >		1              RITE_N_TIMES,LST_NG,WRITE_RVSIG,
												   >		1              NT,ND,LUSCR,NEWMOD)
												   >	!
	        T2=LOG10(POPS(IVAR,ID,IT)/POPS(IVAR,ID+1,IT))					   |		        T2=DLOG10(POPS(IVAR,ID,IT)/POPS(IVAR,ID+1,IT))
	        T2=LOG10(POPS(IVAR,ID,IT)/POPS(IVAR,ID+1,IT))					   |		        T2=DLOG10(POPS(IVAR,ID,IT)/POPS(IVAR,ID+1,IT))
	          T3=10**(LOG10(POPS(IVAR,ID+1,IT))+T1)						   |		          T3=10**(DLOG10(POPS(IVAR,ID+1,IT))+T1)
												   >	!
												   >		ELSE IF(PLT_OPT(1:4) .EQ. 'DNRG')THEN
												   >		  LEVELS=0; T1=1.2D0; T2=0.0D0; T3=0.0D0
												   >		  CALL GEN_IN(LEVELS,I,NLEV_MAX,'Levels for defining new r grid')
												   >		  CALL GEN_IN(T1,'Max ratio of level populations between cons. grid points')
												   >		  CALL DEF_NEW_RG_V1(Y,R,POPS(1,1,NIT),LEVELS,T1,T2,T3,TMP_LOG,I,NT,ND)
												   >		  IF(TMP_LOG)THEN
												   >		    DO J=1,I
												   >		      TA(1:ND)=LOG10(POPS(LEVELS(J),1:ND,NIT))
												   >		      WRITE(STRING,*)LEVELS(J); STRING='OLD '//ADJUSTL(STRING)
												   >		      CALL DP_CURVE_LAB(ND,R,TA,STRING)
												   >		      CALL MON_INTERP(TB,ND,IONE,Y,ND,TA,ND,R,ND)
												   >		      WRITE(STRING,*)LEVELS(J); STRING='NEW '//ADJUSTL(STRING)
												   >		      CALL DP_CURVE_LAB(ND,Y,TB,STRING)
												   >		    END DO
												   >		    CALL GRAMON_PGPLOT(' ',' ',' ',' ')
												   >	!
												   >		    DO I=2,ND-1
												   >		      TA(I)=(Y(I-1)-Y(I))/(Y(I)-Y(I+1))
												   >		    END DO
												   >		    CALL DP_CURVE(ND-2,Y(2:ND-1),TA(2:ND-1))
												   >		    CALL GRAMON_PGPLOT('R','dR/dR',' ',' ')
												   >		  ELSE
												   >		    WRITE(6,*)'Construction of a new R Grid failed'
												   >		    WRITE(6,*)'Iteration failed to converge to required number of grid points'
												   >		    WRITE(6,'(A)',ADVANCE='NO')' Enter any character to continue: '; READ(5,*)TMP_STR
												   >		  END IF
												   >		  GOTO 200
												   >	!
												   >		ELSE IF(PLT_OPT(1:4) .EQ. 'CNRG')THEN
												   >	!
												   >		   WRITE(6,*)RED_PEN
												   >		   WRITE(6,*)'This option assumes you have created plots using the PR option'
												   >		   WRITE(6,*)'It also assumes that you used the NOI option so that the plots were not in
												   >		   WRITE(6,*)DEF_PEN
												   >	! 
												   >		   I=MIN(3*ND,SIZE(TA))
												   >		   CALL CHANGE_XAXIS_GRIDDING(TA,K,I)
												   >	!
												   >	! For SN models, we sometimes plot in uts of 10^14 cm.
												   >	! We also ensure boundary vales are absolutely correct.
												   >	!
												   >		   IF(R(1) .GT. 1.0D+04)TA(1:K)=1.0D+04*TA(1:K)
												   >		   TA(1)=R(1); TA(K)=R(ND)
												   >		   OPEN(UNIT=LU_OUT,FILE='NEW_RDINR',STATUS='UNKNOWN',ACTION='WRITE')
												   >		   WRITE(LU_OUT,'(/,2X,A,10X,A,/)')'24-FEB-2004','!Format date'
												   >		   WRITE(LU_OUT,'(2ES14.5,3X,I5,3X,I5,/)')1.0E+05,1.0D0,1,K
												   >		   DO I=1,K
												   >		     WRITE(LU_OUT,'(ES20.12,6ES14.7,3X,I5)')TA(I),(1.0D0, J=1,6),I
												   >		     WRITE(LU_OUT,'(F12.4,/)')1.0D0
												   >		   END DO
												   >		   CLOSE(LU_OUT)
												   >		   GOTO 200
./spec_plt/plt_spec.f
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: OBSF(:)							   |		REAL*8, ALLOCATABLE :: OBSF(:)
	REAL(10), ALLOCATABLE :: FQW(:)								   |		REAL*8, ALLOCATABLE :: FQW(:)
	REAL(10), ALLOCATABLE :: AL_D_EBmV(:)							   |		REAL*8, ALLOCATABLE :: AL_D_EBmV(:)
	REAL(10), ALLOCATABLE :: NU_CONT(:)							   |		REAL*8, ALLOCATABLE :: NU_CONT(:)
	REAL(10), ALLOCATABLE :: OBSF_CONT(:)							   |		REAL*8, ALLOCATABLE :: OBSF_CONT(:)
	REAL(10), ALLOCATABLE ::  NU_OBS(:)							   |		REAL*8, ALLOCATABLE ::  NU_OBS(:)
	REAL(10), ALLOCATABLE ::  OBSF_OBS(:)							   |		REAL*8, ALLOCATABLE ::  OBSF_OBS(:)
	REAL(10), ALLOCATABLE :: XVEC(:)							   |		REAL*8, ALLOCATABLE :: XVEC(:)
	REAL(10), ALLOCATABLE :: YVEC(:)							   |		REAL*8, ALLOCATABLE :: YVEC(:)
	REAL(10) LUM										   |		REAL*8 LUM
	REAL(10) TOT_LUM									   |		REAL*8 TOT_LUM
	REAL(10) N_PHOT										   |		REAL*8 N_PHOT
	REAL(10) ZAN_FREQ(10)									   |		REAL*8 ZAN_FREQ(10)
C												   |	C
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) KEV_TO_HZ									   |		REAL*8 KEV_TO_HZ
	REAL(10) NORM_WAVE									   |		REAL*8 NORM_WAVE
	REAL(10) NORM_FREQ									   |		REAL*8 NORM_FREQ
	REAL(10) NORM_FLUX									   |		REAL*8 NORM_FLUX
	REAL(10) DNU										   |		REAL*8 DNU
	REAL(10) BB_FLUX									   |		REAL*8 BB_FLUX
	REAL(10) SCALE_FAC									   |		REAL*8 SCALE_FAC
	REAL(10) XFAC										   |		REAL*8 XFAC
	REAL(10) ADD_FAC									   |		REAL*8 ADD_FAC
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) RAD_VEL			!Radial velcity in km/s				   |		REAL*8 RAD_VEL			!Radial velcity in km/s
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) WT(30)			!Used when smoothing observational data.		   |		REAL*8 WT(30)			!Used when smoothing observational data.
	REAL(10) LAM_RANGE(2)									   |		REAL*8 LAM_RANGE(2)
												   >		LOGICAL FIRST
	LOGICAL WR_PLT,OVER									   |		LOGICAL WR_PLT,OVER,ABS_VALUE
	REAL(10) T_IN_K                    ! temp in K of intersteallar H&HII			   |		REAL*8 T_IN_K                    ! temp in K of intersteallar H&HII
	REAL(10) V_TURB                    ! turbulent velocity of "     "			   |		REAL*8 V_TURB                    ! turbulent velocity of "     "
	REAL(10) V_R                       ! radial v of star w.r.t. ISM			   |		REAL*8 V_R                       ! radial v of star w.r.t. ISM
	REAL(10) LOG_NTOT                  ! log of H column density				   |		REAL*8 LOG_NTOT                  ! log of H column density
	REAL(10) LOG_H2_NTOT               ! log of H2 column density				   |		REAL*8 LOG_H2_NTOT               ! log of H2 column density
	REAL(10) INST_RES                  ! desired instrument resolution (dl) 		   |		REAL*8 INST_RES                  ! desired instrument resolution (dl) 
	REAL(10) MIN_RES_KMS               ! minimum resolution for model data			   |		REAL*8 MIN_RES_KMS               ! minimum resolution for model data
	REAL(10) NUM_RES                   ! number of res. elements to cons.			   |		REAL*8 NUM_RES                   ! number of res. elements to cons.
	REAL(10) RESOLUTION                ! desired resolution (R=l/dl)			   |		REAL*8 RESOLUTION                ! desired resolution (R=l/dl)
	REAL(10) WAVE_MAX                  ! max wavelength to convolve over			   |		REAL*8 WAVE_MAX                  ! max wavelength to convolve over
	REAL(10) WAVE_MIN                  ! min wavelength to convolve over			   |		REAL*8 WAVE_MIN                  ! min wavelength to convolve over
	REAL(10) VSINI										   |		REAL*8 VSINI
	REAL(10) EPSILON									   |		REAL*8 EPSILON
	REAL(10) LAM_CENT									   |		REAL*8 LAM_CENT
	REAL(10) HEIGHT										   |		REAL*8 HEIGHT
	REAL(10) SIGMA										   |		REAL*8 SIGMA
!												   |	!
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) SUM										   |		REAL*8 SUM
	REAL(10) TEMP										   |		REAL*8 TEMP
	REAL(10) TMP_FREQ									   |		REAL*8 TMP_FREQ
	REAL(10), PARAMETER :: EDGE_HYD=3.28808662499619D0					   |		REAL*8, PARAMETER :: EDGE_HYD=3.28808662499619D0
	REAL(10), PARAMETER :: EDGE_HEI=5.94520701882481D0					   |		REAL*8, PARAMETER :: EDGE_HEI=5.94520701882481D0
	REAL(10), PARAMETER :: EDGE_HE2=13.1581564178623D0					   |		REAL*8, PARAMETER :: EDGE_HE2=13.1581564178623D0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) R_SEED										   |		REAL*8 R_SEED
	REAL(10) COUNTS										   |		REAL*8 COUNTS
	REAL(10) POIDEV										   |		REAL*8 POIDEV
	REAL(10) SPEED_OF_LIGHT,FAC,LAM_VAC							   |		REAL*8 SPEED_OF_LIGHT,FAC,LAM_VAC
	REAL(10) NORM_LUM									   |		REAL*8 NORM_LUM
	REAL(10) DIST										   |		REAL*8 DIST
	REAL(10) R_EXT										   |		REAL*8 R_EXT
	REAL(10) EBMV_GAL									   |		REAL*8 EBMV_GAL
	REAL(10) EBMV_LMC									   |		REAL*8 EBMV_LMC
	REAL(10) EBMV_CCM									   |		REAL*8 EBMV_CCM
	REAL(10) EBMV_SMC         !KN - SMC law							   |		REAL*8 EBMV_SMC         !KN - SMC law
	REAL(10) RAX,RBX									   |		REAL*8 RAX,RBX
	REAL(10) FILTLAM(8),FILTZP(8),FLAM(24),ZERO_POINT					   |		REAL*8 FILTLAM(8),FILTZP(8),FLAM(24),ZERO_POINT
	REAL(10) C1,C2,C3,C4,D,F  !KN For SMC							   |		REAL*8 C1,C2,C3,C4,D,F  !KN For SMC
	REAL(10) RESPONSE1									   |		REAL*8 RESPONSE1
	REAL(10) RESPONSE2									   |		REAL*8 RESPONSE2
	REAL(10) FILT_INT_BEG									   |		REAL*8 FILT_INT_BEG
												   >	! If logy is set, the logarithm of the y data is taken.
												   >	!
												   >		  CALL USR_HIDDEN(ABS_VALUE,'ABSR','F','Use absolute values when taking log')
												   >		    IF(LOG_Y .AND. ABS_VALUE)THEN
												   >		      OBSF_CONT(1:NCF_CONT)=LOG10(ABS(OBSF_CONT(1:NCF_CONT)))
												   >		    ELSE IF(LOG_Y)THEN 
												   >		      FIRST=.TRUE.
												   >		      DO I=1,NCF_CONT
												   >		        IF(OBSF_CONT(I) .GT. 0)THEN 
												   >		          OBSF_CONT(I)=LOG10(OBSF_CONT(I)) 
												   >		        ELSE
												   >		          OBSF_CONT(I)=-200
												   >		          IF(FIRST)THEN
												   >		             FIRST=.FALSE.
												   >		             WRITE(6,*)'Warning -- zero or neagtive values encountered'
												   >		 	     WRITE(6,*)'Log set to -200'
												   >		          END IF 
												   >		        END IF
												   >		      END DO
												   >		    END IF
	    N_PHOT=47.2566+LOG10(N_PHOT) !LOG10(4pi*(1kpc)**2*(1D-23)/h)			   |		    N_PHOT=47.2566+DLOG10(N_PHOT) !DLOG10(4pi*(1kpc)**2*(1D-23)/h)
	    YV(ML)=47.2566D0+LOG10(YV(ML)) 		!LOG10(4pi*(1kpc)**2*(1E-23)/h)		   |		    YV(ML)=47.2566D0+LOG10(YV(ML)) 		!DLOG10(4pi*(1kpc)**2*(1E-23)/h)
!	        T1=LOG10(OBSF(ML-1))-LOG10(NU(ML-1)*FILTLAM(L)/0.2998)				   |	!	        T1=DLOG10(OBSF(ML-1))-DLOG10(NU(ML-1)*FILTLAM(L)/0.2998)
!	1       *(LOG10(OBSF(ML)/OBSF(ML-1))/(LOG10(NU(ML)/NU(ML-1))))				   |	!	1       *(DLOG10(OBSF(ML)/OBSF(ML-1))/(DLOG10(NU(ML)/NU(ML-1))))
!	        T1=5.0*LOG10(DIST)-2.5*T1+2.5*LOG10(FILTZP(L))					   |	!	        T1=5.0*DLOG10(DIST)-2.5*T1+2.5*DLOG10(FILTZP(L))
!	        T1=LOG10(OBSF(ML-1))-LOG10(NU(ML-1)*FLAM(L)/0.2998)				   |	!	        T1=DLOG10(OBSF(ML-1))-DLOG10(NU(ML-1)*FLAM(L)/0.2998)
!	1       *(LOG10(OBSF(ML)/OBSF(ML-1))/(LOG10(NU(ML)/NU(ML-1))))				   |	!	1       *(DLOG10(OBSF(ML)/OBSF(ML-1))/(DLOG10(NU(ML)/NU(ML-1))))
!	        T1=5.0*LOG10(DIST)-2.5*T1+2.5*LOG10(ZERO_POINT)					   |	!	        T1=5.0*DLOG10(DIST)-2.5*T1+2.5*DLOG10(ZERO_POINT)
	         YV(I)=TWOHCSQ*(NU(I)**3)*EXP(-T3)/(1.0D0-EXP(-T3))				   |		         YV(I)=TWOHCSQ*(NU(I)**3)*DEXP(-T3)/(1.0D0-DEXP(-T3))
	         YV(I)=TWOHCSQ*(NU(I)**3)/(EXP(T3)-1.0D0)					   |		         YV(I)=TWOHCSQ*(NU(I)**3)/(DEXP(T3)-1.0D0)
	    DNU=LOG10(NU(NCF)/NU(1))/(NBB-1)							   |		    DNU=DLOG10(NU(NCF)/NU(1))/(NBB-1)
	         YV(I)=TWOHCSQ*(T1**3)*EXP(-T3)/(1.0D0-EXP(-T3))				   |		         YV(I)=TWOHCSQ*(T1**3)*DEXP(-T3)/(1.0D0-DEXP(-T3))
	         YV(I)=TWOHCSQ*(T1**3)/(EXP(T3)-1.0D0)						   |		         YV(I)=TWOHCSQ*(T1**3)/(DEXP(T3)-1.0D0)
	      BB_FLUX=TWOHCSQ*(NORM_FREQ**3)/(EXP(HDKT*NORM_FREQ/TEMP)-1.0D0)			   |		      BB_FLUX=TWOHCSQ*(NORM_FREQ**3)/(DEXP(HDKT*NORM_FREQ/TEMP)-1.0D0)
	REAL(10) FAC										   |		REAL*8 FAC
./spec_plt/plt_steq.f
	  REAL(10), ALLOCATABLE :: STEQ(:,:)							   |		  REAL*8, ALLOCATABLE :: STEQ(:,:)
	  REAL(10), ALLOCATABLE :: SOL(:,:)							   |		  REAL*8, ALLOCATABLE :: SOL(:,:)
	  REAL(10), ALLOCATABLE :: RE(:)							   |		  REAL*8, ALLOCATABLE :: RE(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
./spec_plt/scr_plt.f
./spec_plt/simp_ip.f
	REAL(10), ALLOCATABLE :: IP(:,:)							   |		REAL*8, ALLOCATABLE :: IP(:,:)
	REAL(10), ALLOCATABLE :: NU(:)								   |		REAL*8, ALLOCATABLE :: NU(:)
	REAL(10), ALLOCATABLE :: P(:)								   |		REAL*8, ALLOCATABLE :: P(:)
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: ZV(:)								   |		REAL*8, ALLOCATABLE :: ZV(:)
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DISTANCE,PI,PARSEC								   |		REAL*8 DISTANCE,PI,PARSEC
	REAL(10) LAM_ST,LAM_END									   |		REAL*8 LAM_ST,LAM_END
./spec_plt/fint.inc
 
Comparing files in ./spec_plt/subs with those in  /home/hillier/wnode04/cmf_testing_real8//spec_plt/subs
 
./spec_plt/subs/Makefile
##         $(LIB)(num_rec.o)\									   <
#												   <
												   >	         $(LIB)(num_rec.o)\
	$(F90) -c $(FG)  $<									   |		$(F90) -c $(FD)  $<
	$(F90) -c $(FG)  $<									   |		$(F90) -c $(FD)  $<
./spec_plt/subs/adjust_jes.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) J_ES(NCF)									   |		REAL*8 J_ES(NCF)
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10) PLANCK_FN(NCF)									   |		REAL*8 PLANCK_FN(NCF)
	REAL(10) PLANCK_ES(NCF)									   |		REAL*8 PLANCK_ES(NCF)
	REAL(10) LOG_J_ES(NCF)									   |		REAL*8 LOG_J_ES(NCF)
	REAL(10) PLANCK_NU(NCF)									   |		REAL*8 PLANCK_NU(NCF)
	REAL(10) D(NCF)										   |		REAL*8 D(NCF)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1										   |		REAL*8 T1
./spec_plt/subs/adjust_jes_v2.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) J_ES(NCF)									   |		REAL*8 J_ES(NCF)
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10) PLANCK_FN(NCF)									   |		REAL*8 PLANCK_FN(NCF)
	REAL(10) PLANCK_ES(NCF)									   |		REAL*8 PLANCK_ES(NCF)
	REAL(10) LOG_J_ES(NCF)									   |		REAL*8 LOG_J_ES(NCF)
	REAL(10) PLANCK_NU(NCF)									   |		REAL*8 PLANCK_NU(NCF)
	REAL(10) D(NCF)										   |		REAL*8 D(NCF)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1										   |		REAL*8 T1
./spec_plt/subs/clip.f
	REAL(10) XV(NCF)									   |		REAL*8 XV(NCF)
	REAL(10) YV(NCF)									   |		REAL*8 YV(NCF)
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FREQ(4,NCLIP_MAX)								   |		REAL*8 FREQ(4,NCLIP_MAX)
	REAL(10) X0,T1										   |		REAL*8 X0,T1
	REAL(10) X_SUM,Y_SUM									   |		REAL*8 X_SUM,Y_SUM
	REAL(10) XSQ_SUM,XY_SUM									   |		REAL*8 XSQ_SUM,XY_SUM
	REAL(10) INTERCEPT,SLOPE								   |		REAL*8 INTERCEPT,SLOPE
./spec_plt/subs/cnvlv_es_one_par_v2.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) RJ(NCF)									   |		REAL*8 RJ(NCF)
	REAL(10) J_ES(NCF)									   |		REAL*8 J_ES(NCF)
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10) A(NCF)										   |		REAL*8 A(NCF)
	REAL(10) B(NCF)										   |		REAL*8 B(NCF)
	REAL(10) C(NCF)										   |		REAL*8 C(NCF)
	REAL(10) D(NCF)										   |		REAL*8 D(NCF)
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) D1,D2,DH									   |		REAL*8 D1,D2,DH
	REAL(10) OLD_FLUX									   |		REAL*8 OLD_FLUX
	REAL(10) NEW_FLUX									   |		REAL*8 NEW_FLUX
	REAL(10) OLD_N_PHOT									   |		REAL*8 OLD_N_PHOT
	REAL(10) NEW_N_PHOT									   |		REAL*8 NEW_N_PHOT
./spec_plt/subs/cnvlv_es_two_par_v2.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) RJ(NCF)									   |		REAL*8 RJ(NCF)
	REAL(10) J_ES(NCF)									   |		REAL*8 J_ES(NCF)
	REAL(10) T_ELEC										   |		REAL*8 T_ELEC
	REAL(10) A(NCF)										   |		REAL*8 A(NCF)
	REAL(10) H(NCF)										   |		REAL*8 H(NCF)
	REAL(10) C(NCF)										   |		REAL*8 C(NCF)
	REAL(10) D(NCF)										   |		REAL*8 D(NCF)
	REAL(10) A_STORE(NCF)									   |		REAL*8 A_STORE(NCF)
	REAL(10) C_STORE(NCF)									   |		REAL*8 C_STORE(NCF)
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) D1,D2,DH									   |		REAL*8 D1,D2,DH
	REAL(10) OLD_FLUX									   |		REAL*8 OLD_FLUX
	REAL(10) NEW_FLUX									   |		REAL*8 NEW_FLUX
	REAL(10) OLD_N_PHOT									   |		REAL*8 OLD_N_PHOT
	REAL(10) NEW_N_PHOT									   |		REAL*8 NEW_N_PHOT
	REAL(10) ACOEF(2),BCOEF(2)								   |		REAL*8 ACOEF(2),BCOEF(2)
./spec_plt/subs/cnvrt.f
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT,LAM_AIR								   |		REAL*8 SPEED_OF_LIGHT,LAM_AIR
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) KEV_TO_HZ,ANG_TO_HZ								   |		REAL*8 KEV_TO_HZ,ANG_TO_HZ
./spec_plt/subs/cnvrt_j.f
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) KEV_TO_HZ,ANG_TO_HZ								   |		REAL*8 KEV_TO_HZ,ANG_TO_HZ
./spec_plt/subs/cnvrt_j_v2.f
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) KEV_TO_HZ,ANG_TO_HZ								   |		REAL*8 KEV_TO_HZ,ANG_TO_HZ
./spec_plt/subs/comp_ip_ew.f
	REAL(10) IP(NP,NCF)									   |		REAL*8 IP(NP,NCF)
	REAL(10) NU(NCF),LAM(NCF)								   |		REAL*8 NU(NCF),LAM(NCF)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) DISTANCE									   |		REAL*8 DISTANCE
	REAL(10), ALLOCATABLE :: XV(:)								   |		REAL*8, ALLOCATABLE :: XV(:)
	REAL(10), ALLOCATABLE :: YV(:)								   |		REAL*8, ALLOCATABLE :: YV(:)
	REAL(10), ALLOCATABLE :: CONT_FLUX(:)							   |		REAL*8, ALLOCATABLE :: CONT_FLUX(:)
	REAL(10), ALLOCATABLE :: EW(:)								   |		REAL*8, ALLOCATABLE :: EW(:)
	REAL(10) CONT_LAM_B,CONT_LAM_R								   |		REAL*8 CONT_LAM_B,CONT_LAM_R
	REAL(10) LINE_LAM_B,LINE_LAM_R								   |		REAL*8 LINE_LAM_B,LINE_LAM_R
	REAL(10) LINE_WAVELENGTH								   |		REAL*8 LINE_WAVELENGTH
	REAL(10) LINE_FREQUENCY									   |		REAL*8 LINE_FREQUENCY
	REAL(10) CONT_SLOPE									   |		REAL*8 CONT_SLOPE
	REAL(10) CONT_FLUX_R									   |		REAL*8 CONT_FLUX_R
	REAL(10) CONT_FLUX_B									   |		REAL*8 CONT_FLUX_B
	REAL(10) T1,T2,PI									   |		REAL*8 T1,T2,PI
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) PARSEC										   |		REAL*8 PARSEC
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./spec_plt/subs/compute_tau_radial.f
	REAL(10) dV		!Spacing in velcity space -- set to V(DOP)/2			   |		REAL*8 dV		!Spacing in velcity space -- set to V(DOP)/2
	REAL(10) VMIN		!Lower limit for integration					   |		REAL*8 VMIN		!Lower limit for integration
	REAL(10) NU(NF)		!Freuqency (10^15 Hz)						   |		REAL*8 NU(NF)		!Freuqency (10^15 Hz)
	REAL(10) TAU(NF)									   |		REAL*8 TAU(NF)
	REAL(10) CHI(ND,NF)	!Opacity (scaled by 10^10) in comoving frame			   |		REAL*8 CHI(ND,NF)	!Opacity (scaled by 10^10) in comoving frame
	REAL(10) VEL(ND)		!Velocity (km/s)					   |		REAL*8 VEL(ND)		!Velocity (km/s)
	REAL(10) R(ND)		!Radius (in units of 10^10 cm).					   |		REAL*8 R(ND)		!Radius (in units of 10^10 cm).
!												   |	!
	REAL(10), ALLOCATABLE :: NEW_CHI(:,:)		!New opacity (interpolated in space and    |		REAL*8, ALLOCATABLE :: NEW_CHI(:,:)		!New opacity (interpolated in space and 
	REAL(10), ALLOCATABLE :: NEW_VEL(:)							   |		REAL*8, ALLOCATABLE :: NEW_VEL(:)
	REAL(10), ALLOCATABLE :: NEW_R(:)							   |		REAL*8, ALLOCATABLE :: NEW_R(:)
	REAL(10), ALLOCATABLE :: TMP_CHI(:)							   |		REAL*8, ALLOCATABLE :: TMP_CHI(:)
	REAL(10), ALLOCATABLE :: TMP_FREQ(:)							   |		REAL*8, ALLOCATABLE :: TMP_FREQ(:)
	REAL(10), ALLOCATABLE :: WRK_VEC(:)							   |		REAL*8, ALLOCATABLE :: WRK_VEC(:)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) T2										   |		REAL*8 T2
	REAL(10) SPEED_OF_LIGHT,C_KMS								   |		REAL*8 SPEED_OF_LIGHT,C_KMS
./spec_plt/subs/convolve.f
	REAL(10) origwave(Norig),origflux(Norig)						   |		real*8 origwave(Norig),origflux(Norig)
	REAL(10) wave_max,wave_min								   |		real*8 wave_max,wave_min
	REAL(10) inst_res     	! the instrumental resolution (dlambda)				   |		real*8 inst_res     	! the instrumental resolution (dlambda)
	REAL(10) Resolution   	! resolving power (R = lambda/dlambda)				   |		real*8 Resolution   	! resolving power (R = lambda/dlambda)
	REAL(10) min_res_kms  	! minimum resolution to work with				   |		real*8 min_res_kms  	! minimum resolution to work with
	REAL(10) num_res      	! num resolution elements to consider beyond			   |		real*8 num_res      	! num resolution elements to consider beyond
	REAL(10) vsini		! Projected rotational velocity in km/s				   |		real*8 vsini		! Projected rotational velocity in km/s
	REAL(10) epsilon		! Limb darkenin parameter: 				   |		real*8 epsilon		! Limb darkenin parameter: 
	REAL(10) origfreq(Norig)								   |		real*8 origfreq(Norig)
	REAL(10), allocatable :: modwave(:)							   |		real*8, allocatable :: modwave(:)
	REAL(10), allocatable :: modflux(:)							   |		real*8, allocatable :: modflux(:)
	REAL(10), allocatable :: tempwave(:)							   |		real*8, allocatable :: tempwave(:)
	REAL(10), allocatable :: tempflux(:)							   |		real*8, allocatable :: tempflux(:)
	REAL(10) cwave_max,cwave_min								   |		real*8 cwave_max,cwave_min
	REAL(10) model_res    ! the model resolution						   |		real*8 model_res    ! the model resolution
	REAL(10) min_dlam     ! the model resolution						   |		real*8 min_dlam     ! the model resolution
	REAL(10) kernal_sig   ! the corresponding sigma (fwhm = 2.354sig)			   |		real*8 kernal_sig   ! the corresponding sigma (fwhm = 2.354sig)
	REAL(10) extend       ! wavelength extension to consider				   |		real*8 extend       ! wavelength extension to consider
	REAL(10) t1										   |		real*8 t1
	 inst_res = log((two*resolution+one)/(two*resolution-one))				   |		 inst_res = dlog((two*resolution+one)/(two*resolution-one))
	REAL(10) wave(Nmod)									   |		real*8 wave(Nmod)
	REAL(10) flux(Nmod)									   |		real*8 flux(Nmod)
	REAL(10) sigma										   |		real*8 sigma
	REAL(10) vsini										   |		real*8 vsini
	REAL(10) epsilon									   |		real*8 epsilon
	REAL(10) wave(Nmod)									   |		real*8 wave(Nmod)
	REAL(10) flux(Nmod)									   |		real*8 flux(Nmod)
	REAL(10) sigma										   |		real*8 sigma
	REAL(10) vsini										   |		real*8 vsini
	REAL(10) epsilon									   |		real*8 epsilon
	REAL(10) answer(Nmod)									   |		real*8 answer(Nmod)
	REAL(10) response(Nmod)									   |		real*8 response(Nmod)
	REAL(10) wave(NMAX)									   |		real*8 wave(NMAX)
	REAL(10) flux(NMAX)									   |		real*8 flux(NMAX)
	REAL(10) response(NMAX)									   |		real*8 response(NMAX)
	REAL(10) ans(NMAX)									   |		real*8 ans(NMAX)
	REAL(10) sigma										   |		real*8 sigma
	REAL(10) dlam										   |		real*8 dlam
	REAL(10) wave(Nmod)        ! wavelength array						   |		real*8 wave(Nmod)        ! wavelength array
	REAL(10) response(Nmod)    ! response array						   |		real*8 response(Nmod)    ! response array
	REAL(10) sigma             ! sigma of gaussian 						   |		real*8 sigma             ! sigma of gaussian 
	REAL(10) lambda,dlam,cutoff,mu								   |		real*8 lambda,dlam,cutoff,mu
	REAL(10) gauss										   |		real*8 gauss
	REAL(10) response_area									   |		real*8 response_area
	REAL(10) wave(Nmod)     	! wavelength array					   |		real*8 wave(Nmod)     	! wavelength array
	REAL(10) response(Nmod) 	! response array					   |		real*8 response(Nmod) 	! response array
	REAL(10) vsini										   |		real*8 vsini
	REAL(10) epsilon									   |		real*8 epsilon
	REAL(10) lambda,dlam,cutoff,mu								   |		real*8 lambda,dlam,cutoff,mu
	REAL(10) response_area									   |		real*8 response_area
	REAL(10) t1,dlam_rot,a1,a2								   |		real*8 t1,dlam_rot,a1,a2
	REAL(10) sigma,x,mu									   |		real*8 sigma,x,mu
	REAL(10) gauss										   |		real*8 gauss
	REAL(10) wave(NMAX),flux(NMAX)								   |		real*8 wave(NMAX),flux(NMAX)
	REAL(10) dlam 				! even spacing in wavelength			   |		real*8 dlam 				! even spacing in wavelength
	REAL(10) tempwave(N),tempflux(N)							   |		real*8 tempwave(N),tempflux(N)
	REAL(10) dlamover2									   |		real*8 dlamover2
./spec_plt/subs/create_gauss.f
	REAL(10) XVEC(NX)									   |		REAL*8 XVEC(NX)
	REAL(10) YVEC(NX)									   |		REAL*8 YVEC(NX)
	REAL(10) LAM_CENT									   |		REAL*8 LAM_CENT
	REAL(10) dX										   |		REAL*8 dX
	REAL(10) SIGMA										   |		REAL*8 SIGMA
	REAL(10) HEIGHT										   |		REAL*8 HEIGHT
	REAL(10) LAM_ST										   |		REAL*8 LAM_ST
./spec_plt/subs/determ_reddening.f
	REAL(10) OBS_SPEC(NOBS),OBS_NU(NOBS)							   |		REAL*8 OBS_SPEC(NOBS),OBS_NU(NOBS)
	REAL(10) FIT_SPEC(NFIT),FIT_NU(NFIT)							   |		REAL*8 FIT_SPEC(NFIT),FIT_NU(NFIT)
	REAL(10) R_MIN,R_MAX									   |		REAL*8 R_MIN,R_MAX
	REAL(10) RHS(2)										   |		REAL*8 RHS(2)
	REAL(10) MAT(2,2)									   |		REAL*8 MAT(2,2)
	REAL(10), ALLOCATABLE :: NU_ST(:)							   |		REAL*8, ALLOCATABLE :: NU_ST(:)
	REAL(10), ALLOCATABLE :: NU_END(:)							   |		REAL*8, ALLOCATABLE :: NU_END(:)
	REAL(10), ALLOCATABLE :: LAM_ST(:)							   |		REAL*8, ALLOCATABLE :: LAM_ST(:)
	REAL(10), ALLOCATABLE :: LAM_END(:)							   |		REAL*8, ALLOCATABLE :: LAM_END(:)
	REAL(10), ALLOCATABLE :: OBS(:)								   |		REAL*8, ALLOCATABLE :: OBS(:)
	REAL(10), ALLOCATABLE :: FIT(:)								   |		REAL*8, ALLOCATABLE :: FIT(:)
	REAL(10), ALLOCATABLE :: WEIGHT(:)							   |		REAL*8, ALLOCATABLE :: WEIGHT(:)
	REAL(10), ALLOCATABLE :: GAL_RED_LAW(:)							   |		REAL*8, ALLOCATABLE :: GAL_RED_LAW(:)
	REAL(10), ALLOCATABLE :: GAL_RED_LAW_SAVE(:)						   |		REAL*8, ALLOCATABLE :: GAL_RED_LAW_SAVE(:)
	REAL(10) R_EXT										   |		REAL*8 R_EXT
	REAL(10) RAX,RBX									   |		REAL*8 RAX,RBX
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) EBMV										   |		REAL*8 EBMV
	REAL(10) LOG_DIST									   |		REAL*8 LOG_DIST
	REAL(10) CHI_SQ										   |		REAL*8 CHI_SQ
	REAL(10) ANG_TO_HZ									   |		REAL*8 ANG_TO_HZ
	REAL(10) CHI_SQ_SVE									   |		REAL*8 CHI_SQ_SVE
	REAL(10) EBMV_SVE									   |		REAL*8 EBMV_SVE
	REAL(10) DIST_SVE									   |		REAL*8 DIST_SVE
	REAL(10) R_SVE										   |		REAL*8 R_SVE
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./spec_plt/subs/divide_by_cont.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) OBSF(NCF)									   |		REAL*8 OBSF(NCF)
	REAL(10) YV(NCF)									   |		REAL*8 YV(NCF)
	REAL(10) NU_CONT(NCF_CONT)								   |		REAL*8 NU_CONT(NCF_CONT)
	REAL(10) OBSF_CONT(NCF_CONT)								   |		REAL*8 OBSF_CONT(NCF_CONT)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./spec_plt/subs/do_int_rec_ap.f
! 05-Fev-2021: All arrays made REAL(10).							   |	! 05-Fev-2021: All arrays made REAL*8.
	REAL(10) IP(NP,NCF)									   |		REAL*8 IP(NP,NCF)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) A										   |		REAL*8 A
	REAL(10) B										   |		REAL*8 B
	REAL(10) WIDTH										   |		REAL*8 WIDTH
	REAL(10) LENGTH										   |		REAL*8 LENGTH
	REAL(10) YV(NCF)									   |		REAL*8 YV(NCF)
	REAL(10), ALLOCATABLE :: P_SHRT(:)							   |		REAL*8, ALLOCATABLE :: P_SHRT(:)
	REAL(10), ALLOCATABLE :: P_REV(:)							   |		REAL*8, ALLOCATABLE :: P_REV(:)
	REAL(10), ALLOCATABLE :: IP_REV(:)							   |		REAL*8, ALLOCATABLE :: IP_REV(:)
	REAL(10), ALLOCATABLE :: dTHETA(:)							   |		REAL*8, ALLOCATABLE :: dTHETA(:)
	REAL(10), ALLOCATABLE :: QW(:)								   |		REAL*8, ALLOCATABLE :: QW(:)
	REAL(10), ALLOCATABLE ::  INT_COEF(:)							   |		REAL*8, ALLOCATABLE ::  INT_COEF(:)
	REAL(10) P_INS(10)									   |		REAL*8 P_INS(10)
	REAL(10) P1,P2,P3,P4									   |		REAL*8 P1,P2,P3,P4
	REAL(10) LEFT_EDGE									   |		REAL*8 LEFT_EDGE
	REAL(10) RIGHT_EDGE									   |		REAL*8 RIGHT_EDGE
	REAL(10) BOT_EDGE									   |		REAL*8 BOT_EDGE
	REAL(10) TOP_EDGE									   |		REAL*8 TOP_EDGE
!												   |	!
	REAL(10) PMIN										   |		REAL*8 PMIN
	REAL(10) PMAX										   |		REAL*8 PMAX
!												   |	!
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) TH1,TH2									   |		REAL*8 TH1,TH2
	REAL(10) DELP										   |		REAL*8 DELP
	REAL(10) PI										   |		REAL*8 PI
./spec_plt/subs/dp_cnvrt.f
	REAL(10) XV(NBB),YV(NBB)								   |		REAL*8 XV(NBB),YV(NBB)
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT,LAM_AIR								   |		REAL*8 SPEED_OF_LIGHT,LAM_AIR
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) KEV_TO_HZ,ANG_TO_HZ								   |		REAL*8 KEV_TO_HZ,ANG_TO_HZ
./spec_plt/subs/dp_cnvrt_j.f
	REAL(10) XV(NBB),YV(NBB)								   |		REAL*8 XV(NBB),YV(NBB)
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) KEV_TO_HZ,ANG_TO_HZ								   |		REAL*8 KEV_TO_HZ,ANG_TO_HZ
./spec_plt/subs/dp_cnvrt_j_v2.f
	REAL(10) XV(NBB),YV(NBB)								   |		REAL*8 XV(NBB),YV(NBB)
	REAL(10) LAMC										   |		REAL*8 LAMC
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) C_CMS										   |		REAL*8 C_CMS
	REAL(10) KEV_TO_HZ,ANG_TO_HZ								   |		REAL*8 KEV_TO_HZ,ANG_TO_HZ
./spec_plt/subs/dp_rd_obs_data_v2.f
	REAL(10) LAM(NMAX),FLUX(NMAX)								   |		REAL*8 LAM(NMAX),FLUX(NMAX)
	REAL(10) TEMP_STORE( MAX(COLS(1),COLS(2)) )						   |		REAL*8 TEMP_STORE( MAX(COLS(1),COLS(2)) )
	REAL(10) TO_JANSKY									   |		REAL*8 TO_JANSKY
	REAL(10) LAM_ST										   |		REAL*8 LAM_ST
	REAL(10) DEL_LAM									   |		REAL*8 DEL_LAM
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) OMIT_VAL									   |		REAL*8 OMIT_VAL
	REAL(10) VAL_SCALE_FAC									   |		REAL*8 VAL_SCALE_FAC
	REAL(10) LAM_VAC									   |		REAL*8 LAM_VAC
./spec_plt/subs/filt_pass_band.f
	REAL(10) FILT_ST_LAM(NF)								   |		REAL*8 FILT_ST_LAM(NF)
	REAL(10) FILT_DEL_LAM(NF)								   |		REAL*8 FILT_DEL_LAM(NF)
	REAL(10) FILT_ZP(NF)									   |		REAL*8 FILT_ZP(NF)
	REAL(10) NORM_PASS(25,NF)								   |		REAL*8 NORM_PASS(25,NF)
./spec_plt/subs/filt_pass_band_v2.f
	REAL(10) FILT_ST_LAM(NF)								   |		REAL*8 FILT_ST_LAM(NF)
	REAL(10) FILT_DEL_LAM(NF)								   |		REAL*8 FILT_DEL_LAM(NF)
	REAL(10) FILT_ZP(NF)									   |		REAL*8 FILT_ZP(NF)
	REAL(10) NORM_PASS(25,NF)								   |		REAL*8 NORM_PASS(25,NF)
./spec_plt/subs/fix_pop_oscillations.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) POPS_MAT(NT,ND,5)								   |		REAL*8 POPS_MAT(NT,ND,5)
	REAL(10) R_TMP(ND)									   |		REAL*8 R_TMP(ND)
	REAL(10) V_TMP(ND)									   |		REAL*8 V_TMP(ND)
	REAL(10) SIGMA_TMP(ND)									   |		REAL*8 SIGMA_TMP(ND)
	REAL(10) D5,D4,D3,D2,D1									   |		REAL*8 D5,D4,D3,D2,D1
./spec_plt/subs/get_mag.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) FLUX(NCF)									   |		REAL*8 FLUX(NCF)
	REAL(10) DIST										   |		REAL*8 DIST
	REAL(10) REV_NU(MAX(NCF,N_LOC))								   |		REAL*8 REV_NU(MAX(NCF,N_LOC))
	REAL(10) REV_FLUX(MAX(NCF,N_LOC))							   |		REAL*8 REV_FLUX(MAX(NCF,N_LOC))
	REAL(10) RESP(MAX(NCF,N_LOC))								   |		REAL*8 RESP(MAX(NCF,N_LOC))
	REAL(10) TRANS(MAX(NCF,N_LOC))								   |		REAL*8 TRANS(MAX(NCF,N_LOC))
	REAL(10) FILT_LAM(NF_MAX)								   |		REAL*8 FILT_LAM(NF_MAX)
	REAL(10) FILT_FREQ(NF_MAX)								   |		REAL*8 FILT_FREQ(NF_MAX)
	REAL(10) FILT_RESP(NF_MAX)								   |		REAL*8 FILT_RESP(NF_MAX)
	REAL(10) ATM_LAM(NF_MAX)								   |		REAL*8 ATM_LAM(NF_MAX)
	REAL(10) ATM_TRANS(NF_MAX)								   |		REAL*8 ATM_TRANS(NF_MAX)
	REAL(10) ATM_FREQ(NF_MAX)								   |		REAL*8 ATM_FREQ(NF_MAX)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) MAG										   |		REAL*8 MAG
	REAL(10) NORM										   |		REAL*8 NORM
	REAL(10) FILT_ZP 									   |		REAL*8 FILT_ZP 
./spec_plt/subs/get_nd_nt_nit.f
./spec_plt/subs/get_prof_params.f
	REAL(10) SN_AGE										   |		REAL*8 SN_AGE
	REAL(10) LINE_WAVE									   |		REAL*8 LINE_WAVE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) QW										   |		REAL*8 QW
	REAL(10) MAXIMUM,MINIMUM								   |		REAL*8 MAXIMUM,MINIMUM
	REAL(10) XEMIS_MEAN									   |		REAL*8 XEMIS_MEAN
	REAL(10) C_Mms										   |		REAL*8 C_Mms
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./spec_plt/subs/get_prof_params_v2.f
	REAL(10) SN_AGE										   |		REAL*8 SN_AGE
	REAL(10) LINE_WAVE									   |		REAL*8 LINE_WAVE
	REAL(10) EST_VEL_MIN									   |		REAL*8 EST_VEL_MIN
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) QW										   |		REAL*8 QW
	REAL(10) MAXIMUM,MINIMUM								   |		REAL*8 MAXIMUM,MINIMUM
	REAL(10) XEMIS_MEAN									   |		REAL*8 XEMIS_MEAN
	REAL(10) C_Mms										   |		REAL*8 C_Mms
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./spec_plt/subs/h2abs.f
	REAL(10) WAVE(NLAM)									   |		REAL*8 WAVE(NLAM)
	REAL(10) FLUX(NLAM)									   |		REAL*8 FLUX(NLAM)
	REAL(10) V_TURB		!km/s								   |		REAL*8 V_TURB		!km/s
	REAL(10) LOG_NTOT									   |		REAL*8 LOG_NTOT
	REAL(10) T_IN_K										   |		REAL*8 T_IN_K
	REAL(10) H2_LAM(NH2)									   |		REAL*8 H2_LAM(NH2)
	REAL(10) H2_FREQ(NH2)									   |		REAL*8 H2_FREQ(NH2)
	REAL(10) H2_OSC(NH2)									   |		REAL*8 H2_OSC(NH2)
	REAL(10) H2_GAM(NH2)									   |		REAL*8 H2_GAM(NH2)
	REAL(10) H2_G(NH2)									   |		REAL*8 H2_G(NH2)
	REAL(10) NU_DOP(NH2)									   |		REAL*8 NU_DOP(NH2)
	REAL(10) G_J(0:7)									   |		REAL*8 G_J(0:7)
	REAL(10) N_J(0:7)									   |		REAL*8 N_J(0:7)
	REAL(10) CHIL(NH2)									   |		REAL*8 CHIL(NH2)
	REAL(10) C_KMS,PI									   |		REAL*8 C_KMS,PI
	REAL(10) OPLIN										   |		REAL*8 OPLIN
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) NTOT										   |		REAL*8 NTOT
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) PHI										   |		REAL*8 PHI
	REAL(10) a										   |		REAL*8 a
	REAL(10) v										   |		REAL*8 v
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) HC_ON_K									   |		REAL*8 HC_ON_K
	REAL(10) B										   |		REAL*8 B
	REAL(10) POP_SUM									   |		REAL*8 POP_SUM
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./spec_plt/subs/hiabs.f
	REAL(10) WAVE(NLAM)									   |		REAL*8 WAVE(NLAM)
	REAL(10) FLUX(NLAM)									   |		REAL*8 FLUX(NLAM)
	REAL(10) V_TURB		!km/s								   |		REAL*8 V_TURB		!km/s
	REAL(10) LOG_NTOT									   |		REAL*8 LOG_NTOT
	REAL(10) T_IN_K										   |		REAL*8 T_IN_K
	REAL(10) HYD_LAM(NHYD)									   |		REAL*8 HYD_LAM(NHYD)
	REAL(10) HYD_FREQ(NHYD)									   |		REAL*8 HYD_FREQ(NHYD)
	REAL(10) HYD_OSC(NHYD)									   |		REAL*8 HYD_OSC(NHYD)
	REAL(10) HYD_GAM(NHYD)									   |		REAL*8 HYD_GAM(NHYD)
	REAL(10) HYD_G(NHYD)									   |		REAL*8 HYD_G(NHYD)
	REAL(10) NU_DOP(NHYD)									   |		REAL*8 NU_DOP(NHYD)
C												   |	C
	REAL(10) CHIL(NHYD)									   |		REAL*8 CHIL(NHYD)
C												   |	C
	REAL(10) C_KMS,PI									   |		REAL*8 C_KMS,PI
	REAL(10) OPLIN										   |		REAL*8 OPLIN
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) NTOT										   |		REAL*8 NTOT
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) PHI										   |		REAL*8 PHI
	REAL(10) a										   |		REAL*8 a
	REAL(10) v										   |		REAL*8 v
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./spec_plt/subs/int_rec_ap.f
! 05-Fev-2021: All arrays made REAL(10).							   |	! 05-Fev-2021: All arrays made REAL*8.
	REAL(10) IP(NP,NCF)									   |		REAL*8 IP(NP,NCF)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) YV(NCF)									   |		REAL*8 YV(NCF)
	REAL(10) X_CENT										   |		REAL*8 X_CENT
	REAL(10) Y_CENT										   |		REAL*8 Y_CENT
	REAL(10) WIDTH										   |		REAL*8 WIDTH
	REAL(10) LENGTH										   |		REAL*8 LENGTH
	REAL(10) LOC_X_CENT									   |		REAL*8 LOC_X_CENT
	REAL(10) LOC_Y_CENT									   |		REAL*8 LOC_Y_CENT
	REAL(10) LOC_LENGTH									   |		REAL*8 LOC_LENGTH
	REAL(10) T1										   |		REAL*8 T1
./spec_plt/subs/is_line_abs.f
	REAL(10) WAVE(NLAM)									   |		REAL*8 WAVE(NLAM)
	REAL(10) FLUX(NLAM)									   |		REAL*8 FLUX(NLAM)
	REAL(10) V_TURB		!km/s								   |		REAL*8 V_TURB		!km/s
	REAL(10) LOG_NTOT									   |		REAL*8 LOG_NTOT
	REAL(10) T_IN_K										   |		REAL*8 T_IN_K
	REAL(10) LAM_ZERO(NLINES_MAX)								   |		REAL*8 LAM_ZERO(NLINES_MAX)
	REAL(10) NU_ZERO(NLINES_MAX)								   |		REAL*8 NU_ZERO(NLINES_MAX)
	REAL(10) OSC(NLINES_MAX)								   |		REAL*8 OSC(NLINES_MAX)
	REAL(10) GAM(NLINES_MAX)								   |		REAL*8 GAM(NLINES_MAX)
	REAL(10) GL(NLINES_MAX)									   |		REAL*8 GL(NLINES_MAX)
	REAL(10) GUP(NLINES_MAX)								   |		REAL*8 GUP(NLINES_MAX)
	REAL(10) VDOP(NLINES_MAX)								   |		REAL*8 VDOP(NLINES_MAX)
	REAL(10) VRAD(NLINES_MAX)								   |		REAL*8 VRAD(NLINES_MAX)
	REAL(10) NCOL(NLINES_MAX)								   |		REAL*8 NCOL(NLINES_MAX)
	REAL(10) NU_DOP(NLINES_MAX)								   |		REAL*8 NU_DOP(NLINES_MAX)
C												   |	C
	REAL(10) CHIL(NLINES_MAX)								   |		REAL*8 CHIL(NLINES_MAX)
C												   |	C
	REAL(10) C_KMS,PI									   |		REAL*8 C_KMS,PI
	REAL(10) OPLIN										   |		REAL*8 OPLIN
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) NTOT										   |		REAL*8 NTOT
	REAL(10) PHI										   |		REAL*8 PHI
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) a										   |		REAL*8 a
	REAL(10) v										   |		REAL*8 v
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./spec_plt/subs/is_line_abs_v2.f
	REAL(10) WAVE(NLAM)									   |		REAL*8 WAVE(NLAM)
	REAL(10) FLUX(NLAM)									   |		REAL*8 FLUX(NLAM)
	REAL(10) V_TURB		!km/s								   |		REAL*8 V_TURB		!km/s
	REAL(10) LOG_NTOT									   |		REAL*8 LOG_NTOT
	REAL(10) T_IN_K										   |		REAL*8 T_IN_K
	REAL(10) LAM_ZERO(NLINES_MAX)								   |		REAL*8 LAM_ZERO(NLINES_MAX)
	REAL(10) NU_ZERO(NLINES_MAX)								   |		REAL*8 NU_ZERO(NLINES_MAX)
	REAL(10) OSC(NLINES_MAX)								   |		REAL*8 OSC(NLINES_MAX)
	REAL(10) GAM(NLINES_MAX)								   |		REAL*8 GAM(NLINES_MAX)
	REAL(10) GL(NLINES_MAX)									   |		REAL*8 GL(NLINES_MAX)
	REAL(10) GUP(NLINES_MAX)								   |		REAL*8 GUP(NLINES_MAX)
	REAL(10) VDOP(NLINES_MAX)								   |		REAL*8 VDOP(NLINES_MAX)
	REAL(10) VRAD(NLINES_MAX)								   |		REAL*8 VRAD(NLINES_MAX)
	REAL(10) NCOL(NLINES_MAX)								   |		REAL*8 NCOL(NLINES_MAX)
	REAL(10) NU_DOP(NLINES_MAX)								   |		REAL*8 NU_DOP(NLINES_MAX)
C												   |	C
	REAL(10) CHIL(NLINES_MAX)								   |		REAL*8 CHIL(NLINES_MAX)
C												   |	C
	REAL(10) C_KMS,PI									   |		REAL*8 C_KMS,PI
	REAL(10) OPLIN										   |		REAL*8 OPLIN
	REAL(10) TAU										   |		REAL*8 TAU
	REAL(10) NTOT										   |		REAL*8 NTOT
	REAL(10) PHI										   |		REAL*8 PHI
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) a										   |		REAL*8 a
	REAL(10) v										   |		REAL*8 v
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./spec_plt/subs/num_rec.f
      REAL(10) data(NMAX), respns(NMAX)								   |	      real*8 data(NMAX), respns(NMAX)
      REAL(10) :: HALF=0.5D0									   <
          IF (CABS(ANS(I)) .EQ. zero)THEN							   |	          IF (CDABS(ANS(I)) .EQ. zero)THEN
      REAL(10) DATA1(NMAX),DATA2(NMAX)								   |	      real*8 DATA1(NMAX),DATA2(NMAX)
      REAL(10) WR,WI,WPR,WPI,WTEMP,THETA							   |	      REAL*8 WR,WI,WPR,WPI,WTEMP,THETA
      REAL(10) DATA(NMAX)									   |	      real*8 DATA(NMAX)
      REAL(10) wis,wrs										   |	      real*8 wis,wrs
      REAL(10) c1,c2,h1r,h1i,h2r,h2i								   |	      real*8 c1,c2,h1r,h1i,h2r,h2i
      REAL(10) :: HALF=0.5D0									   <
      WPR=-2.0D0*SIN(HALF*THETA)**2d0								   |	      WPR=-2.0D0*DSIN(0.5D0*THETA)**2d0
      WPI=SIN(THETA)										   |	      WPI=DSIN(THETA)
      REAL(10) WR,WI,WPR,WPI,WTEMP,THETA							   |	      REAL*8 WR,WI,WPR,WPI,WTEMP,THETA
      REAL(10) data(NMAX)									   |	      real*8 data(NMAX)
      REAL(10) tempi,tempr									   |	      real*8 tempi,tempr
      REAL(10) :: HALF=0.5D0									   |
        WPR=-2.D0*SIN(HALF*THETA)**2d0								   |	        WPR=-2.D0*DSIN(0.5D0*THETA)**2d0
        WPI=SIN(THETA)										   |	        WPI=DSIN(THETA)
./spec_plt/subs/plt_jh_opt_desc.f
./spec_plt/subs/poidev.f
      REAL(10) XM										   |	      REAL*8 XM
      REAL(10) POIDEV										   |	      REAL*8 POIDEV
      REAL(10) T										   |	      REAL*8 T
      REAL(10) Y										   |	      REAL*8 Y
      REAL(10) GAMMLN										   |	      REAL*8 GAMMLN
      REAL(10) EM										   |	      REAL*8 EM
      REAL(10) RAN2_DP										   |	      REAL*8 RAN2_DP
      REAL(10), SAVE :: G,SQ,ALXM								   |	      REAL*8, SAVE :: G,SQ,ALXM
      REAL(10), SAVE :: OLDM=-1									   |	      REAL*8, SAVE :: OLDM=-1
      REAL(10), PARAMETER :: PI=3.141592654D0							   |	      REAL*8, PARAMETER :: PI=3.141592654D0
      REAL(10) XX										   |	      REAL*8 XX
      REAL(10) COF(6),STP,HALF,ONE,FPF,X,TMP,SER						   |	      REAL*8 COF(6),STP,HALF,ONE,FPF,X,TMP,SER
      REAL(10) GAMMLN										   |	      REAL*8 GAMMLN
./spec_plt/subs/ran2.f
	REAL(10) RAN2_DP									   |		REAL*8 RAN2_DP
	REAL(10), PARAMETER :: AM=1.0D0/IM1							   |		REAL*8, PARAMETER :: AM=1.0D0/IM1
	REAL(10), PARAMETER :: EPS=1.2D-12							   |		REAL*8, PARAMETER :: EPS=1.2D-12
	REAL(10), PARAMETER :: RNMX=1.0D0-EPS							   |		REAL*8, PARAMETER :: RNMX=1.0D0-EPS
./spec_plt/subs/raw_subphot.f
	REAL(10) FREQ(NCF)		!Cross-section						   |		REAL*8 FREQ(NCF)		!Cross-section
	REAL(10) PHOT(NCF)		!Cross-section						   |		REAL*8 PHOT(NCF)		!Cross-section
	REAL(10) GS_EDGE			!Energy for ionization to Ground State!		   |		REAL*8 GS_EDGE			!Energy for ionization to Ground State!
	REAL(10) EXC_FREQ									   |		REAL*8 EXC_FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CROSS_A(10)									   |		REAL*8 CROSS_A(10)
	REAL(10) VOIGT,HYDCROSSL,GBF								   |		REAL*8 VOIGT,HYDCROSSL,GBF
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10), PARAMETER :: CONV_FAC=1.0D-08							   |		REAL*8, PARAMETER :: CONV_FAC=1.0D-08
	REAL(10), PARAMETER :: LG10_CONV_FAC=-8.0D0						   |		REAL*8, PARAMETER :: LG10_CONV_FAC=-8.0D0
	REAL(10) U			!Defined as FREQ/EDGE					   |		REAL*8 U			!Defined as FREQ/EDGE
	REAL(10) RU			!Defined as EDGE/FREQ					   |		REAL*8 RU			!Defined as EDGE/FREQ
	REAL(10) NEF										   |		REAL*8 NEF
!												   |	!
	REAL(10) EDGE			!Ionization energy					   |		REAL*8 EDGE			!Ionization energy
	REAL(10) ALPHA_BF									   |		REAL*8 ALPHA_BF
	REAL(10) DELF										   |		REAL*8 DELF
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) DOP_NU										   |		REAL*8 DOP_NU
	REAL(10) X										   |		REAL*8 X
	REAL(10) RJ										   |		REAL*8 RJ
	REAL(10) SUM										   |		REAL*8 SUM
	REAL(10) RYD_HZ										   |		REAL*8 RYD_HZ
	REAL(10) EV_TO_HZ									   |		REAL*8 EV_TO_HZ
	    X=LOG10(X)										   |		    X=DLOG10(X)
./spec_plt/subs/raw_subphot_v2.f
	REAL(10) FREQ(NCF)		!Cross-section						   |		REAL*8 FREQ(NCF)		!Cross-section
	REAL(10) PHOT(NCF)		!Cross-section						   |		REAL*8 PHOT(NCF)		!Cross-section
	REAL(10) GS_EDGE			!Energy for ionization to Ground State!		   |		REAL*8 GS_EDGE			!Energy for ionization to Ground State!
	REAL(10) EXC_FREQ									   |		REAL*8 EXC_FREQ
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CROSS_A(10)									   |		REAL*8 CROSS_A(10)
	REAL(10) VOIGT,HYDCROSSL,GBF								   |		REAL*8 VOIGT,HYDCROSSL,GBF
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10), PARAMETER :: CONV_FAC=1.0D-08							   |		REAL*8, PARAMETER :: CONV_FAC=1.0D-08
	REAL(10), PARAMETER :: LG10_CONV_FAC=-8.0D0						   |		REAL*8, PARAMETER :: LG10_CONV_FAC=-8.0D0
	REAL(10) U			!Defined as FREQ/EDGE					   |		REAL*8 U			!Defined as FREQ/EDGE
	REAL(10) RU			!Defined as EDGE/FREQ					   |		REAL*8 RU			!Defined as EDGE/FREQ
	REAL(10) NEF										   |		REAL*8 NEF
!												   |	!
	REAL(10) EDGE			!Ionization energy					   |		REAL*8 EDGE			!Ionization energy
	REAL(10) ALPHA_BF									   |		REAL*8 ALPHA_BF
	REAL(10) DELF										   |		REAL*8 DELF
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) DOP_NU										   |		REAL*8 DOP_NU
	REAL(10) X										   |		REAL*8 X
	REAL(10) RJ										   |		REAL*8 RJ
	REAL(10) SUM										   |		REAL*8 SUM
	REAL(10) RYD_HZ										   |		REAL*8 RYD_HZ
	REAL(10) EV_TO_HZ									   |		REAL*8 EV_TO_HZ
	    X=LOG10(X)										   |		    X=DLOG10(X)
./spec_plt/subs/rd_ew.f
./spec_plt/subs/rd_ion_locations.f
	REAL(10) T1										   |		REAL*8 T1
./spec_plt/subs/rd_ion_locations_v2.f
	REAL(10) ZION(NMAX)									   |		REAL*8 ZION(NMAX)
	REAL(10) AT_NO(NMAX)									   |		REAL*8 AT_NO(NMAX)
	REAL(10) T1										   |		REAL*8 T1
./spec_plt/subs/rd_mod.f
	REAL(10) OBS_FREQ(NCF_MAX)								   |		REAL*8 OBS_FREQ(NCF_MAX)
	REAL(10) OBS_FLUX(NCF_MAX)								   |		REAL*8 OBS_FLUX(NCF_MAX)
./spec_plt/subs/rd_monte_line.f
	REAL(10) FREQ(NMAX)									   |		REAL*8 FREQ(NMAX)
	REAL(10) FLUX(NMAX)									   |		REAL*8 FLUX(NMAX)
	REAL(10) V(NMAX),INTEN(NMAX),P(NMAX),THETA(NMAX),Q(NMAX),U(NMAX)			   |		REAL*8 V(NMAX),INTEN(NMAX),P(NMAX),THETA(NMAX),Q(NMAX),U(NMAX)
	REAL(10) EI(NMAX),EP(NMAX),ET(NMAX),EQ(NMAX),EU(NMAX)					   |		REAL*8 EI(NMAX),EP(NMAX),ET(NMAX),EQ(NMAX),EU(NMAX)
	REAL(10) C_KMS,SUM_I,SUM_Q								   |		REAL*8 C_KMS,SUM_I,SUM_Q
	REAL(10) LINE_WAVE									   |		REAL*8 LINE_WAVE
	REAL(10) SCALING_FLUX									   |		REAL*8 SCALING_FLUX
 	REAL(10) SPEED_OF_LIGHT									   |	 	REAL*8 SPEED_OF_LIGHT
./spec_plt/subs/rd_obs_data_v2.f
	REAL(10) TEMP_STORE( MAX(COLS(1),COLS(2)) )						   |		REAL*8 TEMP_STORE( MAX(COLS(1),COLS(2)) )
	REAL(10) TO_JANSKY									   |		REAL*8 TO_JANSKY
	REAL(10) LAM_ST										   |		REAL*8 LAM_ST
	REAL(10) DEL_LAM									   |		REAL*8 DEL_LAM
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) OMIT_VAL									   |		REAL*8 OMIT_VAL
	REAL(10) VAL_SCALE_FAC									   |		REAL*8 VAL_SCALE_FAC
	REAL(10) LAM_VAC									   |		REAL*8 LAM_VAC
./spec_plt/subs/rd_row_data.f
	REAL(10) XVEC(NX)									   |		REAL*8 XVEC(NX)
	REAL(10) YVEC(NX)									   |		REAL*8 YVEC(NX)
./spec_plt/subs/rd_sing_pol_i.f
	REAL(10) FLUX(NOS)									   |		REAL*8 FLUX(NOS)
	REAL(10) OBSF(NOS)									   |		REAL*8 OBSF(NOS)
	REAL(10) T1										   |		REAL*8 T1
./spec_plt/subs/rd_xy_data.f
												   >	! Altered: 24-Sep-2023 _ Added option to set data index as x variable (18-Sep0-2023)
	REAL(10) XVEC(NX_MAX)									   |		REAL*8 XVEC(NX_MAX)
	REAL(10) YVEC(NX_MAX)									   |		REAL*8 YVEC(NX_MAX)
	REAL(10) TEMP_VAR(MAX_COL)								   |		REAL*8 TEMP_VAR(MAX_COL)
	      XVEC(NX+1)=TEMP_VAR(COLUMN(1))							   |		      IF(COLUMN(1) .EQ. 0)THEN
												   >		        XVEC(NX+1)=NX+1
												   >		      ELSE
												   >		        XVEC(NX+1)=TEMP_VAR(COLUMN(1))
												   >		      END IF
./spec_plt/subs/rd_xy_data_usr.f
												   >	! Altered: 24-Sep-2023 _ Added option to set data index as x variable (18-Sep0-2023)
	REAL(10) XVEC(NX_MAX)									   |		REAL*8 XVEC(NX_MAX)
	REAL(10) YVEC(NX_MAX)									   |		REAL*8 YVEC(NX_MAX)
	REAL(10) TEMP_VAR(MAX_COL)								   |		REAL*8 TEMP_VAR(MAX_COL)
	      XVEC(NX+1)=TEMP_VAR(COLUMN(1))							   |		      IF(COLUMN(1) .EQ. 0)THEN
												   >		        XVEC(NX+1)=NX+1
												   >		      ELSE
												   >		        XVEC(NX+1)=TEMP_VAR(COLUMN(1))
												   >		      END IF
./spec_plt/subs/read_corrections.f
	REAL(10) CORRECTIONS(NT,ND)								   |		REAL*8 CORRECTIONS(NT,ND)
./spec_plt/subs/recom_opac.f
	REAL(10) SIGMA(np_max),NU(np_max),STAT_WT,GION,TEMP					   |		REAL*8 SIGMA(np_max),NU(np_max),STAT_WT,GION,TEMP
	REAL(10) REC(scratch),CROSS(scratch),TOT_REC						   |		REAL*8 REC(scratch),CROSS(scratch),TOT_REC
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1,TP1,CONST,T2								   |		REAL*8 T1,TP1,CONST,T2
	REAL(10) NU_STEP,DEL_NU,DEL_NU_2,DEL_REC						   |		REAL*8 NU_STEP,DEL_NU,DEL_NU_2,DEL_REC
	REAL(10) FRAC_DIFF,MIN_SPACING,X,SIG							   |		REAL*8 FRAC_DIFF,MIN_SPACING,X,SIG
	REAL(10) EDGE,SIG_THRESH								   |		REAL*8 EDGE,SIG_THRESH
	REAL(10) LST_NU										   |		REAL*8 LST_NU
	REAL(10) LST_CROSS									   |		REAL*8 LST_CROSS
./spec_plt/subs/recom_opac_v2.f
	REAL(10) SIGMA(np_max),NU(np_max),STAT_WT,GION,TEMP					   |		REAL*8 SIGMA(np_max),NU(np_max),STAT_WT,GION,TEMP
	REAL(10) REC(scratch),CROSS(scratch),TOT_REC						   |		REAL*8 REC(scratch),CROSS(scratch),TOT_REC
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1,TP1,CONST,T2								   |		REAL*8 T1,TP1,CONST,T2
	REAL(10) NU_STEP,DEL_NU,DEL_NU_2,DEL_REC						   |		REAL*8 NU_STEP,DEL_NU,DEL_NU_2,DEL_REC
	REAL(10) FRAC_DIFF,MIN_SPACING,X,SIG							   |		REAL*8 FRAC_DIFF,MIN_SPACING,X,SIG
	REAL(10) EDGE,SIG_THRESH								   |		REAL*8 EDGE,SIG_THRESH
	REAL(10) FREQ_SCL_FAC									   |		REAL*8 FREQ_SCL_FAC
	REAL(10) LST_NU										   |		REAL*8 LST_NU
	REAL(10) LST_CROSS									   |		REAL*8 LST_CROSS
./spec_plt/subs/set_ip_xspat_unit.f
	REAL(10) XV(NP)										   |		REAL*8 XV(NP)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
	REAL(10) RSTAR										   |		REAL*8 RSTAR
	REAL(10) DISTANCE									   |		REAL*8 DISTANCE
	REAL(10) PARSEC										   |		REAL*8 PARSEC
	REAL(10) T1										   |		REAL*8 T1
./spec_plt/subs/uvabs.f
	REAL(10) origwave(Norig_max)								   |		real*8 origwave(Norig_max)
	REAL(10) origflux(Norig_max)								   |		real*8 origflux(Norig_max)
	REAL(10) origfreq(Norig_max)								   |		real*8 origfreq(Norig_max)
!												   |	!
	REAL(10), allocatable ::  modwave(:)							   |		real*8, allocatable ::  modwave(:)
	REAL(10), allocatable ::  modflux(:)							   |		real*8, allocatable ::  modflux(:)
	REAL(10), allocatable ::  tempwave(:)							   |		real*8, allocatable ::  tempwave(:)
	REAL(10), allocatable ::  tempflux(:)							   |		real*8, allocatable ::  tempflux(:)
	REAL(10), allocatable ::  Hwave(:)							   |		real*8, allocatable ::  Hwave(:)
	REAL(10), allocatable ::  Hflux(:)							   |		real*8, allocatable ::  Hflux(:)
	REAL(10), allocatable ::  Hfreq(:)							   |		real*8, allocatable ::  Hfreq(:)
	REAL(10) t1										   |		real*8 t1
	REAL(10) v_turb        ! turbulent velocity in km/s					   |		real*8 v_turb        ! turbulent velocity in km/s
	REAL(10) v_r           ! radial velocity of star w.r.t. ISM				   |		real*8 v_r           ! radial velocity of star w.r.t. ISM
	REAL(10) log_ntot      ! log base 10 of H column density				   |		real*8 log_ntot      ! log base 10 of H column density
	REAL(10) log_h2_ntot   ! log base 10 of HII column density				   |		real*8 log_h2_ntot   ! log base 10 of HII column density
	REAL(10) t_in_k        ! temperature in K						   |		real*8 t_in_k        ! temperature in K
	REAL(10) wave_max      ! maximum wavelength						   |		real*8 wave_max      ! maximum wavelength
	REAL(10) wave_min      ! minimum wavelength						   |		real*8 wave_min      ! minimum wavelength
	REAL(10) hut_res       ! resolution of H.U.T. in angstroms				   |		real*8 hut_res       ! resolution of H.U.T. in angstroms
	REAL(10) model_res     ! model resolution in angstroms					   |		real*8 model_res     ! model resolution in angstroms
	REAL(10) kernal_res    ! kernal to convolve model spectrm with res.			   |		real*8 kernal_res    ! kernal to convolve model spectrm with res.
	REAL(10) min_res_kms   ! minimum resolution to work with				   |		real*8 min_res_kms   ! minimum resolution to work with
	REAL(10) wave(n)									   |		real*8 wave(n)
	REAL(10) model_res									   |		real*8 model_res
	REAL(10) new_wave(n_new)								   |		real*8 new_wave(n_new)
	REAL(10) New_flux(n_new)								   |		real*8 New_flux(n_new)
	REAL(10) old_wave(n_old)								   |		real*8 old_wave(n_old)
	REAL(10) old_flux(n_old)								   |		real*8 old_flux(n_old)
	REAL(10) dlam 	! even spacing in wavelength						   |		real*8 dlam 	! even spacing in wavelength
	REAL(10) dlamover2									   |		real*8 dlamover2
	REAL(10) freq(n)									   |		real*8 freq(n)
	REAL(10) wave(n)									   |		real*8 wave(n)
	REAL(10) wave(n)									   |		real*8 wave(n)
	  wave(i) = log(wave(i))								   |		  wave(i) = dlog(wave(i))
	  wave(i) = exp(wave(i))								   |		  wave(i) = dexp(wave(i))
	REAL(10) freq(n)									   |		real*8 freq(n)
	REAL(10) flux(n)									   |		real*8 flux(n)
	REAL(10) prev										   |		real*8 prev
	REAL(10) modwave(n)									   |		real*8 modwave(n)
	REAL(10) wave(n),flux(n),freq(n)							   |		real*8 wave(n),flux(n),freq(n)
	REAL(10) Awave(AN),Aflux(AN)								   |		real*8 Awave(AN),Aflux(AN)
	REAL(10) Bwave(BN),Bflux(BN)								   |		real*8 Bwave(BN),Bflux(BN)
	REAL(10) Awave(AN),Aflux(AN)								   |		real*8 Awave(AN),Aflux(AN)
	REAL(10) Bwave(BN),Bflux(BN)								   |		real*8 Bwave(BN),Bflux(BN)
	REAL(10) dlam,dlamover2									   |		real*8 dlam,dlamover2
	REAL(10) fluxsum									   |		real*8 fluxsum
	REAL(10) dlamsum									   |		real*8 dlamsum
	REAL(10) list(n),value									   |		real*8 list(n),value
	REAL(10) list(n),value									   |		real*8 list(n),value
./spec_plt/subs/uvabs_v2.f
	REAL(10) origwave(Norig_max)								   |		real*8 origwave(Norig_max)
	REAL(10) origflux(Norig_max)								   |		real*8 origflux(Norig_max)
	REAL(10) origfreq(Norig_max)								   |		real*8 origfreq(Norig_max)
!												   |	!
	REAL(10), allocatable ::  modwave(:)							   |		real*8, allocatable ::  modwave(:)
	REAL(10), allocatable ::  modflux(:)							   |		real*8, allocatable ::  modflux(:)
	REAL(10), allocatable ::  tempwave(:)							   |		real*8, allocatable ::  tempwave(:)
	REAL(10), allocatable ::  tempflux(:)							   |		real*8, allocatable ::  tempflux(:)
	REAL(10), allocatable ::  Hwave(:)							   |		real*8, allocatable ::  Hwave(:)
	REAL(10), allocatable ::  Hflux(:)							   |		real*8, allocatable ::  Hflux(:)
	REAL(10), allocatable ::  Hfreq(:)							   |		real*8, allocatable ::  Hfreq(:)
	REAL(10) t1										   |		real*8 t1
	REAL(10) v_turb        ! turbulent velocity in km/s					   |		real*8 v_turb        ! turbulent velocity in km/s
	REAL(10) v_r           ! radial velocity of star w.r.t. ISM				   |		real*8 v_r           ! radial velocity of star w.r.t. ISM
	REAL(10) log_ntot      ! log base 10 of H column density				   |		real*8 log_ntot      ! log base 10 of H column density
	REAL(10) log_h2_ntot   ! log base 10 of HII column density				   |		real*8 log_h2_ntot   ! log base 10 of HII column density
	REAL(10) t_in_k        ! temperature in K						   |		real*8 t_in_k        ! temperature in K
	REAL(10) wave_max      ! maximum wavelength						   |		real*8 wave_max      ! maximum wavelength
	REAL(10) wave_min      ! minimum wavelength						   |		real*8 wave_min      ! minimum wavelength
	REAL(10) hut_res       ! resolution of H.U.T. in angstroms				   |		real*8 hut_res       ! resolution of H.U.T. in angstroms
	REAL(10) model_res     ! model resolution in angstroms					   |		real*8 model_res     ! model resolution in angstroms
	REAL(10) kernal_res    ! kernal to convolve model spectrm with res.			   |		real*8 kernal_res    ! kernal to convolve model spectrm with res.
	REAL(10) min_res_kms   ! minimum resolution to work with				   |		real*8 min_res_kms   ! minimum resolution to work with
	REAL(10) wave(n)									   |		real*8 wave(n)
	REAL(10) model_res									   |		real*8 model_res
	REAL(10) new_wave(n_new)								   |		real*8 new_wave(n_new)
	REAL(10) New_flux(n_new)								   |		real*8 New_flux(n_new)
	REAL(10) old_wave(n_old)								   |		real*8 old_wave(n_old)
	REAL(10) old_flux(n_old)								   |		real*8 old_flux(n_old)
	REAL(10) dlam 	! even spacing in wavelength						   |		real*8 dlam 	! even spacing in wavelength
	REAL(10) dlamover2									   |		real*8 dlamover2
	REAL(10) freq(n)									   |		real*8 freq(n)
	REAL(10) wave(n)									   |		real*8 wave(n)
	REAL(10) wave(n)									   |		real*8 wave(n)
	  wave(i) = log(wave(i))								   |		  wave(i) = dlog(wave(i))
	  wave(i) = exp(wave(i))								   |		  wave(i) = dexp(wave(i))
	REAL(10) freq(n)									   |		real*8 freq(n)
	REAL(10) flux(n)									   |		real*8 flux(n)
	REAL(10) prev										   |		real*8 prev
	REAL(10) modwave(n)									   |		real*8 modwave(n)
	REAL(10) wave(n),flux(n),freq(n)							   |		real*8 wave(n),flux(n),freq(n)
	REAL(10) Awave(AN),Aflux(AN)								   |		real*8 Awave(AN),Aflux(AN)
	REAL(10) Bwave(BN),Bflux(BN)								   |		real*8 Bwave(BN),Bflux(BN)
	REAL(10) Awave(AN),Aflux(AN)								   |		real*8 Awave(AN),Aflux(AN)
	REAL(10) Bwave(BN),Bflux(BN)								   |		real*8 Bwave(BN),Bflux(BN)
	REAL(10) dlam,dlamover2									   |		real*8 dlam,dlamover2
	REAL(10) fluxsum									   |		real*8 fluxsum
	REAL(10) dlamsum									   |		real*8 dlamsum
	REAL(10) list(n),value									   |		real*8 list(n),value
	REAL(10) list(n),value									   |		real*8 list(n),value
./spec_plt/subs/constants.inc
./spec_plt/subs/parameters.inc
 
Comparing files in ./subs with those in  /home/hillier/wnode04/cmf_testing_real8//subs
 
./subs/Makefile
./subs/add_par_to_full.f
	REAL(10) BA(NION,NT,NUM_BNDS,ND)							   |		REAL*8 BA(NION,NT,NUM_BNDS,ND)
	REAL(10) BA_PAR(NION,NT,ND)								   |		REAL*8 BA_PAR(NION,NT,ND)
./subs/adjust_line_freq.f
	REAL(10) LINE_FREQ(N_LINE_FREQ)								   |		REAL*8 LINE_FREQ(N_LINE_FREQ)
	REAL(10) WAVE,FREQ,ANG_TO_HZ,T1								   |		REAL*8 WAVE,FREQ,ANG_TO_HZ,T1
	REAL(10) LAM_VAC,SPEED_OF_LIGHT								   |		REAL*8 LAM_VAC,SPEED_OF_LIGHT
./subs/adjust_line_freq_v2.f
	REAL(10) LINE_FREQ(N_LINE_FREQ)								   |		REAL*8 LINE_FREQ(N_LINE_FREQ)
	REAL(10) LINE_STRT_FREQ(N_LINE_FREQ)							   |		REAL*8 LINE_STRT_FREQ(N_LINE_FREQ)
	REAL(10) WAVE,FREQ,ANG_TO_HZ,T1								   |		REAL*8 WAVE,FREQ,ANG_TO_HZ,T1
	REAL(10) LAM_VAC,SPEED_OF_LIGHT								   |		REAL*8 LAM_VAC,SPEED_OF_LIGHT
./subs/ave_flips.f
	REAL(10) NEW_POPS(NT*ND)								   |		REAL*8 NEW_POPS(NT*ND)
	REAL(10) POPS(NT*ND)									   |		REAL*8 POPS(NT*ND)
	REAL(10) OLD_POPS(NT*ND,NUM_OSC+2)							   |		REAL*8 OLD_POPS(NT*ND,NUM_OSC+2)
	REAL(10) R_TMP(ND)									   |		REAL*8 R_TMP(ND)
	REAL(10) V_TMP(ND)									   |		REAL*8 V_TMP(ND)
	REAL(10) SIGMA_TMP(ND)									   |		REAL*8 SIGMA_TMP(ND)
	REAL(10) R										   |		REAL*8 R
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/baion_update_v4.f
C Altered   24-May-1996  -- Cleaning (IONE, RMAX_FAC etc, no ABS)				   |	C Altered   24-May-1996  -- Cleaning (IONE, RMAX_FAC etc, no DABS)
	REAL(10) BAION(NION,NT,NUM_BNDS,ND)							   |		REAL*8 BAION(NION,NT,NUM_BNDS,ND)
	REAL(10) BAION_PAR(NION,NT,ND)								   |		REAL*8 BAION_PAR(NION,NT,ND)
	REAL(10) QFVION_R(NION,ND)								   |		REAL*8 QFVION_R(NION,ND)
	REAL(10) QFVION_P(NION,ND)								   |		REAL*8 QFVION_P(NION,ND)
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) dJ_CHK_FAC									   |		REAL*8 dJ_CHK_FAC
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) COMP_VEC(NT)									   |		REAL*8 COMP_VEC(NT)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/ba_replace.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)						   |		REAL*8 BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)
	REAL(10) BAION(NION,NT,NUM_BNDS,ND),STEQION(NION,ND)					   |		REAL*8 BAION(NION,NT,NUM_BNDS,ND),STEQION(NION,ND)
	REAL(10) C2(NC2,ND),DC2(ND),EDGEC2(NC2),T(ND)						   |		REAL*8 C2(NC2,ND),DC2(ND),EDGEC2(NC2),T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,FAC										   |		REAL*8 T1,FAC
./subs/ba_update_v4.f
	REAL(10), ALLOCATABLE :: VJ_R(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_R(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_P(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_P(:,:,:)
	REAL(10), ALLOCATABLE :: VJ_T(:,:,:)							   |		REAL*8, ALLOCATABLE :: VJ_T(:,:,:)
	REAL(10), ALLOCATABLE :: RJ_SUM(:)							   |		REAL*8, ALLOCATABLE :: RJ_SUM(:)
C                         ABS changed to ABS.							   |	C                         DABS changed to ABS.
	REAL(10) BA(NT,NT,NUM_BNDS,ND)								   |		REAL*8 BA(NT,NT,NUM_BNDS,ND)
	REAL(10) BA_PAR(NT,NT,ND)								   |		REAL*8 BA_PAR(NT,NT,ND)
	REAL(10) QFV_R(NT,ND)									   |		REAL*8 QFV_R(NT,ND)
	REAL(10) QFV_P(NT,ND)									   |		REAL*8 QFV_P(NT,ND)
	REAL(10) VJ(NT,NUM_BNDS,ND)								   |		REAL*8 VJ(NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) dJ_CHK_FAC									   |		REAL*8 dJ_CHK_FAC
C												   |	C
	REAL(10) CHI_CONT(ND)									   |		REAL*8 CHI_CONT(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) COMP_VEC(NT)									   |		REAL*8 COMP_VEC(NT)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,QFV_T									   |		REAL*8 T1,T2,QFV_T
./subs/blkband.f
	REAL(10) BA(N,N,NUM_BNDS,ND),STEQ(N,ND)							   |		REAL*8 BA(N,N,NUM_BNDS,ND),STEQ(N,ND)
	REAL(10) WRKMAT(N,N),VEC(N)								   |		REAL*8 WRKMAT(N,N),VEC(N)
	REAL(10) ROW_SF(N),COL_SF(N)								   |		REAL*8 ROW_SF(N),COL_SF(N)
	REAL(10) ROW_CND,COL_CND,MAX_VAL							   |		REAL*8 ROW_CND,COL_CND,MAX_VAL
	REAL(10) DP_ONE,DP_NEG_ONE,DP_ZERO							   |		REAL*8 DP_ONE,DP_NEG_ONE,DP_ZERO
./subs/check_line_overlap.f
./subs/check_spec_conv.f
	REAL(10) OBS_FLUX(NOBS)									   |		REAL*8 OBS_FLUX(NOBS)
	REAL(10) OBS_FREQ(NOBS)									   |		REAL*8 OBS_FREQ(NOBS)
	REAL(10) LAM_ST			!not yet used						   |		REAL*8 LAM_ST			!not yet used
	REAL(10) LAM_END									   |		REAL*8 LAM_END
	REAL(10), SAVE :: LAM_LIMS(0:NLAM)							   |		REAL*8, SAVE :: LAM_LIMS(0:NLAM)
	REAL(10), SAVE :: HIST_LIMS(NHIST)							   |		REAL*8, SAVE :: HIST_LIMS(NHIST)
	REAL(10), SAVE :: MAX_FRAC_CHNG(NITS)							   |		REAL*8, SAVE :: MAX_FRAC_CHNG(NITS)
	REAL(10), ALLOCATABLE, SAVE :: OBS_SAVE(:)						   |		REAL*8, ALLOCATABLE, SAVE :: OBS_SAVE(:)
	REAL(10), ALLOCATABLE, SAVE :: WRK_VEC(:)						   |		REAL*8, ALLOCATABLE, SAVE :: WRK_VEC(:)
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LAM										   |		REAL*8 LAM
./subs/chk_col_name.f
./subs/chk_eq_num.f
./subs/cmf_form_sol.f
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: P_EXT(:)							   |		REAL*8, ALLOCATABLE :: P_EXT(:)
	REAL(10), ALLOCATABLE :: ROH_EXT(:)							   |		REAL*8, ALLOCATABLE :: ROH_EXT(:)
C												   |	C
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: ESEC_OLD(:)							   |		REAL*8, ALLOCATABLE :: ESEC_OLD(:)
	REAL(10), ALLOCATABLE :: ETA_OLD(:)							   |		REAL*8, ALLOCATABLE :: ETA_OLD(:)
	REAL(10), ALLOCATABLE :: CHI_OLD(:)							   |		REAL*8, ALLOCATABLE :: CHI_OLD(:)
	REAL(10), ALLOCATABLE :: R_FINE(:)							   |		REAL*8, ALLOCATABLE :: R_FINE(:)
	REAL(10), ALLOCATABLE :: CHI_FINE(:)							   |		REAL*8, ALLOCATABLE :: CHI_FINE(:)
	REAL(10), ALLOCATABLE :: ETA_FINE(:)							   |		REAL*8, ALLOCATABLE :: ETA_FINE(:)
	REAL(10), ALLOCATABLE :: dCHIdR_FINE(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_FINE(:)
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) FL_PREV									   |		REAL*8 FL_PREV
	REAL(10) OLD_CHI_AT_IN_BND								   |		REAL*8 OLD_CHI_AT_IN_BND
	REAL(10) ETA_NEW(ND)	!Emissivity --- contains e.s. term.				   |		REAL*8 ETA_NEW(ND)	!Emissivity --- contains e.s. term.
	REAL(10) CHI_NEW(ND)									   |		REAL*8 CHI_NEW(ND)
	REAL(10) ESEC_NEW(ND)									   |		REAL*8 ESEC_NEW(ND)
	REAL(10) ROH(ND)									   |		REAL*8 ROH(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
C												   |	C
	REAL(10) P_OBS(NP_OBS_MAX)								   |		REAL*8 P_OBS(NP_OBS_MAX)
	REAL(10) IPLUS_P(NP_OBS_MAX)								   |		REAL*8 IPLUS_P(NP_OBS_MAX)
	REAL(10) MU_AT_RMAX(NP_OBS_MAX)								   |		REAL*8 MU_AT_RMAX(NP_OBS_MAX)
	REAL(10) HQW_AT_RMAX(NP_OBS_MAX)							   |		REAL*8 HQW_AT_RMAX(NP_OBS_MAX)
	REAL(10) RMAX_OBS,V_AT_RMAX								   |		REAL*8 RMAX_OBS,V_AT_RMAX
	REAL(10) FRAC_DOP,V_DOP,dV_CMF_PROF,dV_CMF_WING						   |		REAL*8 FRAC_DOP,V_DOP,dV_CMF_PROF,dV_CMF_WING
	REAL(10) DBB,IC,FL,dLOG_NU								   |		REAL*8 DBB,IC,FL,dLOG_NU
	REAL(10) EXT_FAC									   |		REAL*8 EXT_FAC
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) TA(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TA(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) TB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) TC(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TC(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) AV(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 AV(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) CV(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 CV(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) DTAU(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 DTAU(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) XM(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 XM(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SOURCE(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SOURCE(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) U(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 U(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) VB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 VB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) VC(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 VC(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) GB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 GB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) H(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 H(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) Q(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 Q(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) QH(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 QH(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) V_RAY(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 V_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SIGMA_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SIGMA_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) CHI_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 CHI_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) ETA_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 ETA_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) dCHIdR(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 dCHIdR(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) LOG_SIGMA(ND)									   |		REAL*8 LOG_SIGMA(ND)
	REAL(10) LOG_CHI(ND)									   |		REAL*8 LOG_CHI(ND)
	REAL(10) LOG_ETA(ND)									   |		REAL*8 LOG_ETA(ND)
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) IBOUND			!Incident intensity on outer boundary.			   |		REAL*8 IBOUND			!Incident intensity on outer boundary.
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELR										   |		REAL*8 DELR
C												   |	C
	REAL(10) NEW_dLOG_NU		!dv							   |		REAL*8 NEW_dLOG_NU		!dv
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) CV_BOUND									   |		REAL*8 CV_BOUND
	REAL(10) MU,dZ										   |		REAL*8 MU,dZ
	REAL(10) ROH_ALPHA									   |		REAL*8 ROH_ALPHA
	REAL(10) ESEC_ALPHA									   |		REAL*8 ESEC_ALPHA
	REAL(10) CHI_ALPHA									   |		REAL*8 CHI_ALPHA
	REAL(10) ETA_ALPHA									   |		REAL*8 ETA_ALPHA
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/cmf_form_sol_v2.f
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: P_EXT(:)							   |		REAL*8, ALLOCATABLE :: P_EXT(:)
	REAL(10), ALLOCATABLE :: ROH_EXT(:)							   |		REAL*8, ALLOCATABLE :: ROH_EXT(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: dGAMdR(:,:)							   |		REAL*8, ALLOCATABLE :: dGAMdR(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: ESEC_OLD(:)							   |		REAL*8, ALLOCATABLE :: ESEC_OLD(:)
	REAL(10), ALLOCATABLE :: ETA_OLD(:)							   |		REAL*8, ALLOCATABLE :: ETA_OLD(:)
	REAL(10), ALLOCATABLE :: CHI_OLD(:)							   |		REAL*8, ALLOCATABLE :: CHI_OLD(:)
	REAL(10), ALLOCATABLE :: R_FINE(:)							   |		REAL*8, ALLOCATABLE :: R_FINE(:)
	REAL(10), ALLOCATABLE :: CHI_FINE(:)							   |		REAL*8, ALLOCATABLE :: CHI_FINE(:)
	REAL(10), ALLOCATABLE :: ETA_FINE(:)							   |		REAL*8, ALLOCATABLE :: ETA_FINE(:)
	REAL(10), ALLOCATABLE :: dCHIdR_FINE(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_FINE(:)
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) FL_PREV									   |		REAL*8 FL_PREV
	REAL(10) OLD_CHI_AT_IN_BND								   |		REAL*8 OLD_CHI_AT_IN_BND
	REAL(10) ETA_NEW(ND)	!Emissivity --- contains e.s. term.				   |		REAL*8 ETA_NEW(ND)	!Emissivity --- contains e.s. term.
	REAL(10) CHI_NEW(ND)									   |		REAL*8 CHI_NEW(ND)
	REAL(10) ESEC_NEW(ND)									   |		REAL*8 ESEC_NEW(ND)
	REAL(10) ROH(ND)									   |		REAL*8 ROH(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
C												   |	C
	REAL(10) P_OBS(NP_OBS_MAX)								   |		REAL*8 P_OBS(NP_OBS_MAX)
	REAL(10) IPLUS_P(NP_OBS_MAX)								   |		REAL*8 IPLUS_P(NP_OBS_MAX)
	REAL(10) MU_AT_RMAX(NP_OBS_MAX)								   |		REAL*8 MU_AT_RMAX(NP_OBS_MAX)
	REAL(10) HQW_AT_RMAX(NP_OBS_MAX)							   |		REAL*8 HQW_AT_RMAX(NP_OBS_MAX)
	REAL(10) RMAX_OBS,V_AT_RMAX								   |		REAL*8 RMAX_OBS,V_AT_RMAX
	REAL(10) FRAC_DOP,V_DOP,dV_CMF_PROF,dV_CMF_WING						   |		REAL*8 FRAC_DOP,V_DOP,dV_CMF_PROF,dV_CMF_WING
	REAL(10) DBB,IC,FL,dLOG_NU								   |		REAL*8 DBB,IC,FL,dLOG_NU
	REAL(10),  PARAMETER :: ONE=1.0D0							   |		REAL*8,  PARAMETER :: ONE=1.0D0
	REAL(10),    PARAMETER :: EXT_FAC=10.0D0						   |		REAL*8,    PARAMETER :: EXT_FAC=10.0D0
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) TA(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TA(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) TB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) TC(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TC(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) AV(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 AV(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) CV(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 CV(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) DTAU(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 DTAU(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) XM(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 XM(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SOURCE(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SOURCE(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) U(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 U(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) VB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 VB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) VC(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 VC(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) GB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 GB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) H(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 H(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) Q(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 Q(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) QH(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 QH(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) V_RAY(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 V_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SIGMA_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SIGMA_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) CHI_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 CHI_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) ETA_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 ETA_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) dCHIdR(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 dCHIdR(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           I_P(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           I_P(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           I_M(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           I_M(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           EE(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           EE(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E0(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E0(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E1(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E1(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E2(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E2(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E3(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E3(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A0(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A0(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A1(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A1(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A2(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A2(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A3(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A3(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A4(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A4(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SOURCE_PRIME(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SOURCE_PRIME(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)            S(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8            S(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           dS(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           dS(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) LOG_CHI(ND)									   |		REAL*8 LOG_CHI(ND)
	REAL(10) LOG_ETA(ND)									   |		REAL*8 LOG_ETA(ND)
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) IBOUND			!Incident intensity on outer boundary.			   |		REAL*8 IBOUND			!Incident intensity on outer boundary.
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELR										   |		REAL*8 DELR
	REAL(10) DELZ										   |		REAL*8 DELZ
	REAL(10) I_CORE										   |		REAL*8 I_CORE
C												   |	C
	REAL(10) NEW_dLOG_NU		!dv							   |		REAL*8 NEW_dLOG_NU		!dv
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) CV_BOUND									   |		REAL*8 CV_BOUND
	REAL(10) MU,dZ										   |		REAL*8 MU,dZ
	REAL(10) ROH_ALPHA									   |		REAL*8 ROH_ALPHA
	REAL(10) ESEC_ALPHA									   |		REAL*8 ESEC_ALPHA
	REAL(10) CHI_ALPHA									   |		REAL*8 CHI_ALPHA
	REAL(10) ETA_ALPHA									   |		REAL*8 ETA_ALPHA
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/cmf_form_sol_v3.f
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: P_EXT(:)							   |		REAL*8, ALLOCATABLE :: P_EXT(:)
	REAL(10), ALLOCATABLE :: ROH_EXT(:)							   |		REAL*8, ALLOCATABLE :: ROH_EXT(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: dGAMdR(:,:)							   |		REAL*8, ALLOCATABLE :: dGAMdR(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: ESEC_OLD(:)							   |		REAL*8, ALLOCATABLE :: ESEC_OLD(:)
	REAL(10), ALLOCATABLE :: ETA_OLD(:)							   |		REAL*8, ALLOCATABLE :: ETA_OLD(:)
	REAL(10), ALLOCATABLE :: CHI_OLD(:)							   |		REAL*8, ALLOCATABLE :: CHI_OLD(:)
	REAL(10), ALLOCATABLE :: R_FINE(:)							   |		REAL*8, ALLOCATABLE :: R_FINE(:)
	REAL(10), ALLOCATABLE :: CHI_FINE(:)							   |		REAL*8, ALLOCATABLE :: CHI_FINE(:)
	REAL(10), ALLOCATABLE :: ETA_FINE(:)							   |		REAL*8, ALLOCATABLE :: ETA_FINE(:)
	REAL(10), ALLOCATABLE :: dCHIdR_FINE(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_FINE(:)
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) FL_PREV									   |		REAL*8 FL_PREV
	REAL(10) OLD_CHI_AT_IN_BND								   |		REAL*8 OLD_CHI_AT_IN_BND
	REAL(10) ETA_NEW(ND)	!Emissivity --- contains e.s. term.				   |		REAL*8 ETA_NEW(ND)	!Emissivity --- contains e.s. term.
	REAL(10) CHI_NEW(ND)									   |		REAL*8 CHI_NEW(ND)
	REAL(10) ESEC_NEW(ND)									   |		REAL*8 ESEC_NEW(ND)
	REAL(10) ROH(ND)									   |		REAL*8 ROH(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) P(NP)										   |		REAL*8 P(NP)
C												   |	C
	REAL(10) P_OBS(NP_OBS_MAX)								   |		REAL*8 P_OBS(NP_OBS_MAX)
	REAL(10) IPLUS_P(NP_OBS_MAX)								   |		REAL*8 IPLUS_P(NP_OBS_MAX)
	REAL(10) MU_AT_RMAX(NP_OBS_MAX)								   |		REAL*8 MU_AT_RMAX(NP_OBS_MAX)
	REAL(10) HQW_AT_RMAX(NP_OBS_MAX)							   |		REAL*8 HQW_AT_RMAX(NP_OBS_MAX)
	REAL(10) RMAX_OBS,V_AT_RMAX								   |		REAL*8 RMAX_OBS,V_AT_RMAX
	REAL(10) FRAC_DOP,V_DOP,dV_CMF_PROF,dV_CMF_WING						   |		REAL*8 FRAC_DOP,V_DOP,dV_CMF_PROF,dV_CMF_WING
	REAL(10) DBB,IC,FL,dLOG_NU								   |		REAL*8 DBB,IC,FL,dLOG_NU
	REAL(10),  PARAMETER :: ONE=1.0D0							   |		REAL*8,  PARAMETER :: ONE=1.0D0
	REAL(10),    PARAMETER :: EXT_FAC=10.0D0						   |		REAL*8,    PARAMETER :: EXT_FAC=10.0D0
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ETA(ND)									   |		REAL*8 ETA(ND)
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) TA(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TA(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) TB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) TC(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 TC(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) AV(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 AV(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) CV(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 CV(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) DTAU(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 DTAU(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) XM(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 XM(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SOURCE(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SOURCE(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) U(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 U(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) VB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 VB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) VC(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 VC(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) GB(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 GB(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) H(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 H(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) Q(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 Q(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) QH(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 QH(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) V_RAY(PNT_FAC*(ND+ND_ADD_MAX))							   |		REAL*8 V_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SIGMA_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SIGMA_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) CHI_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 CHI_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) ETA_RAY(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 ETA_RAY(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) dCHIdR(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 dCHIdR(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           I_P(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           I_P(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           I_M(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           I_M(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           EE(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           EE(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E0(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E0(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E1(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E1(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E2(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E2(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           E3(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           E3(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A0(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A0(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A1(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A1(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A2(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A2(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A3(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A3(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           A4(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           A4(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) SOURCE_PRIME(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8 SOURCE_PRIME(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)            S(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8            S(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10)           dS(PNT_FAC*(ND+ND_ADD_MAX))						   |		REAL*8           dS(PNT_FAC*(ND+ND_ADD_MAX))
	REAL(10) LOG_R(ND)									   |		REAL*8 LOG_R(ND)
	REAL(10) LOG_V(ND)									   |		REAL*8 LOG_V(ND)
	REAL(10) LOG_CHI(ND)									   |		REAL*8 LOG_CHI(ND)
	REAL(10) LOG_ETA(ND)									   |		REAL*8 LOG_ETA(ND)
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) IBOUND			!Incident intensity on outer boundary.			   |		REAL*8 IBOUND			!Incident intensity on outer boundary.
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELR										   |		REAL*8 DELR
	REAL(10) DELZ										   |		REAL*8 DELZ
	REAL(10) I_CORE										   |		REAL*8 I_CORE
C												   |	C
	REAL(10) NEW_dLOG_NU		!dv							   |		REAL*8 NEW_dLOG_NU		!dv
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) CV_BOUND									   |		REAL*8 CV_BOUND
	REAL(10) MU,dZ										   |		REAL*8 MU,dZ
	REAL(10) ROH_ALPHA									   |		REAL*8 ROH_ALPHA
	REAL(10) ESEC_ALPHA									   |		REAL*8 ESEC_ALPHA
	REAL(10) CHI_ALPHA									   |		REAL*8 CHI_ALPHA
	REAL(10) ETA_ALPHA									   |		REAL*8 ETA_ALPHA
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/cnvt_fr_dc.f
	REAL(10) C2(NC2,ND),C2LTE(NC2,ND),DC2(ND),DCI(ND),SUM(ND)				   |		REAL*8 C2(NC2,ND),C2LTE(NC2,ND),DC2(ND),DCI(ND),SUM(ND)
./subs/cnvt_fr_dc_v2.f
	REAL(10) C2(NC2,ND)									   |		REAL*8 C2(NC2,ND)
	REAL(10) LOG_C2LTE(NC2,ND)								   |		REAL*8 LOG_C2LTE(NC2,ND)
	REAL(10) DC2(ND)									   |		REAL*8 DC2(ND)
	REAL(10) DCI(ND)									   |		REAL*8 DCI(ND)
	REAL(10) SUM(ND)									   |		REAL*8 SUM(ND)
./subs/colcool_sl_v3.f
												   >	C Altered 24-Sep-2023 : Adjusted constants for consistency.
	EXTERNAL ERROR_LU									   |		EXTERNAL ERROR_LU, PLANCKS_CONSTANT
												   >	        REAL*8 PLANCKS_CONSTANT
	REAL(10) COOL(ND),CRR(ND),CPR(ND)							   |		REAL*8 COOL(ND),CRR(ND),CPR(ND)
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) ZION,T(ND),ED(ND)								   |		REAL*8 ZION,T(ND),ED(ND)
C												   |	C
	REAL(10) HN_S(N_S,ND),HNST_S(N_S,ND)							   |		REAL*8 HN_S(N_S,ND),HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
C												   |	C
	REAL(10) HN_F(N_F,ND),HNST_F(N_F,ND)							   |		REAL*8 HN_F(N_F,ND),HNST_F(N_F,ND)	
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F),EDGE_F(N_F),G_F(N_F)						   |		REAL*8 A_F(N_F,N_F),EDGE_F(N_F),G_F(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) H,TMP_ED									   |		REAL*8 H,TMP_ED
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
	H=6.6261965D-12		!H*1.0E+15  (1.0E+15 due to times frequency)			   |		H=PLANCKS_CONSTANT()*1.0D+15		!H*1.0E+15  (1.0E+15 due to times frequency)
./subs/comp_j_conv.f
	REAL(10) J_STORE(ND,NT*NT*NUM_BNDS)	!BA matrix in main program.			   |		REAL*8 J_STORE(ND,NT*NT*NUM_BNDS)	!BA matrix in main program.
	REAL(10) NU(NCF)				!Frequency (10^15 Hz)			   |		REAL*8 NU(NCF)				!Frequency (10^15 Hz)
	REAL(10) TEMP(ND)				!Temperature (10^4 K)			   |		REAL*8 TEMP(ND)				!Temperature (10^4 K)
	REAL(10) A(NCF)										   |		REAL*8 A(NCF)
	REAL(10) H(NCF)										   |		REAL*8 H(NCF)
	REAL(10) C(NCF)										   |		REAL*8 C(NCF)
	REAL(10) D(NCF)										   |		REAL*8 D(NCF)
C												   |	C
	REAL(10) A_STORE(NCF)									   |		REAL*8 A_STORE(NCF)
	REAL(10) C_STORE(NCF)									   |		REAL*8 C_STORE(NCF)
	REAL(10) J_ES(NCF)									   |		REAL*8 J_ES(NCF)
C												   |	C
	REAL(10) PLANCK_FN(NCF)									   |		REAL*8 PLANCK_FN(NCF)
	REAL(10) PLANCK_ES(NCF)									   |		REAL*8 PLANCK_ES(NCF)
	REAL(10) PLANCK_NU(NCF)									   |		REAL*8 PLANCK_NU(NCF)
	REAL(10), ALLOCATABLE :: EXTRA_J_ST(:,:)						   |		REAL*8, ALLOCATABLE :: EXTRA_J_ST(:,:)
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) D1,D2,DH									   |		REAL*8 D1,D2,DH
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) ACOEF(2),BCOEF(2)								   |		REAL*8 ACOEF(2),BCOEF(2)
	  A(:)=LOG(J_ES(:))									   |		  A(:)=DLOG(J_ES(:))
./subs/comp_j_conv_v2.f
	REAL(10) J_STORE(ND,J_SIZE/ND)		!BA matrix in main program.			   |		REAL*8 J_STORE(ND,J_SIZE/ND)		!BA matrix in main program.
	REAL(10) NU(NCF)				!Frequency (10^15 Hz)			   |		REAL*8 NU(NCF)				!Frequency (10^15 Hz)
	REAL(10) TEMP(ND)				!Temperature (10^4 K)			   |		REAL*8 TEMP(ND)				!Temperature (10^4 K)
	REAL(10) A(NCF)										   |		REAL*8 A(NCF)
	REAL(10) H(NCF)										   |		REAL*8 H(NCF)
	REAL(10) C(NCF)										   |		REAL*8 C(NCF)
	REAL(10) D(NCF)										   |		REAL*8 D(NCF)
C												   |	C
	REAL(10) A_STORE(NCF)									   |		REAL*8 A_STORE(NCF)
	REAL(10) C_STORE(NCF)									   |		REAL*8 C_STORE(NCF)
	REAL(10) J_ES(NCF)									   |		REAL*8 J_ES(NCF)
C												   |	C
	REAL(10) PLANCK_FN(NCF)									   |		REAL*8 PLANCK_FN(NCF)
	REAL(10) PLANCK_ES(NCF)									   |		REAL*8 PLANCK_ES(NCF)
	REAL(10) PLANCK_NU(NCF)									   |		REAL*8 PLANCK_NU(NCF)
	REAL(10), ALLOCATABLE :: EXTRA_J_ST(:,:)						   |		REAL*8, ALLOCATABLE :: EXTRA_J_ST(:,:)
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) D1,D2,DH									   |		REAL*8 D1,D2,DH
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) ACOEF(2),BCOEF(2)								   |		REAL*8 ACOEF(2),BCOEF(2)
	    A(:)=LOG(J_ES(:))									   |		    A(:)=DLOG(J_ES(:))
./subs/comp_lev_dis.f
	REAL(10), ALLOCATABLE :: B_LEV_DIS(:)							   |		REAL*8, ALLOCATABLE :: B_LEV_DIS(:)
	REAL(10), ALLOCATABLE :: A_LEV_DIS(:)							   |		REAL*8, ALLOCATABLE :: A_LEV_DIS(:)
	REAL(10), ALLOCATABLE :: X_LEV_DIS(:)							   |		REAL*8, ALLOCATABLE :: X_LEV_DIS(:)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) POPION(ND)									   |		REAL*8 POPION(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
./subs/comp_obs.f
	REAL(10) NEW_IPLUS(NP)		!RAW CMF intensities as a function of			   |		REAL*8 NEW_IPLUS(NP)		!RAW CMF intensities as a function of
	REAL(10) NEW_NU			!Current CMF frequency.					   |		REAL*8 NEW_NU			!Current CMF frequency.
	REAL(10) MU(NP)										   |		REAL*8 MU(NP)
	REAL(10) FLUX_WGHTS(NP)									   |		REAL*8 FLUX_WGHTS(NP)
	REAL(10) OBS_FREQ(N_OBS)								   |		REAL*8 OBS_FREQ(N_OBS)
	REAL(10) OBS_FLUX(N_OBS)								   |		REAL*8 OBS_FLUX(N_OBS)
	REAL(10) IPLUS_STORE(NST_CMF,NP)							   |		REAL*8 IPLUS_STORE(NST_CMF,NP)
	REAL(10) NU_STORE(NST_CMF)								   |		REAL*8 NU_STORE(NST_CMF)
	REAL(10) VINF			!							   |		REAL*8 VINF			!
	REAL(10) RMAX			!Radius at outer boundary.				   |		REAL*8 RMAX			!Radius at outer boundary.
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) FLUX_CONST									   |		REAL*8 FLUX_CONST
	REAL(10) SPEED_OF_LIGHT,PARSEC,FUN_PI							   |		REAL*8 SPEED_OF_LIGHT,PARSEC,FUN_PI
	REAL(10) NU_SM_CMF									   |		REAL*8 NU_SM_CMF
	REAL(10) FLUX,T1									   |		REAL*8 FLUX,T1
	REAL(10) CMF_FREQ		!Observer's frequency transformed to comoving		   |		REAL*8 CMF_FREQ		!Observer's frequency transformed to comoving
	REAL(10) HIM1,HI,HIP1									   |		REAL*8 HIM1,HI,HIP1
	REAL(10) SGN,SIM1,SI,SIP1								   |		REAL*8 SGN,SIM1,SI,SIP1
	REAL(10) DYI,DYIP1									   |		REAL*8 DYI,DYIP1
	REAL(10) A,B,C,D									   |		REAL*8 A,B,C,D
	REAL(10) ONE										   |		REAL*8 ONE
./subs/comp_obs_v2.f
	REAL(10) NEW_IPLUS(NP)		!RAW CMF intensities as a function of			   |		REAL*8 NEW_IPLUS(NP)		!RAW CMF intensities as a function of
	REAL(10) NEW_NU			!Current CMF frequency.					   |		REAL*8 NEW_NU			!Current CMF frequency.
	REAL(10) MU(NP)										   |		REAL*8 MU(NP)
	REAL(10) FLUX_WGHTS(NP)									   |		REAL*8 FLUX_WGHTS(NP)
	REAL(10) OBS_FREQ(N_OBS)								   |		REAL*8 OBS_FREQ(N_OBS)
	REAL(10) OBS_FLUX(N_OBS)								   |		REAL*8 OBS_FLUX(N_OBS)
	REAL(10) IPLUS_STORE(NST_CMF,NP)							   |		REAL*8 IPLUS_STORE(NST_CMF,NP)
	REAL(10) NU_STORE(NST_CMF)								   |		REAL*8 NU_STORE(NST_CMF)
	REAL(10), SAVE, ALLOCATABLE :: FREQ_CONV_FAC(:)						   |		REAL*8, SAVE, ALLOCATABLE :: FREQ_CONV_FAC(:)
	REAL(10), SAVE, ALLOCATABLE :: INTEN_CONV_FAC(:)					   |		REAL*8, SAVE, ALLOCATABLE :: INTEN_CONV_FAC(:)
	REAL(10), SAVE :: MIN_FREQ_CONV_FAC							   |		REAL*8, SAVE :: MIN_FREQ_CONV_FAC
	REAL(10) VINF			!							   |		REAL*8 VINF			!
	REAL(10) RMAX			!Radius at outer boundary.				   |		REAL*8 RMAX			!Radius at outer boundary.
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) FLUX_CONST									   |		REAL*8 FLUX_CONST
	REAL(10) SPEED_OF_LIGHT,PARSEC,FUN_PI							   |		REAL*8 SPEED_OF_LIGHT,PARSEC,FUN_PI
	REAL(10) NU_SM_CMF									   |		REAL*8 NU_SM_CMF
	REAL(10) FLUX,T1									   |		REAL*8 FLUX,T1
	REAL(10) CMF_FREQ		!Observer's frequency transformed to comoving		   |		REAL*8 CMF_FREQ		!Observer's frequency transformed to comoving
	REAL(10) HIM1,HI,HIP1									   |		REAL*8 HIM1,HI,HIP1
	REAL(10) SGN,SIM1,SI,SIP1								   |		REAL*8 SGN,SIM1,SI,SIP1
	REAL(10) DYI,DYIP1									   |		REAL*8 DYI,DYIP1
	REAL(10) A,B,C,D									   |		REAL*8 A,B,C,D
	REAL(10) ONE										   |		REAL*8 ONE
./subs/comp_var_jrec.f
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) EMHNUKT(ND)									   |		REAL*8 EMHNUKT(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) HDKT,TWOHCSQ									   |		REAL*8 HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/comp_var_jrec_v2.f
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) dJREC_CRdT(ND)									   |		REAL*8 dJREC_CRdT(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) EMHNUKT(ND)									   |		REAL*8 EMHNUKT(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) HDKT,TWOHCSQ									   |		REAL*8 HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	WRITE(187,'(10ES18.8)')NU,FQW,HDKT,TWOHCSQ,RJ(5),EMHNUKT(5)				   <
./subs/det_main_cont_freq.f
	REAL(10) NU(NCF)									   |		REAL*8 NU(NCF)
	REAL(10) NU_EVAL(NCF)									   |		REAL*8 NU_EVAL(NCF)
	REAL(10) NU_CONT(NCF_CONT)								   |		REAL*8 NU_CONT(NCF_CONT)
	REAL(10) DOPV		!Doppler spacing across lines					   |		REAL*8 DOPV		!Doppler spacing across lines
	REAL(10) DELV_CONT									   |		REAL*8 DELV_CONT
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) T1,T2,T3,T4,DOP_RAT,VRAT,C_KMS							   |		REAL*8 T1,T2,T3,T4,DOP_RAT,VRAT,C_KMS
./subs/dop_pro.f
C Altered 24-May-1996 : EXP removed								   |	C Altered 24-May-1996 : DEXP removed
	REAL(10) PF,FL,T,VTURB,AMASS,DOP_PRO							   |		REAL*8 PF,FL,T,VTURB,AMASS,DOP_PRO
	REAL(10) SCL,RDELD									   |		REAL*8 SCL,RDELD
./subs/do_sl_ls_split.f
./subs/dp_zero.f
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
./subs/dspheredchi.f
	REAL(10) W(ND,ND),DTAU(ND),Q(ND),R(ND)							   |		REAL*8 W(ND,ND),DTAU(ND),Q(ND),R(ND)
	REAL(10) ALPHA,BETA									   |		REAL*8 ALPHA,BETA
./subs/edd_j_var_v4.f
	REAL(10) VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND)							   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND)
	REAL(10) DTAU(ND),R(ND),SIGMA(ND)							   |		REAL*8 DTAU(ND),R(ND),SIGMA(ND)
	REAL(10) MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND),RSQ_DTAUONQ(ND)				   |		REAL*8 MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND),RSQ_DTAUONQ(ND)
	REAL(10) W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)						   |		REAL*8 W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)
	REAL(10) EPS_A(ND),EPS_B(ND)								   |		REAL*8 EPS_A(ND),EPS_B(ND)
	REAL(10) EPS_PREV_A(ND),EPS_PREV_B(ND)							   |		REAL*8 EPS_PREV_A(ND),EPS_PREV_B(ND)
	REAL(10) JNU(ND),JNUM1(ND),RSQ_HNUM1(ND)						   |		REAL*8 JNU(ND),JNUM1(ND),RSQ_HNUM1(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)						   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)						   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)
	REAL(10) dRHSdI(ND),dRHSdJ(ND)								   |		REAL*8 dRHSdI(ND),dRHSdJ(ND)
	REAL(10) ES_COH_VEC(ND)									   |		REAL*8 ES_COH_VEC(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K							   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K
	REAL(10) dXM_EPS_J,dXM_EPS_I,dXM_EPS_K							   |		REAL*8 dXM_EPS_J,dXM_EPS_I,dXM_EPS_K
./subs/edd_j_var_v5.f
	REAL(10) VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND),ES_COH_VEC(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND),ES_COH_VEC(ND)
	REAL(10) DTAU(ND),R(ND),SIGMA(ND)							   |		REAL*8 DTAU(ND),R(ND),SIGMA(ND)
	REAL(10) MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND),RSQ_DTAUONQ(ND)				   |		REAL*8 MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND),RSQ_DTAUONQ(ND)
	REAL(10) W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)						   |		REAL*8 W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)
	REAL(10) EPS_A(ND),EPS_B(ND)								   |		REAL*8 EPS_A(ND),EPS_B(ND)
	REAL(10) EPS_PREV_A(ND),EPS_PREV_B(ND)							   |		REAL*8 EPS_PREV_A(ND),EPS_PREV_B(ND)
	REAL(10) JNU(ND),JNUM1(ND),RSQ_HNUM1(ND)						   |		REAL*8 JNU(ND),JNUM1(ND),RSQ_HNUM1(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)						   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)						   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)
	REAL(10) dRHSdI(ND),dRHSdJ(ND)								   |		REAL*8 dRHSdI(ND),dRHSdJ(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
	REAL(10) dXM_EPS_J,dXM_EPS_I,dXM_EPS_K							   |		REAL*8 dXM_EPS_J,dXM_EPS_I,dXM_EPS_K
./subs/edd_j_var_v6.f
	REAL(10) VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND),ES_COH_VEC(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND),ES_COH_VEC(ND)
	REAL(10) DTAU(ND),R(ND),SIGMA(ND)							   |		REAL*8 DTAU(ND),R(ND),SIGMA(ND)
	REAL(10) MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND),RSQ_DTAUONQ(ND)				   |		REAL*8 MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND),RSQ_DTAUONQ(ND)
	REAL(10) W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)						   |		REAL*8 W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)
	REAL(10) EPS_A(ND),EPS_B(ND)								   |		REAL*8 EPS_A(ND),EPS_B(ND)
	REAL(10) EPS_PREV_A(ND),EPS_PREV_B(ND)							   |		REAL*8 EPS_PREV_A(ND),EPS_PREV_B(ND)
	REAL(10) JNU(ND),JNUM1(ND),RSQ_HNUM1(ND)						   |		REAL*8 JNU(ND),JNUM1(ND),RSQ_HNUM1(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) HBC										   |		REAL*8 HBC
	REAL(10) dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)						   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)						   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND),EPS_FAC(ND)
	REAL(10) dRHSdI(ND),dRHSdJ(ND)								   |		REAL*8 dRHSdI(ND),dRHSdJ(ND)
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2,T3
	REAL(10) dUdCHI										   |		REAL*8 dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI						   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K,dTBdCHI
	REAL(10) dXM_EPS_J,dXM_EPS_I,dXM_EPS_K							   |		REAL*8 dXM_EPS_J,dXM_EPS_I,dXM_EPS_K
./subs/eddline_var.f
	REAL(10) VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 VK(ND,ND,NM),RHS_dHdCHI(ND-1,ND)
	REAL(10) dTAUdCHI(ND,ND)								   |		REAL*8 dTAUdCHI(ND,ND)
	REAL(10) SOURCE(ND),TCHI(ND),DTAU(ND),R(ND),SIGMA(ND)					   |		REAL*8 SOURCE(ND),TCHI(ND),DTAU(ND),R(ND),SIGMA(ND)
	REAL(10) MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND)						   |		REAL*8 MIDF(ND),Q(ND),HU(ND),HL(ND),HS(ND)
	REAL(10) W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)						   |		REAL*8 W(ND),WPREV(ND),PSI(ND),PSIPREV(ND)
	REAL(10) AV(ND),AVM1(ND),CVM1(ND)							   |		REAL*8 AV(ND),AVM1(ND),CVM1(ND)
	REAL(10) DEPTHPRO(ND)									   |		REAL*8 DEPTHPRO(ND)
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)						   |		REAL*8 dHUdCHI(ND),dHLdCHI(ND),dHSdCHI(ND)
	REAL(10) dHUdTAU(ND),dHLdTAU(ND)							   |		REAL*8 dHUdTAU(ND),dHLdTAU(ND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) dRHSdI,dRHSdJ,dUdCHI								   |		REAL*8 dRHSdI,dRHSdJ,dUdCHI
	REAL(10) dTAdCHI_J,dTAdCHI_I								   |		REAL*8 dTAdCHI_J,dTAdCHI_I
	REAL(10) dTCdCHI_I,dTCdCHI_K								   |		REAL*8 dTCdCHI_I,dTCdCHI_K
	REAL(10) dTBdCHI_J,dTBdCHI_I,dTBdCHI_K							   |		REAL*8 dTBdCHI_J,dTBdCHI_I,dTBdCHI_K
./subs/elec_prep.f
	REAL(10) SPEC_DENS(ND,NSPEC_MAX)							   |		REAL*8 SPEC_DENS(ND,NSPEC_MAX)
	REAL(10) AT_NO_VEC(NSPEC_MAX*ND)							   |		REAL*8 AT_NO_VEC(NSPEC_MAX*ND)
	REAL(10) POPHYD(ND)									   |		REAL*8 POPHYD(ND)
	REAL(10) AT_NO_HYD									   |		REAL*8 AT_NO_HYD
./subs/equal.f
	REAL(10) X,Y,Z										   |		REAL*8 X,Y,Z
./subs/esopac.f
	REAL(10) RKI(ND),ED(ND)									   |		REAL*8 RKI(ND),ED(ND)
./subs/estau.f
	REAL(10) R(ND),ED(ND),DTAU(ND),OPT_DEP(ND)						   |		REAL*8 R(ND),ED(ND),DTAU(ND),OPT_DEP(ND)
./subs/estau_v2.f
	REAL(10) R(ND),ED(ND),CLUMP_FAC(ND),DTAU(ND),OPT_DEP(ND)				   |		REAL*8 R(ND),ED(ND),CLUMP_FAC(ND),DTAU(ND),OPT_DEP(ND)
	REAL(10) T1,TAU_BND									   |		REAL*8 T1,TAU_BND
./subs/eval_adiabatic.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND)								   |		REAL*8 BA(NT,NT,NUM_BNDS,ND)	
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) AD_CR_V(ND)									   |		REAL*8 AD_CR_V(ND)
	REAL(10) AD_CR_DT(ND)									   |		REAL*8 AD_CR_DT(ND)
	REAL(10) POPION(ND)									   |		REAL*8 POPION(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) VEL(ND)									   |		REAL*8 VEL(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) WORK(ND)									   |		REAL*8 WORK(ND)
	REAL(10) DIFFW(NT)		!d(dT/dR)/d?						   |		REAL*8 DIFFW(NT)		!d(dT/dR)/d?
	REAL(10) DTDR			!dT/dR (Program units)					   |		REAL*8 DTDR			!dT/dR (Program units)
	REAL(10) BOLTZMANN_CONSTANT,FUN_PI							   |		REAL*8 BOLTZMANN_CONSTANT,FUN_PI
	REAL(10) SCALE,T1,PI									   |		REAL*8 SCALE,T1,PI
./subs/eval_ed.f
	REAL(10) CHARGE(ND),dCHARGEdNE(ND),U(ND,NSPEC),PHI(ND,NSPEC)				   |		REAL*8 CHARGE(ND),dCHARGEdNE(ND),U(ND,NSPEC),PHI(ND,NSPEC)
	REAL(10) Z(NSPEC),ED(ND),POPOXY(ND)							   |		REAL*8 Z(NSPEC),ED(ND),POPOXY(ND)
	REAL(10) DION(ND),LOC_CH(ND),dDIONdNe(ND),dLOC_CH_dNe(ND)				   |		REAL*8 DION(ND),LOC_CH(ND),dDIONdNe(ND),dLOC_CH_dNe(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/evalse_qwvj_v5.f
	REAL(10) STEQ(2-NST:NT-NST+1,ND),STEQION(NION,ND)					   |		REAL*8 STEQ(2-NST:NT-NST+1,ND),STEQION(NION,ND)
	REAL(10) QFV_R(2-NST:NT-NST+1,ND),QFV_P(2-NST:NT-NST+1,ND)				   |		REAL*8 QFV_R(2-NST:NT-NST+1,ND),QFV_P(2-NST:NT-NST+1,ND)
	REAL(10) QFVION_R(NION,ND),QFVION_P(NION,ND)						   |		REAL*8 QFVION_R(NION,ND),QFVION_P(NION,ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND)							   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND)
	REAL(10) WSE(NLEV,ND)									   |		REAL*8 WSE(NLEV,ND)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) NETR										   |		REAL*8 NETR
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) SUM_SE,SUM_VJ_R,SUM_VJ_P							   |		REAL*8 SUM_SE,SUM_VJ_R,SUM_VJ_P
	REAL(10) B_RAT										   |		REAL*8 B_RAT
./subs/evalse_x_qwvj_v3.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) STEQION(NION,ND)								   |		REAL*8 STEQION(NION,ND)
	REAL(10) QFV_R(NT,ND)			!Recombination weight				   |		REAL*8 QFV_R(NT,ND)			!Recombination weight
	REAL(10) QFVION_R(NION,ND)								   |		REAL*8 QFVION_R(NION,ND)
	REAL(10) QFV_P(NT,ND)			!Photoiozation weight				   |		REAL*8 QFV_P(NT,ND)			!Photoiozation weight
	REAL(10) QFVION_P(NION,ND)								   |		REAL*8 QFVION_P(NION,ND)
C												   |	C
	REAL(10) HN_A(N_A,ND)		!    Pops. of ith ionzation stage			   |		REAL*8 HN_A(N_A,ND)		!    Pops. of ith ionzation stage
	REAL(10) HNST_A(N_A,ND)		!LTE   "    "  "      "       "				   |		REAL*8 HNST_A(N_A,ND)		!LTE   "    "  "      "       "
	REAL(10) HN_B(N_B,ND)		!    Pops. of (i+1)th ionization stage			   |		REAL*8 HN_B(N_B,ND)		!    Pops. of (i+1)th ionization stage
	REAL(10) HNST_B(N_B,ND)		!LTE   "   "    "       "        "			   |		REAL*8 HNST_B(N_B,ND)		!LTE   "   "    "       "        "
	REAL(10) WSE_X(N_A,ND)									   |		REAL*8 WSE_X(N_A,ND)
	REAL(10) JREC(ND)			! Int (2h/c2v^3+J)*EXP(-hv/kT)/v dv		   |		REAL*8 JREC(ND)			! Int (2h/c2v^3+J)*EXP(-hv/kT)/v dv
	REAL(10) JPHOT(ND)		! Int J/v dv						   |		REAL*8 JPHOT(ND)		! Int J/v dv
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) NETR										   |		REAL*8 NETR
	REAL(10) SUM_SE										   |		REAL*8 SUM_SE
	REAL(10) SUM_VJ_R,SUM_VJ_P								   |		REAL*8 SUM_VJ_R,SUM_VJ_P
	REAL(10) J_B_ION,B_ION									   |		REAL*8 J_B_ION,B_ION
./subs/ew_format.f
	REAL(10) LAMBDA,FLUX,EW									   |		REAL*8 LAMBDA,FLUX,EW
./subs/ew_format_v2.f
	REAL(10) LAMBDA,FLUX,EW									   |		REAL*8 LAMBDA,FLUX,EW
	REAL(10) T1										   |		REAL*8 T1
./subs/ew_format_v3.f
	REAL(10) LAMBDA,FLUX,EW,EMISS_EW							   |		REAL*8 LAMBDA,FLUX,EW,EMISS_EW
	REAL(10) T1										   |		REAL*8 T1
./subs/ex_e1x_fun.f
	REAL(10) X,EX_E1X_FUN									   |		REAL*8 X,EX_E1X_FUN
	REAL(10) W(6),A(4),B(4),NUM,DENOM							   |		REAL*8 W(6),A(4),B(4),NUM,DENOM
./subs/exponx.f
C ALtered 24-May-1996 :  DOUBLE PRECISION replaced by REAL(10)					   |	C ALtered 24-May-1996 :  DOUBLE PRECISION replaced by REAL*8
	REAL(10) EXPONX,X									   |		REAL*8 EXPONX,X
./subs/extend3opac.f
	REAL(10) CHIEXT(NX),ETAEXT(NX),ESECEXT(NX),COEF(0:3,NX)					   |		REAL*8 CHIEXT(NX),ETAEXT(NX),ESECEXT(NX),COEF(0:3,NX)
	REAL(10) CHI(ND),ETA(ND),ESEC(ND)							   |		REAL*8 CHI(ND),ETA(ND),ESEC(ND)
./subs/extend_opac.f
	REAL(10) CHIEXT(NX),ETAEXT(NX),ESECEXT(NX),RJEXT(NX),COEF(0:3,NX)			   |		REAL*8 CHIEXT(NX),ETAEXT(NX),ESECEXT(NX),RJEXT(NX),COEF(0:3,NX)
	REAL(10) CHI(ND),ETA(ND),ESEC(ND),RJ(ND)						   |		REAL*8 CHI(ND),ETA(ND),ESEC(ND),RJ(ND)
./subs/extend_vtsigma.f
	REAL(10) VEXT(NX),SIGMAEXT(NX),TEXT(NX),COEF(0:3,NX)					   |		REAL*8 VEXT(NX),SIGMAEXT(NX),TEXT(NX),COEF(0:3,NX)
	REAL(10) V(ND),SIGMA(ND),T(ND)								   |		REAL*8 V(ND),SIGMA(ND),T(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/fdg_f_to_s_ns_v1.f
./subs/fg_comp.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),JCONT(ND),CHIL(ND),ETAL(ND)				   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),JCONT(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)					   |		REAL*8 JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)
	REAL(10) JNU(ND,NLF+1),HNU(ND,NLF+1),KNU(ND,NLF+1),NNU(ND,NLF+1)			   |		REAL*8 JNU(ND,NLF+1),HNU(ND,NLF+1),KNU(ND,NLF+1),NNU(ND,NLF+1)
	REAL(10) IN_HBC(NLF+1),HBC(3,NLF+1),NBC(3,NLF+1)					   |		REAL*8 IN_HBC(NLF+1),HBC(3,NLF+1),NBC(3,NLF+1)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,FL,EW,CONT_INT								   |		REAL*8 DBB,IC,FL,EW,CONT_INT
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)
	REAL(10) TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)					   |		REAL*8 TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)
	REAL(10) GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)					   |		REAL*8 GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)
	REAL(10) JPREV(ND),AVCONT(ND),CVCONT(ND),dCHIdR(ND)					   |		REAL*8 JPREV(ND),AVCONT(ND),CVCONT(ND),dCHIdR(ND)
	REAL(10) OLDCHI,DBC,SCALE,HBLANK,IBOUND,IMIN,IMINOLD,IMIN_dSL				   |		REAL*8 OLDCHI,DBC,SCALE,HBLANK,IBOUND,IMIN,IMINOLD,IMIN_dSL
	REAL(10) T1,TOR,DNU,WERF_EXP								   |		REAL*8 T1,TOR,DNU,WERF_EXP
	      DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		      DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
	      DBC=DBB*DNU*SQRT(R(ND)*R(ND)-P(LS)*P(LS))						   |		      DBC=DBB*DNU*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))
./subs/fg_comp_tst.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),JCONT(ND),CHIL(ND),ETAL(ND)				   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),JCONT(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)					   |		REAL*8 JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)
	REAL(10) JNU(ND,NLF+1),HNU(ND,NLF+1),KNU(ND,NLF+1),NNU(ND,NLF+1)			   |		REAL*8 JNU(ND,NLF+1),HNU(ND,NLF+1),KNU(ND,NLF+1),NNU(ND,NLF+1)
	REAL(10) IN_HBC(NLF+1),HBC(3,NLF+1),NBC(3,NLF+1)					   |		REAL*8 IN_HBC(NLF+1),HBC(3,NLF+1),NBC(3,NLF+1)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,FL,EW,CONT_INT								   |		REAL*8 DBB,IC,FL,EW,CONT_INT
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)
	REAL(10) TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)					   |		REAL*8 TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)
	REAL(10) GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)					   |		REAL*8 GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)
	REAL(10) JPREV(ND),AVCONT(ND),CVCONT(ND),dCHIdR(ND)					   |		REAL*8 JPREV(ND),AVCONT(ND),CVCONT(ND),dCHIdR(ND)
	REAL(10) OLDCHI,DBC,SCALE,HBLANK,IBOUND,IMIN,IMINOLD,IMIN_dSL				   |		REAL*8 OLDCHI,DBC,SCALE,HBLANK,IBOUND,IMIN,IMINOLD,IMIN_dSL
	REAL(10) T1,S1,TOR,DNU,WERF_EXP								   |		REAL*8 T1,S1,TOR,DNU,WERF_EXP
	      DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		      DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
	      DBC=DBB*DNU*SQRT(R(ND)*R(ND)-P(LS)*P(LS))						   |		      DBC=DBB*DNU*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))
./subs/fg_j_cmf_v10.f
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: DTAU(:,:)							   |		REAL*8, ALLOCATABLE :: DTAU(:,:)
	REAL(10), ALLOCATABLE :: AV(:,:)							   |		REAL*8, ALLOCATABLE :: AV(:,:)
	REAL(10), ALLOCATABLE :: CV(:,:)							   |		REAL*8, ALLOCATABLE :: CV(:,:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_R_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_EXT(:)
	REAL(10), ALLOCATABLE :: Z_EXT(:)							   |		REAL*8, ALLOCATABLE :: Z_EXT(:)
	REAL(10), ALLOCATABLE :: V_EXT(:)							   |		REAL*8, ALLOCATABLE :: V_EXT(:)
	REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	REAL(10), ALLOCATABLE :: ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: ETA_EXT(:)
	REAL(10), ALLOCATABLE :: CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: CHI_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_ETA_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_ETA_EXT(:)
	REAL(10), ALLOCATABLE :: LOG_CHI_EXT(:)							   |		REAL*8, ALLOCATABLE :: LOG_CHI_EXT(:)
	REAL(10), ALLOCATABLE :: N_WGHTS(:)							   |		REAL*8, ALLOCATABLE :: N_WGHTS(:)
	REAL(10), ALLOCATABLE :: H_WGHTS(:)							   |		REAL*8, ALLOCATABLE :: H_WGHTS(:)
	REAL(10), ALLOCATABLE :: MU_VAL(:)							   |		REAL*8, ALLOCATABLE :: MU_VAL(:)
	REAL(10), ALLOCATABLE :: dCHIdR(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: QH(:)								   |		REAL*8, ALLOCATABLE :: QH(:)
	REAL(10), ALLOCATABLE :: V_RAY(:)							   |		REAL*8, ALLOCATABLE :: V_RAY(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SIGMA_RAY(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_RAY(:)
	REAL(10), ALLOCATABLE :: ETA_RAY(:)							   |		REAL*8, ALLOCATABLE :: ETA_RAY(:)
	REAL(10), ALLOCATABLE :: CHI_RAY(:)							   |		REAL*8, ALLOCATABLE :: CHI_RAY(:)
	REAL(10), ALLOCATABLE :: dCHIdR_RAY(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR_RAY(:)
	REAL(10), ALLOCATABLE :: SOURCE_RAY(:)							   |		REAL*8, ALLOCATABLE :: SOURCE_RAY(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: AV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: AV_STORE(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: CV_STORE(:,:)
	REAL(10), ALLOCATABLE :: PAR_AV(:,:)							   |		REAL*8, ALLOCATABLE :: PAR_AV(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: TA(:,:)							   |		REAL*8, ALLOCATABLE :: TA(:,:)
	REAL(10), ALLOCATABLE :: TB(:,:)							   |		REAL*8, ALLOCATABLE :: TB(:,:)
	REAL(10), ALLOCATABLE :: TC(:,:)							   |		REAL*8, ALLOCATABLE :: TC(:,:)
	REAL(10), ALLOCATABLE :: GB(:,:)							   |		REAL*8, ALLOCATABLE :: GB(:,:)
	REAL(10), ALLOCATABLE :: H(:,:)								   |		REAL*8, ALLOCATABLE :: H(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: U(:)								   |		REAL*8, ALLOCATABLE :: U(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: DIV(:)								   |		REAL*8, ALLOCATABLE :: DIV(:)
	REAL(10), ALLOCATABLE :: OLDCHI(:)							   |		REAL*8, ALLOCATABLE :: OLDCHI(:)
	REAL(10), ALLOCATABLE :: OLDCHI_STORE(:)						   |		REAL*8, ALLOCATABLE :: OLDCHI_STORE(:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_STORE(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_STORE(:,:)
	REAL(10), ALLOCATABLE :: dGAMdR(:,:)							   |		REAL*8, ALLOCATABLE :: dGAMdR(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: A0(:,:)							   |		REAL*8, ALLOCATABLE :: A0(:,:)
	REAL(10), ALLOCATABLE :: A1(:,:)							   |		REAL*8, ALLOCATABLE :: A1(:,:)
	REAL(10), ALLOCATABLE :: A2(:,:)							   |		REAL*8, ALLOCATABLE :: A2(:,:)
	REAL(10), ALLOCATABLE :: A3(:,:)							   |		REAL*8, ALLOCATABLE :: A3(:,:)
	REAL(10), ALLOCATABLE :: A4(:,:)							   |		REAL*8, ALLOCATABLE :: A4(:,:)
	REAL(10), ALLOCATABLE :: I_P(:,:)							   |		REAL*8, ALLOCATABLE :: I_P(:,:)
	REAL(10), ALLOCATABLE :: I_M(:,:)							   |		REAL*8, ALLOCATABLE :: I_M(:,:)
	REAL(10), ALLOCATABLE :: EE(:)								   |		REAL*8, ALLOCATABLE :: EE(:)
	REAL(10), ALLOCATABLE :: E0(:)								   |		REAL*8, ALLOCATABLE :: E0(:)
	REAL(10), ALLOCATABLE :: E1(:)								   |		REAL*8, ALLOCATABLE :: E1(:)
	REAL(10), ALLOCATABLE :: E2(:)								   |		REAL*8, ALLOCATABLE :: E2(:)
	REAL(10), ALLOCATABLE :: E3(:)								   |		REAL*8, ALLOCATABLE :: E3(:)
!												   |	!
	REAL(10), ALLOCATABLE :: SOURCE_PRIME(:)						   |		REAL*8, ALLOCATABLE :: SOURCE_PRIME(:)
	REAL(10), ALLOCATABLE :: S(:)								   |		REAL*8, ALLOCATABLE :: S(:)
	REAL(10), ALLOCATABLE :: dS(:)								   |		REAL*8, ALLOCATABLE :: dS(:)
	REAL(10) PREVIOUS_FREQ									   |		REAL*8 PREVIOUS_FREQ
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10) HN_VAL										   |		REAL*8 HN_VAL
	REAL(10) HN_VAL_PREV									   |		REAL*8 HN_VAL_PREV
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)					   |		REAL*8 JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)
	REAL(10) JNU(ND),HNU(ND),KNU(ND),NNU(ND),RSQN_ON_RSQJ(ND)				   |		REAL*8 JNU(ND),HNU(ND),KNU(ND),NNU(ND),RSQN_ON_RSQJ(ND)
	REAL(10) IN_HBC,HBC,NBC									   |		REAL*8 IN_HBC,HBC,NBC
	REAL(10) IPLUS_P(NP)									   |		REAL*8 IPLUS_P(NP)
	REAL(10) VDOP_VEC(ND)									   |		REAL*8 VDOP_VEC(ND)
	REAL(10) VDOP_FRAC									   |		REAL*8 VDOP_FRAC
	REAL(10) DBB,IC,FREQ,dLOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) CV_BOUND(NP)		!Outer boundary V					   |		REAL*8 CV_BOUND(NP)		!Outer boundary V
	REAL(10) I_M_IN_BND(NP)		!Inner boundary						   |		REAL*8 I_M_IN_BND(NP)		!Inner boundary
	REAL(10) IBOUND(NP)		!Incident intensity on outer boundary.			   |		REAL*8 IBOUND(NP)		!Incident intensity on outer boundary.
	REAL(10) FG_ERR_ON_FREQ									   |		REAL*8 FG_ERR_ON_FREQ
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) DELTA_Z									   |		REAL*8 DELTA_Z
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX,DEL_R_FAC									   |		REAL*8 RMAX,DEL_R_FAC
	REAL(10) MU,dZ,PSQ									   |		REAL*8 MU,dZ,PSQ
	REAL(10) DEL_R										   |		REAL*8 DEL_R
./subs/fg_j_cmf_v7.f
	REAL(10), ALLOCATABLE :: OLDCHI(:)							   |		REAL*8, ALLOCATABLE :: OLDCHI(:)
	REAL(10), ALLOCATABLE :: OLDCHI_STORE(:)						   |		REAL*8, ALLOCATABLE :: OLDCHI_STORE(:)
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: AV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: AV_STORE(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: CV_STORE(:,:)
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
C												   |	C
	REAL(10), ALLOCATABLE :: R_INS(:,:)							   |		REAL*8, ALLOCATABLE :: R_INS(:,:)
	REAL(10), ALLOCATABLE :: V_INS(:,:)							   |		REAL*8, ALLOCATABLE :: V_INS(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_INS(:,:)							   |		REAL*8, ALLOCATABLE :: SIGMA_INS(:,:)
	REAL(10), ALLOCATABLE :: CHI_INS(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_INS(:,:)
	REAL(10), ALLOCATABLE :: dCHIdR_INS(:,:)						   |		REAL*8, ALLOCATABLE :: dCHIdR_INS(:,:)
	REAL(10), ALLOCATABLE :: SOURCE_INS(:,:)						   |		REAL*8, ALLOCATABLE :: SOURCE_INS(:,:)
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: V_EXT(:)							   |		REAL*8, ALLOCATABLE :: V_EXT(:)
	REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	REAL(10), ALLOCATABLE :: N_WGHTS(:)							   |		REAL*8, ALLOCATABLE :: N_WGHTS(:)
	REAL(10), ALLOCATABLE :: H_WGHTS(:)							   |		REAL*8, ALLOCATABLE :: H_WGHTS(:)
	REAL(10), ALLOCATABLE :: MU_VAL(:)							   |		REAL*8, ALLOCATABLE :: MU_VAL(:)
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)					   |		REAL*8 JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)
	REAL(10) JNU(ND),HNU(ND),KNU(ND),NNU(ND),RSQN_ON_RSQJ(ND)				   |		REAL*8 JNU(ND),HNU(ND),KNU(ND),NNU(ND),RSQN_ON_RSQJ(ND)
	REAL(10) IN_HBC,HBC,NBC									   |		REAL*8 IN_HBC,HBC,NBC
	REAL(10) IPLUS_P(NP)									   |		REAL*8 IPLUS_P(NP)
	REAL(10) DBB,IC,FL,dLOG_NU								   |		REAL*8 DBB,IC,FL,dLOG_NU
	REAL(10) TA(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 TA(ND+ND_ADD_MAX+6,NP)
	REAL(10) TB(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 TB(ND+ND_ADD_MAX+6,NP)
	REAL(10) TC(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 TC(ND+ND_ADD_MAX+6,NP)
	REAL(10) AV(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 AV(ND+ND_ADD_MAX+6,NP)
	REAL(10) CV(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 CV(ND+ND_ADD_MAX+6,NP)
	REAL(10) GB(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 GB(ND+ND_ADD_MAX+6,NP)
	REAL(10) H(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 H(ND+ND_ADD_MAX+6,NP)
C												   |	C
	REAL(10) DTAU(ND+ND_ADD_MAX+6)								   |		REAL*8 DTAU(ND+ND_ADD_MAX+6)
	REAL(10) XM(ND+ND_ADD_MAX+6)								   |		REAL*8 XM(ND+ND_ADD_MAX+6)
	REAL(10) SOURCE(ND+ND_ADD_MAX+6)							   |		REAL*8 SOURCE(ND+ND_ADD_MAX+6)
	REAL(10) U(ND+ND_ADD_MAX+6)								   |		REAL*8 U(ND+ND_ADD_MAX+6)
	REAL(10) VB(ND+ND_ADD_MAX+6)								   |		REAL*8 VB(ND+ND_ADD_MAX+6)
	REAL(10) VC(ND+ND_ADD_MAX+6)								   |		REAL*8 VC(ND+ND_ADD_MAX+6)
	REAL(10) Q(ND+ND_ADD_MAX+6)								   |		REAL*8 Q(ND+ND_ADD_MAX+6)
	REAL(10) QH(ND+ND_ADD_MAX+6)								   |		REAL*8 QH(ND+ND_ADD_MAX+6)
	REAL(10) dCHIdR(ND+ND_ADD_MAX+6)							   |		REAL*8 dCHIdR(ND+ND_ADD_MAX+6)
C												   |	C
	REAL(10) ETA_EXT(ND+ND_ADD_MAX+6)							   |		REAL*8 ETA_EXT(ND+ND_ADD_MAX+6)
	REAL(10) CHI_EXT(ND+ND_ADD_MAX+6)							   |		REAL*8 CHI_EXT(ND+ND_ADD_MAX+6)
C												   |	C
	REAL(10) V_RAY(ND+ND_ADD_MAX+6)								   |		REAL*8 V_RAY(ND+ND_ADD_MAX+6)
	REAL(10) SIGMA_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 SIGMA_RAY(ND+ND_ADD_MAX+6)
	REAL(10) SOURCE_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 SOURCE_RAY(ND+ND_ADD_MAX+6)
	REAL(10) CHI_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 CHI_RAY(ND+ND_ADD_MAX+6)
	REAL(10) dCHIdR_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 dCHIdR_RAY(ND+ND_ADD_MAX+6)
	REAL(10) DIV(ND+ND_ADD_MAX+6)								   |		REAL*8 DIV(ND+ND_ADD_MAX+6)
	REAL(10) DTAU_BND(NP)									   |		REAL*8 DTAU_BND(NP)
	REAL(10) FG_ERR_ON_FREQ									   |		REAL*8 FG_ERR_ON_FREQ
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) IBOUND			!Incident intensity on outer boundary.			   |		REAL*8 IBOUND			!Incident intensity on outer boundary.
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX,DEL_R_FAC									   |		REAL*8 RMAX,DEL_R_FAC
	REAL(10) CV_BOUND									   |		REAL*8 CV_BOUND
	REAL(10) MU,dZ,PSQ									   |		REAL*8 MU,dZ,PSQ
	REAL(10) DEL_R										   |		REAL*8 DEL_R
./subs/fg_j_cmf_v9.f
	REAL(10), ALLOCATABLE :: R_RAY(:,:)							   |		REAL*8, ALLOCATABLE :: R_RAY(:,:)
	REAL(10), ALLOCATABLE :: Z(:,:)								   |		REAL*8, ALLOCATABLE :: Z(:,:)
	REAL(10), ALLOCATABLE :: GAM(:,:)							   |		REAL*8, ALLOCATABLE :: GAM(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:,:)							   |		REAL*8, ALLOCATABLE :: DTAU(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: R_INS(:,:)							   |		REAL*8, ALLOCATABLE :: R_INS(:,:)
	REAL(10), ALLOCATABLE :: V_INS(:,:)							   |		REAL*8, ALLOCATABLE :: V_INS(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_INS(:,:)							   |		REAL*8, ALLOCATABLE :: SIGMA_INS(:,:)
	REAL(10), ALLOCATABLE :: CHI_INS(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_INS(:,:)
	REAL(10), ALLOCATABLE :: dCHIdR_INS(:,:)						   |		REAL*8, ALLOCATABLE :: dCHIdR_INS(:,:)
	REAL(10), ALLOCATABLE :: ETA_INS(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_INS(:,:)
	REAL(10), ALLOCATABLE :: dCHIdR(:)							   |		REAL*8, ALLOCATABLE :: dCHIdR(:)
	REAL(10), ALLOCATABLE :: R_EXT(:)							   |		REAL*8, ALLOCATABLE :: R_EXT(:)
	REAL(10), ALLOCATABLE :: V_EXT(:)							   |		REAL*8, ALLOCATABLE :: V_EXT(:)
	REAL(10), ALLOCATABLE :: SIGMA_EXT(:)							   |		REAL*8, ALLOCATABLE :: SIGMA_EXT(:)
	REAL(10), ALLOCATABLE :: N_WGHTS(:)							   |		REAL*8, ALLOCATABLE :: N_WGHTS(:)
	REAL(10), ALLOCATABLE :: H_WGHTS(:)							   |		REAL*8, ALLOCATABLE :: H_WGHTS(:)
	REAL(10), ALLOCATABLE :: MU_VAL(:)							   |		REAL*8, ALLOCATABLE :: MU_VAL(:)
	REAL(10) PREVIOUS_FREQ									   |		REAL*8 PREVIOUS_FREQ
	REAL(10), ALLOCATABLE :: AV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: AV_PREV(:,:)
	REAL(10), ALLOCATABLE :: AV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: AV_STORE(:,:)
	REAL(10), ALLOCATABLE :: CV_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: CV_PREV(:,:)
	REAL(10), ALLOCATABLE :: CV_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: CV_STORE(:,:)
	REAL(10), ALLOCATABLE :: PAR_AV(:,:)							   |		REAL*8, ALLOCATABLE :: PAR_AV(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: GAMH(:,:)							   |		REAL*8, ALLOCATABLE :: GAMH(:,:)
	REAL(10), ALLOCATABLE :: TA(:,:)							   |		REAL*8, ALLOCATABLE :: TA(:,:)
	REAL(10), ALLOCATABLE :: TB(:,:)							   |		REAL*8, ALLOCATABLE :: TB(:,:)
	REAL(10), ALLOCATABLE :: TC(:,:)							   |		REAL*8, ALLOCATABLE :: TC(:,:)
	REAL(10), ALLOCATABLE :: GB(:,:)							   |		REAL*8, ALLOCATABLE :: GB(:,:)
	REAL(10), ALLOCATABLE :: H(:,:)								   |		REAL*8, ALLOCATABLE :: H(:,:)
	REAL(10), ALLOCATABLE :: OLDCHI(:)							   |		REAL*8, ALLOCATABLE :: OLDCHI(:)
	REAL(10), ALLOCATABLE :: OLDCHI_STORE(:)						   |		REAL*8, ALLOCATABLE :: OLDCHI_STORE(:)
	REAL(10), ALLOCATABLE :: I_P_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_P_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_P_STORE(:,:)
	REAL(10), ALLOCATABLE :: I_M_PREV(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_PREV(:,:)
	REAL(10), ALLOCATABLE :: I_M_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: I_M_STORE(:,:)
	REAL(10), ALLOCATABLE :: dGAMdR(:,:)							   |		REAL*8, ALLOCATABLE :: dGAMdR(:,:)
!												   |	!
	REAL(10), ALLOCATABLE :: A0(:,:)							   |		REAL*8, ALLOCATABLE :: A0(:,:)
	REAL(10), ALLOCATABLE :: A1(:,:)							   |		REAL*8, ALLOCATABLE :: A1(:,:)
	REAL(10), ALLOCATABLE :: A2(:,:)							   |		REAL*8, ALLOCATABLE :: A2(:,:)
	REAL(10), ALLOCATABLE :: A3(:,:)							   |		REAL*8, ALLOCATABLE :: A3(:,:)
	REAL(10), ALLOCATABLE :: A4(:,:)							   |		REAL*8, ALLOCATABLE :: A4(:,:)
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)					   |		REAL*8 JQW(ND,NP),HQW(ND,NP),KQW(ND,NP),NQW(ND,NP)
	REAL(10) JNU(ND),HNU(ND),KNU(ND),NNU(ND),RSQN_ON_RSQJ(ND)				   |		REAL*8 JNU(ND),HNU(ND),KNU(ND),NNU(ND),RSQN_ON_RSQJ(ND)
	REAL(10) IN_HBC,HBC,NBC									   |		REAL*8 IN_HBC,HBC,NBC
	REAL(10) IPLUS_P(NP)									   |		REAL*8 IPLUS_P(NP)
	REAL(10) DBB,IC,FREQ,dLOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) I_P(ND+ND_ADD_MAX+6,NP)							   |		REAL*8 I_P(ND+ND_ADD_MAX+6,NP)
	REAL(10) I_M(ND+ND_ADD_MAX+6,NP)							   |		REAL*8 I_M(ND+ND_ADD_MAX+6,NP)
	REAL(10) AV(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 AV(ND+ND_ADD_MAX+6,NP)
	REAL(10) CV(ND+ND_ADD_MAX+6,NP)								   |		REAL*8 CV(ND+ND_ADD_MAX+6,NP)
	REAL(10) EE(ND+ND_ADD_MAX+6)								   |		REAL*8 EE(ND+ND_ADD_MAX+6)
	REAL(10) E0(ND+ND_ADD_MAX+6)								   |		REAL*8 E0(ND+ND_ADD_MAX+6)
	REAL(10) E1(ND+ND_ADD_MAX+6)								   |		REAL*8 E1(ND+ND_ADD_MAX+6)
	REAL(10) E2(ND+ND_ADD_MAX+6)								   |		REAL*8 E2(ND+ND_ADD_MAX+6)
	REAL(10) E3(ND+ND_ADD_MAX+6)								   |		REAL*8 E3(ND+ND_ADD_MAX+6)
!												   |	!
	REAL(10) SOURCE_PRIME(ND+ND_ADD_MAX+6)							   |		REAL*8 SOURCE_PRIME(ND+ND_ADD_MAX+6)
	REAL(10) S(ND+ND_ADD_MAX+6)								   |		REAL*8 S(ND+ND_ADD_MAX+6)
	REAL(10) dS(ND+ND_ADD_MAX+6)								   |		REAL*8 dS(ND+ND_ADD_MAX+6)
!												   |	!
	REAL(10) XM(ND+ND_ADD_MAX+6)								   |		REAL*8 XM(ND+ND_ADD_MAX+6)
	REAL(10) U(ND+ND_ADD_MAX+6)								   |		REAL*8 U(ND+ND_ADD_MAX+6)
	REAL(10) VB(ND+ND_ADD_MAX+6)								   |		REAL*8 VB(ND+ND_ADD_MAX+6)
	REAL(10) VC(ND+ND_ADD_MAX+6)								   |		REAL*8 VC(ND+ND_ADD_MAX+6)
	REAL(10) Q(ND+ND_ADD_MAX+6)								   |		REAL*8 Q(ND+ND_ADD_MAX+6)
	REAL(10) QH(ND+ND_ADD_MAX+6)								   |		REAL*8 QH(ND+ND_ADD_MAX+6)
!												   |	!
	REAL(10) ETA_EXT(ND+ND_ADD_MAX+6)							   |		REAL*8 ETA_EXT(ND+ND_ADD_MAX+6)
	REAL(10) CHI_EXT(ND+ND_ADD_MAX+6)							   |		REAL*8 CHI_EXT(ND+ND_ADD_MAX+6)
!												   |	!
	REAL(10) V_RAY(ND+ND_ADD_MAX+6)								   |		REAL*8 V_RAY(ND+ND_ADD_MAX+6)
	REAL(10) SIGMA_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 SIGMA_RAY(ND+ND_ADD_MAX+6)
	REAL(10) ETA_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 ETA_RAY(ND+ND_ADD_MAX+6)
	REAL(10) CHI_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 CHI_RAY(ND+ND_ADD_MAX+6)
	REAL(10) dCHIdR_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 dCHIdR_RAY(ND+ND_ADD_MAX+6)
	REAL(10) SOURCE_RAY(ND+ND_ADD_MAX+6)							   |		REAL*8 SOURCE_RAY(ND+ND_ADD_MAX+6)
!												   |	!
	REAL(10) DIV(ND+ND_ADD_MAX+6)								   |		REAL*8 DIV(ND+ND_ADD_MAX+6)
!												   |	!
	REAL(10) IBOUND(NP)		!Incident intensity on outer boundary.			   |		REAL*8 IBOUND(NP)		!Incident intensity on outer boundary.
	REAL(10) CV_BOUND(NP)		!Outer boundary V					   |		REAL*8 CV_BOUND(NP)		!Outer boundary V
	REAL(10) I_M_IN_BND(NP)		!Inner boundary						   |		REAL*8 I_M_IN_BND(NP)		!Inner boundary
	REAL(10) FG_ERR_ON_FREQ									   |		REAL*8 FG_ERR_ON_FREQ
	REAL(10), PARAMETER :: ONE=1								   |		REAL*8, PARAMETER :: ONE=1
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) I_CORE										   |		REAL*8 I_CORE
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) ESEC_POW									   |		REAL*8 ESEC_POW
	REAL(10) BETA										   |		REAL*8 BETA
	REAL(10) VINF										   |		REAL*8 VINF
	REAL(10) RMAX,DEL_R_FAC									   |		REAL*8 RMAX,DEL_R_FAC
	REAL(10) MU,dZ,PSQ									   |		REAL*8 MU,dZ,PSQ
	REAL(10) DEL_R										   |		REAL*8 DEL_R
./subs/fix_dchi.f
	REAL(10) F2DA(NDEXT,ND,2)								   |		REAL*8 F2DA(NDEXT,ND,2)
	REAL(10) RHS_dHdCHI(NDEXT-1,ND)								   |		REAL*8 RHS_dHdCHI(NDEXT-1,ND)
	REAL(10) CHI(ND),ETA(ND)								   |		REAL*8 CHI(ND),ETA(ND)
	REAL(10) F2DAEXT(NDEXT,NDEXT,2)								   |		REAL*8 F2DAEXT(NDEXT,NDEXT,2)
	REAL(10) RHS_dHdCHIEXT(NDEXT-1,NDEXT)							   |		REAL*8 RHS_dHdCHIEXT(NDEXT-1,NDEXT)
	REAL(10) CHIEXT(NDEXT),ETAEXT(NDEXT)							   |		REAL*8 CHIEXT(NDEXT),ETAEXT(NDEXT)
	REAL(10) COEF(0:3,NDEXT)								   |		REAL*8 COEF(0:3,NDEXT)
	REAL(10) T1										   |		REAL*8 T1
./subs/fixpop.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)						   |		REAL*8 BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)
	REAL(10) POP(NSPEC,ND),POPVEC(ND)							   |		REAL*8 POP(NSPEC,ND),POPVEC(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/formsol.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) JBAR(ND),ZNET(ND)								   |		REAL*8 JBAR(ND),ZNET(ND)
	REAL(10) JCONT(ND),JBLANK(ND),HBLANK(ND),JINT(ND)					   |		REAL*8 JCONT(ND),JBLANK(ND),HBLANK(ND),JINT(ND)
	REAL(10) LAMLINE(ND),dZdCHIL(ND),dZdETAL(ND)						   |		REAL*8 LAMLINE(ND),dZdCHIL(ND),dZdETAL(ND)
	REAL(10) JQW(ND,NP),HQW(ND,NP)								   |		REAL*8 JQW(ND,NP),HQW(ND,NP)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,AMASS,FL,EW,CONT_INT							   |		REAL*8 DBB,IC,AMASS,FL,EW,CONT_INT
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)
	REAL(10) TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)					   |		REAL*8 TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)
	REAL(10) GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)					   |		REAL*8 GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)
	REAL(10) JEX_SCAT(ND),BAR_WTS(ND),DEPTH_PRO(ND)						   |		REAL*8 JEX_SCAT(ND),BAR_WTS(ND),DEPTH_PRO(ND)
	REAL(10) HCONT(ND),JINT_PREV(ND),HINT(ND)						   |		REAL*8 HCONT(ND),JINT_PREV(ND),HINT(ND)
	REAL(10) AVCONT(ND),CVCONT(ND),dCHIdR(ND)						   |		REAL*8 AVCONT(ND),CVCONT(ND),dCHIdR(ND)
	REAL(10) AVM1(ND),CVM1(ND),dJBARdKI(ND),DIAG(ND)					   |		REAL*8 AVM1(ND),CVM1(ND),dJBARdKI(ND),DIAG(ND)
	REAL(10) VSRCE(ND),dUdS(ND),dVdS_UP(ND),dVdS_LOW(ND),dJINTdS(ND)			   |		REAL*8 VSRCE(ND),dUdS(ND),dVdS_UP(ND),dVdS_LOW(ND),dJINTdS(ND)
	REAL(10) VKI(ND),RKB(ND),dUdKI(ND),dVdKI_UP(ND),dVdKI_LOW(ND)				   |		REAL*8 VKI(ND),RKB(ND),dUdKI(ND),dVdKI_UP(ND),dVdKI_LOW(ND)
	REAL(10) OLDCHI,T1,T2,DBC,DNU,TOR,IBOUND,WERF_EXP,SCALE					   |		REAL*8 OLDCHI,T1,T2,DBC,DNU,TOR,IBOUND,WERF_EXP,SCALE
	      DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		      DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
	      DBC=DBB*DNU*SQRT(R(ND)*R(ND)-P(LS)*P(LS))						   |		      DBC=DBB*DNU*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))
./subs/fqcomp_ibc.f
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)
	REAL(10) NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)					   |		REAL*8 NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)
	REAL(10) SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)				   |		REAL*8 SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)
	REAL(10) DBB,DBC,IBOUND,TOR,HBC_J,HBC_S,INBCNEW,IC,E1,E2,E3				   |		REAL*8 DBB,DBC,IBOUND,TOR,HBC_J,HBC_S,INBCNEW,IC,E1,E2,E3
	    DBC=DBB*SQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )/R(ND)/CHI(ND)				   |		    DBC=DBB*DSQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )/R(ND)/CHI(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
./subs/fqcomp_ibc_v2.f
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND)
	REAL(10) NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)					   |		REAL*8 NEWRJ(ND),NEWRK(ND),DTAU(ND),dCHIdR(ND)
	REAL(10) SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)				   |		REAL*8 SOURCE(ND),CHI(ND),AQW(ND,NP),AQW3(ND,NP),P(NP)
	REAL(10) DBB,DBC,IBOUND,TOR,HBC_J,HBC_S,INBCNEW,IC,E1,E2,E3				   |		REAL*8 DBB,DBC,IBOUND,TOR,HBC_J,HBC_S,INBCNEW,IC,E1,E2,E3
	    DBC=DBB*SQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )/R(ND)/CHI(ND)				   |		    DBC=DBB*DSQRT( (R(ND)-P(LS))*(R(ND)+P(LS)) )/R(ND)/CHI(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
./subs/fqnew.f
	REAL(10) FQAF(ND,ND,NM),F2DA(ND,ND),FC(ND,ND)						   |		REAL*8 FQAF(ND,ND,NM),F2DA(ND,ND),FC(ND,ND)
	REAL(10) W(ND,ND),ESEC(ND)								   |		REAL*8 W(ND,ND),ESEC(ND)
./subs/full_to_sup.f
	REAL(10) DC2_S(ND)		!Ion density (Super levels)				   |		REAL*8 DC2_S(ND)		!Ion density (Super levels)
	REAL(10) DC2_F(ND)		!Ion density (Full model atom)				   |		REAL*8 DC2_F(ND)		!Ion density (Full model atom)
	REAL(10) C2_F(NC2_F,ND)									   |		REAL*8 C2_F(NC2_F,ND)
	REAL(10) C2_S(NC2_S,ND)									   |		REAL*8 C2_S(NC2_S,ND)
	REAL(10) CIII_S(NCIII_S,ND)								   |		REAL*8 CIII_S(NCIII_S,ND)
./subs/gamma.f
	REAL(10) GAM(NI),GAMH(NI)								   |		REAL*8 GAM(NI),GAMH(NI)
	REAL(10) SIGMA(ND),Z(NI),R(ND),V(ND)							   |		REAL*8 SIGMA(ND),Z(NI),R(ND),V(ND)
	REAL(10) MU										   |		REAL*8 MU
./subs/gausel.f
	REAL(10) A(N,N),B(N,NR),C(N)								   |		REAL*8 A(N,N),B(N,NR),C(N)
	REAL(10), PARAMETER :: TOL=1.0D-30							   |		REAL*8, PARAMETER :: TOL=1.0D-30
	REAL(10) BIG,RBIG,T1									   |		REAL*8 BIG,RBIG,T1
./subs/gbf.f
C                       A now declared REAL(10)							   |	C                       A now declared REAL*8
	REAL(10) GBF,RNU,ZHE									   |		REAL*8 GBF,RNU,ZHE
	REAL(10) A(0:6,10),T1									   |		REAL*8 A(0:6,10),T1
./subs/genaccel.f
	REAL(10) POPS(NT*ND),MAXINC,MAXDEC							   |		REAL*8 POPS(NT*ND),MAXINC,MAXDEC
	REAL(10) RDPOPS(ND*NT,4),TEMP(4,NT),NEWEST(NT)						   |		REAL*8 RDPOPS(ND*NT,4),TEMP(4,NT),NEWEST(NT)
	REAL(10) T1,LOCINC,LOCDEC								   |		REAL*8 T1,LOCINC,LOCDEC
./subs/genangqw.f
	REAL(10) QW(ND,NP),R(ND),TA(NP),TB(NP),TC(NP),P(NP)					   |		REAL*8 QW(ND,NP),R(ND),TA(NP),TB(NP),TC(NP),P(NP)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/genangqw_v2.f
	REAL(10) QW(ND,NP),R(ND),P(NP)								   |		REAL*8 QW(ND,NP),R(ND),P(NP)
	REAL(10) PSQ(NP),MU(NP),dMU(NP),WEIGHT(NP)						   |		REAL*8 PSQ(NP),MU(NP),dMU(NP),WEIGHT(NP)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/gen_omega_rd_v2.f
	REAL(10) STAT_WT(NLEV)									   |		REAL*8 STAT_WT(NLEV)
	REAL(10) OMEGA_SCALE,OMEGA_SET								   |		REAL*8 OMEGA_SCALE,OMEGA_SET
	REAL(10) T_TABLE(MAX_TVALS)								   |		REAL*8 T_TABLE(MAX_TVALS)
	REAL(10) OMEGA_TABLE(MAX_TAB_SIZE)							   |		REAL*8 OMEGA_TABLE(MAX_TAB_SIZE)
	REAL(10) COL_VEC(MAX_TVALS)								   |		REAL*8 COL_VEC(MAX_TVALS)
	REAL(10) GL_SUM,GU_SUM,NORM_FAC								   |		REAL*8 GL_SUM,GU_SUM,NORM_FAC
./subs/genopaeta_v6.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) ETA(ND)			!Emissivity					   |		REAL*8 ETA(ND)			!Emissivity
	REAL(10) HN(N,ND),HNST(N,ND)								   |		REAL*8 HN(N,ND),HNST(N,ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) T(ND)			!Temperature (K)					   |		REAL*8 T(ND)			!Temperature (K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) ZION			!Charge on resultiong ion.				   |		REAL*8 ZION			!Charge on resultiong ion.
	REAL(10) GFF_VAL(ND)		!g(ff) as a function of depth				   |		REAL*8 GFF_VAL(ND)		!g(ff) as a function of depth
	REAL(10) COR_FAC(ND)		!Factor to convert HNST for ION_LEV			   |		REAL*8 COR_FAC(ND)		!Factor to convert HNST for ION_LEV
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N)		!Photionization cross-section
	REAL(10) TMP_CHI(N)		!Photionization cross-section				   |		REAL*8 TMP_CHI(N)		!Photionization cross-section
	REAL(10) TMP_ETA(N)		!Photionization cross-section				   |		REAL*8 TMP_ETA(N)		!Photionization cross-section
	REAL(10) ALPHA,TCHI1,TETA1,TETA2							   |		REAL*8 ALPHA,TCHI1,TETA1,TETA2
	REAL(10) T1,T2,ZION_CUBED,NEFF								   |		REAL*8 T1,T2,ZION_CUBED,NEFF
./subs/genosc_v5.f
	REAL(10) EINA(N,N),FEDGE(N),STAT_WT(N)							   |		REAL*8 EINA(N,N),FEDGE(N),STAT_WT(N)
	REAL(10) IONIZATION_EN,ZION								   |		REAL*8 IONIZATION_EN,ZION
	REAL(10) GF_CUT										   |		REAL*8 GF_CUT
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,RD_FREE_VAL							   |		REAL*8 SPEED_OF_LIGHT,RD_FREE_VAL
	REAL(10) T1,SPEED_LIGHT									   |		REAL*8 T1,SPEED_LIGHT
./subs/genosc_v6.f
	REAL(10) EINA(N,N),FEDGE(N),STAT_WT(N)							   |		REAL*8 EINA(N,N),FEDGE(N),STAT_WT(N)
	REAL(10) IONIZATION_EN,ZION								   |		REAL*8 IONIZATION_EN,ZION
	REAL(10) GF_CUT										   |		REAL*8 GF_CUT
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,RD_FREE_VAL							   |		REAL*8 SPEED_OF_LIGHT,RD_FREE_VAL
	REAL(10) T1,SPEED_LIGHT									   |		REAL*8 T1,SPEED_LIGHT
	REAL(10) DOWN(N)									   |		REAL*8 DOWN(N)
./subs/get_col_ref.f
./subs/getelec_v2.f
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) SPEC_DENS(ND,N_SPEC)								   |		REAL*8 SPEC_DENS(ND,N_SPEC)
	REAL(10) AT_NO(N_SPEC)									   |		REAL*8 AT_NO(N_SPEC)
	REAL(10), ALLOCATABLE :: OLD_ED(:)		!NGAM					   |		REAL*8, ALLOCATABLE :: OLD_ED(:)		!NGAM
	REAL(10), ALLOCATABLE :: OLD_GAM(:,:)		!NGAM,N_SPEC				   |		REAL*8, ALLOCATABLE :: OLD_GAM(:,:)		!NGAM,N_SPEC
	REAL(10), ALLOCATABLE :: NEW_GAM(:)		!ND					   |		REAL*8, ALLOCATABLE :: NEW_GAM(:)		!ND
	REAL(10), ALLOCATABLE :: NEW_ED(:)		!ND					   |		REAL*8, ALLOCATABLE :: NEW_ED(:)		!ND
	REAL(10) CHANGE,T1,T2									   |		REAL*8 CHANGE,T1,T2
	REAL(10) LOC_AT_NO									   |		REAL*8 LOC_AT_NO
./subs/gff.f
C Altered 21-Jun-1998 : E0_DP's inserted.							   |	C Altered 21-Jun-1998 : D0's inserted.
	REAL(10) RNU,T,ZION,GFF									   |		REAL*8 RNU,T,ZION,GFF
	REAL(10) U,GB,DU,DGB									   |		REAL*8 U,GB,DU,DGB
	INTEGER, PARAMETER :: DP=SELECTED_REAL_KIND(15,3000)					   |		REAL*8, SAVE :: A(12,11)
	REAL(10), SAVE :: A(12,11)								   <
	1/ 5.53E0_DP,4.91E0_DP,4.29E0_DP,3.64E0_DP,3.00E0_DP,2.41E0_DP,1.87E0_DP,1.33E0_DP,0.90E   |		1/ 5.53D0,4.91D0,4.29D0,3.64D0,3.00D0,2.41D0,1.87D0,1.33D0,0.90D0,0.55D0,0.33D0,0.19D0
	1, 5.49E0_DP,4.87E0_DP,4.25E0_DP,3.61E0_DP,2.98E0_DP,2.41E0_DP,1.89E0_DP,1.39E0_DP,0.95E   |		1, 5.49D0,4.87D0,4.25D0,3.61D0,2.98D0,2.41D0,1.89D0,1.39D0,0.95D0,0.59D0,0.36D0,0.21D0
	1, 5.46E0_DP,4.84E0_DP,4.22E0_DP,3.59E0_DP,2.97E0_DP,2.41E0_DP,1.91E0_DP,1.44E0_DP,1.00E   |		1, 5.46D0,4.84D0,4.22D0,3.59D0,2.97D0,2.41D0,1.91D0,1.44D0,1.00D0,0.63D0,0.39D0,0.24D0
	1, 5.43E0_DP,4.80E0_DP,4.18E0_DP,3.56E0_DP,2.95E0_DP,2.41E0_DP,1.93E0_DP,1.49E0_DP,1.08E   |		1, 5.43D0,4.80D0,4.18D0,3.56D0,2.95D0,2.41D0,1.93D0,1.49D0,1.08D0,0.72D0,0.46D0,0.28D0
	1, 5.40E0_DP,4.77E0_DP,4.15E0_DP,3.54E0_DP,2.94E0_DP,2.41E0_DP,1.95E0_DP,1.55E0_DP,1.17E   |		1, 5.40D0,4.77D0,4.15D0,3.54D0,2.94D0,2.41D0,1.95D0,1.55D0,1.17D0,0.86D0,0.59D0,0.38D0
	1, 5.25E0_DP,4.63E0_DP,4.02E0_DP,3.41E0_DP,2.81E0_DP,2.32E0_DP,1.90E0_DP,1.56E0_DP,1.30E   |		1, 5.25D0,4.63D0,4.02D0,3.41D0,2.81D0,2.32D0,1.90D0,1.56D0,1.30D0,1.01D0,0.76D0,0.53D0
	1, 5.00E0_DP,4.40E0_DP,3.80E0_DP,3.22E0_DP,2.65E0_DP,2.19E0_DP,1.80E0_DP,1.51E0_DP,1.32E   |		1, 5.00D0,4.40D0,3.80D0,3.22D0,2.65D0,2.19D0,1.80D0,1.51D0,1.32D0,1.14D0,0.97D0,0.76D0
	1, 4.69E0_DP,4.13E0_DP,3.57E0_DP,2.97E0_DP,2.44E0_DP,2.02E0_DP,1.68E0_DP,1.42E0_DP,1.30E   |		1, 4.69D0,4.13D0,3.57D0,2.97D0,2.44D0,2.02D0,1.68D0,1.42D0,1.30D0,1.18D0,1.09D0,0.96D0
	1, 4.48E0_DP,3.87E0_DP,3.27E0_DP,2.70E0_DP,2.21E0_DP,1.84E0_DP,1.52E0_DP,1.33E0_DP,1.20E   |		1, 4.48D0,3.87D0,3.27D0,2.70D0,2.21D0,1.84D0,1.52D0,1.33D0,1.20D0,1.15D0,1.13D0,1.08D0
	1, 4.16E0_DP,3.52E0_DP,2.98E0_DP,2.45E0_DP,2.01E0_DP,1.67E0_DP,1.41E0_DP,1.25E0_DP,1.15E   |		1, 4.16D0,3.52D0,2.98D0,2.45D0,2.01D0,1.67D0,1.41D0,1.25D0,1.15D0,1.11D0,1.10D0,1.09D0
	1, 3.85E0_DP,3.27E0_DP,2.70E0_DP,2.20E0_DP,1.81E0_DP,1.50E0_DP,1.30E0_DP,1.17E0_DP,1.11E   |		1, 3.85D0,3.27D0,2.70D0,2.20D0,1.81D0,1.50D0,1.30D0,1.17D0,1.11D0,1.08D0,1.08D0,1.09D0/
C												   |	C
	U=4.7994E0_DP; U=LOG10(U*RNU/T)								   |		U=LOG10(4.7994D0*RNU/T)
	U=MAX(-3.99999999E0_DP,U)								   |		U=MAX(-3.99999999D0,U)
	U=MIN(1.499999E0_DP,U)									   |		U=MIN(1.499999D0,U)
	GB=15.789E0_DP; GB=LOG10(GB*ZION*ZION/T)						   |		GB=LOG10(15.789D0*ZION*ZION/T)
	GB=MAX(-2.99999999E0_DP,GB)								   |		GB=MAX(-2.99999999D0,GB)
	GB=MIN(1.999999E0_DP,GB)								   |		GB=MIN(1.999999D0,GB)
	IU=INT(U*2+9.0E0_DP)									   |		IU=INT(U*2+9.0D0)
	IGB=INT(GB*2+7.0E0_DP)									   |		IGB=INT(GB*2+7.0D0)
	DU=2*U+9.0E0_DP-IU									   |		DU=2*U+9.0D0-IU
	DGB=2*GB+7.0E0_DP-IGB									   |		DGB=2*GB+7.0D0-IGB
	GFF=((1.0E0_DP-DU)*A(IU,IGB)+DU*A(IU+1,IGB))*(1.0E0_DP-DGB)				   |		GFF=((1.0D0-DU)*A(IU,IGB)+DU*A(IU+1,IGB))*(1.0D0-DGB)
	1 +((1.0E0_DP-DU)*A(IU,IGB+1)+DU*A(IU+1,IGB+1))*DGB					   |		1 +((1.0D0-DU)*A(IU,IGB+1)+DU*A(IU+1,IGB+1))*DGB
	REAL(10) ZION  		!Ion charge							   |		REAL*8 ZION  		!Ion charge
	REAL(10) RNU		!Frequency in units of 10^15 Hz					   |		REAL*8 RNU		!Frequency in units of 10^15 Hz
	REAL(10) T(ND)		!T in units 10^4 K						   |		REAL*8 T(ND)		!T in units 10^4 K
	REAL(10) GFF_VAL(ND)	!Returned free-free Gaunt factors.				   |		REAL*8 GFF_VAL(ND)	!Returned free-free Gaunt factors.
	INTEGER, PARAMETER :: DP=SELECTED_REAL_KIND(15,3000)					   |		REAL*8, SAVE :: A(12,11)
	REAL(10), SAVE :: A(12,11)								   <
	1/ 5.53E0_DP,4.91E0_DP,4.29E0_DP,3.64E0_DP,3.00E0_DP,2.41E0_DP,1.87E0_DP,1.33E0_DP,0.90E   |		1/ 5.53D0,4.91D0,4.29D0,3.64D0,3.00D0,2.41D0,1.87D0,1.33D0,0.90D0,0.55D0,0.33D0,0.19D0
	1, 5.49E0_DP,4.87E0_DP,4.25E0_DP,3.61E0_DP,2.98E0_DP,2.41E0_DP,1.89E0_DP,1.39E0_DP,0.95E   |		1, 5.49D0,4.87D0,4.25D0,3.61D0,2.98D0,2.41D0,1.89D0,1.39D0,0.95D0,0.59D0,0.36D0,0.21D0
	1, 5.46E0_DP,4.84E0_DP,4.22E0_DP,3.59E0_DP,2.97E0_DP,2.41E0_DP,1.91E0_DP,1.44E0_DP,1.00E   |		1, 5.46D0,4.84D0,4.22D0,3.59D0,2.97D0,2.41D0,1.91D0,1.44D0,1.00D0,0.63D0,0.39D0,0.24D0
	1, 5.43E0_DP,4.80E0_DP,4.18E0_DP,3.56E0_DP,2.95E0_DP,2.41E0_DP,1.93E0_DP,1.49E0_DP,1.08E   |		1, 5.43D0,4.80D0,4.18D0,3.56D0,2.95D0,2.41D0,1.93D0,1.49D0,1.08D0,0.72D0,0.46D0,0.28D0
	1, 5.40E0_DP,4.77E0_DP,4.15E0_DP,3.54E0_DP,2.94E0_DP,2.41E0_DP,1.95E0_DP,1.55E0_DP,1.17E   |		1, 5.40D0,4.77D0,4.15D0,3.54D0,2.94D0,2.41D0,1.95D0,1.55D0,1.17D0,0.86D0,0.59D0,0.38D0
	1, 5.25E0_DP,4.63E0_DP,4.02E0_DP,3.41E0_DP,2.81E0_DP,2.32E0_DP,1.90E0_DP,1.56E0_DP,1.30E   |		1, 5.25D0,4.63D0,4.02D0,3.41D0,2.81D0,2.32D0,1.90D0,1.56D0,1.30D0,1.01D0,0.76D0,0.53D0
	1, 5.00E0_DP,4.40E0_DP,3.80E0_DP,3.22E0_DP,2.65E0_DP,2.19E0_DP,1.80E0_DP,1.51E0_DP,1.32E   |		1, 5.00D0,4.40D0,3.80D0,3.22D0,2.65D0,2.19D0,1.80D0,1.51D0,1.32D0,1.14D0,0.97D0,0.76D0
	1, 4.69E0_DP,4.13E0_DP,3.57E0_DP,2.97E0_DP,2.44E0_DP,2.02E0_DP,1.68E0_DP,1.42E0_DP,1.30E   |		1, 4.69D0,4.13D0,3.57D0,2.97D0,2.44D0,2.02D0,1.68D0,1.42D0,1.30D0,1.18D0,1.09D0,0.96D0
	1, 4.48E0_DP,3.87E0_DP,3.27E0_DP,2.70E0_DP,2.21E0_DP,1.84E0_DP,1.52E0_DP,1.33E0_DP,1.20E   |		1, 4.48D0,3.87D0,3.27D0,2.70D0,2.21D0,1.84D0,1.52D0,1.33D0,1.20D0,1.15D0,1.13D0,1.08D0
	1, 4.16E0_DP,3.52E0_DP,2.98E0_DP,2.45E0_DP,2.01E0_DP,1.67E0_DP,1.41E0_DP,1.25E0_DP,1.15E   |		1, 4.16D0,3.52D0,2.98D0,2.45D0,2.01D0,1.67D0,1.41D0,1.25D0,1.15D0,1.11D0,1.10D0,1.09D0
	1, 3.85E0_DP,3.27E0_DP,2.70E0_DP,2.20E0_DP,1.81E0_DP,1.50E0_DP,1.30E0_DP,1.17E0_DP,1.11E   |		1, 3.85D0,3.27D0,2.70D0,2.20D0,1.81D0,1.50D0,1.30D0,1.17D0,1.11D0,1.08D0,1.08D0,1.09D0/
	REAL(10) U,GB,DU,DGB,A1,A2,LOGT								   |		REAL*8 U,GB,DU,DGB,A1,A2,LOGT
	A1=4.7994E0_DP; A1=LOG10(A1*RNU)							   |		A1=LOG10(4.7994D0*RNU)
	A2=15.789E0_DP; A2=LOG10(A2*ZION*ZION)							   |		A2=LOG10(15.789D0*ZION*ZION)
	  U=MAX(-3.99999999E0_DP,U)								   |		  U=MAX(-3.99999999D0,U)
	  U=MIN(1.499999E0_DP,U)								   |		  U=MIN(1.499999D0,U)
	  GB=MAX(-2.99999999E0_DP,GB)								   |		  GB=MAX(-2.99999999D0,GB)
	  GB=MIN(1.999999E0_DP,GB)								   |		  GB=MIN(1.999999D0,GB)
	 											   |	C
C												   |		  IU=INT(U*2+9.0D0)
	  IU=INT(U*2+9.0E0_DP)									   |		  IGB=INT(GB*2+7.0D0)
	  IGB=INT(GB*2+7.0E0_DP)								   |		  DU=2*U+9.0D0-IU
	  DU=2*U+9.0E0_DP-IU									   |		  DGB=2*GB+7.0D0-IGB
	  DGB=2*GB+7.0E0_DP-IGB									   |		  GFF_VAL(I)=((1.0D0-DU)*A(IU,IGB)+DU*A(IU+1,IGB))*(1.0D0-DGB)
	  GFF_VAL(I)=((1.0E0_DP-DU)*A(IU,IGB)+DU*A(IU+1,IGB))*(1.0E0_DP-DGB)			   |		1               +((1.0D0-DU)*A(IU,IGB+1)+DU*A(IU+1,IGB+1))*DGB
	1               +((1.0E0_DP-DU)*A(IU,IGB+1)+DU*A(IU+1,IGB+1))*DGB			   <
./subs/gnthydl.f
	REAL(10) SIGMA(0:N-1),KSQ								   |		REAL*8 SIGMA(0:N-1),KSQ
	REAL(10) G(0:N-1,0:N+1)									   |		REAL*8 G(0:N-1,0:N+1)
	REAL(10) GAMRAT										   |		REAL*8 GAMRAT
	REAL(10) G0,NKSQ,MULT,K,ROOT3								   |		REAL*8 G0,NKSQ,MULT,K,ROOT3
	REAL(10), PARAMETER :: PI=3.1415926535897932384D0					   |		REAL*8, PARAMETER :: PI=3.1415926535897932384D0
	REAL(10), PARAMETER :: RHALF=0.5D0							   |		REAL*8, PARAMETER :: RHALF=0.5D0
	REAL(10), PARAMETER :: RONE=1.0D0							   |		REAL*8, PARAMETER :: RONE=1.0D0
	REAL(10), PARAMETER :: RTWO=2.0D0							   |		REAL*8, PARAMETER :: RTWO=2.0D0
	REAL(10), PARAMETER :: RTHREE=3.0D0							   |		REAL*8, PARAMETER :: RTHREE=3.0D0
	REAL(10), PARAMETER :: RFOUR=4.0D0							   |		REAL*8, PARAMETER :: RFOUR=4.0D0
./subs/htrpwgt.f
	REAL(10) X(N),W(N),T1,T2,SUM								   |		REAL*8 X(N),W(N),T1,T2,SUM
	LOGICAL, SAVE :: CHECK									   |		LOGICAL, SAVE :: CHECK = .FALSE.
./subs/htrpwgt_v2.f
	REAL(10) X(N),dX(N),W(N)								   |		REAL*8 X(N),dX(N),W(N)
	REAL(10) T1,T2,SUM,XSUM									   |		REAL*8 T1,T2,SUM,XSUM
./subs/hweight.f
	REAL(10) X(N),W(N),H,HN,RF,RE,SUM							   |		REAL*8 X(N),W(N),H,HN,RF,RE,SUM
./subs/hweight_v2.f
	REAL(10) X(N)        !MU								   |		REAL*8 X(N)        !MU
	REAL(10) dX(N)       !dMU								   |		REAL*8 dX(N)       !dMU
	REAL(10) W(N)        !Quadrature weight							   |		REAL*8 W(N)        !Quadrature weight
	REAL(10) H,HN,RF,RE,SUM									   |		REAL*8 H,HN,RF,RE,SUM
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/hydanggaunt.f
	REAL(10) HYD										   |		REAL*8 HYD
	REAL(10) TMP_HYD(0:24,1:18)								   |		REAL*8 TMP_HYD(0:24,1:18)
./subs/hydcrossl.f
	REAL(10) HYDCROSSL									   |		REAL*8 HYDCROSSL
	REAL(10) NU,NUION,Z,NEF									   |		REAL*8 NU,NUION,Z,NEF
	REAL(10) G(0:NMAX,0:NMAX),SIGMA(0:NMAX)							   |		REAL*8 G(0:NMAX,0:NMAX),SIGMA(0:NMAX)
	REAL(10) NSAV,USAV,GSUM,U								   |		REAL*8 NSAV,USAV,GSUM,U
./subs/hydro_terms.f
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) LUM_STAR(ND)                        						   |		REAL*8 LUM_STAR(ND)                        
	REAL(10) FLUX_MEAN_OPAC(ND)								   |		REAL*8 FLUX_MEAN_OPAC(ND)
	REAL(10) ELEC_MEAN_OPAC(ND)								   |		REAL*8 ELEC_MEAN_OPAC(ND)
	REAL(10) STARS_MASS									   |		REAL*8 STARS_MASS
	REAL(10) MEAN_ATOMIC_WEIGHT								   |		REAL*8 MEAN_ATOMIC_WEIGHT
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) GRAVITATIONAL_CONSTANT								   |		REAL*8 GRAVITATIONAL_CONSTANT
	REAL(10) MASS_SUN									   |		REAL*8 MASS_SUN
	REAL(10) LUM_SUN									   |		REAL*8 LUM_SUN
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) VdVdR										   |		REAL*8 VdVdR
	REAL(10) dPdR_ON_ROH									   |		REAL*8 dPdR_ON_ROH
	REAL(10) g_TOT										   |		REAL*8 g_TOT
	REAL(10) g_ELEC										   |		REAL*8 g_ELEC
	REAL(10) g_GRAV										   |		REAL*8 g_GRAV
	REAL(10) g_RAD										   |		REAL*8 g_RAD
	REAL(10) ERROR										   |		REAL*8 ERROR
C												   |	C
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) dP_CON										   |		REAL*8 dP_CON
	REAL(10) RAD_CON									   |		REAL*8 RAD_CON
./subs/hydro_terms_v2.f
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) LUM_STAR(ND)                        						   |		REAL*8 LUM_STAR(ND)                        
	REAL(10) FLUX_MEAN_OPAC(ND)								   |		REAL*8 FLUX_MEAN_OPAC(ND)
	REAL(10) ELEC_MEAN_OPAC(ND)								   |		REAL*8 ELEC_MEAN_OPAC(ND)
	REAL(10) LAM_FLUXMEAN_BAND_END(ND)							   |		REAL*8 LAM_FLUXMEAN_BAND_END(ND)
	REAL(10) BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)						   |		REAL*8 BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)
	REAL(10) BAND_FLUX(ND,N_FLUXMEAN_BANDS)							   |		REAL*8 BAND_FLUX(ND,N_FLUXMEAN_BANDS)
	REAL(10) STARS_MASS									   |		REAL*8 STARS_MASS
	REAL(10) MEAN_ATOMIC_WEIGHT								   |		REAL*8 MEAN_ATOMIC_WEIGHT
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) GRAVITATIONAL_CONSTANT								   |		REAL*8 GRAVITATIONAL_CONSTANT
	REAL(10) MASS_SUN									   |		REAL*8 MASS_SUN
	REAL(10) LUM_SUN									   |		REAL*8 LUM_SUN
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) MOD_PRESSURE(ND)								   |		REAL*8 MOD_PRESSURE(ND)
	REAL(10) COEF(ND,4)									   |		REAL*8 COEF(ND,4)
	REAL(10) VdVdR										   |		REAL*8 VdVdR
	REAL(10) dPdR_ON_ROH									   |		REAL*8 dPdR_ON_ROH
	REAL(10) g_TOT										   |		REAL*8 g_TOT
	REAL(10) g_ELEC										   |		REAL*8 g_ELEC
	REAL(10) g_GRAV										   |		REAL*8 g_GRAV
	REAL(10) g_RAD										   |		REAL*8 g_RAD
	REAL(10) ERROR										   |		REAL*8 ERROR
	REAL(10) RLUMST(ND)									   |		REAL*8 RLUMST(ND)
!												   |	!
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) dP_CON										   |		REAL*8 dP_CON
	REAL(10) RAD_CON									   |		REAL*8 RAD_CON
	REAL(10) T1										   |		REAL*8 T1
./subs/hydro_terms_v3.f
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) LUM_STAR(ND)                        						   |		REAL*8 LUM_STAR(ND)                        
	REAL(10) FLUX_MEAN_OPAC(ND)								   |		REAL*8 FLUX_MEAN_OPAC(ND)
	REAL(10) ELEC_MEAN_OPAC(ND)								   |		REAL*8 ELEC_MEAN_OPAC(ND)
	REAL(10) LAM_FLUXMEAN_BAND_END(ND)							   |		REAL*8 LAM_FLUXMEAN_BAND_END(ND)
	REAL(10) BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)						   |		REAL*8 BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)
	REAL(10) BAND_FLUX(ND,N_FLUXMEAN_BANDS)							   |		REAL*8 BAND_FLUX(ND,N_FLUXMEAN_BANDS)
!												   |	!
	REAL(10) STARS_MASS									   |		REAL*8 STARS_MASS
	REAL(10) MEAN_ATOMIC_WEIGHT								   |		REAL*8 MEAN_ATOMIC_WEIGHT
	REAL(10) PRESSURE_VTURB									   |		REAL*8 PRESSURE_VTURB
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) GRAVITATIONAL_CONSTANT								   |		REAL*8 GRAVITATIONAL_CONSTANT
	REAL(10) MASS_SUN									   |		REAL*8 MASS_SUN
	REAL(10) LUM_SUN									   |		REAL*8 LUM_SUN
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) MOD_PRESSURE(ND)								   |		REAL*8 MOD_PRESSURE(ND)
	REAL(10) COEF(ND,4)									   |		REAL*8 COEF(ND,4)
	REAL(10) VdVdR										   |		REAL*8 VdVdR
	REAL(10) dPdR_ON_ROH									   |		REAL*8 dPdR_ON_ROH
	REAL(10) g_TOT										   |		REAL*8 g_TOT
	REAL(10) g_ELEC										   |		REAL*8 g_ELEC
	REAL(10) g_GRAV										   |		REAL*8 g_GRAV
	REAL(10) g_RAD										   |		REAL*8 g_RAD
	REAL(10) ERROR										   |		REAL*8 ERROR
	REAL(10) RLUMST(ND)									   |		REAL*8 RLUMST(ND)
!												   |	!
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) dP_CON										   |		REAL*8 dP_CON
	REAL(10) RAD_CON									   |		REAL*8 RAD_CON
	REAL(10) T1										   |		REAL*8 T1
./subs/hydro_terms_v4.f
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) LUM_STAR(ND)                        						   |		REAL*8 LUM_STAR(ND)                        
	REAL(10) FLUX_MEAN_OPAC(ND)								   |		REAL*8 FLUX_MEAN_OPAC(ND)
	REAL(10) ELEC_MEAN_OPAC(ND)								   |		REAL*8 ELEC_MEAN_OPAC(ND)
	REAL(10) LAM_FLUXMEAN_BAND_END(ND)							   |		REAL*8 LAM_FLUXMEAN_BAND_END(ND)
	REAL(10) BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)						   |		REAL*8 BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)
	REAL(10) BAND_FLUX(ND,N_FLUXMEAN_BANDS)							   |		REAL*8 BAND_FLUX(ND,N_FLUXMEAN_BANDS)
!												   |	!
	REAL(10) STARS_MASS									   |		REAL*8 STARS_MASS
	REAL(10) MEAN_ATOMIC_WEIGHT								   |		REAL*8 MEAN_ATOMIC_WEIGHT
	REAL(10) PRESSURE_VTURB									   |		REAL*8 PRESSURE_VTURB
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) GRAVITATIONAL_CONSTANT								   |		REAL*8 GRAVITATIONAL_CONSTANT
	REAL(10) MASS_SUN									   |		REAL*8 MASS_SUN
	REAL(10) LUM_SUN									   |		REAL*8 LUM_SUN
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) MOD_PRESSURE(ND)								   |		REAL*8 MOD_PRESSURE(ND)
	REAL(10) COEF(ND,4)									   |		REAL*8 COEF(ND,4)
	REAL(10) VdVdR										   |		REAL*8 VdVdR
	REAL(10) dPdR_ON_ROH									   |		REAL*8 dPdR_ON_ROH
	REAL(10) g_TOT										   |		REAL*8 g_TOT
	REAL(10) g_ELEC										   |		REAL*8 g_ELEC
	REAL(10) g_GRAV										   |		REAL*8 g_GRAV
	REAL(10) g_RAD										   |		REAL*8 g_RAD
	REAL(10) ERROR										   |		REAL*8 ERROR
	REAL(10) RLUMST(ND)									   |		REAL*8 RLUMST(ND)
!												   |	!
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) dP_CON										   |		REAL*8 dP_CON
	REAL(10) RAD_CON									   |		REAL*8 RAD_CON
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ERROR_MAX									   |		REAL*8 ERROR_MAX
	REAL(10) ERROR_SUM									   |		REAL*8 ERROR_SUM
	REAL(10) ERROR_SQ									   |		REAL*8 ERROR_SQ
./subs/hydro_terms_v5.f
	REAL(10) POP_ATOM(ND)									   |		REAL*8 POP_ATOM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) LUM_STAR(ND)                        						   |		REAL*8 LUM_STAR(ND)                        
!												   |	!
	REAL(10) FLUX_MEAN_OPAC(ND)								   |		REAL*8 FLUX_MEAN_OPAC(ND)
	REAL(10) ROSS_MEAN_OPAC(ND)								   |		REAL*8 ROSS_MEAN_OPAC(ND)
	REAL(10) ELEC_MEAN_OPAC(ND)								   |		REAL*8 ELEC_MEAN_OPAC(ND)
	REAL(10) LAM_FLUXMEAN_BAND_END(ND)							   |		REAL*8 LAM_FLUXMEAN_BAND_END(ND)
	REAL(10) BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)						   |		REAL*8 BAND_FLUXMEAN(ND,N_FLUXMEAN_BANDS)
	REAL(10) BAND_FLUX(ND,N_FLUXMEAN_BANDS)							   |		REAL*8 BAND_FLUX(ND,N_FLUXMEAN_BANDS)
!												   |	!
	REAL(10) LOGG										   |		REAL*8 LOGG
	REAL(10) STARS_MASS									   |		REAL*8 STARS_MASS
	REAL(10) MEAN_ATOMIC_WEIGHT								   |		REAL*8 MEAN_ATOMIC_WEIGHT
	REAL(10) PRESSURE_VTURB									   |		REAL*8 PRESSURE_VTURB
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	REAL(10) GRAVITATIONAL_CONSTANT								   |		REAL*8 GRAVITATIONAL_CONSTANT
	REAL(10) MASS_SUN									   |		REAL*8 MASS_SUN
	REAL(10) LUM_SUN									   |		REAL*8 LUM_SUN
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	REAL(10) MOD_PRESSURE(ND)								   |		REAL*8 MOD_PRESSURE(ND)
	REAL(10) COEF(ND,4)									   |		REAL*8 COEF(ND,4)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) OPAC(ND)									   |		REAL*8 OPAC(ND)
	REAL(10) TB(ND)										   |		REAL*8 TB(ND)
	REAL(10) TC(ND)										   |		REAL*8 TC(ND)
	REAL(10) VdVdR										   |		REAL*8 VdVdR
	REAL(10) dPdR_ON_ROH									   |		REAL*8 dPdR_ON_ROH
	REAL(10) dPTURBdR_ON_ROH								   |		REAL*8 dPTURBdR_ON_ROH
	REAL(10) g_TOT										   |		REAL*8 g_TOT
	REAL(10) g_ELEC										   |		REAL*8 g_ELEC
	REAL(10) g_GRAV										   |		REAL*8 g_GRAV
	REAL(10) g_RAD										   |		REAL*8 g_RAD
	REAL(10) ERROR,REV_ERROR								   |		REAL*8 ERROR,REV_ERROR
	REAL(10) RLUMST(ND)									   |		REAL*8 RLUMST(ND)
!												   |	!
	REAL(10) GRAV_CON									   |		REAL*8 GRAV_CON
	REAL(10) dP_CON										   |		REAL*8 dP_CON
	REAL(10) PTURB_CON									   |		REAL*8 PTURB_CON
	REAL(10) RAD_CON									   |		REAL*8 RAD_CON
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) SOUND_SPEED									   |		REAL*8 SOUND_SPEED
	REAL(10) RPHOT										   |		REAL*8 RPHOT
	REAL(10) GAM_ES_PHOT									   |		REAL*8 GAM_ES_PHOT
	REAL(10) GPHOT										   |		REAL*8 GPHOT
	REAL(10) ERROR_MAX									   |		REAL*8 ERROR_MAX
	REAL(10) ERROR_SUM									   |		REAL*8 ERROR_SUM
	REAL(10) ERROR_SQ									   |		REAL*8 ERROR_SQ
	REAL(10) PHOT_LOGG									   |		REAL*8 PHOT_LOGG
./subs/hyper.f
	REAL(10) RAT										   |		REAL*8 RAT
	REAL(10) HYPE,RAT,Z									   |		REAL*8 HYPE,RAT,Z
	REAL(10) GAMRAT										   |		REAL*8 GAMRAT
	REAL(10) FAC										   |		REAL*8 FAC
	REAL(10) RADSQ,GAMRAT,FAC,HYPE								   |		REAL*8 RADSQ,GAMRAT,FAC,HYPE
	REAL(10) T1,T2,Z,MAX,MIN								   |		REAL*8 T1,T2,Z,MAX,MIN
./subs/ichrlen.f
./subs/impar.f
	REAL(10) P(NP),R(ND),RP,DELMU								   |		REAL*8 P(NP),R(ND),RP,DELMU
	REAL(10), PARAMETER :: RONE=1.0D0							   |		REAL*8, PARAMETER :: RONE=1.0D0
./subs/impar_with_pnt_srce.f
	REAL(10) P(NP),R(ND)									   |		REAL*8 P(NP),R(ND)
	REAL(10) RP,R_PNT_SRCE									   |		REAL*8 RP,R_PNT_SRCE
	REAL(10) DELMU,dP,T1									   |		REAL*8 DELMU,dP,T1
	REAL(10), PARAMETER :: RONE=1.0D0							   |		REAL*8, PARAMETER :: RONE=1.0D0
./subs/indexx.f
	REAL(10) ARRIN(N)									   |		REAL*8 ARRIN(N)
	REAL(10) Q										   |		REAL*8 Q
	REAL(10) ARRIN(N),WORK(N)								   |		REAL*8 ARRIN(N),WORK(N)
./subs/init_temp.f
	REAL(10) LUM										   |		REAL*8 LUM
	REAL(10) R(ND),ED(ND),T(ND),TAU(ND)							   |		REAL*8 R(ND),ED(ND),T(ND),TAU(ND)
	REAL(10), ALLOCATABLE :: ROLD(:)							   |		REAL*8, ALLOCATABLE :: ROLD(:)
	REAL(10), ALLOCATABLE :: EDOLD(:)							   |		REAL*8, ALLOCATABLE :: EDOLD(:)
	REAL(10), ALLOCATABLE :: TOLD(:)							   |		REAL*8, ALLOCATABLE :: TOLD(:)
	REAL(10), ALLOCATABLE :: TAUOLD(:)							   |		REAL*8, ALLOCATABLE :: TAUOLD(:)
	REAL(10), ALLOCATABLE :: NEWED(:)							   |		REAL*8, ALLOCATABLE :: NEWED(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC_OLD(:)						   |		REAL*8, ALLOCATABLE :: CLUMP_FAC_OLD(:)
	REAL(10) LUMOLD,LDL,MLDL								   |		REAL*8 LUMOLD,LDL,MLDL
	REAL(10) T1,DI,ION_FRAC,VEL								   |		REAL*8 T1,DI,ION_FRAC,VEL
./subs/init_temp_v2.f
	REAL(10) LUM               !Luminosity of star in Lsun					   |		REAL*8 LUM               !Luminosity of star in Lsun
        REAL(10) R(ND)             !Radius Units 10^10 cm)					   |	        REAL*8 R(ND)             !Radius Units 10^10 cm)
        REAL(10) ED(ND)            !Electron density						   |	        REAL*8 ED(ND)            !Electron density
        REAL(10) CLUMP_FAC(ND)     !Volume filling factor					   |	        REAL*8 CLUMP_FAC(ND)     !Volume filling factor
        REAL(10) T(ND)             !Temperature in units od 10^4 K				   |	        REAL*8 T(ND)             !Temperature in units od 10^4 K
        REAL(10) TAU_SWITCH									   |	        REAL*8 TAU_SWITCH
	REAL(10), ALLOCATABLE :: NEWED(:)							   |		REAL*8, ALLOCATABLE :: NEWED(:)
	REAL(10), ALLOCATABLE :: TAU(:)								   |		REAL*8, ALLOCATABLE :: TAU(:)
        REAL(10), ALLOCATABLE :: ROLD(:)							   |	        REAL*8, ALLOCATABLE :: ROLD(:)
	REAL(10), ALLOCATABLE :: EDOLD(:)							   |		REAL*8, ALLOCATABLE :: EDOLD(:)
	REAL(10), ALLOCATABLE :: TOLD(:)							   |		REAL*8, ALLOCATABLE :: TOLD(:)
	REAL(10), ALLOCATABLE :: TAUOLD(:)							   |		REAL*8, ALLOCATABLE :: TAUOLD(:)
	REAL(10), ALLOCATABLE :: CLUMP_FAC_OLD(:)						   |		REAL*8, ALLOCATABLE :: CLUMP_FAC_OLD(:)
        REAL(10) LUMOLD                  !Luminosity of old model in Lsun			   |	        REAL*8 LUMOLD                  !Luminosity of old model in Lsun
        REAL(10) LDL,MLDL                !Used for interpolation.				   |	        REAL*8 LDL,MLDL                !Used for interpolation.
        REAL(10) T1,DI,ION_FRAC,VEL      !Used when reading T_IN				   |	        REAL*8 T1,DI,ION_FRAC,VEL      !Used when reading T_IN
        REAL(10) RTAU1		       !Radius in new model where TAU(e.s.)=1.0			   |	        REAL*8 RTAU1		       !Radius in new model where TAU(e.s.)=1.0
        REAL(10) RTAU1_OLD               !Radius in old model where TAU(e.s.)=1.0		   |	        REAL*8 RTAU1_OLD               !Radius in old model where TAU(e.s.)=1.0
./subs/ins_line_obs_v2.f
	REAL(10) FREQ(NFREQ_MAX)			!New observers frequencies		   |		REAL*8 FREQ(NFREQ_MAX)			!New observers frequencies
	REAL(10) NU_LINE(N_LINES)		!Line frequencies				   |		REAL*8 NU_LINE(N_LINES)		!Line frequencies
	REAL(10) VINF		!Terminal velocity of wind.					   |		REAL*8 VINF		!Terminal velocity of wind.
	REAL(10) dV_OBS_PROF									   |		REAL*8 dV_OBS_PROF
	REAL(10) dV_OBS_WING									   |		REAL*8 dV_OBS_WING
	REAL(10) dV_OBS_BIG									   |		REAL*8 dV_OBS_BIG
	REAL(10) NU_MIN										   |		REAL*8 NU_MIN
	REAL(10) NU_MAX										   |		REAL*8 NU_MAX
	REAL(10) OBS_PRO_EXT_RAT								   |		REAL*8 OBS_PRO_EXT_RAT
	REAL(10) ES_WING_EXT									   |		REAL*8 ES_WING_EXT
	REAL(10) V_DOP										   |		REAL*8 V_DOP
	REAL(10) MAX_B_EXTENT									   |		REAL*8 MAX_B_EXTENT
	REAL(10) MAX_R_EXTENT									   |		REAL*8 MAX_R_EXTENT
	REAL(10) MAX_BW_EXTENT									   |		REAL*8 MAX_BW_EXTENT
	REAL(10) MAX_RW_EXTENT									   |		REAL*8 MAX_RW_EXTENT
C												   |	C
	REAL(10) PROF_SPACING									   |		REAL*8 PROF_SPACING
	REAL(10) WING_SPACING									   |		REAL*8 WING_SPACING
	REAL(10) BIG_SPACING									   |		REAL*8 BIG_SPACING
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) C_KMS,MIN_FREQ									   |		REAL*8 C_KMS,MIN_FREQ
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/ins_line_obs_v3.f
	REAL(10) FREQ(NFREQ_MAX)			!New observers frequencies		   |		REAL*8 FREQ(NFREQ_MAX)			!New observers frequencies
	REAL(10) NU_LINE(N_LINES)		!Line frequencies				   |		REAL*8 NU_LINE(N_LINES)		!Line frequencies
	REAL(10) VINF			!Terminal velocity of wind.				   |		REAL*8 VINF			!Terminal velocity of wind.
	REAL(10) dV_OBS_PROF		!Spcing across line profile				   |		REAL*8 dV_OBS_PROF		!Spcing across line profile
	REAL(10) dV_OBS_WING		!Spacing in e.s. wing					   |		REAL*8 dV_OBS_WING		!Spacing in e.s. wing
	REAL(10) dV_OBS_BIG		!Spacing between lines (i.e., in continuum)		   |		REAL*8 dV_OBS_BIG		!Spacing between lines (i.e., in continuum)
	REAL(10) NU_MIN			!Minimum frequency					   |		REAL*8 NU_MIN			!Minimum frequency
	REAL(10) NU_MAX			!Maximum frequency					   |		REAL*8 NU_MAX			!Maximum frequency
	REAL(10) OBS_PRO_EXT_RAT								   |		REAL*8 OBS_PRO_EXT_RAT
	REAL(10) ES_WING_EXT		!Extent of e.s. wing (thermal; in km/s)			   |		REAL*8 ES_WING_EXT		!Extent of e.s. wing (thermal; in km/s)
	REAL(10) V_DOP										   |		REAL*8 V_DOP
	REAL(10) MAX_B_EXTENT		!Blue profile extent					   |		REAL*8 MAX_B_EXTENT		!Blue profile extent
	REAL(10) MAX_R_EXTENT		!Red profile extent					   |		REAL*8 MAX_R_EXTENT		!Red profile extent
	REAL(10) MAX_BW_EXTENT		!Blue e.s. wing extent (from line core)			   |		REAL*8 MAX_BW_EXTENT		!Blue e.s. wing extent (from line core)
	REAL(10) MAX_RW_EXTENT		!Red e.s. wing etent (from line core)			   |		REAL*8 MAX_RW_EXTENT		!Red e.s. wing etent (from line core)
C												   |	C
	REAL(10) PROF_SPACING									   |		REAL*8 PROF_SPACING
	REAL(10) WING_SPACING									   |		REAL*8 WING_SPACING
	REAL(10) BIG_SPACING									   |		REAL*8 BIG_SPACING
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) C_KMS,MIN_FREQ									   |		REAL*8 C_KMS,MIN_FREQ
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/ins_line_obs_v5.f
	REAL(10) FREQ(NFREQ_MAX)			!New observers frequencies		   |		REAL*8 FREQ(NFREQ_MAX)			!New observers frequencies
	REAL(10) NU_LINE(N_LINES)		!Line frequencies				   |		REAL*8 NU_LINE(N_LINES)		!Line frequencies
	REAL(10) NU_STRT_LINE(N_LINES)	!Frequencies of start of res. zone.			   |		REAL*8 NU_STRT_LINE(N_LINES)	!Frequencies of start of res. zone.
	REAL(10) VEC_VMIN_VDOP(N_LINES)	!Minium Doppler velocity in km/s.			   |		REAL*8 VEC_VMIN_VDOP(N_LINES)	!Minium Doppler velocity in km/s.
	REAL(10) VINF		!Terminal velocity of wind.					   |		REAL*8 VINF		!Terminal velocity of wind.
	REAL(10) dV_OBS_PROF									   |		REAL*8 dV_OBS_PROF
	REAL(10) dV_OBS_WING									   |		REAL*8 dV_OBS_WING
	REAL(10) dV_OBS_BIG									   |		REAL*8 dV_OBS_BIG
	REAL(10) NU_MIN										   |		REAL*8 NU_MIN
	REAL(10) NU_MAX										   |		REAL*8 NU_MAX
	REAL(10) OBS_PRO_EXT_RAT								   |		REAL*8 OBS_PRO_EXT_RAT
	REAL(10) ES_WING_EXT									   |		REAL*8 ES_WING_EXT
	REAL(10) V_DOP										   |		REAL*8 V_DOP
	REAL(10) FRAC_DOP_OBS									   |		REAL*8 FRAC_DOP_OBS
	REAL(10) MAX_B_EXTENT		!Maximum blueward extent of line profile		   |		REAL*8 MAX_B_EXTENT		!Maximum blueward extent of line profile
	REAL(10) MAX_R_EXTENT		!Maximum  redward extent of line profile		   |		REAL*8 MAX_R_EXTENT		!Maximum  redward extent of line profile
	REAL(10) MAX_BW_EXTENT		!Maximum blueward extent of e.s. wings			   |		REAL*8 MAX_BW_EXTENT		!Maximum blueward extent of e.s. wings
	REAL(10) MAX_RW_EXTENT		!Maximum  redward extent of e.s. wings			   |		REAL*8 MAX_RW_EXTENT		!Maximum  redward extent of e.s. wings
!												   |	!
	REAL(10) PROF_SPACING									   |		REAL*8 PROF_SPACING
	REAL(10) WING_SPACING									   |		REAL*8 WING_SPACING
	REAL(10) BIG_SPACING									   |		REAL*8 BIG_SPACING
	REAL(10) T1,T2,T3									   |		REAL*8 T1,T2
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) NU_END_LINE									   |		REAL*8 NU_END_LINE
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	  T3=1.0D0										   <
	          T3=1.0D0 + C_KMS*ABS(T3-NU_LINE(K)/FREQ(INDX))/VEC_VMIN_VDOP(K)		   |		          T2=FREQ(INDX)*FRAC_DOP_OBS*VEC_VMIN_VDOP(K)*
	          T2=FREQ(INDX)*FRAC_DOP_OBS*VEC_VMIN_VDOP(K)*SQRT(T3)/C_KMS			   |		1               SQRT( 1.0D0+ C_KMS*ABS(1.0D0-NU_LINE(K)/FREQ(INDX))/
												   >		1                     VEC_VMIN_VDOP(K) )/C_KMS
./subs/ins_line_v4.f
	REAL(10) FREQ(NFREQ_MAX)			!Continuum frequencies			   |		REAL*8 FREQ(NFREQ_MAX)			!Continuum frequencies
	REAL(10) NU_CONT(NCF)		!Continuum frequencies					   |		REAL*8 NU_CONT(NCF)		!Continuum frequencies
	REAL(10) NU_LINE(N_LINES)		!Line frequencies				   |		REAL*8 NU_LINE(N_LINES)		!Line frequencies
	REAL(10) VINF		!Terminal velocity of wind.					   |		REAL*8 VINF		!Terminal velocity of wind.
	REAL(10) V_DOP		!Doppler velocity (km/s).					   |		REAL*8 V_DOP		!Doppler velocity (km/s).
	REAL(10) FRAC_DOP		!Indicates dNU across line in Doppler widths.		   |		REAL*8 FRAC_DOP		!Indicates dNU across line in Doppler widths.
	REAL(10) MAX_DOP		!Half the extent of intrinsic profile			   |		REAL*8 MAX_DOP		!Half the extent of intrinsic profile
	REAL(10) dV_CMF_PROF	!Indicate spacing in profile but outside			   |		REAL*8 dV_CMF_PROF	!Indicate spacing in profile but outside
	REAL(10) dV_CMF_WING	!Indicate spacing in wings (i.e. outside 			   |		REAL*8 dV_CMF_WING	!Indicate spacing in wings (i.e. outside 
	REAL(10) ES_WING_EXT									   |		REAL*8 ES_WING_EXT
	REAL(10) R_CMF_WING_EXT									   |		REAL*8 R_CMF_WING_EXT
	REAL(10) dNU_on_NU	!Actual spacing used across intrinsic line 			   |		REAL*8 dNU_on_NU	!Actual spacing used across intrinsic line 
	REAL(10) RES_EXTENT	!Maximum frequency in line is NU*RES_EXTENT			   |		REAL*8 RES_EXTENT	!Maximum frequency in line is NU*RES_EXTENT
	REAL(10) BLUE_WING_EXT	!In km/s							   |		REAL*8 BLUE_WING_EXT	!In km/s
	REAL(10) RED_WING_EXT									   |		REAL*8 RED_WING_EXT
	REAL(10) APP_RES_EXT	!No units.							   |		REAL*8 APP_RES_EXT	!No units.
	REAL(10) APP_ESBW_EXT									   |		REAL*8 APP_ESBW_EXT
	REAL(10) EDGE_SEP_FAC									   |		REAL*8 EDGE_SEP_FAC
	REAL(10) MIN_FREQ_RAT									   |		REAL*8 MIN_FREQ_RAT
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) DELF										   |		REAL*8 DELF
	REAL(10) MIN_FREQ									   |		REAL*8 MIN_FREQ
	REAL(10) SWITCH_FREQ									   |		REAL*8 SWITCH_FREQ
	REAL(10) TEMP_FREQ									   |		REAL*8 TEMP_FREQ
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/ins_line_v6.f
	REAL(10) FREQ(NFREQ_MAX)			!Continuum frequencies			   |		REAL*8 FREQ(NFREQ_MAX)			!Continuum frequencies
	REAL(10) NU_CONT(NCF)			!Continuum frequencies				   |		REAL*8 NU_CONT(NCF)			!Continuum frequencies
	REAL(10) NU_LINE(N_LINES)			!Line frequencies			   |		REAL*8 NU_LINE(N_LINES)			!Line frequencies
	REAL(10) NU_STRT_LINE(N_LINES)		!Start frequency of resoance zone.		   |		REAL*8 NU_STRT_LINE(N_LINES)		!Start frequency of resoance zone.
	REAL(10) VEC_MIN_VDOP(N_LINES)		!Minimum doppler velocity for line.		   |		REAL*8 VEC_MIN_VDOP(N_LINES)		!Minimum doppler velocity for line.
	REAL(10) VINF		!Terminal velocity of wind.					   |		REAL*8 VINF		!Terminal velocity of wind.
	REAL(10) FRAC_DOP		!Indicates dNU across line in Doppler widths.		   |		REAL*8 FRAC_DOP		!Indicates dNU across line in Doppler widths.
	REAL(10) dV_CMF_PROF	!Indicate spacing in profile but outside			   |		REAL*8 dV_CMF_PROF	!Indicate spacing in profile but outside
	REAL(10) dV_CMF_WING	!Indicate spacing in wings (i.e. outside 			   |		REAL*8 dV_CMF_WING	!Indicate spacing in wings (i.e. outside 
	REAL(10) ES_WING_EXT									   |		REAL*8 ES_WING_EXT
	REAL(10) R_CMF_WING_EXT									   |		REAL*8 R_CMF_WING_EXT
	REAL(10) NU_END_LINE(N_LINES)								   |		REAL*8 NU_END_LINE(N_LINES)
	REAL(10) dNU_on_NU	!Actual spacing used across intrinsic line 			   |		REAL*8 dNU_on_NU	!Actual spacing used across intrinsic line 
	REAL(10) ES_BLUE_WING_EXT		!In km/s					   |		REAL*8 ES_BLUE_WING_EXT		!In km/s
	REAL(10) ES_RED_WING_EXT								   |		REAL*8 ES_RED_WING_EXT
	REAL(10) CUR_RED_PROF_EXT		!10^15 Hz					   |		REAL*8 CUR_RED_PROF_EXT		!10^15 Hz
	REAL(10) EDGE_SEP_FAC									   |		REAL*8 EDGE_SEP_FAC
	REAL(10) MIN_FREQ_RAT									   |		REAL*8 MIN_FREQ_RAT
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) dNU_NEXT									   |		REAL*8 dNU_NEXT
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/integrate.f
	REAL(10) X(ND),F(ND),TA(ND)								   |		REAL*8 X(ND),F(ND),TA(ND)
	REAL(10) H0,H1,H2,F01,F12,F23,F012,F123,F0123						   |		REAL*8 H0,H1,H2,F01,F12,F23,F012,F123,F0123
./subs/interp_knowncoeef.f
	REAL(10) CHIEXT(NX),CHI(ND),COEF(0:3,NX)						   |		REAL*8 CHIEXT(NX),CHI(ND),COEF(0:3,NX)
./subs/jfeau_ibc.f
	REAL(10) TA(ND),TB(ND),TC(ND),R(ND),ZETA(ND)						   |		REAL*8 TA(ND),TB(ND),TC(ND),R(ND),ZETA(ND)
	REAL(10) RJ(ND),DTAU(ND),Q(ND),F(ND)							   |		REAL*8 RJ(ND),DTAU(ND),Q(ND),F(ND)
	REAL(10) THETA(ND),CHI(ND)								   |		REAL*8 THETA(ND),CHI(ND)
	REAL(10) DBB,HBC_J,HBC_S,INBC,IC,T1							   |		REAL*8 DBB,HBC_J,HBC_S,INBC,IC,T1
./subs/jfeau_ibc_v2.f
	REAL(10) TA(ND),TB(ND),TC(ND),R(ND),ZETA(ND)						   |		REAL*8 TA(ND),TB(ND),TC(ND),R(ND),ZETA(ND)
	REAL(10) RJ(ND),DTAU(ND),Q(ND),F(ND)							   |		REAL*8 RJ(ND),DTAU(ND),Q(ND),F(ND)
	REAL(10) THETA(ND),CHI(ND)								   |		REAL*8 THETA(ND),CHI(ND)
	REAL(10) DBB,HBC_J,HBC_S,INBC,IC,T1							   |		REAL*8 DBB,HBC_J,HBC_S,INBC,IC,T1
./subs/jgrey.f
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND),CHI(ND),dCHIdr(ND)			   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),R(ND),Z(ND),CHI(ND),dCHIdr(ND)
	REAL(10) RJ(ND),NEWRJ(ND),NEWRK(ND),DTAU(ND),Q(ND),F(ND)				   |		REAL*8 RJ(ND),NEWRJ(ND),NEWRK(ND),DTAU(ND),Q(ND),F(ND)
	REAL(10) AQW(ND,NP),AQW3(ND,NP),P(NP),LUM,HBC,HBCNEW,E1,E2,E3				   |		REAL*8 AQW(ND,NP),AQW3(ND,NP),P(NP),LUM,HBC,HBCNEW,E1,E2,E3
	REAL(10) DBC,DBB,T1,T2,IC								   |		REAL*8 DBC,DBB,T1,T2,IC
	  E1=EXP(-DTAU(1))									   |		  E1=DEXP(-DTAU(1))
./subs/jgrey_with_fvt.f
	REAL(10) RJ(ND)			!Mean intensity (computed and returned)			   |		REAL*8 RJ(ND)			!Mean intensity (computed and returned)
	REAL(10) RSQ_HFLUX(ND)            !r^2 . Flux						   |		REAL*8 RSQ_HFLUX(ND)            !r^2 . Flux
	REAL(10) CHI(ND)			!Opacity					   |		REAL*8 CHI(ND)			!Opacity
	REAL(10) R(ND)			!Radius grid (in units of 10^10 cm)			   |		REAL*8 R(ND)			!Radius grid (in units of 10^10 cm)
	REAL(10) VEL(ND)			!Velocity (in km/s)				   |		REAL*8 VEL(ND)			!Velocity (in km/s)
	REAL(10) SIGMA(ND)		!dlnv/dlnr -1						   |		REAL*8 SIGMA(ND)		!dlnv/dlnr -1
!												   |	!
	REAL(10) P(NP)			!Impact parameters					   |		REAL*8 P(NP)			!Impact parameters
	REAL(10) JQW(ND,NP)		!Quadrature weight for J (on grid)			   |		REAL*8 JQW(ND,NP)		!Quadrature weight for J (on grid)
	REAL(10) KQW(ND,NP) 		!Quadrature weight for K (on grid)			   |		REAL*8 KQW(ND,NP) 		!Quadrature weight for K (on grid)
	REAL(10) HQW(ND-1,NP)		!Quadrature weight for H (at midpoints)			   |		REAL*8 HQW(ND-1,NP)		!Quadrature weight for H (at midpoints)
	REAL(10) NQW(ND-1,NP)		!Quadrature weight for N (at midpoints)			   |		REAL*8 NQW(ND-1,NP)		!Quadrature weight for N (at midpoints)
!												   |	!
	REAL(10) LUMINOSITY               !Luminosity at inner bounary in Lsun.			   |		REAL*8 LUMINOSITY               !Luminosity at inner bounary in Lsun.
	REAL(10) IC										   |		REAL*8 IC
	REAL(10) ACCURACY			!Convergence accuracy for computing f.		   |		REAL*8 ACCURACY			!Convergence accuracy for computing f.
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) HU(ND),HL(ND)									   |		REAL*8 HU(ND),HL(ND)
	REAL(10) XM(ND)										   |		REAL*8 XM(ND)
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
	REAL(10) CHI_MOD(ND)									   |		REAL*8 CHI_MOD(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) dCHI_MODdR(ND)									   |		REAL*8 dCHI_MODdR(ND)
	REAL(10) Q(ND)										   |		REAL*8 Q(ND)
	REAL(10) F(ND)										   |		REAL*8 F(ND)
	REAL(10) JFAC(ND)									   |		REAL*8 JFAC(ND)
	REAL(10) N_ON_H(ND)									   |		REAL*8 N_ON_H(ND)
	REAL(10) DTAU(ND)									   |		REAL*8 DTAU(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) VU(ND)										   |		REAL*8 VU(ND)
	REAL(10) CV(ND)										   |		REAL*8 CV(ND)
	REAL(10) AVE_DTAU(ND)									   |		REAL*8 AVE_DTAU(ND)
	REAL(10) FS_RSQJ(ND)									   |		REAL*8 FS_RSQJ(ND)
	REAL(10) FS_RSQH(ND)									   |		REAL*8 FS_RSQH(ND)
	REAL(10) FS_RSQK(ND)									   |		REAL*8 FS_RSQK(ND)
	REAL(10) FS_RSQN(ND)									   |		REAL*8 FS_RSQN(ND)
!												   |	!
	REAL(10) HBC		!Eddington factor for H at outer boundary.			   |		REAL*8 HBC		!Eddington factor for H at outer boundary.
	REAL(10) IN_HBC		!Eddington factor for H at inner boundary.			   |		REAL*8 IN_HBC		!Eddington factor for H at inner boundary.
	REAL(10) HMOD										   |		REAL*8 HMOD
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) DBB										   |		REAL*8 DBB
	REAL(10) DBC										   |		REAL*8 DBC
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	    DBC=DBB*SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)						   |		    DBC=DBB*DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)
	      Z(I)=SQRT( (R(I)-P(LS))*(R(I)+P(LS)) )						   |		      Z(I)=DSQRT( (R(I)-P(LS))*(R(I)+P(LS)) )
	    E1=EXP(-DTAU(1))									   |		    E1=DEXP(-DTAU(1))
./subs/jtrpwgt.f
	REAL(10) X(N),W(N),H,T1,SUM								   |		REAL*8 X(N),W(N),H,T1,SUM
	LOGICAL, SAVE :: CHECK=.TRUE.								   |		LOGICAL, SAVE :: CHECK=.FALSE.
./subs/jtrpwgt_v2.f
	REAL(10) X(N),dX(N),W(N)								   |		REAL*8 X(N),dX(N),W(N)
	REAL(10) H,T1,T2,SUM,XSUM								   |		REAL*8 H,T1,T2,SUM,XSUM
./subs/jweight.f
	REAL(10) X(N),W(N),H,HN,RE,RF,SUM							   |		REAL*8 X(N),W(N),H,HN,RE,RF,SUM
./subs/jweight_v2.f
	REAL(10) X(N),dX(N),W(N)								   |		REAL*8 X(N),dX(N),W(N)
	REAL(10) H,HN,RE,RF,SUM									   |		REAL*8 H,HN,RE,RF,SUM
./subs/kivarnm.f
	REAL(10) VK(NI,3,NM),RKB(NI),RKC(NI),X(NI)						   |		REAL*8 VK(NI,3,NM),RKB(NI),RKC(NI),X(NI)
	REAL(10) DTAU(NI),Q(NI),QH(NI),UK(NI),UKM1(NI),Z(NI)					   |		REAL*8 DTAU(NI),Q(NI),QH(NI),UK(NI),UKM1(NI),Z(NI)
	REAL(10) VKM1(NI),TCHI(NI),SOURCE(NI)							   |		REAL*8 VKM1(NI),TCHI(NI),SOURCE(NI)
	REAL(10) CHI(NI),CHIL(NI),ETAL(NI)							   |		REAL*8 CHI(NI),CHIL(NI),ETAL(NI)
	REAL(10) TERF										   |		REAL*8 TERF
	REAL(10) T1,T2,T3,T4,T5,T6,T7								   |		REAL*8 T1,T2,T3,T4,T5,T6,T7
./subs/ktrpwgt.f
	REAL(10) X(N),W(N),T1,T2,SUM								   |		REAL*8 X(N),W(N),T1,T2,SUM
	LOGICAL, SAVE :: CHECK=.TRUE.								   |		LOGICAL, SAVE :: CHECK=.FALSE.
./subs/ktrpwgt_v2.f
	REAL(10) X(N),dX(N),W(N)								   |		REAL*8 X(N),dX(N),W(N)
	REAL(10) T1,T2,SUM,XSUM									   |		REAL*8 T1,T2,SUM,XSUM
./subs/kweight.f
	REAL(10) X(N),W(N),H,HN,RE,RF,SUM							   |		REAL*8 X(N),W(N),H,HN,RE,RF,SUM
./subs/kweight_v2.f
	REAL(10) X(N),dX(N),W(N)								   |		REAL*8 X(N),dX(N),W(N)
	REAL(10) H,HN,RE,RF,SUM									   |		REAL*8 H,HN,RE,RF,SUM
./subs/lamvacair.f
	REAL(10) LAMVACAIR,FREQ,T1								   |		REAL*8 LAMVACAIR,FREQ,T1
	REAL(10) LAM_AIR,LAM,T1									   |		REAL*8 LAM_AIR,LAM,T1
./subs/lam_vac.f
	REAL(10) LAM_VAC			!Vacuum wavelength in Ang.			   |		REAL*8 LAM_VAC			!Vacuum wavelength in Ang.
	REAL(10) LAM_AIR			!Air wavelength in Ang.				   |		REAL*8 LAM_AIR			!Air wavelength in Ang.
	REAL(10) T1										   |		REAL*8 T1
./subs/last2rays.f
C Altered 24-May-1996. - EXP replaced by EXP							   |	C Altered 24-May-1996. - DEXP replaced by EXP
	REAL(10) XM(NI),WM(NI,NI),THETA(NI),CHI(NI),P						   |		REAL*8 XM(NI),WM(NI,NI),THETA(NI),CHI(NI),P
	REAL(10) DTAU(NI),R(NI),Z(NI),ZETA(NI)							   |		REAL*8 DTAU(NI),R(NI),Z(NI),ZETA(NI)
	REAL(10) TOR,E1,E2,E3,T1,IBOUND								   |		REAL*8 TOR,E1,E2,E3,T1,IBOUND
./subs/last2vki.f
C Altered 24-May-1996 -EXP replaced bu EXP							   |	C Altered 24-May-1996 -DEXP replaced bu EXP
	REAL(10) VK(NI,NI),SOURCE(NI),CHI(NI),DTAU(NI),Z(NI)					   |		REAL*8 VK(NI,NI),SOURCE(NI),CHI(NI),DTAU(NI),Z(NI)
	REAL(10) E1,E2,E3,DE1,DE2,DE3,TOR,T1,U2							   |		REAL*8 E1,E2,E3,DE1,DE2,DE3,TOR,T1,U2
./subs/lin_interp.f
	REAL(10) R(ND),V(ND),U(NIN),W(NIN)							   |		REAL*8 R(ND),V(ND),U(NIN),W(NIN)
	REAL(10) T1										   |		REAL*8 T1
./subs/locsolut.f
	REAL(10) STEQ(NT,ND),POPS(NT,ND),TA(ND)							   |		REAL*8 STEQ(NT,ND),POPS(NT,ND),TA(ND)
	REAL(10) T1,T2,T3,SCALE									   |		REAL*8 T1,T2,T3,SCALE
./subs/ltepop.f
	REAL(10) HNST(N,NR),ED(NR),DI(NR),T(NR),G(N),NUION(N),GU				   |		REAL*8 HNST(N,NR),ED(NR),DI(NR),T(NR),G(N),NUION(N),GU
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X,Y,RGU									   |		REAL*8 X,Y,RGU
./subs/lte_pop_sl.f
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./subs/lte_pop_sl_v2.f
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) LOG_HNST_S(N_S,ND)								   |		REAL*8 LOG_HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) LOG_HNST_F(N_F,ND)								   |		REAL*8 LOG_HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), PARAMETER :: MAX_LOG_LTE_POP=600.0D0						   |		REAL*8, PARAMETER :: MAX_LOG_LTE_POP=600.0D0
	REAL(10) SCALE_FAC(N_S)									   |		REAL*8 SCALE_FAC(N_S)
	REAL(10) T1										   |		REAL*8 T1
./subs/ltepop_wld_v1.f
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature 10^4K					   |		REAL*8 T(ND)			!Temperature 10^4K
	REAL(10) DIC2(ND)			!Ion density (Full model atom)			   |		REAL*8 DIC2(ND)			!Ion density (Full model atom)
	REAL(10) C2LTE(NC2,ND)									   |		REAL*8 C2LTE(NC2,ND)
	REAL(10) W_C2(NC2,ND)									   |		REAL*8 W_C2(NC2,ND)
	REAL(10) EDGEC2(NC2)									   |		REAL*8 EDGEC2(NC2)
	REAL(10) GC2(NC2)									   |		REAL*8 GC2(NC2)
	REAL(10) GION_C2			!Statistical weight of ion groun state.		   |		REAL*8 GION_C2			!Statistical weight of ion groun state.
	REAL(10) ZC2			!Ion charge						   |		REAL*8 ZC2			!Ion charge
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X,Y,RGU									   |		REAL*8 X,Y,RGU
	    RGU=LOG(RGU)									   |		    RGU=DLOG(RGU)
	  RGU=LOG(2.07078D-22)									   |		  RGU=DLOG(2.07078D-22)
./subs/ltepop_wld_v2.f
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature 10^4K					   |		REAL*8 T(ND)			!Temperature 10^4K
	REAL(10) DIC2(ND)			!Ion density (Full model atom)			   |		REAL*8 DIC2(ND)			!Ion density (Full model atom)
	REAL(10) C2LTE(NC2,ND)									   |		REAL*8 C2LTE(NC2,ND)
	REAL(10) LOG_C2LTE(NC2,ND)								   |		REAL*8 LOG_C2LTE(NC2,ND)
	REAL(10) W_C2(NC2,ND)									   |		REAL*8 W_C2(NC2,ND)
	REAL(10) EDGEC2(NC2)									   |		REAL*8 EDGEC2(NC2)
	REAL(10) GC2(NC2)									   |		REAL*8 GC2(NC2)
	REAL(10) GION_C2			!Statistical weight of ion groun state.		   |		REAL*8 GION_C2			!Statistical weight of ion groun state.
	REAL(10) ZC2			!Ion charge						   |		REAL*8 ZC2			!Ion charge
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X,Y,RGU									   |		REAL*8 X,Y,RGU
	REAL(10), PARAMETER :: MAX_LOG_LTE_POP=3000.0D0						   |		REAL*8, PARAMETER :: MAX_LOG_LTE_POP=600.0D0
	 RGU=LOG(RGU)										   |		 RGU=DLOG(RGU)
./subs/lum_from_eta.f
	REAL(10) LINE_LUM(ND)									   |		REAL*8 LINE_LUM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) DERIV(ND)									   |		REAL*8 DERIV(ND)
./subs/lum_from_eta_v2.f
	REAL(10) LINE_LUM(ND)									   |		REAL*8 LINE_LUM(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) DERIV(ND)									   |		REAL*8 DERIV(ND)
./subs/marupv.f
	REAL(10) TVX(NI-1,NI,NM),TX(NI,NI,NM),GB(NI),H(NI)					   |		REAL*8 TVX(NI-1,NI,NM),TX(NI,NI,NM),GB(NI),H(NI)
./subs/mat5pen.f
	REAL(10) A(N,NR),C(N,NR),E(N,NR),WRKMAT(N,NR)						   |		REAL*8 A(N,NR),C(N,NR),E(N,NR),WRKMAT(N,NR)
	REAL(10) B(N,N),D(N,N),F(N,N),VEC(N)							   |		REAL*8 B(N,N),D(N,N),F(N,N),VEC(N)
	REAL(10) DP_ONE,DP_ZERO,DP_NEG_ONE							   |		REAL*8 DP_ONE,DP_ZERO,DP_NEG_ONE
./subs/mess.f
./subs/modifyba.f
	REAL(10) BA(N,N,ND,ND),STEQ(N,ND),C(N),CMORE(N,5)					   |		REAL*8 BA(N,N,ND,ND),STEQ(N,ND),C(N),CMORE(N,5)
	REAL(10) TOL,BIG,RBIG,T1								   |		REAL*8 TOL,BIG,RBIG,T1
./subs/mod_trap_derivatives.f
	  REAL(10), ALLOCATABLE :: A(:)								   |		  REAL*8, ALLOCATABLE :: A(:)
	  REAL(10), ALLOCATABLE :: B(:)								   |		  REAL*8, ALLOCATABLE :: B(:)
	  REAL(10), ALLOCATABLE :: C(:)								   |		  REAL*8, ALLOCATABLE :: C(:)
./subs/momjbar.f
	REAL(10) ETA(ND),CHI(ND),THETA(ND),ESEC(ND)						   |		REAL*8 ETA(ND),CHI(ND),THETA(ND),ESEC(ND)
	REAL(10) CHIL(ND),ETAL(ND),JCONT(ND)							   |		REAL*8 CHIL(ND),ETAL(ND),JCONT(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) JNU(ND,NLF+1),RSQHNU(ND,NLF+1)							   |		REAL*8 JNU(ND,NLF+1),RSQHNU(ND,NLF+1)
	REAL(10) F(ND,NLF+1),G(ND,NLF+1)							   |		REAL*8 F(ND,NLF+1),G(ND,NLF+1)
	REAL(10) HBC(3,NLF+1),NBC(3,NLF+1),IN_HBC(NLF+1)					   |		REAL*8 HBC(3,NLF+1),NBC(3,NLF+1),IN_HBC(NLF+1)
	REAL(10) JBAR(ND),ZNET(ND),HBLANK(ND),JBLANK(ND)					   |		REAL*8 JBAR(ND),ZNET(ND),HBLANK(ND),JBLANK(ND)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF)							   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF)
	REAL(10) DBB,IC,FL,EW,CONT_INT,SRCEBND							   |		REAL*8 DBB,IC,FL,EW,CONT_INT,SRCEBND
	REAL(10) TA(ND),TB(ND),TC(ND),DTAU(ND),TCHI(ND),DTAUONQ(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),DTAU(ND),TCHI(ND),DTAUONQ(ND)
	REAL(10) Q(ND),XM(ND),SOURCE(ND),JEX_SCAT(ND)						   |		REAL*8 Q(ND),XM(ND),SOURCE(ND),JEX_SCAT(ND)
	REAL(10) VB(ND),VC(ND),HU(ND),HL(ND),HS(ND)						   |		REAL*8 VB(ND),VC(ND),HU(ND),HL(ND),HS(ND)
	REAL(10) GAM(ND),GAMH(ND),W(ND),WPREV(ND)						   |		REAL*8 GAM(ND),GAMH(ND),W(ND),WPREV(ND)
	REAL(10) PSI(ND),PSIPREV(ND)								   |		REAL*8 PSI(ND),PSIPREV(ND)
	REAL(10) T1,T2,DNU,SCALE								   |		REAL*8 T1,T2,DNU,SCALE
./subs/mom_j_cmf_v5.f
C Altered:  05-Dec-1996  PROGDESC set to number not character. Keep as REAL(10)			   |	C Altered:  05-Dec-1996  PROGDESC set to number not character. Keep as REAL*8
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) F(ND),G(ND),RSQN_ON_RSQJ(ND)							   |		REAL*8 F(ND),G(ND),RSQN_ON_RSQJ(ND)
	REAL(10) F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)					   |		REAL*8 F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)
	REAL(10) JNU(ND),RSQHNU(ND)								   |		REAL*8 JNU(ND),RSQHNU(ND)
	REAL(10) JNU_PREV(ND),RSQHNU_PREV(ND)							   |		REAL*8 JNU_PREV(ND),RSQHNU_PREV(ND)
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) HBC_PREV,NBC_PREV,IN_HBC_PREV							   |		REAL*8 HBC_PREV,NBC_PREV,IN_HBC_PREV
	REAL(10) DBB,IC,FREQ,dLOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10), PARAMETER :: PROG_ID=1.46310043D+08  !Must be unique (MOM_J_CM)		   |		REAL*8, PARAMETER :: PROG_ID=1.46310043D+08  !Must be unique (MOM_J_CM)
	REAL(10) CON_GAM(NV),CON_GAMH(NV),AV_SIGMA(NV)						   |		REAL*8 CON_GAM(NV),CON_GAMH(NV),AV_SIGMA(NV)
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),DTAUONQ(NV)					   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),DTAUONQ(NV)
	REAL(10) Q(NV),XM(NV),SOURCE(NV)							   |		REAL*8 Q(NV),XM(NV),SOURCE(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),COH_VEC(NV)					   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),COH_VEC(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV(NV)								   |		REAL*8 PSI(NV),PSIPREV(NV)
	REAL(10) EPS(NV),EPS_PREV(NV)								   |		REAL*8 EPS(NV),EPS_PREV(NV)
	REAL(10) RSQJNU_PREV(NV)								   |		REAL*8 RSQJNU_PREV(NV)
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
./subs/mom_j_cmf_v6.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: G_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: G_COEF(:,:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: G(:)								   |		REAL*8, ALLOCATABLE :: G(:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ(:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: G_SAV(:)							   |		REAL*8, ALLOCATABLE :: G_SAV(:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_SAV(:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_SAV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
	REAL(10), ALLOCATABLE :: G_PREV(:)							   |		REAL*8, ALLOCATABLE :: G_PREV(:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:)								   |		REAL*8, ALLOCATABLE :: EPS(:)
	REAL(10), ALLOCATABLE :: EPS_PREV(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV(:)
        REAL(10) HBC_PREV									   |	        REAL*8 HBC_PREV
	REAL(10) IN_HBC_PREV									   |		REAL*8 IN_HBC_PREV
	REAL(10) NBC_PREV									   |		REAL*8 NBC_PREV
!												   |	!
	REAL(10) HBC_SAV									   |		REAL*8 HBC_SAV
	REAL(10) IN_HBC_SAV									   |		REAL*8 IN_HBC_SAV
	REAL(10) NBC_SAV									   |		REAL*8 NBC_SAV
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)					   |		REAL*8 V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)
	REAL(10) F_SM(ND_SM),G_SM(ND_SM),RSQN_ON_RSQJ_SM(ND_SM)					   |		REAL*8 F_SM(ND_SM),G_SM(ND_SM),RSQN_ON_RSQJ_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM),RSQHNU_SM(ND_SM)							   |		REAL*8 JNU_SM(ND_SM),RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM),VDOP_FRAC							   |		REAL*8 VDOP_VEC(ND_SM),VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) DBB,IC,FREQ,dLOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
./subs/mom_j_cmf_v7.f
	REAL(10), ALLOCATABLE :: LOG_R_SM(:)							   |		REAL*8, ALLOCATABLE :: LOG_R_SM(:)
	REAL(10), ALLOCATABLE :: V_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: V_COEF(:,:)
	REAL(10), ALLOCATABLE :: SIGMA_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: SIGMA_COEF(:,:)
	REAL(10), ALLOCATABLE :: ESEC_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ESEC_COEF(:,:)
	REAL(10), ALLOCATABLE :: CHI_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: CHI_COEF(:,:)
	REAL(10), ALLOCATABLE :: ETA_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: ETA_COEF(:,:)
	REAL(10), ALLOCATABLE :: F_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: F_COEF(:,:)
	REAL(10), ALLOCATABLE :: G_COEF(:,:)							   |		REAL*8, ALLOCATABLE :: G_COEF(:,:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_COEF(:,:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_COEF(:,:)
	REAL(10), ALLOCATABLE :: R(:)								   |		REAL*8, ALLOCATABLE :: R(:)
	REAL(10), ALLOCATABLE :: V(:)								   |		REAL*8, ALLOCATABLE :: V(:)
	REAL(10), ALLOCATABLE :: SIGMA(:)							   |		REAL*8, ALLOCATABLE :: SIGMA(:)
	REAL(10), ALLOCATABLE :: ESEC(:)							   |		REAL*8, ALLOCATABLE :: ESEC(:)
	REAL(10), ALLOCATABLE :: CHI(:)								   |		REAL*8, ALLOCATABLE :: CHI(:)
	REAL(10), ALLOCATABLE :: ETA(:)								   |		REAL*8, ALLOCATABLE :: ETA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU(:)
	REAL(10), ALLOCATABLE :: RSQHNU(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU(:)
	REAL(10), ALLOCATABLE :: F(:)								   |		REAL*8, ALLOCATABLE :: F(:)
	REAL(10), ALLOCATABLE :: G(:)								   |		REAL*8, ALLOCATABLE :: G(:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ(:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ(:)
	REAL(10), ALLOCATABLE :: F_SAV(:)							   |		REAL*8, ALLOCATABLE :: F_SAV(:)
	REAL(10), ALLOCATABLE :: G_SAV(:)							   |		REAL*8, ALLOCATABLE :: G_SAV(:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_SAV(:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_SAV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: RSQJNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQJNU_PREV(:)
	REAL(10), ALLOCATABLE :: RSQHNU_PREV(:)							   |		REAL*8, ALLOCATABLE :: RSQHNU_PREV(:)
	REAL(10), ALLOCATABLE :: F_PREV(:)							   |		REAL*8, ALLOCATABLE :: F_PREV(:)
	REAL(10), ALLOCATABLE :: G_PREV(:)							   |		REAL*8, ALLOCATABLE :: G_PREV(:)
	REAL(10), ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)						   |		REAL*8, ALLOCATABLE :: RSQN_ON_RSQJ_PREV(:)
!												   |	!
	REAL(10), ALLOCATABLE :: CON_GAM(:)							   |		REAL*8, ALLOCATABLE :: CON_GAM(:)
	REAL(10), ALLOCATABLE :: CON_GAMH(:)							   |		REAL*8, ALLOCATABLE :: CON_GAMH(:)
	REAL(10), ALLOCATABLE :: AV_SIGMA(:)							   |		REAL*8, ALLOCATABLE :: AV_SIGMA(:)
!												   |	!
	REAL(10), ALLOCATABLE :: DTAU(:)							   |		REAL*8, ALLOCATABLE :: DTAU(:)
	REAL(10), ALLOCATABLE :: DTAUONQ(:)							   |		REAL*8, ALLOCATABLE :: DTAUONQ(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: TC(:)								   |		REAL*8, ALLOCATABLE :: TC(:)
	REAL(10), ALLOCATABLE :: Q(:)								   |		REAL*8, ALLOCATABLE :: Q(:)
	REAL(10), ALLOCATABLE :: XM(:)								   |		REAL*8, ALLOCATABLE :: XM(:)
	REAL(10), ALLOCATABLE :: SOURCE(:)							   |		REAL*8, ALLOCATABLE :: SOURCE(:)
	REAL(10), ALLOCATABLE :: VB(:)								   |		REAL*8, ALLOCATABLE :: VB(:)
	REAL(10), ALLOCATABLE :: VC(:)								   |		REAL*8, ALLOCATABLE :: VC(:)
	REAL(10), ALLOCATABLE :: HU(:)								   |		REAL*8, ALLOCATABLE :: HU(:)
	REAL(10), ALLOCATABLE :: HL(:)								   |		REAL*8, ALLOCATABLE :: HL(:)
	REAL(10), ALLOCATABLE :: HS(:)								   |		REAL*8, ALLOCATABLE :: HS(:)
	REAL(10), ALLOCATABLE :: COH_VEC(:)							   |		REAL*8, ALLOCATABLE :: COH_VEC(:)
	REAL(10), ALLOCATABLE :: GAM(:)								   |		REAL*8, ALLOCATABLE :: GAM(:)
	REAL(10), ALLOCATABLE :: GAMH(:)							   |		REAL*8, ALLOCATABLE :: GAMH(:)
	REAL(10), ALLOCATABLE :: W(:)								   |		REAL*8, ALLOCATABLE :: W(:)
	REAL(10), ALLOCATABLE :: WPREV(:)							   |		REAL*8, ALLOCATABLE :: WPREV(:)
	REAL(10), ALLOCATABLE :: PSI(:)								   |		REAL*8, ALLOCATABLE :: PSI(:)
	REAL(10), ALLOCATABLE :: PSIPREV(:)							   |		REAL*8, ALLOCATABLE :: PSIPREV(:)
	REAL(10), ALLOCATABLE :: EPS(:)								   |		REAL*8, ALLOCATABLE :: EPS(:)
	REAL(10), ALLOCATABLE :: EPS_PREV(:)							   |		REAL*8, ALLOCATABLE :: EPS_PREV(:)
        REAL(10) HBC_PREV									   |	        REAL*8 HBC_PREV
	REAL(10) IN_HBC_PREV									   |		REAL*8 IN_HBC_PREV
	REAL(10) NBC_PREV									   |		REAL*8 NBC_PREV
!												   |	!
	REAL(10) HBC_SAV									   |		REAL*8 HBC_SAV
	REAL(10) IN_HBC_SAV									   |		REAL*8 IN_HBC_SAV
	REAL(10) NBC_SAV									   |		REAL*8 NBC_SAV
	REAL(10) VDOP_FRAC_SAV									   |		REAL*8 VDOP_FRAC_SAV
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)					   |		REAL*8 V_SM(ND_SM),SIGMA_SM(ND_SM),R_SM(ND_SM)
	REAL(10) F_SM(ND_SM),G_SM(ND_SM),RSQN_ON_RSQJ_SM(ND_SM)					   |		REAL*8 F_SM(ND_SM),G_SM(ND_SM),RSQN_ON_RSQJ_SM(ND_SM)
	REAL(10) JNU_SM(ND_SM),RSQHNU_SM(ND_SM)							   |		REAL*8 JNU_SM(ND_SM),RSQHNU_SM(ND_SM)
	REAL(10) VDOP_VEC(ND_SM),VDOP_FRAC							   |		REAL*8 VDOP_VEC(ND_SM),VDOP_FRAC
	REAL(10) MOM_ERR_ON_FREQ								   |		REAL*8 MOM_ERR_ON_FREQ
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) DBB,IC,FREQ,dLOG_NU								   |		REAL*8 DBB,IC,FREQ,dLOG_NU
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10)  DELTA_R									   |		REAL*8  DELTA_R
./subs/mon_interp.f
	REAL(10) QZ(NQ,LIN_END),QZR(NX)								   |		REAL*8 QZ(NQ,LIN_END),QZR(NX)
	REAL(10) VARRAY(NV,LIN_END),R(ND)							   |		REAL*8 VARRAY(NV,LIN_END),R(ND)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) HI,HIM1,HIP1									   |		REAL*8 HI,HIM1,HIP1
	REAL(10) SI,SIM1,SIP1									   |		REAL*8 SI,SIM1,SIP1
	REAL(10) A,B,C,D,DYI,DYIP1,SGN								   |		REAL*8 A,B,C,D,DYI,DYIP1,SGN
./subs/mon_interp_fast.f
	REAL(10) QZ(NQ,LIN_END),QZR(NX)								   |		REAL*8 QZ(NQ,LIN_END),QZR(NX)
	REAL(10) VARRAY(NV,LIN_END),R(ND)							   |		REAL*8 VARRAY(NV,LIN_END),R(ND)
	REAL(10) S(ND)		!Slopes								   |		REAL*8 S(ND)		!Slopes
	REAL(10) H(ND)										   |		REAL*8 H(ND)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) A(ND)										   |		REAL*8 A(ND)
	REAL(10) B(ND)										   |		REAL*8 B(ND)
	REAL(10) C(ND)										   |		REAL*8 C(ND)
	REAL(10) D(ND)		!Used for derivative at I.					   |		REAL*8 D(ND)		!Used for derivative at I.
	REAL(10) E(ND)										   |		REAL*8 E(ND)
	REAL(10) SGN										   |		REAL*8 SGN
./subs/mon_interp_fast_v2.f
	REAL(10) QZ(NQ,LIN_END),QZR(NX)								   |		REAL*8 QZ(NQ,LIN_END),QZR(NX)
	REAL(10) VARRAY(NV,LIN_END),R(ND)							   |		REAL*8 VARRAY(NV,LIN_END),R(ND)
	REAL(10) S(ND)		!Slopes								   |		REAL*8 S(ND)		!Slopes
	REAL(10) H(ND)										   |		REAL*8 H(ND)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) A(ND)										   |		REAL*8 A(ND)
	REAL(10) B(ND)										   |		REAL*8 B(ND)
	REAL(10) C(ND)										   |		REAL*8 C(ND)
	REAL(10) D(ND)		!Used for derivative at I.					   |		REAL*8 D(ND)		!Used for derivative at I.
	REAL(10) E(ND)										   |		REAL*8 E(ND)
	REAL(10) SGN										   |		REAL*8 SGN
./subs/mon_interp_nonmon.f
	REAL(10) QZ(NQ,LIN_END),QZR(NX)								   |		REAL*8 QZ(NQ,LIN_END),QZR(NX)
	REAL(10) VARRAY(NV,LIN_END),R(ND)							   |		REAL*8 VARRAY(NV,LIN_END),R(ND)
	REAL(10) S(ND)		!Slopes								   |		REAL*8 S(ND)		!Slopes
	REAL(10) H(ND)										   |		REAL*8 H(ND)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) RMIN,RMAX									   |		REAL*8 RMIN,RMAX
	REAL(10) A(ND)										   |		REAL*8 A(ND)
	REAL(10) B(ND)										   |		REAL*8 B(ND)
	REAL(10) C(ND)										   |		REAL*8 C(ND)
	REAL(10) D(ND)		!Used for derivative at I.					   |		REAL*8 D(ND)		!Used for derivative at I.
	REAL(10) E(ND)										   |		REAL*8 E(ND)
	REAL(10) SGN										   |		REAL*8 SGN
./subs/mon_int_funs_v2.f
	REAL(10) COEF(ND,4)									   |		REAL*8 COEF(ND,4)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) H(ND)			!Delta R [ R(I+1)-R(I) ]				   |		REAL*8 H(ND)			!Delta R [ R(I+1)-R(I) ]
	REAL(10) S(ND)			!Slope in interval (I to I+1)				   |		REAL*8 S(ND)			!Slope in interval (I to I+1)
	REAL(10) D(ND)			!First derivative at node I				   |		REAL*8 D(ND)			!First derivative at node I
./subs/mon_int_ins_v1.f
	REAL(10) CHI_INS(ND-1,NINS)								   |		REAL*8 CHI_INS(ND-1,NINS)
	REAL(10) R_INS(ND-1,NINS)								   |		REAL*8 R_INS(ND-1,NINS)
	REAL(10) dCHIdR_INS(ND-1,NINS)								   |		REAL*8 dCHIdR_INS(ND-1,NINS)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) dCHIdR(ND)									   |		REAL*8 dCHIdR(ND)
	REAL(10) X(ND)			!Revised R array					   |		REAL*8 X(ND)			!Revised R array
	REAL(10) Y(ND)			!Revised CHI array					   |		REAL*8 Y(ND)			!Revised CHI array
	REAL(10) H(ND)			!Delta R [ R(I+1)-R(I) ]				   |		REAL*8 H(ND)			!Delta R [ R(I+1)-R(I) ]
	REAL(10) S(ND)			!Slope in interval (I to I+1)				   |		REAL*8 S(ND)			!Slope in interval (I to I+1)
	REAL(10) D(ND)			!First derivative at node I				   |		REAL*8 D(ND)			!First derivative at node I
	REAL(10) COEF(ND,4)									   |		REAL*8 COEF(ND,4)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) DELR										   |		REAL*8 DELR
./subs/monotonic_integrate.f
	REAL(10) INTEGRAL(ND)									   |		REAL*8 INTEGRAL(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) ONE										   |		REAL*8 ONE
	REAL(10) H(ND)			!Delta R [ R(I+1)-R(I) ]				   |		REAL*8 H(ND)			!Delta R [ R(I+1)-R(I) ]
	REAL(10) S(ND)			!Slope in interval (I to I+1)				   |		REAL*8 S(ND)			!Slope in interval (I to I+1)
	REAL(10) D(ND)			!First derivative at node I				   |		REAL*8 D(ND)			!First derivative at node I
./subs/mult2d.f
	REAL(10) FB(ND,ND,NM),TB(NI),W(NI,NI,NM)						   |		REAL*8 FB(ND,ND,NM),TB(NI),W(NI,NI,NM)
./subs/multvec.f
	REAL(10) FA(NI),ESEC(NI),RJ(NI),ZETA(NI)						   |		REAL*8 FA(NI),ESEC(NI),RJ(NI),ZETA(NI)
./subs/nagminsol.f
	REAL(10) BA(NV,NV,ND,ND),STEQ(NV,ND)							   |		REAL*8 BA(NV,NV,ND,ND),STEQ(NV,ND)
	REAL(10) ABT(NV*NV*ND),FQ(NV*ND)							   |		REAL*8 ABT(NV*NV*ND),FQ(NV*ND)
	REAL(10) DP										   |		REAL*8 DP
./subs/newgsit.f
	REAL(10) BA(NV,NV,ND,ND),STEQ(NV,ND),PIVOT(NV,ND)					   |		REAL*8 BA(NV,NV,ND,ND),STEQ(NV,ND),PIVOT(NV,ND)
	REAL(10) FQ(NV,ND),TBA(NV,NV,ND),REPA							   |		REAL*8 FQ(NV,ND),TBA(NV,NV,ND),REPA
	REAL(10) RELAX										   |		REAL*8 RELAX
	REAL(10) WXX(NV)									   |		REAL*8 WXX(NV)
./subs/newjsold.f
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),WM(ND,ND)						   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),WM(ND,ND)
	REAL(10) FB(ND,ND),RJ(ND),DTAU(ND),R(ND),Z(ND),ZETA(ND)					   |		REAL*8 FB(ND,ND),RJ(ND),DTAU(ND),R(ND),Z(ND),ZETA(ND)
	REAL(10) THETA(ND),CHI(ND),dCHIdr(ND),AQW(ND,NP),P(NP)					   |		REAL*8 THETA(ND),CHI(ND),dCHIdr(ND),AQW(ND,NP),P(NP)
	REAL(10) DBB,IC										   |		REAL*8 DBB,IC
	REAL(10) DBC,IBOUND,TOR									   |		REAL*8 DBC,IBOUND,TOR
./subs/newpertjd.f
	REAL(10) F2DA(ND,ND),FC(ND,ND),FB(ND,ND),VK(ND,ND)					   |		REAL*8 F2DA(ND,ND),FC(ND,ND),FB(ND,ND),VK(ND,ND)
	REAL(10) WM(ND,ND),AQW(ND,NP)								   |		REAL*8 WM(ND,ND),AQW(ND,NP)
	REAL(10) DTAU(ND),CHI(ND),dCHIdR(ND)							   |		REAL*8 DTAU(ND),CHI(ND),dCHIdR(ND)
	REAL(10) THETA(ND),SOURCE(ND),FA(ND),R(ND),Z(ND),P(NP)					   |		REAL*8 THETA(ND),SOURCE(ND),FA(ND),R(ND),Z(ND),P(NP)
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),ESEC(ND)						   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),ESEC(ND)
	REAL(10) IC,DBB										   |		REAL*8 IC,DBB
	REAL(10) CONTIG(ND,2*ND+1)								   |		REAL*8 CONTIG(ND,2*ND+1)
	REAL(10) IBOUND,TOR,DBC									   |		REAL*8 IBOUND,TOR,DBC
./subs/new_r_scale_v2.f
	REAL(10) R_NEW(ND)	!New radius grid						   |		REAL*8 R_NEW(ND)	!New radius grid
	REAL(10) R(NI)		!Old radius grid						   |		REAL*8 R(NI)		!Old radius grid
	REAL(10) CHI(NI)		!Opacity						   |		REAL*8 CHI(NI)		!Opacity
	REAL(10) P		!Impact parameter (scaler)					   |		REAL*8 P		!Impact parameter (scaler)
	REAL(10) Z(NI)										   |		REAL*8 Z(NI)
	REAL(10) TAU(NI)									   |		REAL*8 TAU(NI)
	REAL(10) TAU_NEW(ND)									   |		REAL*8 TAU_NEW(ND)
	REAL(10) Z_NEW(ND)									   |		REAL*8 Z_NEW(ND)
	REAL(10) ALPHA,DELR									   |		REAL*8 ALPHA,DELR
	REAL(10) R_MAX,R_BIG,R_SMALL								   |		REAL*8 R_MAX,R_BIG,R_SMALL
	REAL(10) Z_BIG,Z_SMALL									   |		REAL*8 Z_BIG,Z_SMALL
	REAL(10) CHI_BIG,CHI_SMALL								   |		REAL*8 CHI_BIG,CHI_SMALL
	REAL(10) DTAU										   |		REAL*8 DTAU
./subs/newvkimd.f
	REAL(10) W(NI,NI),DTAU(NI),S(NI),U(NI),Z(NI)						   |		REAL*8 W(NI,NI),DTAU(NI),S(NI),U(NI),Z(NI)
	REAL(10) R(ND),RKI(ND),DBC								   |		REAL*8 R(ND),RKI(ND),DBC
	REAL(10) ALPHA,BETA									   |		REAL*8 ALPHA,BETA
./subs/newwmat.f
	REAL(10) W(NI,NI),DTAU(NI),THETA(NI),TOR						   |		REAL*8 W(NI,NI),DTAU(NI),THETA(NI),TOR
./subs/ngaccel_arb_ord.f
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) PREVRJ(0:NORD+1,ND)								   |		REAL*8 PREVRJ(0:NORD+1,ND)
	REAL(10) CMAT(NORD,NORD)								   |		REAL*8 CMAT(NORD,NORD)
	REAL(10) RHS(NORD)									   |		REAL*8 RHS(NORD)
	REAL(10) WEIGHT(ND)									   |		REAL*8 WEIGHT(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/ngaccel.f
C Revised 02-Feb-1989 - Variables A,B etc made REAL(10). Check for				   |	C Revised 02-Feb-1989 - Variables A,B etc made REAL*8. Check for
	REAL(10) RJ(ND),PREVRJ(4,ND)								   |		REAL*8 RJ(ND),PREVRJ(4,ND)
	REAL(10) A,B,A1,B1,B2,C1,C2,D0,D1,D2,W,DIVISOR						   |		REAL*8 A,B,A1,B1,B2,C1,C2,D0,D1,D2,W,DIVISOR
	REAL(10) DIV1,DIV2,PRECIS,X02AJF							   |		REAL*8 DIV1,DIV2,PRECIS,X02AJF
./subs/nordangqw.f
	REAL(10) QW(ND,NP),R(ND),TA(NP),TB(NP),TC(NP),P(NP)					   |		REAL*8 QW(ND,NP),R(ND),TA(NP),TB(NP),TC(NP),P(NP)
	REAL(10) T1										   |		REAL*8 T1
./subs/nordangqw_v2.f
	REAL(10) QW(ND,NP),R(ND),P(NP)								   |		REAL*8 QW(ND,NP),R(ND),P(NP)
	REAL(10) MU(NP)										   |		REAL*8 MU(NP)
	REAL(10) dMU(NP)									   |		REAL*8 dMU(NP)
	REAL(10) WEIGHT(NP)									   |		REAL*8 WEIGHT(NP)
	REAL(10) PSQ(NP)									   |		REAL*8 PSQ(NP)
	REAL(10) T1										   |		REAL*8 T1
./subs/nordflux.f
C                       EXP etc replaced by GENRIC calls.					   |	C                       DEXP etc replaced by GENRIC calls.
	REAL(10) TA(ND),TB(ND),TC(ND),XM(ND),DTAU(ND),dCHIdr(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),XM(ND),DTAU(ND),dCHIdr(ND)
	REAL(10) R(ND),Z(ND),P(NP),SOURCE(ND),CHI(ND),SOB(ND)					   |		REAL*8 R(ND),Z(ND),P(NP),SOURCE(ND),CHI(ND),SOB(ND)
	REAL(10) HAQW(ND,NP),S1,DBB,IC								   |		REAL*8 HAQW(ND,NP),S1,DBB,IC
	REAL(10) IBOUND,TOR,DBC									   |		REAL*8 IBOUND,TOR,DBC
	REAL(10) E1,E2,E3,PP									   |		REAL*8 E1,E2,E3,PP
./subs/nordtau.f
	REAL(10) DTAU(NI),CHI(NI),Z(NI),R(NI),dCHIdR(NI)					   |		REAL*8 DTAU(NI),CHI(NI),Z(NI),R(NI),dCHIdR(NI)
	REAL(10) CHI(ND),dCHIdR(ND),R(ND),LIM							   |		REAL*8 CHI(ND),dCHIdR(ND),R(ND),LIM
	REAL(10) H(ND),SLOPE(ND)								   |		REAL*8 H(ND),SLOPE(ND)
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
	REAL(10) CHI(ND),dCHIdR(ND),R(ND),LIM							   |		REAL*8 CHI(ND),dCHIdR(ND),R(ND),LIM
	REAL(10) SLOPE(ND),H(ND)								   |		REAL*8 SLOPE(ND),H(ND)
	REAL(10) LIN_SLOPE(ND),LIN_H(ND)							   |		REAL*8 LIN_SLOPE(ND),LIN_H(ND)
	REAL(10) T1,T2,ORIG_dCHIdR								   |		REAL*8 T1,T2,ORIG_dCHIdR
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
./subs/ntrpwgt.f
	REAL(10) X(N),W(N)									   |		REAL*8 X(N),W(N)
	REAL(10) T1,T2,SUM									   |		REAL*8 T1,T2,SUM
	LOGICAL, SAVE :: CHECK=.TRUE.								   |		LOGICAL, SAVE :: CHECK=.FALSE.
./subs/ntrpwgt_v2.f
	REAL(10) X(N),dX(N),W(N)								   |		REAL*8 X(N),dX(N),W(N)
	REAL(10) T1,T2,SUM,XSUM									   |		REAL*8 T1,T2,SUM,XSUM
./subs/nweight.f
	REAL(10) X(N),W(N),H,R,RE,RF,T1,SUM							   |		REAL*8 X(N),W(N),H,R,RE,RF,T1,SUM
./subs/nweight_v2.f
	REAL(10) X(N),dX(N),W(N)								   |		REAL*8 X(N),dX(N),W(N)
	REAL(10) H,R,RE,RF,T1,SUM								   |		REAL*8 H,R,RE,RF,T1,SUM
./subs/occupation_prob.f
	REAL(10) W_C2(NC2,ND)		!Occupation probability					   |		REAL*8 W_C2(NC2,ND)		!Occupation probability
	REAL(10) EDGE_C2(NC2)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE_C2(NC2)		!Ionization frequency (10^15 Hz)
	REAL(10) ZC2			!Charge in ion						   |		REAL*8 ZC2			!Charge in ion
	REAL(10) NEFF,F,Y,BETA,REAL_K,T1							   |		REAL*8 NEFF,F,Y,BETA,REAL_K,T1
	        IF(W_C2(LEV,I) .GT. 0.99999999D0)W_C2(LEV,I)=1.0D0				   <
./subs/omega_gen_v2.f
	REAL(10) OMEGA(NLEV,NLEV),dln_OMEGA_dlnT(NLEV,NLEV)					   |		REAL*8 OMEGA(NLEV,NLEV),dln_OMEGA_dlnT(NLEV,NLEV)
	REAL(10) EIN_A(NLEV,NLEV)		!Einstein A coefficient				   |		REAL*8 EIN_A(NLEV,NLEV)		!Einstein A coefficient
	REAL(10) EDGE(NLEV)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE(NLEV)		!Ionization frequency (10^15 Hz)
	REAL(10) STAT_WT(NLEV)		!Statistical weight.					   |		REAL*8 STAT_WT(NLEV)		!Statistical weight.
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) TEMP	       		!Temperature (10^4 K)					   |		REAL*8 TEMP	       		!Temperature (10^4 K)
	REAL(10), PARAMETER :: THREE=3.0D0							   |		REAL*8, PARAMETER :: THREE=3.0D0
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), SAVE :: T_TABLE(MAX_TVALS)							   |		REAL*8, SAVE :: T_TABLE(MAX_TVALS)
	REAL(10), SAVE :: OMEGA_TABLE(MAX_TAB_SIZE)						   |		REAL*8, SAVE :: OMEGA_TABLE(MAX_TAB_SIZE)
	REAL(10), SAVE :: OMEGA_SET,OMEGA_SCALE							   |		REAL*8, SAVE :: OMEGA_SET,OMEGA_SCALE
	REAL(10) EX_E1X,EX_E1X_FUN								   |		REAL*8 EX_E1X,EX_E1X_FUN
	REAL(10) X,FL,G1,G2,GBAR,dln_GBAR_dlnT,PHOT_CONST					   |		REAL*8 X,FL,G1,G2,GBAR,dln_GBAR_dlnT,PHOT_CONST
	REAL(10) ALPHA										   |		REAL*8 ALPHA
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), PARAMETER :: ZERO=0.0D0							   |		REAL*8, PARAMETER :: ZERO=0.0D0
	REAL(10) PHOT_CROSS(NLEV)								   |		REAL*8 PHOT_CROSS(NLEV)
	  T1=LOG(T_TABLE(L)/T_TABLE(L-1))							   |		  T1=DLOG(T_TABLE(L)/T_TABLE(L-1))
	    ALPHA=LOG(ALPHA)/T1									   |		    ALPHA=DLOG(ALPHA)/T1
./subs/open_dir_acc_v1.f
./subs/par_fun_v2.f
	REAL(10) HE2(N,ND)									   |		REAL*8 HE2(N,ND)
	REAL(10) HE2LTE(N,ND)									   |		REAL*8 HE2LTE(N,ND)
	REAL(10) W_HE2(N,ND)									   |		REAL*8 W_HE2(N,ND)
	REAL(10) DHE2(ND)									   |		REAL*8 DHE2(ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) GHE2(N)									   |		REAL*8 GHE2(N)
	REAL(10) GION,ZION									   |		REAL*8 GION,ZION
	REAL(10) U(ND,NSPEC_MAX),PHI(ND,NSPEC_MAX),ZPFN(NSPEC_MAX),T(ND)			   |		REAL*8 U(ND,NSPEC_MAX),PHI(ND,NSPEC_MAX),ZPFN(NSPEC_MAX),T(ND)
	REAL(10) HIGH_POP(ND)									   |		REAL*8 HIGH_POP(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,RGU									   |		REAL*8 T1,T2,RGU
./subs/par_fun_v3.f
	REAL(10) HE2(N,ND)									   |		REAL*8 HE2(N,ND)
	REAL(10) HE2LTE(N,ND)									   |		REAL*8 HE2LTE(N,ND)
	REAL(10) W_HE2(N,ND)									   |		REAL*8 W_HE2(N,ND)
	REAL(10) DHE2(ND)									   |		REAL*8 DHE2(ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) GHE2(N)									   |		REAL*8 GHE2(N)
	REAL(10) GION,ZION									   |		REAL*8 GION,ZION
	REAL(10) U(ND,NSPEC_MAX)								   |		REAL*8 U(ND,NSPEC_MAX)
	REAL(10) PHI(ND,NSPEC_MAX)								   |		REAL*8 PHI(ND,NSPEC_MAX)
	REAL(10) ZPFN(NSPEC_MAX)								   |		REAL*8 ZPFN(NSPEC_MAX)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) HIGH_POP(ND)									   |		REAL*8 HIGH_POP(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,T3,LOG_RGU								   |		REAL*8 T1,T2,T3,LOG_RGU
	REAL(10) TEXCITE(N)									   |		REAL*8 TEXCITE(N)
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) CONST										   |		REAL*8 CONST
./subs/par_fun_v4.f
	REAL(10) HE2(N,ND)									   |		REAL*8 HE2(N,ND)
	REAL(10) LOG_HE2LTE(N,ND)								   |		REAL*8 LOG_HE2LTE(N,ND)
	REAL(10) W_HE2(N,ND)									   |		REAL*8 W_HE2(N,ND)
	REAL(10) DHE2(ND)									   |		REAL*8 DHE2(ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) GHE2(N)									   |		REAL*8 GHE2(N)
	REAL(10) GION,ZION									   |		REAL*8 GION,ZION
	REAL(10) U(ND,NSPEC_MAX)								   |		REAL*8 U(ND,NSPEC_MAX)
	REAL(10) PHI(ND,NSPEC_MAX)								   |		REAL*8 PHI(ND,NSPEC_MAX)
	REAL(10) ZPFN(NSPEC_MAX)								   |		REAL*8 ZPFN(NSPEC_MAX)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) OLD_T(ND)									   |		REAL*8 OLD_T(ND)
	REAL(10) OLD_ED(ND)									   |		REAL*8 OLD_ED(ND)
	REAL(10) HIGH_POP(ND)									   |		REAL*8 HIGH_POP(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2,T3,LOG_RGU								   |		REAL*8 T1,T2,T3,LOG_RGU
	REAL(10) TEXCITE(N)									   |		REAL*8 TEXCITE(N)
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) CONST										   |		REAL*8 CONST
./subs/pertjfeau_ibc.f
	REAL(10) F2DA(ND,ND),FC(ND,ND),FA(ND),DTAU(ND),CHI(ND),R(ND)				   |		REAL*8 F2DA(ND,ND),FC(ND,ND),FA(ND),DTAU(ND),CHI(ND),R(ND)
	REAL(10) ZETA(ND),THETA(ND),RJ(ND),Q(ND),F(ND)						   |		REAL*8 ZETA(ND),THETA(ND),RJ(ND),Q(ND),F(ND)
	REAL(10) dCHIdR(ND),TA(ND),TB(ND),TC(ND)						   |		REAL*8 dCHIdR(ND),TA(ND),TB(ND),TC(ND)
	REAL(10) DBB,HBC_J,HBC_S,INBC								   |		REAL*8 DBB,HBC_J,HBC_S,INBC
	REAL(10) T1										   |		REAL*8 T1
./subs/phys_con.f
												   >	C Altered 22-Sep-2023: Revised physical constants.
C Altered 29-Apr-1991: ALL routines. REAL(10) now specified in separate				   |	C Altered 29-Apr-1991: ALL routines. REAL*8 now specified in separate
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ELECTRON_VOLT									   |		REAL*8 ELECTRON_VOLT
	ELECTRON_VOLT=1.60217733D-12                    !ergs					   |		ELECTRON_VOLT=1.602176634D-12                    !ergs
	REAL(10) GRAVITATIONAL_CONSTANT								   |		REAL*8 GRAVITATIONAL_CONSTANT
	REAL(10) PLANCKS_CONSTANT								   |		REAL*8 PLANCKS_CONSTANT
	PLANCKS_CONSTANT=6.626075D-27			!erg sec				   |		PLANCKS_CONSTANT=6.62607015D-27			!erg sec
	REAL(10) ATOMIC_MASS_UNIT								   |		REAL*8 ATOMIC_MASS_UNIT
	ATOMIC_MASS_UNIT=1.660540D-24			!gm					   |		ATOMIC_MASS_UNIT=1.6605390666D-24		!gm
	REAL(10) ELECTRON_MASS									   |		REAL*8 ELECTRON_MASS
	ELECTRON_MASS=9.109389D-28			!gm					   |		ELECTRON_MASS=9.1093837015D-28			!gm
												   >		RETURN
												   >		END
												   >	!
												   >		FUNCTION ELECTRON_CHARGE()
												   >		IMPLICIT NONE
												   >		REAL*8 ELECTRON_CHARGE
												   >		ELECTRON_CHARGE=4.80320427E-10                    !esu
	REAL(10) BOLTZMANN_CONSTANT								   |		REAL*8 BOLTZMANN_CONSTANT
	BOLTZMANN_CONSTANT=1.380658D-16			!erg/K					   |		BOLTZMANN_CONSTANT=1.380649D-16			!erg/K
	REAL(10) STEFAN_BOLTZ									   |		REAL*8 STEFAN_BOLTZ
	STEFAN_BOLTZ=5.670400D-05			!ergs/cm^2/K^4				   |		STEFAN_BOLTZ=5.670374419D-05			!ergs/cm^2/K^4
	REAL(10) RYDBERG_INF									   |		REAL*8 RYDBERG_INF
	REAL(10) RYDBERG_HYDROGEN								   |		REAL*8 RYDBERG_HYDROGEN
	REAL(10) RYDBERG_HELIUM									   |		REAL*8 RYDBERG_HELIUM
	REAL(10) RYDBERG_CARBON									   |		REAL*8 RYDBERG_CARBON
	REAL(10) RYDBERG_NITROGEN								   |		REAL*8 RYDBERG_NITROGEN
	REAL(10) RYDBERG_OXYGEN									   |		REAL*8 RYDBERG_OXYGEN
	REAL(10) MASS_SUN									   |		REAL*8 MASS_SUN
	REAL(10) RAD_SUN									   |		REAL*8 RAD_SUN
	REAL(10) LUM_SUN									   |		REAL*8 LUM_SUN
	REAL(10) TEFF_SUN									   |		REAL*8 TEFF_SUN
	REAL(10) PARSEC										   |		REAL*8 PARSEC
	REAL(10) ASTRONOMICAL_UNIT								   |		REAL*8 ASTRONOMICAL_UNIT
	REAL(10) JANSKY										   |		REAL*8 JANSKY
	REAL(10) PI			!Use FUN_PI instead so PI				   |		REAL*8 PI			!Use FUN_PI instead so PI
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
	REAL(10) SECS_IN_YEAR									   |		REAL*8 SECS_IN_YEAR
./subs/poptoion.f
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) HYD(NLEV,ND),DHYD(ND),ED(ND),T(ND)						   |		REAL*8 HYD(NLEV,ND),DHYD(ND),ED(ND),T(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) HYD(NLEV,ND),DHYD(ND),ED(ND),T(ND)						   |		REAL*8 HYD(NLEV,ND),DHYD(ND),ED(ND),T(ND)
./subs/prrr_lowt_v1.f
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) LOG_JB_RAT									   |		REAL*8 LOG_JB_RAT
	REAL(10) H										   |		REAL*8 H
	REAL(10) CHIBF,CHIFF									   |		REAL*8 CHIBF,CHIFF
	REAL(10) HDKT,TWOHCSQ									   |		REAL*8 HDKT,TWOHCSQ
./subs/prrr_lowt_v2.f
												   >	! Altered 24-Sep-2023 : Adjusted constants for consistency.
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) FQW										   |		REAL*8 FQW
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) LOG_JB_RAT									   |		REAL*8 LOG_JB_RAT
	REAL(10) H										   |		REAL*8 H
												   >	        REAL*8 PLANCKS_CONSTANT
												   >	        EXTERNAL PLANCKS_CONSTANT
	REAL(10) CHIBF,CHIFF									   |		REAL*8 CHIBF,CHIFF
	REAL(10) HDKT,TWOHCSQ									   |		REAL*8 HDKT,TWOHCSQ
	REAL(10), ALLOCATABLE, SAVE :: XzVLTE_MIN(:)						   |		REAL*8, ALLOCATABLE, SAVE :: XzVLTE_MIN(:)
        H=6.6261965D-12                                 !ergs/s (*1.0E+15 due to *nu)		   |	        H=PLANCKS_CONSTANT()*1.0D+15                                 !ergs/s (*1.0E+15 due to *n
./subs/prrr_sl_v3.f
	REAL(10) PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)					   |		REAL*8 PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) T2,A1,TMP_HNST,B_RAT								   |		REAL*8 T2,A1,TMP_HNST,B_RAT
	REAL(10) H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ						   |		REAL*8 H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) GFF_VAL(ND)									   |		REAL*8 GFF_VAL(ND)
./subs/prrr_sl_v4.f
	REAL(10) PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)					   |		REAL*8 PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) T2,A1,TMP_HNST,B_RAT								   |		REAL*8 T2,A1,TMP_HNST,B_RAT
	REAL(10) H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ						   |		REAL*8 H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) GFF_VAL(ND)									   |		REAL*8 GFF_VAL(ND)
./subs/prrr_sl_v5.f
	REAL(10) PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)					   |		REAL*8 PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) T2,A1,TMP_HNST,B_RAT								   |		REAL*8 T2,A1,TMP_HNST,B_RAT
	REAL(10) H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ						   |		REAL*8 H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) GFF_VAL(ND)									   |		REAL*8 GFF_VAL(ND)
	REAL*8 PLANCKS_CONSTANT									   <
	EXTERNAL PLANCKS_CONSTANT								   <
./subs/prrr_sl_v6.f
												   >	! Altered 24-Sep-2023 : Adjusted constants for consistency. Some data ouput for checking between
												   >	!                            RE and EHB equations.
	REAL(10) PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)					   |		REAL*8 PR(NLEV,ND),RR(NLEV,ND),BFCR(NLEV,ND),FF(ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),WSE(NLEV,ND),WCR(NLEV,ND)
	REAL(10) DI(N_DI,ND),LOG_DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),LOG_DIST(N_DI,ND)
!												   |	!
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) JREC_CR(ND)									   |		REAL*8 JREC_CR(ND)
	REAL(10) JPHOT_CR(ND)									   |		REAL*8 JPHOT_CR(ND)
	REAL(10) BPHOT_CR(ND)									   |		REAL*8 BPHOT_CR(ND)
	REAL(10) NU										   |		REAL*8 NU
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) POP_SUM,T2,A1,TMP_HNST								   |		REAL*8 POP_SUM,T2,A1,TMP_HNST
	REAL(10) JB_RAT, JC_RAT									   |		REAL*8 JB_RAT, JC_RAT
	REAL(10) H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ						   |		REAL*8 H,ZHYD,CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) GFF_VAL(ND)									   |		REAL*8 GFF_VAL(ND)
	REAL(10) PLANCKS_CONSTANT								   |		REAL*8 PLANCKS_CONSTANT
	H=PLANCKS_CONSTANT()*1.0D+15   		!ergs/s (*1.0E+15 due to *nu)			   |		H=PLANCKS_CONSTANT()*1.0D+15   		 !ergs/s (*1.0E+15 due to *nu)
												   >	!	      IF(J .EQ. 5 .AND. I .EQ. 2)THEN
												   >	!		WRITE(184,*)I,( HNST(I,J)*(WCR(I,J)*JB_RAT+WSE(I,J)*JC_RAT)
												   >	!	1              -HN(I,J)*(WCR(I,J)*JPHOT(J)+WSE(I,J)*JPHOT_CR(J)) )*H,WSE(I,J)
												   >	!	      END IF
!	WRITE(186,'(I5,2X,I3,2X,F5.1,3X,ES16.8,7ES16.6E3)')NLEV,PHOT_ID,ZHYD,NU,WSE(1:2,5),WCR(1   |	!	WRITE(186,'(I5,2X,I3,2X,F5.1,3X,ES16.8,6ES14.6)')NLEV,PHOT_ID,ZHYD,NU,WSE(1:2,5),WCR(1:2
!	WRITE(184,'(I5,2X,I3,2X,F5.1,3X,ES16.8,7ES16.6E3)')NLEV,PHOT_ID,ZHYD,NU,BFCR(1:5,5),SUM(   |	!	WRITE(184,'(I5,2X,I3,2X,F5.1,3X,ES16.8,6ES14.6)')NLEV,PHOT_ID,ZHYD,NU,BFCR(1:5,5),SUM(BF
												   >	!	  WRITE(185,*)NU,FF(5)
./subs/qfromf.f
C Altered 26-May-1996 - GENERIC calls now used for LOG and DEXp					   |	C Altered 26-May-1996 - GENERIC calls now used for DLOG and DEXp
	REAL(10) F(ND),Q(ND),R(ND),TA(ND),TB(ND)						   |		REAL*8 F(ND),Q(ND),R(ND),TA(ND),TB(ND)
	REAL(10), PARAMETER :: TWO=2.0D0							   |		REAL*8, PARAMETER :: TWO=2.0D0
./subs/qkim.f
	REAL(10) Q(NI),QH(NI)									   |		REAL*8 Q(NI),QH(NI)
	REAL(10) GAM(NI),GAMH(NI),TCHI(NI),PF(NLF)						   |		REAL*8 GAM(NI),GAMH(NI),TCHI(NI),PF(NLF)
	REAL(10) DNU										   |		REAL*8 DNU
./subs/quad_multi_v5.f
	REAL(10) WSE_S(N_S,ND)									   |		REAL*8 WSE_S(N_S,ND)
	REAL(10) dWSE_SdT(N_S,ND)								   |		REAL*8 dWSE_SdT(N_S,ND)
	REAL(10) WSE_CR_S(N_S,ND)								   |		REAL*8 WSE_CR_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)			!In 10^15 Hz					   |		REAL*8 EDGE_F(N_F)			!In 10^15 Hz
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CROSS(ND)			!No longer used.				   |		REAL*8 CROSS(ND)			!No longer used.
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) YDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 YDIS(ND)		!Constant for computing level dissolution/
	REAL(10) XDIS(ND)		!Constant for computing level dissolution/		   |		REAL*8 XDIS(ND)		!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)	!Constant appearing in dissolution formula.			   |		REAL*8 DIS_CONST(N_F)	!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)									   |		REAL*8 ALPHA_VEC(N_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) OPLIN,EMLIN									   |		REAL*8 OPLIN,EMLIN
	REAL(10) T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H						   |		REAL*8 T1,T2,T3,ZION_CUBED,NEFF,FOUR_PI_D_H
./subs/quad_x_gen_v4.f
	REAL(10) ZCORE,NUM_ELEC									   |		REAL*8 ZCORE,NUM_ELEC
	REAL(10) WSE(N_S,ND)									   |		REAL*8 WSE(N_S,ND)
	REAL(10) WCR(N_S,ND)									   |		REAL*8 WCR(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) EDGE_B(N_B)									   |		REAL*8 EDGE_B(N_B)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) WEIGHT										   |		REAL*8 WEIGHT
	REAL(10) FOUR_PI_ON_H									   |		REAL*8 FOUR_PI_ON_H
./subs/quad_x_gen_v5.f
	REAL(10) ZCORE,NUM_ELEC									   |		REAL*8 ZCORE,NUM_ELEC
	REAL(10) WSE(N_S,ND)									   |		REAL*8 WSE(N_S,ND)
	REAL(10) WCR(N_S,ND)									   |		REAL*8 WCR(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) HNST_F_ON_S(N_F,ND)								   |		REAL*8 HNST_F_ON_S(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) EDGE_B(N_B)									   |		REAL*8 EDGE_B(N_B)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) WEIGHT										   |		REAL*8 WEIGHT
	REAL(10) FOUR_PI_ON_H									   |		REAL*8 FOUR_PI_ON_H
./subs/quad_x_lit_v3.f
	REAL(10) ZCORE,NUM_ELEC									   |		REAL*8 ZCORE,NUM_ELEC
	REAL(10) WSE(N,ND)									   |		REAL*8 WSE(N,ND)
	REAL(10) NU_CONT									   |		REAL*8 NU_CONT
	REAL(10) XCROSS										   |		REAL*8 XCROSS
	REAL(10) FOUR_PI_ON_H									   |		REAL*8 FOUR_PI_ON_H
	REAL(10) WEIGHT										   |		REAL*8 WEIGHT
./subs/rd_free_val.f
	REAL(10) RD_FREE_VAL									   |		REAL*8 RD_FREE_VAL
./subs/rd_f_to_s_ids.f
./subs/rd_f_to_s_ids_v2.f
./subs/rd_f_to_s_ids_v3.f
./subs/rdgendie_v3.f
	REAL(10) GION			!St. Weight of ion (eg CIII).				   |		REAL*8 GION			!St. Weight of ion (eg CIII).
	REAL(10) EDGEDIE(NMAX)									   |		REAL*8 EDGEDIE(NMAX)
	REAL(10) EINADIE(NMAX)									   |		REAL*8 EINADIE(NMAX)
	REAL(10) GUPDIE(NMAX)									   |		REAL*8 GUPDIE(NMAX)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) A10,A20,A30									   |		REAL*8 A10,A20,A30
	REAL(10) A1,A2,A3,M1,M2,M3		!Effective recombination rate.			   |		REAL*8 A1,A2,A3,M1,M2,M3		!Effective recombination rate.
	REAL(10) WIA1,WIA2,WIA3,WIM1,WIM2,WIM3    !(included and missing).			   |		REAL*8 WIA1,WIA2,WIA3,WIM1,WIM2,WIM3    !(included and missing).
	REAL(10) RD_FREE_VAL									   |		REAL*8 RD_FREE_VAL
./subs/rdgendie_v4.f
	REAL(10) GION			!St. Weight of ion (eg CIII).				   |		REAL*8 GION			!St. Weight of ion (eg CIII).
	REAL(10) EDGEDIE(NMAX)									   |		REAL*8 EDGEDIE(NMAX)
	REAL(10) EINADIE(NMAX)									   |		REAL*8 EINADIE(NMAX)
	REAL(10) GUPDIE(NMAX)									   |		REAL*8 GUPDIE(NMAX)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) A10,A20,A30									   |		REAL*8 A10,A20,A30
	REAL(10) A1,A2,A3,M1,M2,M3		!Effective recombination rate.			   |		REAL*8 A1,A2,A3,M1,M2,M3		!Effective recombination rate.
	REAL(10) WIA1,WIA2,WIA3,WIM1,WIM2,WIM3    !(included and missing).			   |		REAL*8 WIA1,WIA2,WIA3,WIM1,WIM2,WIM3    !(included and missing).
	REAL(10) RD_FREE_VAL									   |		REAL*8 RD_FREE_VAL
./subs/rd_log.f
C 24-Mar-1993 : Created - Based on routines in RLOG.						   |	C 24-Mar-1993 : Created - Based on routines in RDLOG.
	REAL(10) VALUE										   |		REAL*8 VALUE
./subs/rd_sol_abund_scale.f
	REAL(10) AT_MASS(NSPEC)									   |		REAL*8 AT_MASS(NSPEC)
	REAL(10) AT_NO(NSPEC)									   |		REAL*8 AT_NO(NSPEC)
	REAL(10) SOL_ABUND_HSCL(NSPEC)								   |		REAL*8 SOL_ABUND_HSCL(NSPEC)
	REAL(10) SOL_MASS_FRAC(NSPEC)								   |		REAL*8 SOL_MASS_FRAC(NSPEC)
	REAL(10) ABUND(MAX_N_ABUND)								   |		REAL*8 ABUND(MAX_N_ABUND)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LOCAL_AT_NO									   |		REAL*8 LOCAL_AT_NO
	REAL(10) LOC_AT_MASS									   |		REAL*8 LOC_AT_MASS
./subs/rd_t_ed.f
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/readba.f
	REAL(10) BA(NT),STEQ(NS)								   |		REAL*8 BA(NT),STEQ(NS)
./subs/regrid_b_on_ne.f
	SUBROUTINE REGRID_B_ON_NE(DHEN,ED,ION,ELOG,N,NST,NFIN,ND,				   |		SUBROUTINE REGRID_B_ON_NE(DHEN,ED,ION,EDLOG,N,NST,NFIN,ND,
	REAL(10) DHEN(2-NST:N-NST+1,ND),ED(ND),ION(ND),ELOG(ND)					   |		REAL*8 DHEN(2-NST:N-NST+1,ND),ED(ND),ION(ND),EDLOG(ND)
	REAL(10), ALLOCATABLE :: HYD(:,:)							   |		REAL*8, ALLOCATABLE :: HYD(:,:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: OLDION(:)							   |		REAL*8, ALLOCATABLE :: OLDION(:)
	REAL(10) CONST,TSTAROLD,RPOLD								   |		REAL*8 CONST,TSTAROLD,RPOLD
	REAL(10) ION_FRAC,VEL,OLD_CLUMP_FAC							   |		REAL*8 ION_FRAC,VEL,OLD_CLUMP_FAC
	  ELOG(I)=LOG(ED(I))									   |		  EDLOG(I)=LOG(ED(I))
	DO WHILE (ELOG(NXST) .LT. OLDED(1))							   |		DO WHILE (EDLOG(NXST) .LT. OLDED(1))
	DO WHILE (ELOG(NX_END) .GT. OLDED(NDOLD))						   |		DO WHILE (EDLOG(NX_END) .GT. OLDED(NDOLD))
	  CALL LINPOP(ELOG(NXST),TA(NXST),NX,OLDED,TB,NDOLD)					   |		  CALL LINPOP(EDLOG(NXST),TA(NXST),NX,OLDED,TB,NDOLD)
	      DHEN(J,I)=EXP(TB(3)+(ELOG(I)-OLDED(3))						   |		      DHEN(J,I)=EXP(TB(3)+(EDLOG(I)-OLDED(3))
	CALL LINPOP(ELOG(NXST),ION(NXST),NX,OLDED,OLDION,NDOLD)					   |		CALL LINPOP(EDLOG(NXST),ION(NXST),NX,OLDED,OLDION,NDOLD)
	    ION(I)=OLDION(3)+(ELOG(I)-OLDED(3))							   |		    ION(I)=OLDION(3)+(EDLOG(I)-OLDED(3))
./subs/regrid_b_on_sph_tau.f
	REAL(10) DHEN(N,ND)									   |		REAL*8 DHEN(N,ND)
	REAL(10) ION(ND)									   |		REAL*8 ION(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) NEW_ED(ND)									   |		REAL*8 NEW_ED(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10), ALLOCATABLE :: HYD(:,:)							   |		REAL*8, ALLOCATABLE :: HYD(:,:)
	REAL(10), ALLOCATABLE :: ROLD(:)							   |		REAL*8, ALLOCATABLE :: ROLD(:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDTAU(:)							   |		REAL*8, ALLOCATABLE :: OLDTAU(:)
	REAL(10), ALLOCATABLE :: OLDION(:)							   |		REAL*8, ALLOCATABLE :: OLDION(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10) CONST,TSTAROLD,RPOLD								   |		REAL*8 CONST,TSTAROLD,RPOLD
	REAL(10) ION_FRAC,VEL,OLD_CLUMP_FAC							   |		REAL*8 ION_FRAC,VEL,OLD_CLUMP_FAC
	REAL(10) RTAU1,RTAU1_OLD,T1								   |		REAL*8 RTAU1,RTAU1_OLD,T1
./subs/regrid_dchi.f
	REAL(10) F2DA(ND,ND),CHI(ND),T1								   |		REAL*8 F2DA(ND,ND),CHI(ND),T1
	REAL(10) F2DAEXT(NDEXT,NDEXT)								   |		REAL*8 F2DAEXT(NDEXT,NDEXT)
	REAL(10) CHIEXT(NDEXT),COEF(0:3,NDEXT)							   |		REAL*8 CHIEXT(NDEXT),COEF(0:3,NDEXT)
./subs/regrid_h.f
	REAL(10) HNU(ND)		!Returned - Flux on nodes				   |		REAL*8 HNU(ND)		!Returned - Flux on nodes
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) RSQHNU(ND-1)									   |		REAL*8 RSQHNU(ND-1)
	REAL(10) H_OUT		!H flux at outer boundary (from boundary 			   |		REAL*8 H_OUT		!H flux at outer boundary (from boundary 
	REAL(10) H_IN             !H flux at inner boundary.					   |		REAL*8 H_IN             !H flux at inner boundary.
	REAL(10) MIDR(ND)		!Work array						   |		REAL*8 MIDR(ND)		!Work array
./subs/regrid_log_dc_v1.f
												   >	! Altered 21-Aug-2023 - Fixed issue with TR option and rounding.
	REAL(10) DHEN(N,ND)									   |		REAL*8 DHEN(N,ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DI(ND)										   |		REAL*8 DI(ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) POPATOM(ND)									   |		REAL*8 POPATOM(ND)
	REAL(10) CLUMP_FAC(ND)									   |		REAL*8 CLUMP_FAC(ND)
	REAL(10) TAU(ND)									   |		REAL*8 TAU(ND)
	REAL(10) NEW_ED(ND)									   |		REAL*8 NEW_ED(ND)
	REAL(10) NEW_X(ND)									   |		REAL*8 NEW_X(ND)
	REAL(10) NEW_T(ND)									   |		REAL*8 NEW_T(ND)
	REAL(10) LOG_TEN									   |		REAL*8 LOG_TEN
!												   |	!
	REAL(10), ALLOCATABLE :: DPOP(:,:)							   |		REAL*8, ALLOCATABLE :: DPOP(:,:)
	REAL(10), ALLOCATABLE :: OLD_CLUMP_FAC(:)						   |		REAL*8, ALLOCATABLE :: OLD_CLUMP_FAC(:)
	REAL(10), ALLOCATABLE :: OLD_DI(:)							   |		REAL*8, ALLOCATABLE :: OLD_DI(:)
	REAL(10), ALLOCATABLE :: OLD_ED(:)							   |		REAL*8, ALLOCATABLE :: OLD_ED(:)
	REAL(10), ALLOCATABLE :: OLD_R(:)							   |		REAL*8, ALLOCATABLE :: OLD_R(:)
	REAL(10), ALLOCATABLE :: OLD_T(:)							   |		REAL*8, ALLOCATABLE :: OLD_T(:)
	REAL(10), ALLOCATABLE :: OLD_TAU(:)							   |		REAL*8, ALLOCATABLE :: OLD_TAU(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: OLD_X(:)							   |		REAL*8, ALLOCATABLE :: OLD_X(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T_EXCITE,FX,DELTA_T								   |		REAL*8 T_EXCITE,FX,DELTA_T
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMAX,TMIN									   |		REAL*8 TMAX,TMIN
	REAL(10) RTAU1,RTAU1_OLD								   |		REAL*8 RTAU1,RTAU1_OLD
	IF( ABS( TA(NOLD) ) .LT. 0.2D0 .AND. CHECK_DC)DPOP=DPOP+1.0D0				   |		IF( DABS( TA(NOLD) ) .LT. 0.2D0 .AND. CHECK_DC)DPOP=DPOP+1.0D0
	  DPOP=LOG(DPOP)									   |		  DPOP=DLOG(DPOP)
	  IF(ABS(OLD_R(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN					   |		  IF(DABS(OLD_R(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN
	  IF(ABS(OLD_R(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN					   |		  IF(DABS(OLD_R(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN
												   >	! This code may have issues if T is very nomonotonic.
												   >	!
												   >		  OLD_X=LOG(OLD_ED*OLD_CLUMP_FAC)
	    IF(T(I) .LT. TMIN)THEN								   |		    IF(T(I) .LT. TMIN .AND. ABS(LOG(OLD_X(JMIN)/ED(I))) .LT. 1.0D0)THEN
	        IF( (T(I)-OLD_T(J))*(OLD_T(J+1)-T(I)) .GE. 0)THEN				   |		        IF( (T(I)-OLD_T(J))*(OLD_T(J+1)-T(I)) .GE. -1.0D-10)THEN
	            WRITE(6,'(/,A)')'Warning: T at outer boundary outside old model range in REG   |		            WRITE(6,'(/,A)')'Warning: T outside old model range in REGRID_LOG_DC_V1'
	      DPOP(I,J)=LOG(T_EXCITE)								   |		      DPOP(I,J)=DLOG(T_EXCITE)
./subs/regrid_t_ed.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) POPATOM(ND)									   |		REAL*8 POPATOM(ND)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDT(:)							   |		REAL*8, ALLOCATABLE :: OLDT(:)
	REAL(10), ALLOCATABLE :: RLOG(:)							   |		REAL*8, ALLOCATABLE :: RLOG(:)
	REAL(10), ALLOCATABLE :: OLDR(:)							   |		REAL*8, ALLOCATABLE :: OLDR(:)
	REAL(10) RPOLD,T1									   |		REAL*8 RPOLD,T1
	IF(ABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN					   |		IF(DABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN
./subs/regrid_t_ed_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) POPATOM(ND)									   |		REAL*8 POPATOM(ND)
	REAL(10) VOL_EXP_FAC(ND)								   |		REAL*8 VOL_EXP_FAC(ND)
!												   |	!
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDT(:)							   |		REAL*8, ALLOCATABLE :: OLDT(:)
	REAL(10), ALLOCATABLE :: RLOG(:)							   |		REAL*8, ALLOCATABLE :: RLOG(:)
	REAL(10), ALLOCATABLE :: OLDR(:)							   |		REAL*8, ALLOCATABLE :: OLDR(:)
	REAL(10) RPOLD,T1									   |		REAL*8 RPOLD,T1
	IF(ABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN					   |		IF(DABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN
./subs/regrid_t_ed_v3.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) POPATOM(ND)									   |		REAL*8 POPATOM(ND)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDT(:)							   |		REAL*8, ALLOCATABLE :: OLDT(:)
	REAL(10), ALLOCATABLE :: RLOG(:)							   |		REAL*8, ALLOCATABLE :: RLOG(:)
	REAL(10), ALLOCATABLE :: OLDR(:)							   |		REAL*8, ALLOCATABLE :: OLDR(:)
	REAL(10) RPOLD,T1									   |		REAL*8 RPOLD,T1
	  IF(ABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN					   |		  IF(DABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN
./subs/regrid_tx_r.f
	REAL(10) DHEN(N,ND)									   |		REAL*8 DHEN(N,ND)
	REAL(10) DI(ND)										   |		REAL*8 DI(ND)
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) T_MOD(ND)									   |		REAL*8 T_MOD(ND)
	REAL(10) EDGE(N)									   |		REAL*8 EDGE(N)
	REAL(10) POPATOM(ND)									   |		REAL*8 POPATOM(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10), ALLOCATABLE :: DPOP(:,:)							   |		REAL*8, ALLOCATABLE :: DPOP(:,:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDDI(:)							   |		REAL*8, ALLOCATABLE :: OLDDI(:)
	REAL(10), ALLOCATABLE :: OLDT(:)							   |		REAL*8, ALLOCATABLE :: OLDT(:)
	REAL(10), ALLOCATABLE :: RLOG(:)							   |		REAL*8, ALLOCATABLE :: RLOG(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: TB(:)								   |		REAL*8, ALLOCATABLE :: TB(:)
	REAL(10), ALLOCATABLE :: OLDR(:)							   |		REAL*8, ALLOCATABLE :: OLDR(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) RPOLD,TX,T1,T2									   |		REAL*8 RPOLD,TX,T1,T2
	REAL(10) T_EXCITE									   |		REAL*8 T_EXCITE
	REAL(10) FX										   |		REAL*8 FX
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	IF( ABS( TA(NOLD) ) .LT. 0.2D0 .AND. CHECK_DC)DPOP=DPOP+1.0D0				   |		IF( DABS( TA(NOLD) ) .LT. 0.2D0 .AND. CHECK_DC)DPOP=DPOP+1.0D0
	IF(ABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN					   |		IF(DABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN
./subs/regridwsc.f
C Altered 02-Aug-1994 - PROGRDESC change from INTEGER to REAL(10). Corrects			   |	C Altered 02-Aug-1994 - PROGRDESC change from INTEGER to REAL*8. Corrects
	REAL(10) DHEN(N,ND),R(ND),T(ND),ED(ND),DI(ND),EDGE(N)					   |		REAL*8 DHEN(N,ND),R(ND),T(ND),ED(ND),DI(ND),EDGE(N)
	REAL(10), ALLOCATABLE :: DPOP(:,:)							   |		REAL*8, ALLOCATABLE :: DPOP(:,:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDDI(:)							   |		REAL*8, ALLOCATABLE :: OLDDI(:)
	REAL(10), ALLOCATABLE :: OLDT(:)							   |		REAL*8, ALLOCATABLE :: OLDT(:)
	REAL(10), ALLOCATABLE :: RLOG(:)							   |		REAL*8, ALLOCATABLE :: RLOG(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: OLDR(:)							   |		REAL*8, ALLOCATABLE :: OLDR(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) RPOLD,TX,DELTA_T,T1,ADD1							   |		REAL*8 RPOLD,TX,DELTA_T,T1,ADD1
	IF( ABS( TA(NOLD) ) .LT. 0.2 )ADD1=1.0D0						   |		IF( DABS( TA(NOLD) ) .LT. 0.2 )ADD1=1.0D0
	IF(ABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001)THEN					   |		IF(DABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001)THEN
./subs/regridwsc_v2.f
! Altered 02-Aug-1994 - PROGRDESC change from INTEGER to REAL(10). Corrects			   |	! Altered 02-Aug-1994 - PROGRDESC change from INTEGER to REAL*8. Corrects
	REAL(10) DHEN(N,ND),R(ND),T(ND),ED(ND),DI(ND),EDGE(N)					   |		REAL*8 DHEN(N,ND),R(ND),T(ND),ED(ND),DI(ND),EDGE(N)
	REAL(10), ALLOCATABLE :: DPOP(:,:)							   |		REAL*8, ALLOCATABLE :: DPOP(:,:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDDI(:)							   |		REAL*8, ALLOCATABLE :: OLDDI(:)
	REAL(10), ALLOCATABLE :: OLDT(:)							   |		REAL*8, ALLOCATABLE :: OLDT(:)
	REAL(10), ALLOCATABLE :: RLOG(:)							   |		REAL*8, ALLOCATABLE :: RLOG(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: OLDR(:)							   |		REAL*8, ALLOCATABLE :: OLDR(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) RPOLD,TX,DELTA_T,T1,ADD1,DC_MOD						   |		REAL*8 RPOLD,TX,DELTA_T,T1,ADD1,DC_MOD
	IF( ABS( TA(NOLD) ) .LT. 0.2 .AND. CHECK_DC)ADD1=1.0D0					   |		IF( DABS( TA(NOLD) ) .LT. 0.2 .AND. CHECK_DC)ADD1=1.0D0
	IF(ABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001)THEN					   |		IF(DABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001)THEN
./subs/regridwsc_v3.f
! Altered 02-Aug-1994 - PROGRDESC change from INTEGER to REAL(10). Corrects			   |	! Altered 02-Aug-1994 - PROGRDESC change from INTEGER to REAL*8. Corrects
	REAL(10) DHEN(N,ND),R(ND),T(ND),ED(ND),DI(ND),EDGE(N)					   |		REAL*8 DHEN(N,ND),R(ND),T(ND),ED(ND),DI(ND),EDGE(N)
	REAL(10) POPATOM(ND)									   |		REAL*8 POPATOM(ND)
	REAL(10), ALLOCATABLE :: DPOP(:,:)							   |		REAL*8, ALLOCATABLE :: DPOP(:,:)
	REAL(10), ALLOCATABLE :: OLDED(:)							   |		REAL*8, ALLOCATABLE :: OLDED(:)
	REAL(10), ALLOCATABLE :: OLDDI(:)							   |		REAL*8, ALLOCATABLE :: OLDDI(:)
	REAL(10), ALLOCATABLE :: OLDT(:)							   |		REAL*8, ALLOCATABLE :: OLDT(:)
	REAL(10), ALLOCATABLE :: RLOG(:)							   |		REAL*8, ALLOCATABLE :: RLOG(:)
	REAL(10), ALLOCATABLE :: TA(:)								   |		REAL*8, ALLOCATABLE :: TA(:)
	REAL(10), ALLOCATABLE :: OLDR(:)							   |		REAL*8, ALLOCATABLE :: OLDR(:)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) RPOLD,TX,FX,DELTA_T,T1,T2							   |		REAL*8 RPOLD,TX,FX,DELTA_T,T1,T2
	IF( ABS( TA(NOLD) ) .LT. 0.2D0 .AND. CHECK_DC)DPOP=DPOP+1.0D0				   |		IF( DABS( TA(NOLD) ) .LT. 0.2D0 .AND. CHECK_DC)DPOP=DPOP+1.0D0
	IF(ABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN					   |		IF(DABS(OLDR(NDOLD)/R(ND)-1.0D0) .GT. 0.0001D0)THEN
	    T2=MIN(1.0D0, ABS(LOG(DPOP(J,1)))/ABS(LOG(DPOP(1,1))) )				   |		    T2=MIN(1.0D0, ABS(LOG(DPOP(J,1)))/ABS(DLOG(DPOP(1,1))) )
./subs/rext_coef_v2.f
	REAL(10) REXT(NX),COEF(4,NX),R(ND)							   |		REAL*8 REXT(NX),COEF(4,NX),R(ND)
	REAL(10) DELR,T1,T2,A1,A2,A3,A4								   |		REAL*8 DELR,T1,T2,A1,A2,A3,A4
./subs/rite_asc.f
	REAL(10) CI(NCI,ND),DCI(ND)								   |		REAL*8 CI(NCI,ND),DCI(ND)
./subs/rite_atmdes_v2.f
	REAL(10) ZCI,GIONCI_F									   |		REAL*8 ZCI,GIONCI_F
	REAL(10) MASS_CARB									   |		REAL*8 MASS_CARB
	REAL(10) AT_NO_CARB									   |		REAL*8 AT_NO_CARB
	REAL(10) AT_NO_SAVE									   |		REAL*8 AT_NO_SAVE
./subs/rite_atmdes_v3.f
	REAL(10) ZCI,GIONCI_F									   |		REAL*8 ZCI,GIONCI_F
	REAL(10) MASS_CARB									   |		REAL*8 MASS_CARB
	REAL(10) AT_NO_CARB									   |		REAL*8 AT_NO_CARB
	REAL(10) AT_NO_SAVE									   |		REAL*8 AT_NO_SAVE
./subs/rite_gam_v2.f
	REAL(10) R(ND),ED(ND),T(ND)								   |		REAL*8 R(ND),ED(ND),T(ND)
	REAL(10) POP(ND)									   |		REAL*8 POP(ND)
	REAL(10) GAM(ND)									   |		REAL*8 GAM(ND)
	REAL(10) AT_NO										   |		REAL*8 AT_NO
./subs/rv_sn_model.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) RP										   |		REAL*8 RP
	REAL(10) VCORE										   |		REAL*8 VCORE
	REAL(10) BETA1										   |		REAL*8 BETA1
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) T1,DLNR									   |		REAL*8 T1,DLNR
./subs/rv_sn_model_v2.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) V(ND)										   |		REAL*8 V(ND)
	REAL(10) SIGMA(ND)									   |		REAL*8 SIGMA(ND)
	REAL(10) RMAX										   |		REAL*8 RMAX
	REAL(10) RP										   |		REAL*8 RP
	REAL(10) VCORE										   |		REAL*8 VCORE
	REAL(10) BETA1										   |		REAL*8 BETA1
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) T1,DLNR									   |		REAL*8 T1,DLNR
./subs/s15adf.f
      REAL(10) S15ADF,Y										   |	      REAL*8 S15ADF,Y
      REAL(10) P(5),Q(4),P1(9),Q1(8),P2(6),Q2(5)              					   |	      REAL*8 P(5),Q(4),P1(9),Q1(8),P2(6),Q2(5)              
      REAL(10) XMIN,XLARGE,SQRPI,X,           							   |	      REAL*8 XMIN,XLARGE,SQRPI,X,           
   60 RES = RES*EXP(-XSQ)                                              				   |	   60 RES = RES*DEXP(-XSQ)                                              
./subs/same_n.f
./subs/scale_grey.f
	REAL(10) TGREY(ND)									   |		REAL*8 TGREY(ND)
	REAL(10) TAUROSS(ND)									   |		REAL*8 TAUROSS(ND)
	REAL(10) LOG_TAU(ND)									   |		REAL*8 LOG_TAU(ND)
	REAL(10) SCALE_FAC(ND)									   |		REAL*8 SCALE_FAC(ND)
	REAL(10), ALLOCATABLE :: OLD_TAU(:)							   |		REAL*8, ALLOCATABLE :: OLD_TAU(:)
	REAL(10), ALLOCATABLE :: OLD_SCALE_FAC(:)						   |		REAL*8, ALLOCATABLE :: OLD_SCALE_FAC(:)
./subs/scale_pops.f
	REAL(10) HYD(NHYD,ND),DHYD(ND),POPHYD(ND),SUM(ND)					   |		REAL*8 HYD(NHYD,ND),DHYD(ND),POPHYD(ND),SUM(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/scr_read_v2.f
	REAL(10) R(ND),V(ND),SIGMA(ND),POPS(NT*ND)						   |		REAL*8 R(ND),V(ND),SIGMA(ND),POPS(NT*ND)
	REAL(10) RVSIG_VEC(3*ND)								   |		REAL*8 RVSIG_VEC(3*ND)
	REAL(10) R(ND),V(ND),SIGMA(ND),POPS(NT*ND)						   |		REAL*8 R(ND),V(ND),SIGMA(ND),POPS(NT*ND)
	REAL(10) RVSIG_VEC(3*ND)								   |		REAL*8 RVSIG_VEC(3*ND)
	REAL(10) R(ND),V(ND),SIGMA(ND),POPS(NT*ND)						   |		REAL*8 R(ND),V(ND),SIGMA(ND),POPS(NT*ND)
	REAL(10) RVSIG_VEC(3*ND)								   |		REAL*8 RVSIG_VEC(3*ND)
./subs/set_acc_dmu.f
	REAL(10) X(N),dX(N)									   |		REAL*8 X(N),dX(N)
	REAL(10) P(N),RVAL									   |		REAL*8 P(N),RVAL
	REAL(10) A(8)										   |		REAL*8 A(8)
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./subs/set_case.f
./subs/set_cont_freq.f
	REAL(10) FREQ(NCF_MAX),NEW_FREQ(NCF_MAX)						   |		REAL*8 FREQ(NCF_MAX),NEW_FREQ(NCF_MAX)
	REAL(10) MAX_FREQ		!Maximum continuum frequency				   |		REAL*8 MAX_FREQ		!Maximum continuum frequency
	REAL(10) MIN_FREQ		!Minimum continuum frequency				   |		REAL*8 MIN_FREQ		!Minimum continuum frequency
	REAL(10) DNU_MAX		! Twice the maximum frequency spacing near/above	   |		REAL*8 DNU_MAX		! Twice the maximum frequency spacing near/above
	REAL(10) BIG_AMP  	!Amplification. dNU increases by a factor			   |		REAL*8 BIG_AMP  	!Amplification. dNU increases by a factor
   	REAL(10) SMALL_RAT	!Used to define frequency spacing for				   |	   	REAL*8 SMALL_RAT	!Used to define frequency spacing for
	REAL(10) dV_LEV			!Spacing near b-f edge.					   |		REAL*8 dV_LEV			!Spacing near b-f edge.
	REAL(10) AMP_DIS			!Amplification factor for dNU as we		   |		REAL*8 AMP_DIS			!Amplification factor for dNU as we
	REAL(10) MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies		   |		REAL*8 MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies
        REAL(10), PARAMETER :: RZERO=0.0D0							   |	        REAL*8, PARAMETER :: RZERO=0.0D0
        REAL(10), PARAMETER :: RHALF=0.5D0							   |	        REAL*8, PARAMETER :: RHALF=0.5D0
        REAL(10), PARAMETER :: RONE=1.0D0							   |	        REAL*8, PARAMETER :: RONE=1.0D0
        REAL(10), PARAMETER :: RTWO=2.0D0							   |	        REAL*8, PARAMETER :: RTWO=2.0D0
	REAL(10) T1,dV_NEW,dV									   |		REAL*8 T1,dV_NEW,dV
	REAL(10) FAC,EQUAL_FAC									   |		REAL*8 FAC,EQUAL_FAC
	REAL(10) UP,LOW,DELF,DIFF,RAT,SWITCH_FREQ						   |		REAL*8 UP,LOW,DELF,DIFF,RAT,SWITCH_FREQ
./subs/set_cont_freq_v2.f
	REAL(10) EDGE(NCF_MAX)									   |		REAL*8 EDGE(NCF_MAX)
	REAL(10) NEW_FREQ(NCF_MAX)								   |		REAL*8 NEW_FREQ(NCF_MAX)
	REAL(10) MAX_FREQ		!Maximum continuum frequency				   |		REAL*8 MAX_FREQ		!Maximum continuum frequency
	REAL(10) MIN_FREQ		!Minimum continuum frequency				   |		REAL*8 MIN_FREQ		!Minimum continuum frequency
	REAL(10) DNU_MAX		!Maximum frequency spacing near/above			   |		REAL*8 DNU_MAX		!Maximum frequency spacing near/above
	REAL(10) BIG_AMP  	!Amplification. dNU increases by a factor			   |		REAL*8 BIG_AMP  	!Amplification. dNU increases by a factor
   	REAL(10) SMALL_RAT	!Used to define frequency spacing for				   |	   	REAL*8 SMALL_RAT	!Used to define frequency spacing for
	REAL(10) dV_LEV			!Spacing near b-f edge.					   |		REAL*8 dV_LEV			!Spacing near b-f edge.
	REAL(10) AMP_DIS			!Amplification factor for dNU as we		   |		REAL*8 AMP_DIS			!Amplification factor for dNU as we
	REAL(10) MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies		   |		REAL*8 MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies
	REAL(10) dV_DOP			!Minimum spacing in Doppler line profiles		   |		REAL*8 dV_DOP			!Minimum spacing in Doppler line profiles
	REAL(10) dV_CONT                  !Maximum spacing in arbitrary section of 		   |		REAL*8 dV_CONT                  !Maximum spacing in arbitrary section of 
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) RN										   |		REAL*8 RN
	REAL(10) COINCIDENT_FRAC								   |		REAL*8 COINCIDENT_FRAC
	REAL(10) DEL_NU										   |		REAL*8 DEL_NU
	REAL(10) DEL_NU_TO_NEXT_EDGE								   |		REAL*8 DEL_NU_TO_NEXT_EDGE
	REAL(10) FAC,EQUAL_FAC									   |		REAL*8 FAC,EQUAL_FAC
	REAL(10) SWITCH_FREQ									   |		REAL*8 SWITCH_FREQ
./subs/set_cont_freq_v3.f
	REAL(10) FREQ(NCF_MAX),NEW_FREQ(NCF_MAX)						   |		REAL*8 FREQ(NCF_MAX),NEW_FREQ(NCF_MAX)
	REAL(10) MAX_FREQ		!Maximum continuum frequency				   |		REAL*8 MAX_FREQ		!Maximum continuum frequency
	REAL(10) MIN_FREQ		!Minimum continuum frequency				   |		REAL*8 MIN_FREQ		!Minimum continuum frequency
	REAL(10) DNU_MAX		! Twice the maximum frequency spacing near/above	   |		REAL*8 DNU_MAX		! Twice the maximum frequency spacing near/above
	REAL(10) BIG_AMP  	!Amplification. dNU increases by a factor			   |		REAL*8 BIG_AMP  	!Amplification. dNU increases by a factor
   	REAL(10) SMALL_RAT	!Used to define frequency spacing for				   |	   	REAL*8 SMALL_RAT	!Used to define frequency spacing for
	REAL(10) dV_LEV			!Spacing near b-f edge.					   |		REAL*8 dV_LEV			!Spacing near b-f edge.
	REAL(10) AMP_DIS			!Amplification factor for dNU as we		   |		REAL*8 AMP_DIS			!Amplification factor for dNU as we
	REAL(10) MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies		   |		REAL*8 MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies
	REAL(10) DELV_CONT									   |		REAL*8 DELV_CONT
	REAL(10) DELV_XRAY									   |		REAL*8 DELV_XRAY
	REAL(10) NU_END_XRAY									   |		REAL*8 NU_END_XRAY
C												   |	C
        REAL(10), PARAMETER :: RZERO=0.0D0							   |	        REAL*8, PARAMETER :: RZERO=0.0D0
        REAL(10), PARAMETER :: RHALF=0.5D0							   |	        REAL*8, PARAMETER :: RHALF=0.5D0
        REAL(10), PARAMETER :: RONE=1.0D0							   |	        REAL*8, PARAMETER :: RONE=1.0D0
        REAL(10), PARAMETER :: RTWO=2.0D0							   |	        REAL*8, PARAMETER :: RTWO=2.0D0
	REAL(10) T1,dV_NEW,dV									   |		REAL*8 T1,dV_NEW,dV
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) FAC,EQUAL_FAC									   |		REAL*8 FAC,EQUAL_FAC
	REAL(10) UP,LOW,DELF,DIFF,RAT,SWITCH_FREQ						   |		REAL*8 UP,LOW,DELF,DIFF,RAT,SWITCH_FREQ
./subs/set_cont_freq_v4.f
	REAL(10) FREQ(NCF_MAX),NEW_FREQ(NCF_MAX)						   |		REAL*8 FREQ(NCF_MAX),NEW_FREQ(NCF_MAX)
	REAL(10) MAX_FREQ		!Maximum continuum frequency				   |		REAL*8 MAX_FREQ		!Maximum continuum frequency
	REAL(10) MIN_FREQ		!Minimum continuum frequency				   |		REAL*8 MIN_FREQ		!Minimum continuum frequency
	REAL(10) DNU_MAX		! Twice the maximum frequency spacing near/above	   |		REAL*8 DNU_MAX		! Twice the maximum frequency spacing near/above
	REAL(10) BIG_AMP  	!Amplification. dNU increases by a factor			   |		REAL*8 BIG_AMP  	!Amplification. dNU increases by a factor
   	REAL(10) SMALL_RAT	!Used to define frequency spacing for				   |	   	REAL*8 SMALL_RAT	!Used to define frequency spacing for
	REAL(10) dV_LEV			!Spacing near b-f edge.					   |		REAL*8 dV_LEV			!Spacing near b-f edge.
	REAL(10) AMP_DIS			!Amplification factor for dNU as we		   |		REAL*8 AMP_DIS			!Amplification factor for dNU as we
	REAL(10) MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies		   |		REAL*8 MIN_FREQ_LEV_DIS		!Indicates that the extra frequencies
	REAL(10) DELV_CONT									   |		REAL*8 DELV_CONT
	REAL(10) DELV_XRAY									   |		REAL*8 DELV_XRAY
	REAL(10) NU_END_XRAY									   |		REAL*8 NU_END_XRAY
!												   |	!
        REAL(10), PARAMETER :: RZERO=0.0D0							   |	        REAL*8, PARAMETER :: RZERO=0.0D0
        REAL(10), PARAMETER :: RHALF=0.5D0							   |	        REAL*8, PARAMETER :: RHALF=0.5D0
        REAL(10), PARAMETER :: RONE=1.0D0							   |	        REAL*8, PARAMETER :: RONE=1.0D0
        REAL(10), PARAMETER :: RTWO=2.0D0							   |	        REAL*8, PARAMETER :: RTWO=2.0D0
	REAL(10) T1,T2,dV_NEW,dV								   |		REAL*8 T1,T2,dV_NEW,dV
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) FAC,EQUAL_FAC									   |		REAL*8 FAC,EQUAL_FAC
	REAL(10) UP,LOW,DELF,DIFF,RAT,SWITCH_FREQ						   |		REAL*8 UP,LOW,DELF,DIFF,RAT,SWITCH_FREQ
./subs/set_dc_lte.f
	REAL(10) XzVLTE(NXzV,ND)								   |		REAL*8 XzVLTE(NXzV,ND)
	REAL(10) DXzV(ND)									   |		REAL*8 DXzV(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) EDGE(NXzV)									   |		REAL*8 EDGE(NXzV)
	REAL(10) TMIN										   |		REAL*8 TMIN
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./subs/set_dc_lte_v2.f
	REAL(10) XzVLTE(NXzV,ND)								   |		REAL*8 XzVLTE(NXzV,ND)
	REAL(10) DXzV(ND)									   |		REAL*8 DXzV(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) EDGE(NXzV)									   |		REAL*8 EDGE(NXzV)
	REAL(10) TMIN										   |		REAL*8 TMIN
        REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |	        REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) TMIN_LOC									   |		REAL*8 TMIN_LOC
./subs/set_edge_freq_v2.f
	REAL(10) FREQ(NCF_MAX)									   |		REAL*8 FREQ(NCF_MAX)
	REAL(10) EDGEHI_F(NHI_F)								   |		REAL*8 EDGEHI_F(NHI_F)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10), PARAMETER :: ZERO=0.0D0							   |		REAL*8, PARAMETER :: ZERO=0.0D0
	REAL(10) PHOT_CROSS(NHI_F)								   |		REAL*8 PHOT_CROSS(NHI_F)
	REAL(10) EDGE_FREQ(NHI_F)								   |		REAL*8 EDGE_FREQ(NHI_F)
./subs/set_gf_values_small.f
	REAL(10) VEC_OSCIL(N_LINE_FREQ)								   |		REAL*8 VEC_OSCIL(N_LINE_FREQ)
	REAL(10) VEC_EINA(N_LINE_FREQ)								   |		REAL*8 VEC_EINA(N_LINE_FREQ)
	REAL(10) WAVE,FREQ,ANG_TO_HZ,T1								   |		REAL*8 WAVE,FREQ,ANG_TO_HZ,T1
	REAL(10) LAM_VAC,SPEED_OF_LIGHT								   |		REAL*8 LAM_VAC,SPEED_OF_LIGHT
./subs/set_gm_all.f
	REAL(10) G_ALL(NT)									   |		REAL*8 G_ALL(NT)
	REAL(10) MASS_ALL(NT)									   |		REAL*8 MASS_ALL(NT)
	REAL(10) GCI(NCI)									   |		REAL*8 GCI(NCI)
	REAL(10) MASS_CARB									   |		REAL*8 MASS_CARB
./subs/set_t_ed_grid.f
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DELTA_T									   |		REAL*8 DELTA_T
	REAL(10) DELTA_ED									   |		REAL*8 DELTA_ED
	REAL(10) ATOM_MIN_VAL,ATOM_MAX_VAL							   |		REAL*8 ATOM_MIN_VAL,ATOM_MAX_VAL
	REAL(10) T_MIN_VAL,T_MAX_VAL								   |		REAL*8 T_MIN_VAL,T_MAX_VAL
./subs/set_x_freq.f
	REAL(10) FREQ(NCF_MAX)									   |		REAL*8 FREQ(NCF_MAX)
	REAL(10) ZCORE,ZION,CON_FAC								   |		REAL*8 ZCORE,ZION,CON_FAC
	REAL(10) EDGE_C(6),EDGE_N(7),EDGE_O(8)							   |		REAL*8 EDGE_C(6),EDGE_N(7),EDGE_O(8)
./subs/set_z_pop.f
	REAL(10) ZPOP(NT),ZHYD									   |		REAL*8 ZPOP(NT),ZHYD
./subs/simq.f
      REAL(10) A(N),B(N)									   |	      REAL*8 A(N),B(N)
      REAL(10) TOL										   |	      REAL*8 TOL
      REAL(10) BIGA										   |	      REAL*8 BIGA
      REAL(10) SAVE										   |	      REAL*8 SAVE
./subs/sobew.f
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)				   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)
	REAL(10) DBB,IC,FL,EW,CONT_FLUX,LINE_FLUX(ND)						   |		REAL*8 DBB,IC,FL,EW,CONT_FLUX,LINE_FLUX(ND)
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)
	REAL(10) GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)						   |		REAL*8 GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)
	REAL(10) EXPONX										   |		REAL*8 EXPONX
	REAL(10) T1,T2,T3,T4,DBC,TOR								   |		REAL*8 T1,T2,T3,T4,DBC,TOR
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) IBOUND										   |		REAL*8 IBOUND
./subs/sobew_grad.f
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) FORCE_MULT(ND)									   |		REAL*8 FORCE_MULT(ND)
	REAL(10) RLUM 										   |		REAL*8 RLUM 
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)				   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)
	REAL(10) DBB,IC,FL,EW,CONT_FLUX,LINE_FLUX(ND)						   |		REAL*8 DBB,IC,FL,EW,CONT_FLUX,LINE_FLUX(ND)
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)
	REAL(10) GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)						   |		REAL*8 GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)
	REAL(10) GLINE(ND)									   |		REAL*8 GLINE(ND)
	REAL(10) EXPONX										   |		REAL*8 EXPONX
	REAL(10) T1,T2,T3,T4,DBC,TOR								   |		REAL*8 T1,T2,T3,T4,DBC,TOR
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) IBOUND										   |		REAL*8 IBOUND
./subs/sobew_grad_v2.f
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) FORCE_MULT(ND)									   |		REAL*8 FORCE_MULT(ND)
	REAL(10) RLUM 										   |		REAL*8 RLUM 
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)				   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)
	REAL(10) DBB,IC,FL,EW,CONT_FLUX,LINE_FLUX(ND)						   |		REAL*8 DBB,IC,FL,EW,CONT_FLUX,LINE_FLUX(ND)
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)
	REAL(10) GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)						   |		REAL*8 GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)
	REAL(10) GLINE(ND)									   |		REAL*8 GLINE(ND)
	REAL(10) EXPONX										   |		REAL*8 EXPONX
	REAL(10) T1,T2,T3,T4,TOR								   |		REAL*8 T1,T2,T3,T4,TOR
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) JFLUX										   |		REAL*8 JFLUX
./subs/sobew_grad_v3.f
	REAL(10) SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 SOURCE(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) FORCE_MULT(ND)									   |		REAL*8 FORCE_MULT(ND)
	REAL(10) RLUM 										   |		REAL*8 RLUM 
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)				   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP),HAQW(ND,NP)
	REAL(10) DBB,IC,FL,CONT_FLUX,LINE_FLUX(ND)						   |		REAL*8 DBB,IC,FL,CONT_FLUX,LINE_FLUX(ND)
	REAL(10) EW, EMISS_EW									   |		REAL*8 EW, EMISS_EW
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)
	REAL(10) GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)						   |		REAL*8 GAM(ND),GAMH(ND),dCHIdR(ND),NOES(ND)
	REAL(10) GLINE(ND),EMISS_LINE_FLUX(ND)							   |		REAL*8 GLINE(ND),EMISS_LINE_FLUX(ND)
	REAL(10) EXPONX										   |		REAL*8 EXPONX
	REAL(10) T1,T2,T3,T4,TOR								   |		REAL*8 T1,T2,T3,T4,TOR
	REAL(10) E1,E2,E3									   |		REAL*8 E1,E2,E3
	REAL(10) IBOUND										   |		REAL*8 IBOUND
	REAL(10) JFLUX										   |		REAL*8 JFLUX
./subs/sobjbar_sim.f
	REAL(10) SOURCE(ND),CHI(ND),CHIL(ND),ETAL(ND)						   |		REAL*8 SOURCE(ND),CHI(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP)						   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP),AQW(ND,NP)
	REAL(10) JBAR(ND)									   |		REAL*8 JBAR(ND)
	REAL(10) BETA(ND)									   |		REAL*8 BETA(ND)
	REAL(10) ZNET(ND,NSIM)									   |		REAL*8 ZNET(ND,NSIM)
	REAL(10) VB(ND,NSIM)									   |		REAL*8 VB(ND,NSIM)
	REAL(10) VC(ND,NSIM)									   |		REAL*8 VC(ND,NSIM)
	REAL(10) VB_2(ND)									   |		REAL*8 VB_2(ND)
	REAL(10) VC_2(ND)									   |		REAL*8 VC_2(ND)
	REAL(10) BETAC(ND,NSIM)									   |		REAL*8 BETAC(ND,NSIM)
C												   |	C
	REAL(10) CHIL_MAT(ND,NSIM)								   |		REAL*8 CHIL_MAT(ND,NSIM)
	REAL(10) ETAL_MAT(ND,NSIM)								   |		REAL*8 ETAL_MAT(ND,NSIM)
	REAL(10) BBCOR(ND,NSIM)									   |		REAL*8 BBCOR(ND,NSIM)
	REAL(10) DBB,IC,FL									   |		REAL*8 DBB,IC,FL
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)					   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),DTAU(ND),Z(ND)
	REAL(10) GAM(ND),GAMH(ND),dCHIdR(ND)							   |		REAL*8 GAM(ND),GAMH(ND),dCHIdR(ND)
	REAL(10) EX_VEC(ND),dEX_VEC(ND)								   |		REAL*8 EX_VEC(ND),dEX_VEC(ND)
	REAL(10) ZNET_BL(ND),BETAC_BL(ND)							   |		REAL*8 ZNET_BL(ND),BETAC_BL(ND)
	REAL(10) VB_BL(ND),VC_BL(ND)								   |		REAL*8 VB_BL(ND),VC_BL(ND)
	REAL(10) ST_ON_SL									   |		REAL*8 ST_ON_SL
	REAL(10) EXPONX,d_EXPONX_dX								   |		REAL*8 EXPONX,d_EXPONX_dX
	REAL(10) T1,T2,DBC,TOR									   |		REAL*8 T1,T2,DBC,TOR
	REAL(10) IBOUND,E1,E2,E3  		!To handle NI=2					   |		REAL*8 IBOUND,E1,E2,E3  		!To handle NI=2
./subs/solveba_v2.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)						   |		REAL*8 BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)
	REAL(10) TBA(NT,NT,ND)				!Working array				   |		REAL*8 TBA(NT,NT,ND)				!Working array
	REAL(10) POPS(NT,ND),REPA,MAXCH,CHANGE_LIM						   |		REAL*8 POPS(NT,ND),REPA,MAXCH,CHANGE_LIM
	REAL(10) WM(NT*ND)									   |		REAL*8 WM(NT*ND)
	REAL(10) PIVOT(NT*ND)									   |		REAL*8 PIVOT(NT*ND)	
	REAL(10) SCALE,MINSCALE,T1,T2,T3,INCREASE,DECREASE					   |		REAL*8 SCALE,MINSCALE,T1,T2,T3,INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./subs/solveba_v3.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)						   |		REAL*8 BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)
	REAL(10) TBA(NT,NT,ND)				!Working array				   |		REAL*8 TBA(NT,NT,ND)				!Working array
	REAL(10) POPS(NT,ND),REPA,MAXCH,CHANGE_LIM						   |		REAL*8 POPS(NT,ND),REPA,MAXCH,CHANGE_LIM
	REAL(10) WM(NT*ND)									   |		REAL*8 WM(NT*ND)
	REAL(10) PIVOT(NT*ND)									   |		REAL*8 PIVOT(NT*ND)	
	REAL(10) SCALE,MINSCALE,T1,T2,T3,INCREASE,DECREASE					   |		REAL*8 SCALE,MINSCALE,T1,T2,T3,INCREASE,DECREASE
	REAL(10) BIG_LIM,LIT_LIM								   |		REAL*8 BIG_LIM,LIT_LIM
./subs/specfy_it_cycle.f
./subs/specify_it_cycle_v2.f
./subs/specify_it_cycle_v3.f
./subs/starfin.f
	REAL(10) R(ND),V(ND),SIGMA(ND)								   |		REAL*8 R(ND),V(ND),SIGMA(ND)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) RMAX,RP1,RN1,VRP1,VINF1							   |		REAL*8 RMAX,RP1,RN1,VRP1,VINF1
	REAL(10) EPS1,GAM1,RP2,RN2,VRP2,VINF2,EPS2,GAM2						   |		REAL*8 EPS1,GAM1,RP2,RN2,VRP2,VINF2,EPS2,GAM2
	REAL(10) VF1,VF2									   |		REAL*8 VF1,VF2
	REAL(10) X,Y,Z										   |		REAL*8 X,Y,Z
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) DLNR,DLT									   |		REAL*8 DLNR,DLT
	REAL(10) ALPHA1,BETA1									   |		REAL*8 ALPHA1,BETA1
./subs/starnew.f
	REAL(10) R(ND),V(ND),SIGMA(ND)								   |		REAL*8 R(ND),V(ND),SIGMA(ND)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) RMAX,RP1,RN1,VRP1,VINF1							   |		REAL*8 RMAX,RP1,RN1,VRP1,VINF1
	REAL(10) EPS1,GAM1,RP2,RN2,VRP2,VINF2,EPS2,GAM2						   |		REAL*8 EPS1,GAM1,RP2,RN2,VRP2,VINF2,EPS2,GAM2
	REAL(10) VF1,VF2									   |		REAL*8 VF1,VF2
	REAL(10) T1,T2,T3,T4									   |		REAL*8 T1,T2,T3,T4
	REAL(10) DLNR,DLT									   |		REAL*8 DLNR,DLT
	REAL(10) ALPHA1,BETA1									   |		REAL*8 ALPHA1,BETA1
	REAL(10) ALPHA2,BETA2									   |		REAL*8 ALPHA2,BETA2
./subs/starpcyg.f
	REAL(10) R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)					   |		REAL*8 R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)
	REAL(10) RMAX,RP,GAMMA,SCLHT,VCORE,VINF,VPHOT,BETA,RPHOT				   |		REAL*8 RMAX,RP,GAMMA,SCLHT,VCORE,VINF,VPHOT,BETA,RPHOT
	REAL(10) T1,DLNR,DLT									   |		REAL*8 T1,DLNR,DLT
./subs/starpcyg_v2.f
	REAL(10) R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)					   |		REAL*8 R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)
	REAL(10) RMAX,RP									   |		REAL*8 RMAX,RP
	REAL(10) SCLHT										   |		REAL*8 SCLHT
	REAL(10) VCORE										   |		REAL*8 VCORE
	REAL(10) VPHOT										   |		REAL*8 VPHOT
	REAL(10) VINF1										   |		REAL*8 VINF1
	REAL(10) BETA1										   |		REAL*8 BETA1
	REAL(10) EPS1										   |		REAL*8 EPS1
	REAL(10) VINF2										   |		REAL*8 VINF2
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) EPS2										   |		REAL*8 EPS2
	REAL(10) RP1,RP2,VEXT									   |		REAL*8 RP1,RP2,VEXT
	REAL(10) V_RAT										   |		REAL*8 V_RAT
	REAL(10) RPHOT										   |		REAL*8 RPHOT
	REAL(10) T1,DLNR,DLT									   |		REAL*8 T1,DLNR,DLT
./subs/starpcyg_v3.f
	REAL(10) R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)					   |		REAL*8 R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)
	REAL(10) RMAX,RP									   |		REAL*8 RMAX,RP
	REAL(10) SCLHT_ON_RP									   |		REAL*8 SCLHT_ON_RP
	REAL(10) VCORE										   |		REAL*8 VCORE
	REAL(10) VPHOT										   |		REAL*8 VPHOT
	REAL(10) VINF1										   |		REAL*8 VINF1
	REAL(10) BETA1										   |		REAL*8 BETA1
	REAL(10) EPS1										   |		REAL*8 EPS1
	REAL(10) VINF2										   |		REAL*8 VINF2
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) EPS2										   |		REAL*8 EPS2
	REAL(10) CONS_FOR_TAU_SCL								   |		REAL*8 CONS_FOR_TAU_SCL
	REAL(10) EXP_FOR_TAU_SCL								   |		REAL*8 EXP_FOR_TAU_SCL
	REAL(10) RP1,RP2,VEXT									   |		REAL*8 RP1,RP2,VEXT
	REAL(10) V_RAT										   |		REAL*8 V_RAT
	REAL(10) SCLHT										   |		REAL*8 SCLHT
	REAL(10) RPHOT										   |		REAL*8 RPHOT
	REAL(10) T1,DLNR,DLT									   |		REAL*8 T1,DLNR,DLT
./subs/starpcyg_v4.f
	REAL(10) R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)					   |		REAL*8 R(ND),V(ND),SIGMA(ND),TA(ND),TB(ND),TC(ND)
	REAL(10) RMAX,RP									   |		REAL*8 RMAX,RP
	REAL(10) SCLHT										   |		REAL*8 SCLHT
	REAL(10) VCORE										   |		REAL*8 VCORE
	REAL(10) VPHOT										   |		REAL*8 VPHOT
	REAL(10) VINF1										   |		REAL*8 VINF1
	REAL(10) BETA1										   |		REAL*8 BETA1
	REAL(10) EPS1										   |		REAL*8 EPS1
	REAL(10) VINF2										   |		REAL*8 VINF2
	REAL(10) BETA2										   |		REAL*8 BETA2
	REAL(10) EPS2										   |		REAL*8 EPS2
        REAL(10) REF_RADIUS 									   |	        REAL*8 REF_RADIUS 
	REAL(10) CONS_FOR_TAU_SCL								   |		REAL*8 CONS_FOR_TAU_SCL
	REAL(10) EXP_FOR_TAU_SCL								   |		REAL*8 EXP_FOR_TAU_SCL
        REAL(10) RP1,RP2,RP3,VEXT								   |	        REAL*8 RP1,RP2,RP3,VEXT
	REAL(10) S1,S2										   |		REAL*8 S1,S2
	REAL(10) V_RAT										   |		REAL*8 V_RAT
	REAL(10) RPHOT										   |		REAL*8 RPHOT
	REAL(10) T1,DLNR,DLT									   |		REAL*8 T1,DLNR,DLT
./subs/starrave.f
	REAL(10) R(ND),V(ND),SIGMA(ND)								   |		REAL*8 R(ND),V(ND),SIGMA(ND)
	REAL(10) RMAX,RP									   |		REAL*8 RMAX,RP
./subs/steq_multi_v3.f
	REAL(10) BA(2-NST:NT-NST+1,2-NST:NT-NST+1,NUM_BNDS,ND)					   |		REAL*8 BA(2-NST:NT-NST+1,2-NST:NT-NST+1,NUM_BNDS,ND)
	REAL(10) SE(2-NST:NT-NST+1,ND)								   |		REAL*8 SE(2-NST:NT-NST+1,ND)
	REAL(10) BAION(NION,2-NST:NT-NST+1,NUM_BNDS,ND),STEQION(NION,ND)			   |		REAL*8 BAION(NION,2-NST:NT-NST+1,NUM_BNDS,ND),STEQION(NION,ND)
	REAL(10) CNM(N_S,N_S),DCNM(N_S,N_S)							   |		REAL*8 CNM(N_S,N_S),DCNM(N_S,N_S)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) DI_S(ND)									   |		REAL*8 DI_S(ND)
C												   |	C
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
C												   |	C
	REAL(10) HN_F(N_F,ND)									   |		REAL*8 HN_F(N_F,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) W_F(N_F,ND)									   |		REAL*8 W_F(N_F,ND)
	REAL(10) A_F(N_F,N_F)									   |		REAL*8 A_F(N_F,N_F)
	REAL(10) FEDGE_F(N_F)									   |		REAL*8 FEDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) POP(ND)		!Population of species.					   |		REAL*8 POP(ND)		!Population of species.
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_VEC_ED(1)									   |		REAL*8 TMP_VEC_ED(1)
	REAL(10) TMP_VEC_COOL(1)								   |		REAL*8 TMP_VEC_COOL(1)
	REAL(10) OMEGA_F(N_F,N_F)								   |		REAL*8 OMEGA_F(N_F,N_F)
	REAL(10) dln_OMEGA_F_dlnT(N_F,N_F)							   |		REAL*8 dln_OMEGA_F_dlnT(N_F,N_F)
./subs/steqne.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND)								   |		REAL*8 BA(NT,NT,NUM_BNDS,ND)
	REAL(10) STEQ(NT,ND),ED(ND)								   |		REAL*8 STEQ(NT,ND),ED(ND)
./subs/storeba.f
	REAL(10) BA(NT),STEQ(NS)								   |		REAL*8 BA(NT),STEQ(NS)
./subs/subcol_multi_v3.f
C                       Bug FIX: COL_FILE was declared REAL(10), NOW declared			   |	C                       Bug FIX: COL_FILE was declared REAL*8, NOW declared
	REAL(10) OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)					   |		REAL*8 OMEGA_F(N_F,N_F),dln_OMEGA_dlnT(N_F,N_F)
	REAL(10) COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)						   |		REAL*8 COL_S(N_S,N_S,ND),DCOL_S(N_S,N_S,ND)
	REAL(10) HN_S(N_S,ND)		!Population of atom with super levels.			   |		REAL*8 HN_S(N_S,ND)		!Population of atom with super levels.
	REAL(10) HNST_S(N_S,ND)		!LTE pop. of atom with super levels.			   |		REAL*8 HNST_S(N_S,ND)		!LTE pop. of atom with super levels.
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
C												   |	C
	REAL(10) HN_F(N_F,ND)		!Population of FULL atom				   |		REAL*8 HN_F(N_F,ND)		!Population of FULL atom
	REAL(10) HNST_F(N_F,ND)		!LTE population of FULL atom				   |		REAL*8 HNST_F(N_F,ND)		!LTE population of FULL atom
	REAL(10) W_F(N_F,ND)		!Occupation probability					   |		REAL*8 W_F(N_F,ND)		!Occupation probability
	REAL(10) AHYD_F(N_F,N_F)		!Einstein A coefficient				   |		REAL*8 AHYD_F(N_F,N_F)		!Einstein A coefficient
	REAL(10) EDGE_F(N_F)		!Ionization frequency (10^15 Hz)			   |		REAL*8 EDGE_F(N_F)		!Ionization frequency (10^15 Hz)
	REAL(10) GHYD_F(N_F)		!Statistical weight.					   |		REAL*8 GHYD_F(N_F)		!Statistical weight.
	REAL(10) ZION			!Charge on ion (i.e. 1 for H)				   |		REAL*8 ZION			!Charge on ion (i.e. 1 for H)
	REAL(10) T(ND)			!Temperature (10^4 K)					   |		REAL*8 T(ND)			!Temperature (10^4 K)
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) COOL(ND)			!Net collisional cooling			   |		REAL*8 COOL(ND)			!Net collisional cooling
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) X										   |		REAL*8 X
	REAL(10) BRAT										   |		REAL*8 BRAT
	REAL(10) CIJ,CJI,CII									   |		REAL*8 CIJ,CJI,CII
./subs/sup_to_full_v3b.f
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature 10^4K					   |		REAL*8 T(ND)			!Temperature 10^4K
	REAL(10) DIC2_S(ND)		!Ion density (Super levels)				   |		REAL*8 DIC2_S(ND)		!Ion density (Super levels)
	REAL(10) DIC2_F(ND)		!Ion density (Full model atom)				   |		REAL*8 DIC2_F(ND)		!Ion density (Full model atom)
	REAL(10) ZC2			!Ion charge						   |		REAL*8 ZC2			!Ion charge
	REAL(10) C2_F(NC2_F,ND)									   |		REAL*8 C2_F(NC2_F,ND)
	REAL(10) C2LTE_F(NC2_F,ND)								   |		REAL*8 C2LTE_F(NC2_F,ND)
	REAL(10) LOG_C2LTE_F(NC2_F,ND)								   |		REAL*8 LOG_C2LTE_F(NC2_F,ND)
	REAL(10) C2LTE_F_ON_S(NC2_F,ND)								   |		REAL*8 C2LTE_F_ON_S(NC2_F,ND)
	REAL(10) W_C2_F(NC2_F,ND)								   |		REAL*8 W_C2_F(NC2_F,ND)
	REAL(10) EDGEC2_F(NC2_F)								   |		REAL*8 EDGEC2_F(NC2_F)
	REAL(10) GC2_F(NC2_F)									   |		REAL*8 GC2_F(NC2_F)
	REAL(10) GIONC2_F									   |		REAL*8 GIONC2_F
	REAL(10) C2_S(NC2_S,ND)									   |		REAL*8 C2_S(NC2_S,ND)
	REAL(10) C2LTE_S(NC2_S,ND)								   |		REAL*8 C2LTE_S(NC2_S,ND)
	REAL(10) LOG_C2LTE_S(NC2_S,ND)								   |		REAL*8 LOG_C2LTE_S(NC2_S,ND)
	REAL(10) EDGECIII_F(NCIII_F)								   |		REAL*8 EDGECIII_F(NCIII_F)
	REAL(10) GCIII_F(NCIII_F)								   |		REAL*8 GCIII_F(NCIII_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), PARAMETER :: MAX_LOG_LTE_POP=600.0D0						   |		REAL*8, PARAMETER :: MAX_LOG_LTE_POP=600.0D0
	REAL(10) B,B1,B2,T1									   |		REAL*8 B,B1,B2,T1
	REAL(10) X,Y,RGU									   |		REAL*8 X,Y,RGU
	REAL(10) GION(ND)									   |		REAL*8 GION(ND)
	REAL(10) EDGE_S(NC2_S)									   |		REAL*8 EDGE_S(NC2_S)	
	REAL(10) SCALE_FAC(NC2_S)								   |		REAL*8 SCALE_FAC(NC2_S)
	REAL(10) SUM(NC2_S)									   |		REAL*8 SUM(NC2_S)
./subs/sup_to_full_v3.f
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature 10^4K					   |		REAL*8 T(ND)			!Temperature 10^4K
	REAL(10) DIC2_S(ND)		!Ion density (Super levels)				   |		REAL*8 DIC2_S(ND)		!Ion density (Super levels)
	REAL(10) DIC2_F(ND)		!Ion density (Full model atom)				   |		REAL*8 DIC2_F(ND)		!Ion density (Full model atom)
	REAL(10) ZC2			!Ion charge						   |		REAL*8 ZC2			!Ion charge
	REAL(10) C2_F(NC2_F,ND)									   |		REAL*8 C2_F(NC2_F,ND)
	REAL(10) C2LTE_F(NC2_F,ND)								   |		REAL*8 C2LTE_F(NC2_F,ND)
	REAL(10) W_C2_F(NC2_F,ND)								   |		REAL*8 W_C2_F(NC2_F,ND)
	REAL(10) EDGEC2_F(NC2_F)								   |		REAL*8 EDGEC2_F(NC2_F)
	REAL(10) GC2_F(NC2_F)									   |		REAL*8 GC2_F(NC2_F)
	REAL(10) GIONC2_F									   |		REAL*8 GIONC2_F
	REAL(10) C2_S(NC2_S,ND)									   |		REAL*8 C2_S(NC2_S,ND)
	REAL(10) C2LTE_S(NC2_S,ND)								   |		REAL*8 C2LTE_S(NC2_S,ND)
	REAL(10) EDGECIII_F(NCIII_F)								   |		REAL*8 EDGECIII_F(NCIII_F)
	REAL(10) GCIII_F(NCIII_F)								   |		REAL*8 GCIII_F(NCIII_F)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) B,B1,B2,T1									   |		REAL*8 B,B1,B2,T1
	REAL(10) X,Y,RGU									   |		REAL*8 X,Y,RGU
	REAL(10) GION(ND)									   |		REAL*8 GION(ND)
	REAL(10) EDGE_S(NC2_S)									   |		REAL*8 EDGE_S(NC2_S)
	REAL(10) SUM(NC2_S)									   |		REAL*8 SUM(NC2_S)
./subs/tau.f
	REAL(10) DTAU(NI),RKI(NI),Z(NI)								   |		REAL*8 DTAU(NI),RKI(NI),Z(NI)
./subs/tcompd.f
	REAL(10) TA(NI),TB(NI),TC(NI),DTAU(NI)							   |		REAL*8 TA(NI),TB(NI),TC(NI),DTAU(NI)
./subs/term_io.f
./subs/tfeau.f
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) R(ND),Q(ND),F(ND),THETA(ND),DTAU(ND),HBC,T1,INBC				   |		REAL*8 R(ND),Q(ND),F(ND),THETA(ND),DTAU(ND),HBC,T1,INBC
./subs/thomas.f
	REAL(10) A(N1),B(N1),C(N1),D(N1,N2)							   |		REAL*8 A(N1),B(N1),C(N1),D(N1,N2)
./subs/thomas_pone.f
	REAL(10) A(N1),B(N1),C(N1),D(N1,N2)							   |		REAL*8 A(N1),B(N1),C(N1),D(N1,N2)
./subs/thomas_rh.f
	REAL(10) A(N1),H(N1),C(N1),D(N1,N2)							   |		REAL*8 A(N1),H(N1),C(N1),D(N1,N2)
	REAL(10) DIV(N1)									   |		REAL*8 DIV(N1)
./subs/torscl.f
	REAL(10) TOR(ND),CHI(ND),R(ND),DTAU(ND),dCHI_dR(ND)					   |		REAL*8 TOR(ND),CHI(ND),R(ND),DTAU(ND),dCHI_dR(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/torscl_v2.f
	REAL(10) TOR(ND),CHI(ND),R(ND),DTAU(ND),dCHI_dR(ND)					   |		REAL*8 TOR(ND),CHI(ND),R(ND),DTAU(ND),dCHI_dR(ND)
	REAL(10) T1										   |		REAL*8 T1
	  T1=LOG(CHI(1)/CHI(INDX))/LOG(R(INDX)/R(1))						   |		  T1=DLOG(CHI(1)/CHI(INDX))/DLOG(R(INDX)/R(1))
./subs/torscl_v3.f
	REAL(10) TOR(ND),CHI(ND),R(ND),DTAU(ND),dCHI_dR(ND)					   |		REAL*8 TOR(ND),CHI(ND),R(ND),DTAU(ND),dCHI_dR(ND)
	REAL(10) T1										   |		REAL*8 T1
	    T1=LOG(CHI(1)/CHI(INDX))/LOG(R(INDX)/R(1))						   |		    T1=DLOG(CHI(1)/CHI(INDX))/DLOG(R(INDX)/R(1))
./subs/transposeba.f
	REAL(10) BA(N,N,ND,ND)									   |		REAL*8 BA(N,N,ND,ND)
	REAL(10) NEWBA(N,ND,N,ND)								   |		REAL*8 NEWBA(N,ND,N,ND)
	REAL(10) TBA(N,N)									   |		REAL*8 TBA(N,N)
	REAL(10) VJ(N,ND,N)									   |		REAL*8 VJ(N,ND,N)
./subs/tst_ins.f
	REAL(10) FREQ(NFREQ_MAX)			!Continuum frequencies			   |		REAL*8 FREQ(NFREQ_MAX)			!Continuum frequencies
	REAL(10) NU_CONT(NCF)		!Continuum frequencies					   |		REAL*8 NU_CONT(NCF)		!Continuum frequencies
	REAL(10) NU_LINE(N_LINES)		!Line frequencies				   |		REAL*8 NU_LINE(N_LINES)		!Line frequencies
	REAL(10) VINF		!Terminal velocity of wind.					   |		REAL*8 VINF		!Terminal velocity of wind.
	REAL(10) V_DOP		!Doppler velocity (km/s).					   |		REAL*8 V_DOP		!Doppler velocity (km/s).
	REAL(10) FRAC_DOP		!Indicates dNU across line in Doppler widths.		   |		REAL*8 FRAC_DOP		!Indicates dNU across line in Doppler widths.
	REAL(10) MAX_DOP		!Half the extent of intrinsic profile			   |		REAL*8 MAX_DOP		!Half the extent of intrinsic profile
	REAL(10) dV_CMF_PROF									   |		REAL*8 dV_CMF_PROF
	REAL(10) dV_CMF_WING									   |		REAL*8 dV_CMF_WING
	REAL(10) ES_WING_ExT									   |		REAL*8 ES_WING_ExT
	REAL(10) R_CMF_WING_EXT									   |		REAL*8 R_CMF_WING_EXT
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/tst_mon.f
	REAL(10) R(ND),CHI(ND)									   |		REAL*8 R(ND),CHI(ND)
	REAL(10) COEF1(ND,4),COEF2(ND,4)							   |		REAL*8 COEF1(ND,4),COEF2(ND,4)
./subs/tst_mon_ins.f
	REAL(10) R(ND),CHI(ND),dCHIdR(ND)							   |		REAL*8 R(ND),CHI(ND),dCHIdR(ND)
	REAL(10) R_INS(ND-1,NINS),CHI_INS(ND-1,NINS),dCHIdR_INS(ND-1,NINS)			   |		REAL*8 R_INS(ND-1,NINS),CHI_INS(ND-1,NINS),dCHIdR_INS(ND-1,NINS)
	REAL(10) X(NINS*ND),Y(NINS*ND)								   |		REAL*8 X(NINS*ND),Y(NINS*ND)
	REAL(10) DELR										   |		REAL*8 DELR
./subs/tst_set_cont.f
	REAL(10) FREQ(NFREQ_MAX)			!Continuum frequencies			   |		REAL*8 FREQ(NFREQ_MAX)			!Continuum frequencies
	REAL(10) EDGE_FREQ(NFREQ_MAX) 								   |		REAL*8 EDGE_FREQ(NFREQ_MAX) 		
	REAL(10) MAX_FREQ									   |		REAL*8 MAX_FREQ
	REAL(10) MIN_FREQ									   |		REAL*8 MIN_FREQ
	REAL(10) SMALL_RAT									   |		REAL*8 SMALL_RAT
	REAL(10) BIG_AMP									   |		REAL*8 BIG_AMP
	REAL(10) DNU_MAX									   |		REAL*8 DNU_MAX
	REAL(10) dV_LEV										   |		REAL*8 dV_LEV
	REAL(10) AMP_DIS									   |		REAL*8 AMP_DIS
	REAL(10) MIN_FREQ_LEV_DIS								   |		REAL*8 MIN_FREQ_LEV_DIS
	REAL(10) dV_DOP										   |		REAL*8 dV_DOP
	REAL(10) dV_CONT									   |		REAL*8 dV_CONT
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
./subs/tst_tri.f
	REAL(10) A(N),B(N),C(N),D(N),F(N)							   |		REAL*8 A(N),B(N),C(N),D(N),F(N)
	REAL(10) X(N),W(N,NRHS),GAM(N),T1							   |		REAL*8 X(N),W(N,NRHS),GAM(N),T1
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) ST_CPU(MAX_IDS)								   |	        REAL*8 ST_CPU(MAX_IDS)
	REAL(10) CPUTOT(MAX_IDS)								   |		REAL*8 CPUTOT(MAX_IDS)
        REAL(10) WALLTOT(MAX_IDS)								   |	        REAL*8 WALLTOT(MAX_IDS)
	REAL(10) CLK_PERIOD,RR0									   |		REAL*8 CLK_PERIOD,RR0
./subs/tst_tri_v.f
	REAL(10) A(N),B(N),C(N),D(N),F(N)							   |		REAL*8 A(N),B(N),C(N),D(N),F(N)
	REAL(10) X(N),W(N,NRHS),GAM(N),T1							   |		REAL*8 X(N),W(N,NRHS),GAM(N),T1
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) ST_CPU(MAX_IDS)								   |	        REAL*8 ST_CPU(MAX_IDS)
	REAL(10) CPUTOT(MAX_IDS)								   |		REAL*8 CPUTOT(MAX_IDS)
        REAL(10) WALLTOT(MAX_IDS)								   |	        REAL*8 WALLTOT(MAX_IDS)
	REAL(10) CLK_PERIOD,RR0									   |		REAL*8 CLK_PERIOD,RR0
	REAL(10) A(N1),B(N1),C(N1),D(N1,N2)							   |		REAL*8 A(N1),B(N1),C(N1),D(N1,N2)
./subs/tst_wr2d.f
	REAL(10) F(N,ND)									   |		REAL*8 F(N,ND)
./subs/tst_wr.f
	REAL(10) F(ND)										   |		REAL*8 F(ND)
./subs/tst_z.f
	REAL(10) A(N)										   |		REAL*8 A(N)
	REAL(10) B(N)										   |		REAL*8 B(N)
	REAL(10) ANS(N)										   |		REAL*8 ANS(N)
./subs/tuvghd.f
	REAL(10) TA(NI),TB(NI),TC(NI),VB(NI),VC(NI),GB(NI)					   |		REAL*8 TA(NI),TB(NI),TC(NI),VB(NI),VC(NI),GB(NI)
	REAL(10) H(NI),U(NI),Q(NI),QH(NI),DTAU(NI)						   |		REAL*8 H(NI),U(NI),Q(NI),QH(NI),DTAU(NI)
./subs/tuvghd_rh.f
	REAL(10) TA(NI),TB(NI),TC(NI),VB(NI),VC(NI),GB(NI),RHS(NI)				   |		REAL*8 TA(NI),TB(NI),TC(NI),VB(NI),VC(NI),GB(NI),RHS(NI)
	REAL(10) H(NI),U(NI),Q(NI),QH(NI),DTAU(NI),SOURCE(NI)					   |		REAL*8 H(NI),U(NI),Q(NI),QH(NI),DTAU(NI),SOURCE(NI)
	REAL(10) DBC,IC										   |		REAL*8 DBC,IC
./subs/undo_it.f
	REAL(10) NEW_POPS(NT,ND)								   |		REAL*8 NEW_POPS(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) OLD_POPS(NT,ND,2)								   |		REAL*8 OLD_POPS(NT,ND,2)
	REAL(10) R_TMP(ND)									   |		REAL*8 R_TMP(ND)
	REAL(10) V_TMP(ND)									   |		REAL*8 V_TMP(ND)
	REAL(10) SIGMA_TMP(ND)									   |		REAL*8 SIGMA_TMP(ND)
	REAL(10) R										   |		REAL*8 R
./subs/ungrid.f
	REAL(10) RJ(ND),RJEXT(NX)								   |		REAL*8 RJ(ND),RJEXT(NX)
./subs/update_gam.f
	REAL(10) GAM(ND),C2(NC2,ND),DC2(ND),ZC2							   |		REAL*8 GAM(ND),C2(NC2,ND),DC2(ND),ZC2
./subs/updateu.f
	REAL(10) TX(NI,NI,NM),TVX(NI-1,NI,NM)							   |		REAL*8 TX(NI,NI,NM),TVX(NI-1,NI,NM)
	REAL(10) KI(NI,3,NM),U(NI),VB(NI),VC(NI)						   |		REAL*8 KI(NI,3,NM),U(NI),VB(NI),VC(NI)
	REAL(10) TA(NI),TB(NI),TC(NI)								   |		REAL*8 TA(NI),TB(NI),TC(NI)
./subs/uptvx_edd.f
	REAL(10) TVX(NI-1,NI,NM)								   |		REAL*8 TVX(NI-1,NI,NM)
	REAL(10) TX(NI,NI,NM)									   |		REAL*8 TX(NI,NI,NM)
	REAL(10) HU(NI),HL(NI),HS(NI)								   |		REAL*8 HU(NI),HL(NI),HS(NI)
	REAL(10) RHS_dHdCHI(NI-1,NI)								   |		REAL*8 RHS_dHdCHI(NI-1,NI)
	REAL(10) DEPTH_PHI(NI)									   |		REAL*8 DEPTH_PHI(NI)
./subs/uptx_edd.f
	REAL(10) TX(NI,NI,NM)									   |		REAL*8 TX(NI,NI,NM)
	REAL(10) TVX(NI-1,NI,NM)								   |		REAL*8 TVX(NI-1,NI,NM)
	REAL(10) KI(NI,NI,NM)									   |		REAL*8 KI(NI,NI,NM)
	REAL(10) TA(NI),TB(NI),TC(NI)								   |		REAL*8 TA(NI),TB(NI),TC(NI)
	REAL(10) U(NI),VB(NI),VC(NI)								   |		REAL*8 U(NI),VB(NI),VC(NI)
./subs/up_tx_tvx_ext_v1.f
	REAL(10) TX(NDEXT,ND,NM_TX)								   |		REAL*8 TX(NDEXT,ND,NM_TX)
	REAL(10) TVX(NDEXT-1,ND,NM_TX)								   |		REAL*8 TVX(NDEXT-1,ND,NM_TX)
	REAL(10) KI(NDEXT,ND,NM_KI)								   |		REAL*8 KI(NDEXT,ND,NM_KI)
	REAL(10) TA(NDEXT),TB(NDEXT),TC(NDEXT)							   |		REAL*8 TA(NDEXT),TB(NDEXT),TC(NDEXT)
	REAL(10) PSIPREV_MOD(NDEXT),VB(NDEXT),VC(NDEXT)						   |		REAL*8 PSIPREV_MOD(NDEXT),VB(NDEXT),VC(NDEXT)
	REAL(10) HU(NDEXT),HL(NDEXT),HS(NDEXT)							   |		REAL*8 HU(NDEXT),HL(NDEXT),HS(NDEXT)
	REAL(10) RHS_dHdCHI(NDEXT-1,ND)								   |		REAL*8 RHS_dHdCHI(NDEXT-1,ND)
	REAL(10) EPS_A(NDEXT),EPS_B(NDEXT)							   |		REAL*8 EPS_A(NDEXT),EPS_B(NDEXT)
	REAL(10) EPS_PREV_A(NDEXT),EPS_PREV_B(NDEXT)						   |		REAL*8 EPS_PREV_A(NDEXT),EPS_PREV_B(NDEXT)
	REAL(10) OLD_TX(NDEXT,ND)								   |		REAL*8 OLD_TX(NDEXT,ND)
./subs/up_tx_tvx.f
	REAL(10) TX(ND,ND,NM_TX)								   |		REAL*8 TX(ND,ND,NM_TX)
	REAL(10) TVX(ND-1,ND,NM_TX)								   |		REAL*8 TVX(ND-1,ND,NM_TX)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) PSIPREV_MOD(ND),VB(ND),VC(ND)							   |		REAL*8 PSIPREV_MOD(ND),VB(ND),VC(ND)
	REAL(10) HU(ND),HL(ND),HS(ND)								   |		REAL*8 HU(ND),HL(ND),HS(ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) EPS_A(ND),EPS_B(ND)								   |		REAL*8 EPS_A(ND),EPS_B(ND)
	REAL(10) EPS_PREV_A(ND),EPS_PREV_B(ND)							   |		REAL*8 EPS_PREV_A(ND),EPS_PREV_B(ND)
	REAL(10) OLD_TX(ND,ND)									   |		REAL*8 OLD_TX(ND,ND)
./subs/up_tx_tvx_noeps.f
	REAL(10) TX(ND,ND,NM_TX)								   |		REAL*8 TX(ND,ND,NM_TX)
	REAL(10) TVX(ND-1,ND,NM_TX)								   |		REAL*8 TVX(ND-1,ND,NM_TX)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) PSIPREV_MOD(ND),VB(ND),VC(ND)							   |		REAL*8 PSIPREV_MOD(ND),VB(ND),VC(ND)
	REAL(10) HU(ND),HL(ND),HS(ND)								   |		REAL*8 HU(ND),HL(ND),HS(ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) OLD_TX(ND,ND)									   |		REAL*8 OLD_TX(ND,ND)
./subs/up_tx_tvx_v2.f
	REAL(10) TX(ND,ND,NM_TX)								   |		REAL*8 TX(ND,ND,NM_TX)
	REAL(10) TVX(ND-1,ND,NM_TX)								   |		REAL*8 TVX(ND-1,ND,NM_TX)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) TA(ND),TB(ND),TC(ND)								   |		REAL*8 TA(ND),TB(ND),TC(ND)
	REAL(10) PSIPREV_MOD(ND),VB(ND),VC(ND)							   |		REAL*8 PSIPREV_MOD(ND),VB(ND),VC(ND)
	REAL(10) HU(ND),HL(ND),HS(ND)								   |		REAL*8 HU(ND),HL(ND),HS(ND)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) EPS_A(ND),EPS_B(ND)								   |		REAL*8 EPS_A(ND),EPS_B(ND)
	REAL(10) EPS_PREV_A(ND),EPS_PREV_B(ND)							   |		REAL*8 EPS_PREV_A(ND),EPS_PREV_B(ND)
	REAL(10) DTAU_BND									   |		REAL*8 DTAU_BND
	REAL(10) OLD_TX(ND,ND)									   |		REAL*8 OLD_TX(ND,ND)
./subs/upvnot.f
	REAL(10) TVX(NI-1,NI,NM)								   |		REAL*8 TVX(NI-1,NI,NM)
	REAL(10) TX(NI,NI,NM),GB(NI),H(NI),RKB(NI),RKC(NI)					   |		REAL*8 TX(NI,NI,NM),GB(NI),H(NI),RKB(NI),RKC(NI)
	REAL(10) VT(NI)										   |		REAL*8 VT(NI)
./subs/var_formsol.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)					   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND),P(NP)							   |		REAL*8 V(ND),SIGMA(ND),R(ND),P(NP)
	REAL(10) FQAF(ND,ND,NM),FQAFD(ND)							   |		REAL*8 FQAF(ND,ND,NM),FQAFD(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM),KI(ND,3,NM)					   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM),KI(ND,3,NM)
	REAL(10) JQW(ND,NP)									   |		REAL*8 JQW(ND,NP)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)						   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF),WERFC(NLF)
	REAL(10) DBB,IC,AMASS,FL								   |		REAL*8 DBB,IC,AMASS,FL
	REAL(10) TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)				   |		REAL*8 TA(ND),TB(ND),TC(ND),AV(ND),CV(ND),DTAU(ND),Z(ND)
	REAL(10) TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)					   |		REAL*8 TCHI(ND),XM(ND),SOURCE(ND),U(ND),VB(ND),VC(ND)
	REAL(10) GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)					   |		REAL*8 GB(ND),H(ND),GAM(ND),GAMH(ND),Q(ND),QH(ND)
	REAL(10) RKB(ND),RKC(ND),BAR_WTS(ND),DEPTH_PRO(ND)					   |		REAL*8 RKB(ND),RKC(ND),BAR_WTS(ND),DEPTH_PRO(ND)
	REAL(10) AVM1(ND),CVM1(ND),TXD(ND),TVXD(ND)						   |		REAL*8 AVM1(ND),CVM1(ND),TXD(ND),TVXD(ND)
	REAL(10) OLDCHI,T1,T2,DBC,DBC_ON_DBB,TOR,IBOUND,WERF_EXP				   |		REAL*8 OLDCHI,T1,T2,DBC,DBC_ON_DBB,TOR,IBOUND,WERF_EXP
	      DBC_ON_DBB=SQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)				   |		      DBC_ON_DBB=DSQRT(R(ND)*R(ND)-P(LS)*P(LS))/R(ND)/TCHI(ND)
./subs/varlamki.f
	REAL(10) TERF										   |		REAL*8 TERF
	REAL(10) KI(NI),VSRCE(NI),RKB(NI),LINE_PRO(NI)						   |		REAL*8 KI(NI),VSRCE(NI),RKB(NI),LINE_PRO(NI)
	REAL(10) DTAU(NI),Q(NI),QH(NI),UK(NI),UKM1(NI),Z(NI)					   |		REAL*8 DTAU(NI),Q(NI),QH(NI),UK(NI),UKM1(NI),Z(NI)
	REAL(10) VKM1(NI),TCHI(NI),SOURCE(NI),CHI(NI),CHIL(NI),ETAL(NI)				   |		REAL*8 VKM1(NI),TCHI(NI),SOURCE(NI),CHI(NI),CHIL(NI),ETAL(NI)
	REAL(10), PARAMETER :: ONE=1.0D0							   |		REAL*8, PARAMETER :: ONE=1.0D0
	REAL(10) T1,T2,T3,T4,T5,T6,T7,KIP,KIM							   |		REAL*8 T1,T2,T3,T4,T5,T6,T7,KIP,KIM
./subs/var_momjbar.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) CHIL(ND),ETAL(ND)								   |		REAL*8 CHIL(ND),ETAL(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) FQAF(ND,ND,NM),FQAFD(ND)							   |		REAL*8 FQAF(ND,ND,NM),FQAFD(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM),WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)				   |		REAL*8 KI(ND,ND,NM),WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) F(ND,NLF+1),G(ND,NLF+1)							   |		REAL*8 F(ND,NLF+1),G(ND,NLF+1)
	REAL(10) HBC(3,NLF+1),NBC(3,NLF+1),IN_HBC(NLF+1)					   |		REAL*8 HBC(3,NLF+1),NBC(3,NLF+1),IN_HBC(NLF+1)
	REAL(10) PF(NLF),PROF(NLF),LFQW(NLF)							   |		REAL*8 PF(NLF),PROF(NLF),LFQW(NLF)
	REAL(10) DBB,IC,FL									   |		REAL*8 DBB,IC,FL
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),TCHI(NV),DTAUONQ(NV)				   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),TCHI(NV),DTAUONQ(NV)
	REAL(10) XM(NV),SOURCE(NV),MIDF(NV),Q(NV)						   |		REAL*8 XM(NV),SOURCE(NV),MIDF(NV),Q(NV)
	REAL(10) JNU(NV),HNU(NV),JNUM1(NV),HNUM1(NV),TXD(NV),TVXD(NV)				   |		REAL*8 JNU(NV),HNU(NV),JNUM1(NV),HNUM1(NV),TXD(NV),TVXD(NV)
	REAL(10) BAR_WTS(NV),DEPTH_PRO(NV)							   |		REAL*8 BAR_WTS(NV),DEPTH_PRO(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)						   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV(NV)								   |		REAL*8 PSI(NV),PSIPREV(NV)
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
	REAL(10), PARAMETER :: PROG_ID=2.22814021D+08 !Must be unique (VAR_MJBA)		   |		REAL*8, PARAMETER :: PROG_ID=2.22814021D+08 !Must be unique (VAR_MJBA)
	REAL(10) T1,DNU,SRCEBND									   |		REAL*8 T1,DNU,SRCEBND
./subs/var_mom_j_cmf_v6.f
C Altered:   05-Dec-1996 : PROGDESC set to REAL(10) value, PROG_ID installed			   |	C Altered:   05-Dec-1996 : PROGDESC set to REAL*8 value, PROG_ID installed
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND),G(ND),RSQN_ON_RSQJ(ND)							   |		REAL*8 F(ND),G(ND),RSQN_ON_RSQJ(ND)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)					   |		REAL*8 F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)
	REAL(10) HBC_PREV,NBC_PREV,IN_HBC_PREV							   |		REAL*8 HBC_PREV,NBC_PREV,IN_HBC_PREV
	REAL(10) dLOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) JNUM1(NV),RSQ_HNUM1(NV)							   |		REAL*8 JNUM1(NV),RSQ_HNUM1(NV)
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)					   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)
	REAL(10) XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)					   |		REAL*8 XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),THETA(NV)					   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),THETA(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)						   |		REAL*8 PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)
	REAL(10) EPS_A(NV),EPS_B(NV)								   |		REAL*8 EPS_A(NV),EPS_B(NV)
	REAL(10) EPS_PREV_A(NV),EPS_PREV_B(NV)							   |		REAL*8 EPS_PREV_A(NV),EPS_PREV_B(NV)
	REAL(10) TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)						   |		REAL*8 TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
	REAL(10), PARAMETER :: PROG_ID=2.2281463D+08  !Must be unique (VAR_MOM_)		   |		REAL*8, PARAMETER :: PROG_ID=2.2281463D+08  !Must be unique (VAR_MOM_)
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
./subs/var_mom_j_cmf_v7.f
C Altered:   05-Dec-1996 : PROGDESC set to REAL(10) value, PROG_ID installed			   |	C Altered:   05-Dec-1996 : PROGDESC set to REAL*8 value, PROG_ID installed
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),THETA(ND)						   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),THETA(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND),G(ND),RSQN_ON_RSQJ(ND)							   |		REAL*8 F(ND),G(ND),RSQN_ON_RSQJ(ND)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)					   |		REAL*8 F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)
	REAL(10) HBC_PREV,NBC_PREV,IN_HBC_PREV							   |		REAL*8 HBC_PREV,NBC_PREV,IN_HBC_PREV
	REAL(10) dLOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) JNUM1(NV),RSQ_HNUM1(NV)							   |		REAL*8 JNUM1(NV),RSQ_HNUM1(NV)
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)					   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)
	REAL(10) XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)					   |		REAL*8 XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)						   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)						   |		REAL*8 PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)
	REAL(10) EPS_A(NV),EPS_B(NV)								   |		REAL*8 EPS_A(NV),EPS_B(NV)
	REAL(10) EPS_PREV_A(NV),EPS_PREV_B(NV)							   |		REAL*8 EPS_PREV_A(NV),EPS_PREV_B(NV)
	REAL(10) TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)						   |		REAL*8 TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
	REAL(10), PARAMETER :: PROG_ID=2.2281463D+08  !Must be unique (VAR_MOM_)		   |		REAL*8, PARAMETER :: PROG_ID=2.2281463D+08  !Must be unique (VAR_MOM_)
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
./subs/var_mom_j_cmf_v8.f
! Altered:   05-Dec-1996 : PROGDESC set to REAL(10) value, PROG_ID installed			   |	! Altered:   05-Dec-1996 : PROGDESC set to REAL*8 value, PROG_ID installed
	REAL(10) ETA(ND),CHI(ND),ESEC(ND),THETA(ND)						   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND),THETA(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) TX(ND,ND,NM),TVX(ND-1,ND,NM)							   |		REAL*8 TX(ND,ND,NM),TVX(ND-1,ND,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)						   |		REAL*8 WORKMAT(ND,ND),RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND),G(ND),RSQN_ON_RSQJ(ND)							   |		REAL*8 F(ND),G(ND),RSQN_ON_RSQJ(ND)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)					   |		REAL*8 F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)
	REAL(10) HBC_PREV,NBC_PREV,IN_HBC_PREV							   |		REAL*8 HBC_PREV,NBC_PREV,IN_HBC_PREV
	REAL(10) dLOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) JNUM1(NV),RSQ_HNUM1(NV)							   |		REAL*8 JNUM1(NV),RSQ_HNUM1(NV)
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)					   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)
	REAL(10) XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)					   |		REAL*8 XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)						   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)						   |		REAL*8 PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)
	REAL(10) EPS_A(NV),EPS_B(NV)								   |		REAL*8 EPS_A(NV),EPS_B(NV)
	REAL(10) EPS_PREV_A(NV),EPS_PREV_B(NV)							   |		REAL*8 EPS_PREV_A(NV),EPS_PREV_B(NV)
	REAL(10) TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)						   |		REAL*8 TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)
!												   |	!
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) DTAU_BND									   |		REAL*8 DTAU_BND
	REAL(10), PARAMETER :: PROG_ID=2.2281463D+08  !Must be unique (VAR_MOM_)		   |		REAL*8, PARAMETER :: PROG_ID=2.2281463D+08  !Must be unique (VAR_MOM_)
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
./subs/var_mom_jext_cmf_v2.f
	REAL(10) ETA(ND),CHI(ND),ESEC(ND)							   |		REAL*8 ETA(ND),CHI(ND),ESEC(ND)
	REAL(10) V(ND),SIGMA(ND),R(ND)								   |		REAL*8 V(ND),SIGMA(ND),R(ND)
	REAL(10) ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)					   |		REAL*8 ETA_SM(ND_SM),CHI_SM(ND_SM),ESEC_SM(ND_SM)
	REAL(10) COEF(0:3,ND)									   |		REAL*8 COEF(0:3,ND)
	REAL(10) TX(ND,ND_SM,NM)								   |		REAL*8 TX(ND,ND_SM,NM)
	REAL(10) TVX(ND-1,ND_SM,NM)								   |		REAL*8 TVX(ND-1,ND_SM,NM)
	REAL(10) KI(ND,ND,NM_KI)								   |		REAL*8 KI(ND,ND,NM_KI)
	REAL(10) RHS_dHdCHI(ND-1,ND)								   |		REAL*8 RHS_dHdCHI(ND-1,ND)
	REAL(10) TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)						   |		REAL*8 TX_DIF_d_T(ND),TX_DIF_d_dTdR(ND)
	REAL(10) TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)						   |		REAL*8 TVX_DIF_d_T(ND),TVX_DIF_d_dTdR(ND)
	REAL(10) F(ND),G(ND),RSQN_ON_RSQJ(ND)							   |		REAL*8 F(ND),G(ND),RSQN_ON_RSQJ(ND)
	REAL(10) HBC,NBC,IN_HBC									   |		REAL*8 HBC,NBC,IN_HBC
	REAL(10) F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)					   |		REAL*8 F_PREV(ND),G_PREV(ND),RSQN_ON_RSQJ_PREV(ND)
	REAL(10) HBC_PREV,NBC_PREV,IN_HBC_PREV							   |		REAL*8 HBC_PREV,NBC_PREV,IN_HBC_PREV
	REAL(10) dLOG_NU,dTdR,DBB,dDBBdT,IC							   |		REAL*8 dLOG_NU,dTdR,DBB,dDBBdT,IC
	REAL(10) JNUM1(NV),RSQ_HNUM1(NV)							   |		REAL*8 JNUM1(NV),RSQ_HNUM1(NV)
	REAL(10) KI_SM(ND,ND_SM,NM_KI)								   |		REAL*8 KI_SM(ND,ND_SM,NM_KI)
	REAL(10) RHS_dHdCHI_SM(ND-1,ND_SM)							   |		REAL*8 RHS_dHdCHI_SM(ND-1,ND_SM)
	REAL(10) WORKMAT(ND,ND)									   |		REAL*8 WORKMAT(ND,ND)
	REAL(10) TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)					   |		REAL*8 TA(NV),TB(NV),TC(NV),DTAU(NV),RSQ_DTAUONQ(NV)
	REAL(10) XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)					   |		REAL*8 XM(NV),SOURCE(NV),Q(NV),JNU(NV),RSQ_HNU(NV)
	REAL(10) VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),THETA(NV)					   |		REAL*8 VB(NV),VC(NV),HU(NV),HL(NV),HS(NV),THETA(NV)
	REAL(10) GAM(NV),GAMH(NV),W(NV),WPREV(NV)						   |		REAL*8 GAM(NV),GAMH(NV),W(NV),WPREV(NV)
	REAL(10) PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)						   |		REAL*8 PSI(NV),PSIPREV_MOD(NV),PSIPREV(NV)
	REAL(10) EPS_A(NV),EPS_B(NV)								   |		REAL*8 EPS_A(NV),EPS_B(NV)
	REAL(10) EPS_PREV_A(NV),EPS_PREV_B(NV)							   |		REAL*8 EPS_PREV_A(NV),EPS_PREV_B(NV)
	REAL(10) TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)						   |		REAL*8 TX_OLD_d_T(NV),TX_OLD_d_dTdR(NV)
	REAL(10) PROGDESC									   |		REAL*8 PROGDESC	
	REAL(10), PARAMETER :: PROG_ID=3.4281463D+08  !Must be unique (VAR_MOM_)		   |		REAL*8, PARAMETER :: PROG_ID=3.4281463D+08  !Must be unique (VAR_MOM_)
	REAL(10) AV_SIGMA									   |		REAL*8 AV_SIGMA
./subs/var_op_v4.f
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)				   |		REAL*8 VCHI(NT,ND)		!VCHI(I,K)=dCHI(K)/dN(I,K)
	REAL(10) VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)				   |		REAL*8 VETA(NT,ND)		!VETA(I,K)=dETA(K)/dN(I,K)
	REAL(10) HN_S(N_S,ND)									   |		REAL*8 HN_S(N_S,ND)
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) dlnHNST_S_dlnT(N_S,ND)								   |		REAL*8 dlnHNST_S_dlnT(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) DI_S(N_DI,ND)									   |		REAL*8 DI_S(N_DI,ND)
	REAL(10) DIST_S(N_DI,ND)								   |		REAL*8 DIST_S(N_DI,ND)
	REAL(10) dlnDIST_S_dlnT(N_DI,ND)							   |		REAL*8 dlnDIST_S_dlnT(N_DI,ND)
	REAL(10) NU			!Frequency (10^15 Hz)					   |		REAL*8 NU			!Frequency (10^15 Hz)
	REAL(10) Z			!Charge on ion						   |		REAL*8 Z			!Charge on ion
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperatuure (10^4 K)					   |		REAL*8 T(ND)			!Temperatuure (10^4 K)
	REAL(10) EMHNUKT(ND)		!exp(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!exp(-hv/kT)
	REAL(10) CROSS(ND)									   |		REAL*8 CROSS(ND)
	REAL(10) GFF_VAL(ND)		!Used as work vector					   |		REAL*8 GFF_VAL(ND)		!Used as work vector
	REAL(10) DI_RAT(ND)		!Used as work vector					   |		REAL*8 DI_RAT(ND)		!Used as work vector
	REAL(10) DT_TERM(ND)		!Used as work vector					   |		REAL*8 DT_TERM(ND)		!Used as work vector
	REAL(10) HDKT_ON_T(ND)		!Used as work vector					   |		REAL*8 HDKT_ON_T(ND)		!Used as work vector
C												   |	C
	REAL(10) YDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 YDIS(ND)			!Constant for computing level dissolution/
	REAL(10) XDIS(ND)			!Constant for computing level dissolution/	   |		REAL*8 XDIS(ND)			!Constant for computing level dissolution/
	REAL(10) DIS_CONST(N_F)		!Constant appearing in dissolution formula.		   |		REAL*8 DIS_CONST(N_F)		!Constant appearing in dissolution formula.
	REAL(10) ALPHA_VEC(N_F)		!Photionization cross-section				   |		REAL*8 ALPHA_VEC(N_F)		!Photionization cross-section
	REAL(10) VCHI_ION(N_F)									   |		REAL*8 VCHI_ION(N_F)
	REAL(10) VCHI_T1(N_F)									   |		REAL*8 VCHI_T1(N_F)
	REAL(10) VCHI_T2(N_F)									   |		REAL*8 VCHI_T2(N_F)
	REAL(10) VCHI_TMP(N_F,ND)								   |		REAL*8 VCHI_TMP(N_F,ND)
	REAL(10) SUM_ION									   |		REAL*8 SUM_ION
	REAL(10) SUM_T1										   |		REAL*8 SUM_T1
	REAL(10) SUM_T2										   |		REAL*8 SUM_T2
	REAL(10) NEFF,ZION_CUBED,T1,T2								   |		REAL*8 NEFF,ZION_CUBED,T1,T2
	REAL(10) TCHI1,TCHI2,TETA1,TETA2,TETA3							   |		REAL*8 TCHI1,TCHI2,TETA1,TETA2,TETA3
	REAL(10) HNUONK,ALPHA									   |		REAL*8 HNUONK,ALPHA
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
./subs/var_x_opa_eta_v2.f
	REAL(10) VCHI(NT,ND),VETA(NT,ND)							   |		REAL*8 VCHI(NT,ND),VETA(NT,ND)
	REAL(10) HN_A(N_A,ND),HNST_A(N_A,ND),dlnHNST_AdlnT(N_A,ND)				   |		REAL*8 HN_A(N_A,ND),HNST_A(N_A,ND),dlnHNST_AdlnT(N_A,ND)
	REAL(10) HN_B(N_B,ND),HNST_B(N_B,ND),dlnHNST_BdlnT(N_B,ND)				   |		REAL*8 HN_B(N_B,ND),HNST_B(N_B,ND),dlnHNST_BdlnT(N_B,ND)
	REAL(10) ED(ND),DI(ND),T(ND),EMHNUKT(ND),NU						   |		REAL*8 ED(ND),DI(ND),T(ND),EMHNUKT(ND),NU
	REAL(10) AT_NO,Z_A									   |		REAL*8 AT_NO,Z_A
	REAL(10) XCROSS_V2									   |		REAL*8 XCROSS_V2
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) ALPHA,LTE_POP,NO_ELEC								   |		REAL*8 ALPHA,LTE_POP,NO_ELEC
	REAL(10) TCHI1,TETA2,TETA3								   |		REAL*8 TCHI1,TETA2,TETA3
./subs/vkifeau_ibc.f
	REAL(10) W(ND,ND),DTAU(ND),RJ(ND),R(ND),F(ND),Q(ND),CHI(ND)				   |		REAL*8 W(ND,ND),DTAU(ND),RJ(ND),R(ND),F(ND),Q(ND),CHI(ND)
	REAL(10) ZETA(ND),THETA(ND),TA(ND),TB(ND),TC(ND)					   |		REAL*8 ZETA(ND),THETA(ND),TA(ND),TB(ND),TC(ND)
	REAL(10) HBC_S,DBB									   |		REAL*8 HBC_S,DBB
	REAL(10) ALPHA,BETA,T1,UIJ,UIK								   |		REAL*8 ALPHA,BETA,T1,UIJ,UIK
./subs/voigt_1p0.f
	REAL(10)  VOIGT,V,A									   |		REAL*8  VOIGT,V,A
	REAL(10)  V0,V2										   |		REAL*8  V0,V2
	REAL(10)  H1(81)									   |		REAL*8  H1(81)
	REAL(10) C(7),D(7)									   |		REAL*8 C(7),D(7)
./subs/vsebyj_multi_v4.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND),BAION(NION,NT,NUM_BNDS,ND)				   |		REAL*8 BA(NT,NT,NUM_BNDS,ND),BAION(NION,NT,NUM_BNDS,ND)
	REAL(10) WSE(NLEV,ND),dWSEdT(NLEV,ND)							   |		REAL*8 WSE(NLEV,ND),dWSEdT(NLEV,ND)
	REAL(10) HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)				   |		REAL*8 HN(NLEV,ND),HNST(NLEV,ND),dlnHNST_dlnT(NLEV,ND)
	REAL(10) DI(N_DI,ND),DIST(N_DI,ND)							   |		REAL*8 DI(N_DI,ND),DIST(N_DI,ND)
	REAL(10) dlnDIST_dlnT(N_DI,ND)								   |		REAL*8 dlnDIST_dlnT(N_DI,ND)
	REAL(10) ED(ND),T(ND)									   |		REAL*8 ED(ND),T(ND)
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T3										   |		REAL*8 T3
	REAL(10) B_RAT										   |		REAL*8 B_RAT
	REAL(10) REV_HNST									   |		REAL*8 REV_HNST
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./subs/vsebyj_x_v3.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND)								   |		REAL*8 BA(NT,NT,NUM_BNDS,ND)
	REAL(10) BAION(NION,NT,NUM_BNDS,ND)							   |		REAL*8 BAION(NION,NT,NUM_BNDS,ND)
	REAL(10) WSE_X(N_A,ND)									   |		REAL*8 WSE_X(N_A,ND)
	REAL(10) HN_A(N_A,ND)		!Pops. of ith ionzation stage				   |		REAL*8 HN_A(N_A,ND)		!Pops. of ith ionzation stage
	REAL(10) HNST_A(N_A,ND)		!LTE   "    "  "      "       "				   |		REAL*8 HNST_A(N_A,ND)		!LTE   "    "  "      "       "
	REAL(10) dlnHNST_AdlnT(N_A,ND)								   |		REAL*8 dlnHNST_AdlnT(N_A,ND)	
	REAL(10) HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage			   |		REAL*8 HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage
	REAL(10) HNST_B(N_B,ND)		!LTE   "   "    "       "        "			   |		REAL*8 HNST_B(N_B,ND)		!LTE   "   "    "       "        "
	REAL(10) EDGE_B(N_B)									   |		REAL*8 EDGE_B(N_B)
C												   |	C
	REAL(10) DI(ND)			!Ion densit for B levels.				   |		REAL*8 DI(ND)			!Ion densit for B levels.
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature in 10^4K.					   |		REAL*8 T(ND)			!Temperature in 10^4K.
	REAL(10) EMHNUKT(ND)		!EXP(-hv/kT)						   |		REAL*8 EMHNUKT(ND)		!EXP(-hv/kT)
	REAL(10) RJ(ND)			!Mean intensity						   |		REAL*8 RJ(ND)			!Mean intensity
	REAL(10) NU(NCF)			!frequency (10^15 Hz)				   |		REAL*8 NU(NCF)			!frequency (10^15 Hz)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,T3,BSTIM									   |		REAL*8 T1,T3,BSTIM
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./subs/vsebyj_x_v4.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND)								   |		REAL*8 BA(NT,NT,NUM_BNDS,ND)
	REAL(10) BAION(NION,NT,NUM_BNDS,ND)							   |		REAL*8 BAION(NION,NT,NUM_BNDS,ND)
	REAL(10) WSE_X(N_A,ND)									   |		REAL*8 WSE_X(N_A,ND)
	REAL(10) HN_A(N_A,ND)		!Pops. of ith ionzation stage				   |		REAL*8 HN_A(N_A,ND)		!Pops. of ith ionzation stage
	REAL(10) HNST_A(N_A,ND)		!LTE   "    "  "      "       "				   |		REAL*8 HNST_A(N_A,ND)		!LTE   "    "  "      "       "
	REAL(10) dlnHNST_AdlnT(N_A,ND)								   |		REAL*8 dlnHNST_AdlnT(N_A,ND)	
	REAL(10) HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage			   |		REAL*8 HN_B(N_B,ND)		!Pops. of (i+1)th ionization stage
	REAL(10) HNST_B(N_B,ND)		!LTE   "   "    "       "        "			   |		REAL*8 HNST_B(N_B,ND)		!LTE   "   "    "       "        "
	REAL(10) EDGE_B(N_B)									   |		REAL*8 EDGE_B(N_B)
C												   |	C
	REAL(10) DI(ND)			!Ion densit for B levels.				   |		REAL*8 DI(ND)			!Ion densit for B levels.
	REAL(10) ED(ND)			!Electron density					   |		REAL*8 ED(ND)			!Electron density
	REAL(10) T(ND)			!Temperature in 10^4K.					   |		REAL*8 T(ND)			!Temperature in 10^4K.
	REAL(10) JREC(ND)									   |		REAL*8 JREC(ND)	
	REAL(10) dJRECdT(ND)									   |		REAL*8 dJRECdT(ND)	
	REAL(10) JPHOT(ND)									   |		REAL*8 JPHOT(ND)	
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T3,T4										   |		REAL*8 T3,T4
	REAL(10) BSTIM,RECIP_B_ION								   |		REAL*8 BSTIM,RECIP_B_ION
	REAL(10) WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC							   |		REAL*8 WSE_BY_RJ,DI_FAC,ED_FAC,T_FAC
./subs/weight.f
	REAL(10) U(N),W(N)									   |		REAL*8 U(N),W(N)
	REAL(10) T1,T2,TT									   |		REAL*8 T1,T2,TT
	    T1=ABS(U(I-1)-U(I))									   |		    T1=DABS(U(I-1)-U(I))
	    IF(I .NE. 2)T2=ABS(ABS(U(I-2)-U(I-1))/T1-1.0D0)					   |		    IF(I .NE. 2)T2=DABS(DABS(U(I-2)-U(I-1))/T1-1.0D0)
./subs/wr2d.f
	REAL(10) A(N,M)										   |		REAL*8 A(N,M)
./subs/wr2d_ma.f
	REAL(10) A(N,M)										   |		REAL*8 A(N,M)
110	FORMAT(1X,I4,'* ',1P,5E30.14E5)								   |	110	FORMAT(1X,I4,'* ',1P,5E26.14)
./subs/wr2d_v2.f
	REAL(10) A(N,M)										   |		REAL*8 A(N,M)
	REAL(10) T1										   |		REAL*8 T1
./subs/wr_ad_cool.f
	REAL(10) AD_COOL_V(ND)									   |		REAL*8 AD_COOL_V(ND)
	REAL(10) AD_COOL_DT(ND)									   |		REAL*8 AD_COOL_DT(ND)
	REAL(10) NETCR(ND)									   |		REAL*8 NETCR(ND)
	REAL(10) TOTCR(ND)									   |		REAL*8 TOTCR(ND)
./subs/wr_art_heat.f
	REAL(10) ARTIFICIAL_HEAT_TERM(ND)							   |		REAL*8 ARTIFICIAL_HEAT_TERM(ND)
	REAL(10) NETCR(ND)									   |		REAL*8 NETCR(ND)
	REAL(10) TOTCR(ND)									   |		REAL*8 TOTCR(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/wrcoolgen.f
	REAL(10) BFCRC2(NC2,ND),FFC2(ND),COLC2(ND),DIECOOL(ND),X_COOL(ND)			   |		REAL*8 BFCRC2(NC2,ND),FFC2(ND),COLC2(ND),DIECOOL(ND),X_COOL(ND)
	REAL(10) R(ND),T(ND),ED(ND),TOTRR(ND),NETRR(ND)						   |		REAL*8 R(ND),T(ND),ED(ND),TOTRR(ND),NETRR(ND)
./subs/wrcoolgen_v2.f
	REAL(10) BFCRC2(NC2,ND),FFC2(ND),COLC2(ND),DIECOOL(ND),X_COOL(ND),NT_COOL(ND)		   |		REAL*8 BFCRC2(NC2,ND),FFC2(ND),COLC2(ND),DIECOOL(ND),X_COOL(ND),NT_COOL(ND)
	REAL(10) R(ND),T(ND),ED(ND),TOTRR(ND),NETRR(ND)						   |		REAL*8 R(ND),T(ND),ED(ND),TOTRR(ND),NETRR(ND)
./subs/wrcoolgen_v3.f
	REAL(10) BFCRC2(NC2,ND),FFC2(ND),COLC2(ND),DIECOOL(ND),X_COOL(ND),NT_COOL(ND)		   |		REAL*8 BFCRC2(NC2,ND),FFC2(ND),COLC2(ND),DIECOOL(ND),X_COOL(ND),NT_COOL(ND)
	REAL(10) TOTRR(ND),NETRR(ND)								   |		REAL*8 TOTRR(ND),NETRR(ND)
	REAL(10) R(ND),V(ND),T(ND),ED(ND),TOTRR(ND),NETRR(ND)					   |		REAL*8 R(ND),V(ND),T(ND),ED(ND),TOTRR(ND),NETRR(ND)
	REAL(10) NETRR(ND),TOTRR(ND)								   |		REAL*8 NETRR(ND),TOTRR(ND)
./subs/wr_cooling_term.f
	REAL(10) dE_COOL(ND)									   |		REAL*8 dE_COOL(ND)
	REAL(10) NETCR(ND)									   |		REAL*8 NETCR(ND)
	REAL(10) TOTCR(ND)									   |		REAL*8 TOTCR(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/writedc.f
	REAL(10) HYD(NHYD,ND),HYDLTE(NHYD,ND),DHYD(NION,ND)					   |		REAL*8 HYD(NHYD,ND),HYDLTE(NHYD,ND),DHYD(NION,ND)
	REAL(10) R(ND),T(ND),ED(ND),V(ND),LUM,T1,T2						   |		REAL*8 R(ND),T(ND),ED(ND),V(ND),LUM,T1,T2
./subs/writedc_v2.f
	REAL(10) HYD(NHYD,ND),HYDLTE(NHYD,ND),DHYD(NION,ND)					   |		REAL*8 HYD(NHYD,ND),HYDLTE(NHYD,ND),DHYD(NION,ND)
	REAL(10) R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)						   |		REAL*8 R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)
	REAL(10) LUM,T1,T2									   |		REAL*8 LUM,T1,T2
./subs/writedc_v3.f
	REAL(10) HYD(NHYD,ND),LOG_HYDLTE(NHYD,ND),DHYD(NION,ND)					   |		REAL*8 HYD(NHYD,ND),LOG_HYDLTE(NHYD,ND),DHYD(NION,ND)
	REAL(10) R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)						   |		REAL*8 R(ND),T(ND),ED(ND),V(ND),CLUMP_FAC(ND)
	REAL(10) LUM,T1,T2									   |		REAL*8 LUM,T1,T2
	REAL(10) LOG_TEN									   |		REAL*8 LOG_TEN
./subs/write_direct_info.f
./subs/write_direct_info_v2.f
./subs/write_direct_info_v3.f
./subs/write_j_cmf_err.f
	REAL(10) FG_ERR_ON_FREQ,MOM_ERR_ON_FREQ							   |		REAL*8 FG_ERR_ON_FREQ,MOM_ERR_ON_FREQ
./subs/write_out_ew.f
	REAL(10) LAMBDA_VAC									   |		REAL*8 LAMBDA_VAC
	REAL(10) FLUX										   |		REAL*8 FLUX
	REAL(10) EW										   |		REAL*8 EW
	REAL(10) EMISS_EW									   |		REAL*8 EMISS_EW
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) LAMVACAIR,LAMBDA_AIR,SPEED_OF_LIGHT						   |		REAL*8 LAMVACAIR,LAMBDA_AIR,SPEED_OF_LIGHT
./subs/write_vec.f
	REAL(10) F(ND)										   |		REAL*8 F(ND)
./subs/writv.f
	REAL(10) F(ND)										   |		REAL*8 F(ND)
./subs/writv_v2.f
	REAL(10) F(ND)										   |		REAL*8 F(ND)
./subs/wrrecomchk.f
	REAL(10) PR(N,ND),RR(N,ND),R(ND),T(ND),ED(ND),DHYD(ND)					   |		REAL*8 PR(N,ND),RR(N,ND),R(ND),T(ND),ED(ND),DHYD(ND)
	REAL(10) TOTRR(ND),NETRR(ND),CPR(ND),CRR(ND),DIERECOM(ND)				   |		REAL*8 TOTRR(ND),NETRR(ND),CPR(ND),CRR(ND),DIERECOM(ND)
	REAL(10) ADDRECOM(ND),X_RECOM_1(ND),X_RECOM_2(ND)					   |		REAL*8 ADDRECOM(ND),X_RECOM_1(ND),X_RECOM_2(ND)
	REAL(10) ABS_SUM									   |		REAL*8 ABS_SUM
./subs/wrrecomchk_v2.f
	REAL(10) PR(N,ND)			!Radiative photioization rate			   |		REAL*8 PR(N,ND)			!Radiative photioization rate
	REAL(10) RR(N,ND)			!Radiative recombination rate			   |		REAL*8 RR(N,ND)			!Radiative recombination rate
	REAL(10) CPR(ND)			!Collisional ioization rate			   |		REAL*8 CPR(ND)			!Collisional ioization rate
	REAL(10) CRR(ND)			!Collisional recombination rate			   |		REAL*8 CRR(ND)			!Collisional recombination rate
	REAL(10) CHG_PR(ND)		!Charge ionization rate					   |		REAL*8 CHG_PR(ND)		!Charge ionization rate
	REAL(10) CHG_RR(ND)		!Charge recombination rate				   |		REAL*8 CHG_RR(ND)		!Charge recombination rate
	REAL(10) DIERECOM(ND)									   |		REAL*8 DIERECOM(ND)
	REAL(10) ADDRECOM(ND)									   |		REAL*8 ADDRECOM(ND)
	REAL(10) X_RECOM_1(ND),X_RECOM_2(ND)							   |		REAL*8 X_RECOM_1(ND),X_RECOM_2(ND)
	REAL(10) TOTRR(ND),NETRR(ND)								   |		REAL*8 TOTRR(ND),NETRR(ND)
	REAL(10) R(ND),T(ND),ED(ND),DHYD(ND)							   |		REAL*8 R(ND),T(ND),ED(ND),DHYD(ND)
	REAL(10) ABS_SUM									   |		REAL*8 ABS_SUM
./subs/wrrecomchk_v3.f
	REAL(10) PR(N,ND)			!Radiative photioization rate			   |		REAL*8 PR(N,ND)			!Radiative photioization rate
	REAL(10) RR(N,ND)			!Radiative recombination rate			   |		REAL*8 RR(N,ND)			!Radiative recombination rate
	REAL(10) CPR(ND)			!Collisional ioization rate			   |		REAL*8 CPR(ND)			!Collisional ioization rate
	REAL(10) CRR(ND)			!Collisional recombination rate			   |		REAL*8 CRR(ND)			!Collisional recombination rate
	REAL(10) CHG_PR(ND)		!Charge ionization rate					   |		REAL*8 CHG_PR(ND)		!Charge ionization rate
	REAL(10) CHG_RR(ND)		!Charge recombination rate				   |		REAL*8 CHG_RR(ND)		!Charge recombination rate
	REAL(10) ADVEC_RR(ND)		!Advection recombination rate				   |		REAL*8 ADVEC_RR(ND)		!Advection recombination rate
	REAL(10) DIERECOM(ND)									   |		REAL*8 DIERECOM(ND)
	REAL(10) ADDRECOM(ND)									   |		REAL*8 ADDRECOM(ND)
	REAL(10) X_RECOM_1(ND),X_RECOM_2(ND)							   |		REAL*8 X_RECOM_1(ND),X_RECOM_2(ND)
	REAL(10) TOTRR(ND),NETRR(ND)								   |		REAL*8 TOTRR(ND),NETRR(ND)
	REAL(10) R(ND),T(ND),ED(ND),DHYD(ND)							   |		REAL*8 R(ND),T(ND),ED(ND),DHYD(ND)
	REAL(10) ABS_SUM									   |		REAL*8 ABS_SUM
	REAL(10) ADVEC_SUM									   |		REAL*8 ADVEC_SUM
	REAL(10) T1										   |		REAL*8 T1
./subs/wrrecomchk_v4.f
	REAL(10) PR(N,ND)			!Radiative photioization rate			   |		REAL*8 PR(N,ND)			!Radiative photioization rate
	REAL(10) RR(N,ND)			!Radiative recombination rate			   |		REAL*8 RR(N,ND)			!Radiative recombination rate
	REAL(10) CPR(ND)			!Collisional ioization rate			   |		REAL*8 CPR(ND)			!Collisional ioization rate
	REAL(10) CRR(ND)			!Collisional recombination rate			   |		REAL*8 CRR(ND)			!Collisional recombination rate
	REAL(10) CHG_PR(ND)		!Charge ionization rate					   |		REAL*8 CHG_PR(ND)		!Charge ionization rate
	REAL(10) CHG_RR(ND)		!Charge recombination rate				   |		REAL*8 CHG_RR(ND)		!Charge recombination rate
	REAL(10) ADVEC_RR(ND)		!Advection recombination rate				   |		REAL*8 ADVEC_RR(ND)		!Advection recombination rate
	REAL(10) DIERECOM(ND)									   |		REAL*8 DIERECOM(ND)
	REAL(10) ADDRECOM(ND)									   |		REAL*8 ADDRECOM(ND)
	REAL(10) X_RECOM_1(ND),X_RECOM_2(ND)							   |		REAL*8 X_RECOM_1(ND),X_RECOM_2(ND)
	REAL(10) NT_ION_RATE(ND)								   |		REAL*8 NT_ION_RATE(ND)
	REAL(10) TOTRR(ND),NETRR(ND)								   |		REAL*8 TOTRR(ND),NETRR(ND)
	REAL(10) R(ND),T(ND),ED(ND),DHYD(ND)							   |		REAL*8 R(ND),T(ND),ED(ND),DHYD(ND)
	REAL(10) ABS_SUM									   |		REAL*8 ABS_SUM
	REAL(10) ADVEC_SUM									   |		REAL*8 ADVEC_SUM
	REAL(10) T1										   |		REAL*8 T1
./subs/wr_x_info.f
	REAL(10) ZION		!Charge on ion (or core)					   |		REAL*8 ZION		!Charge on ion (or core)
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) VAL		!Real value to be output to string				   |		REAL*8 VAL		!Real value to be output to string
	REAL(10) ABUND			!Relative abundance by number				   |		REAL*8 ABUND			!Relative abundance by number
	REAL(10) ABUND_SUM		!Sum of relative abundances				   |		REAL*8 ABUND_SUM		!Sum of relative abundances
	REAL(10) MASS			!Mass in atomic mass units				   |		REAL*8 MASS			!Mass in atomic mass units
	REAL(10) MEAN_ATOMIC_WEIGHT	!Mean ioic atomic weight (all)				   |		REAL*8 MEAN_ATOMIC_WEIGHT	!Mean ioic atomic weight (all)
	REAL(10) SOL_MASS_FRAC									   |		REAL*8 SOL_MASS_FRAC
	REAL(10) T1										   |		REAL*8 T1
./subs/x02ajf.f
	REAL(10) X02AJF										   |		REAL*8 X02AJF
./subs/xcross.f
	REAL(10) XCROSS,FREQ,ZCORE,NUM_ELEC							   |		REAL*8 XCROSS,FREQ,ZCORE,NUM_ELEC
	REAL(10) U,CON_FAC									   |		REAL*8 U,CON_FAC
	REAL(10) SIG_C(6),SIG_N(7),SIG_O(8)							   |		REAL*8 SIG_C(6),SIG_N(7),SIG_O(8)
	REAL(10) EDGE_C(6),EDGE_N(7),EDGE_O(8)							   |		REAL*8 EDGE_C(6),EDGE_N(7),EDGE_O(8)
	REAL(10) S_C(6),S_N(7),S_O(8)								   |		REAL*8 S_C(6),S_N(7),S_O(8)
	REAL(10) ALPHA_C(6),ALPHA_N(7),ALPHA_O(8)						   |		REAL*8 ALPHA_C(6),ALPHA_N(7),ALPHA_O(8)
	REAL(10) SIG_NE(10),SIG_MG(12),SIG_SI(14),SIG_S(16)					   |		REAL*8 SIG_NE(10),SIG_MG(12),SIG_SI(14),SIG_S(16)
	REAL(10) EDGE_NE(10),EDGE_MG(12),EDGE_SI(14),EDGE_S(16)					   |		REAL*8 EDGE_NE(10),EDGE_MG(12),EDGE_SI(14),EDGE_S(16)
	REAL(10) S_NE(10),S_MG(12),S_SI(14),S_S(16)						   |		REAL*8 S_NE(10),S_MG(12),S_SI(14),S_S(16)
	REAL(10) ALPHA_NE(10),ALPHA_MG(12),ALPHA_SI(14),ALPHA_S(16)				   |		REAL*8 ALPHA_NE(10),ALPHA_MG(12),ALPHA_SI(14),ALPHA_S(16)
./subs/x_rrr_cool_v4.f
	REAL(10) NET_X_RR(ND),X_BFCR(ND)							   |		REAL*8 NET_X_RR(ND),X_BFCR(ND)
	REAL(10) HN_A(N_A,ND),HNST_A(N_A,ND)							   |		REAL*8 HN_A(N_A,ND),HNST_A(N_A,ND)
	REAL(10) HN_B(N_B,ND),HNST_B(N_B,ND)							   |		REAL*8 HN_B(N_B,ND),HNST_B(N_B,ND)
	REAL(10) WSE_X_A(N_A,ND)								   |		REAL*8 WSE_X_A(N_A,ND)
	REAL(10) WCR_X_A(N_A,ND)								   |		REAL*8 WCR_X_A(N_A,ND)
	REAL(10) JREC(ND)			!In (2hv^3/c^2 + J) EXP(-hv/kT)/v  dv		   |		REAL*8 JREC(ND)			!In (2hv^3/c^2 + J) EXP(-hv/kT)/v  dv
	REAL(10) JPHOT(ND)		!In J/v dv						   |		REAL*8 JPHOT(ND)		!In J/v dv
	REAL(10) JREC_CR(ND)		!In (2hv^3/c^2 + J) EXP(-hv/kT)   dv			   |		REAL*8 JREC_CR(ND)		!In (2hv^3/c^2 + J) EXP(-hv/kT)   dv
	REAL(10) JPHOT_CR(ND)		!In J dv						   |		REAL*8 JPHOT_CR(ND)		!In J dv
	REAL(10) A1										   |		REAL*8 A1
./subs/x_rrr_cool_v5.f
	REAL(10) NET_X_RR(ND),X_BFCR(ND)							   |		REAL*8 NET_X_RR(ND),X_BFCR(ND)
	REAL(10) HN_A(N_A,ND),HNST_A(N_A,ND)							   |		REAL*8 HN_A(N_A,ND),HNST_A(N_A,ND)
	REAL(10) HN_B(N_B,ND),HNST_B(N_B,ND)							   |		REAL*8 HN_B(N_B,ND),HNST_B(N_B,ND)
	REAL(10) WSE_X_A(N_A,ND)								   |		REAL*8 WSE_X_A(N_A,ND)
	REAL(10) WCR_X_A(N_A,ND)								   |		REAL*8 WCR_X_A(N_A,ND)
	REAL(10) JREC(ND)			!In (2hv^3/c^2 + J) EXP(-hv/kT)/v  dv		   |		REAL*8 JREC(ND)			!In (2hv^3/c^2 + J) EXP(-hv/kT)/v  dv
	REAL(10) JPHOT(ND)		!In J/v dv						   |		REAL*8 JPHOT(ND)		!In J/v dv
	REAL(10) JREC_CR(ND)		!In (2hv^3/c^2 + J) EXP(-hv/kT)   dv			   |		REAL*8 JREC_CR(ND)		!In (2hv^3/c^2 + J) EXP(-hv/kT)   dv
	REAL(10) JPHOT_CR(ND)		!In J dv						   |		REAL*8 JPHOT_CR(ND)		!In J dv
	REAL(10) A1										   |		REAL*8 A1
	REAL(10) H										   |		REAL*8 H
./subs/x_rrr_cool_v6.f
												   >	! Altered 24-Sep-2023 : Adjusted constants for consistency.
	REAL(10) NET_X_RR(ND),X_BFCR(ND)							   |		REAL*8 NET_X_RR(ND),X_BFCR(ND)
	REAL(10) HN_A(N_A,ND),LOG_HNST_A(N_A,ND)						   |		REAL*8 HN_A(N_A,ND),LOG_HNST_A(N_A,ND)
	REAL(10) HN_B(N_B,ND),LOG_HNST_B(N_B,ND)						   |		REAL*8 HN_B(N_B,ND),LOG_HNST_B(N_B,ND)
	REAL(10) WSE_X_A(N_A,ND)								   |		REAL*8 WSE_X_A(N_A,ND)
	REAL(10) WCR_X_A(N_A,ND)								   |		REAL*8 WCR_X_A(N_A,ND)
	REAL(10) JREC(ND)			!In (2hv^3/c^2 + J) EXP(-hv/kT)/v  dv		   |		REAL*8 JREC(ND)			!In (2hv^3/c^2 + J) EXP(-hv/kT)/v  dv
	REAL(10) JPHOT(ND)		!In J/v dv						   |		REAL*8 JPHOT(ND)		!In J/v dv
	REAL(10) JREC_CR(ND)		!In (2hv^3/c^2 + J) EXP(-hv/kT)   dv			   |		REAL*8 JREC_CR(ND)		!In (2hv^3/c^2 + J) EXP(-hv/kT)   dv
	REAL(10) JPHOT_CR(ND)		!In J dv						   |		REAL*8 JPHOT_CR(ND)		!In J dv
	REAL(10) A1										   |		REAL*8 A1
	REAL(10) H										   |		REAL*8 H
												   >		REAL*8 PLANCKS_CONSTANT
												   >		EXTERNAL PLANCKS_CONSTANT
        H=6.6261965D-12 									   |	        H=PLANCKS_CONSTANT()*1.0D+15
./subs/xvecd.f
	REAL(10) DTAU(ND),SOURCE(ND),X(ND)							   |		REAL*8 DTAU(ND),SOURCE(ND),X(ND)
	REAL(10) DBC,IC										   |		REAL*8 DBC,IC
./subs/zalongp.f
	REAL(10) X(NI),R(NI),P									   |		REAL*8 X(NI),R(NI),P
./subs/zero_2d_mat.f
	REAL(10) A(N,M)										   |		REAL*8 A(N,M)
./subs/zero.f
	REAL(10) Z(ND)										   |		REAL*8 Z(ND)
 
Comparing files in ./subs/chg with those in  /home/hillier/wnode04/cmf_testing_real8//subs/chg
 
./subs/chg/Makefile
./subs/chg/chg_exch_mod.f
          REAL(10), ALLOCATABLE :: COEF_CHG(:,:)						   |	          REAL*8, ALLOCATABLE :: COEF_CHG(:,:)
          REAL(10), ALLOCATABLE :: TLO_CHG(:)							   |	          REAL*8, ALLOCATABLE :: TLO_CHG(:)
          REAL(10), ALLOCATABLE :: THI_CHG(:)							   |	          REAL*8, ALLOCATABLE :: THI_CHG(:)
          REAL(10), ALLOCATABLE :: Z_CHG(:,:)							   |	          REAL*8, ALLOCATABLE :: Z_CHG(:,:)
          REAL(10), ALLOCATABLE :: AI_AR_CHG(:,:)						   |	          REAL*8, ALLOCATABLE :: AI_AR_CHG(:,:)
          REAL(10), ALLOCATABLE :: dlnAI_AR_CHG_dlnT(:,:)					   |	          REAL*8, ALLOCATABLE :: dlnAI_AR_CHG_dlnT(:,:)
          REAL(10), ALLOCATABLE :: COOL_CHG(:,:)						   |	          REAL*8, ALLOCATABLE :: COOL_CHG(:,:)
./subs/chg/eval_chg_rates.f
	REAL(10) CHG_PR(ND)									   |		REAL*8 CHG_PR(ND)
	REAL(10) CHG_RR(ND)									   |		REAL*8 CHG_RR(ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10), PARAMETER :: H=6.6261965D-27							   |		REAL*8, PARAMETER :: H=6.6261965D-27
	REAL(10) ALPHA_REC									   |		REAL*8 ALPHA_REC
	REAL(10) ALPHA_ION									   |		REAL*8 ALPHA_ION
	REAL(10) FRD_R										   |		REAL*8 FRD_R
	REAL(10) REV_R										   |		REAL*8 REV_R
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) TVAL										   |		REAL*8 TVAL
./subs/chg/set_chg_exch_v2.f
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) G_CHG_VEC(ND)									   |		REAL*8 G_CHG_VEC(ND)
	REAL(10) dG_CHG_VEC(ND)									   |		REAL*8 dG_CHG_VEC(ND)
	REAL(10) T_VEC(ND)									   |		REAL*8 T_VEC(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/chg/steq_ba_chg_exch.f
	REAL(10) STEQ(NT,ND)									   |		REAL*8 STEQ(NT,ND)
	REAL(10) BA(NT,NT,NUM_BNDS,ND)								   |		REAL*8 BA(NT,NT,NUM_BNDS,ND)
	REAL(10) STEQION(NION,ND)								   |		REAL*8 STEQION(NION,ND)
	REAL(10) BAION(NION,NT,NUM_BNDS,ND)							   |		REAL*8 BAION(NION,NT,NUM_BNDS,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) ALPHA_REC									   |		REAL*8 ALPHA_REC
	REAL(10) ALPHA_ION									   |		REAL*8 ALPHA_ION
	REAL(10) ALPHA_1									   |		REAL*8 ALPHA_1
	REAL(10) ALPHA_2									   |		REAL*8 ALPHA_2
	REAL(10) ALPHA_3									   |		REAL*8 ALPHA_3
	REAL(10) ALPHA_4									   |		REAL*8 ALPHA_4
	REAL(10) dRATEdT									   |		REAL*8 dRATEdT
	REAL(10) dlnALPHA_RECdlnT								   |		REAL*8 dlnALPHA_RECdlnT
	REAL(10) dlnALPHA_IONdlnT								   |		REAL*8 dlnALPHA_IONdlnT
	REAL(10) FRD_R										   |		REAL*8 FRD_R
	REAL(10) REV_R										   |		REAL*8 REV_R
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) TVAL										   |		REAL*8 TVAL
./subs/chg/verify_chg_exch.f
./subs/chg/wr_chg_cool.f
	REAL(10) NETCR(ND)	!Accumlated net cooling rate					   |		REAL*8 NETCR(ND)	!Accumlated net cooling rate
	REAL(10) TOTCR(ND)	!Accumulated sum of absoulte cooling rates.			   |		REAL*8 TOTCR(ND)	!Accumulated sum of absoulte cooling rates.
 
Comparing files in ./subs/two with those in  /home/hillier/wnode04/cmf_testing_real8//subs/two
 
./subs/two/Makefile
./subs/two/ba_replace.f
	REAL(10) BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)						   |		REAL*8 BA(NT,NT,NUM_BNDS,ND),STEQ(NT,ND)
	REAL(10) BAION(NION,NT,NUM_BNDS,ND),STEQION(NION,ND)					   |		REAL*8 BAION(NION,NT,NUM_BNDS,ND),STEQION(NION,ND)
	REAL(10) C2(NC2,ND),DC2(ND),EDGEC2(NC2),T(ND)						   |		REAL*8 C2(NC2,ND),DC2(ND),EDGEC2(NC2),T(ND)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) T1,FAC										   |		REAL*8 T1,FAC
./subs/two/set_two_phot.f
	REAL(10) HNST_S(N_S,ND)									   |		REAL*8 HNST_S(N_S,ND)
	REAL(10) HNST_F(N_F,ND)									   |		REAL*8 HNST_F(N_F,ND)
	REAL(10) EDGE_F(N_F)									   |		REAL*8 EDGE_F(N_F)
	REAL(10) G_F(N_F)									   |		REAL*8 G_F(N_F)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) GION										   |		REAL*8 GION
	REAL(10) ZION										   |		REAL*8 ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
./subs/two/steq_ba_two_phot.f
	REAL(10) STEQ(NT,ND)			!Statistical Equilibrium equations		   |		REAL*8 STEQ(NT,ND)			!Statistical Equilibrium equations
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) BA(NT,NT,NUM_BNDS,ND)		!Variation of STEQ				   |		REAL*8 BA(NT,NT,NUM_BNDS,ND)		!Variation of STEQ
	REAL(10) TA(ND)										   |		REAL*8 TA(ND)
	REAL(10) T1										   |		REAL*8 T1
./subs/two/tst_two.f
./subs/two/two_phot_opac.f
	REAL(10) ETA(ND)		!Emisivity 						   |		REAL*8 ETA(ND)		!Emisivity 
	REAL(10) CHI(ND)		!Opacity [in (10^10 cm)^-1]				   |		REAL*8 CHI(ND)		!Opacity [in (10^10 cm)^-1]
	REAL(10) POPS(NT,ND)	!Atomic populations						   |		REAL*8 POPS(NT,ND)	!Atomic populations
	REAL(10) T(ND)		!in 10^4 K							   |		REAL*8 T(ND)		!in 10^4 K
	REAL(10) FREQ		!Current frequency (10^15 Hz)					   |		REAL*8 FREQ		!Current frequency (10^15 Hz)
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) PLANKS_CONSTANT	!cgs units						   |		REAL*8 PLANKS_CONSTANT	!cgs units
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) CONST										   |		REAL*8 CONST
	REAL(10) ETA_CONST	!Used to evaluate ETA						   |		REAL*8 ETA_CONST	!Used to evaluate ETA
	REAL(10) CHI_CONST	!Used to evaluate CHI						   |		REAL*8 CHI_CONST	!Used to evaluate CHI
	REAL(10) FREQ_B		!Frequency of other photon					   |		REAL*8 FREQ_B		!Frequency of other photon
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
./subs/two/two_phot_rate.f
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) RJ(ND)										   |		REAL*8 RJ(ND)
	REAL(10) FREQ		!In units of 10^15Hz						   |		REAL*8 FREQ		!In units of 10^15Hz
	REAL(10) FQW		!In Hz								   |		REAL*8 FQW		!In Hz
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) DOWN_CONST									   |		REAL*8 DOWN_CONST
	REAL(10) UP_CONST									   |		REAL*8 UP_CONST
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) ALPHA_A		!2 h v^3 / c^2						   |		REAL*8 ALPHA_A		!2 h v^3 / c^2
	REAL(10) FREQ_B		!Frequency of other photon					   |		REAL*8 FREQ_B		!Frequency of other photon
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
./subs/two/two_phot_var_opac.f
	REAL(10) VETA(NT,ND)									   |		REAL*8 VETA(NT,ND)
	REAL(10) VCHI(NT,ND)									   |		REAL*8 VCHI(NT,ND)
	REAL(10) POPS(NT,ND)									   |		REAL*8 POPS(NT,ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) FREQ										   |		REAL*8 FREQ
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ							   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ
	REAL(10) h										   |		REAL*8 h
	REAL(10) PI										   |		REAL*8 PI
	REAL(10) CONST										   |		REAL*8 CONST
	REAL(10) ETA_CONST									   |		REAL*8 ETA_CONST
	REAL(10) CHI_CONST									   |		REAL*8 CHI_CONST
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) FREQ_B										   |		REAL*8 FREQ_B
	REAL(10) AY,Y,U,FU									   |		REAL*8 AY,Y,U,FU
 
Comparing files in ./stark with those in  /home/hillier/wnode04/cmf_testing_real8//stark
 
./stark/Makefile
./stark/conv_strk_v1.f
	REAL(10) PRO(NF)		!Should contain LOG10 of the STARK profile. 		   |		REAL*8 PRO(NF)		!Should contain LOG10 of the STARK profile. 
	REAL(10) PROF_LAM(NF)	!Offset from line center in Angstroms.				   |		REAL*8 PROF_LAM(NF)	!Offset from line center in Angstroms.
	REAL(10) STARK(NWS)									   |		REAL*8 STARK(NWS)
	REAL(10) DWS(NWS)									   |		REAL*8 DWS(NWS)
	REAL(10) DLAM_THERM		!Thermal velocity					   |		REAL*8 DLAM_THERM		!Thermal velocity
	REAL(10) DLAM_TURB		!Turbulent velocity					   |		REAL*8 DLAM_TURB		!Turbulent velocity
	REAL(10) WAVE			!Central wavelength of line in Ang.			   |		REAL*8 WAVE			!Central wavelength of line in Ang.
	REAL(10) MAX_DWS,MIN_DWS								   |		REAL*8 MAX_DWS,MIN_DWS
	REAL(10) DLAM										   |		REAL*8 DLAM
	REAL(10) MAX_INT_LAM									   |		REAL*8 MAX_INT_LAM
	REAL(10) MIN_INT_LAM									   |		REAL*8 MIN_INT_LAM
	REAL(10) SLOPE_RHS,SLOPE_LHS								   |		REAL*8 SLOPE_RHS,SLOPE_LHS
	REAL(10) VAL_RHS,VAL_LHS								   |		REAL*8 VAL_RHS,VAL_LHS
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SQRT_PI									   |		REAL*8 SQRT_PI
	REAL(10) LAM_VAL									   |		REAL*8 LAM_VAL
	REAL(10) STARK_VAL									   |		REAL*8 STARK_VAL
	REAL(10), ALLOCATABLE :: DLAM_INT(:)							   |		REAL*8, ALLOCATABLE :: DLAM_INT(:)
	REAL(10), ALLOCATABLE :: STARK_INT(:)							   |		REAL*8, ALLOCATABLE :: STARK_INT(:)
	  STARK_INT(1:NI)=LOG10(STARK_INT(1:NI))						   |		  STARK_INT(1:NI)=DLOG10(STARK_INT(1:NI))
./stark/conv_strk_v2.f
	REAL(10) PRO(NF)		!Should contain LOG10 of the STARK profile. 		   |		REAL*8 PRO(NF)		!Should contain LOG10 of the STARK profile. 
	REAL(10) PROF_LAM(NF)	!Offset from line center in Angstroms.				   |		REAL*8 PROF_LAM(NF)	!Offset from line center in Angstroms.
	REAL(10) STARK(NWS)									   |		REAL*8 STARK(NWS)
	REAL(10) DWS(NWS)									   |		REAL*8 DWS(NWS)
	REAL(10) ELOG										   |		REAL*8 ELOG
	REAL(10) TLOG										   |		REAL*8 TLOG
	REAL(10) DLAM_THERM		!Thermal velocity					   |		REAL*8 DLAM_THERM		!Thermal velocity
	REAL(10) DLAM_TURB		!Turbulent velocity					   |		REAL*8 DLAM_TURB		!Turbulent velocity
	REAL(10) WAVE			!Central wavelength of line in Ang.			   |		REAL*8 WAVE			!Central wavelength of line in Ang.
	REAL(10) MAX_DWS,MIN_DWS								   |		REAL*8 MAX_DWS,MIN_DWS
	REAL(10) DLAM										   |		REAL*8 DLAM
	REAL(10) MAX_INT_LAM									   |		REAL*8 MAX_INT_LAM
	REAL(10) MIN_INT_LAM									   |		REAL*8 MIN_INT_LAM
	REAL(10) SLOPE_RHS,SLOPE_LHS								   |		REAL*8 SLOPE_RHS,SLOPE_LHS
	REAL(10) VAL_RHS,VAL_LHS								   |		REAL*8 VAL_RHS,VAL_LHS
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) SQRT_PI									   |		REAL*8 SQRT_PI
	REAL(10) LAM_VAL									   |		REAL*8 LAM_VAL
	REAL(10) STARK_VAL									   |		REAL*8 STARK_VAL
	REAL(10), ALLOCATABLE :: DLAM_INT(:)							   |		REAL*8, ALLOCATABLE :: DLAM_INT(:)
	REAL(10), ALLOCATABLE :: STARK_INT(:)							   |		REAL*8, ALLOCATABLE :: STARK_INT(:)
	REAL(10), SAVE :: WAVE_SAVE=0.0D0							   |		REAL*8, SAVE :: WAVE_SAVE=0.0D0
	  STARK_INT(1:NI)=LOG10(STARK_INT(1:NI))						   |		  STARK_INT(1:NI)=DLOG10(STARK_INT(1:NI))
./stark/get_prof_storage_limits.f
./stark/get_prof_storage_limits_v2.f
./stark/griem.f
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
./stark/griem_stark_mod.f
        REAL(10) BET(NBET)									   |	        REAL*8 BET(NBET)
        REAL(10) SS(NS)										   |	        REAL*8 SS(NS)
        REAL(10) SX(NS)										   |	        REAL*8 SX(NS)
        REAL(10) AS										   |	        REAL*8 AS
        REAL(10) PS										   |	        REAL*8 PS
        REAL(10) ODOP										   |	        REAL*8 ODOP
./stark/griem_v2.f
      REAL(10) DWS(NWS),PR(NWS)									   |	      REAL*8 DWS(NWS),PR(NWS)
      REAL(10) ED_IN										   |	      REAL*8 ED_IN
      REAL(10) TEMP_IN										   |	      REAL*8 TEMP_IN
      REAL(10) VDOP										   |	      REAL*8 VDOP
      REAL(10) ZZ										   |	      REAL*8 ZZ
      REAL(10) AMASS										   |	      REAL*8 AMASS
      REAL(10), PARAMETER :: CLIGHT=2.997925D18							   |	      REAL*8, PARAMETER :: CLIGHT=2.997925D18
      REAL(10), PARAMETER :: VLIGHT=2.997925D10							   |	      REAL*8, PARAMETER :: VLIGHT=2.997925D10
      REAL(10), PARAMETER :: CBOLTZ=1.3805D-16							   |	      REAL*8, PARAMETER :: CBOLTZ=1.3805D-16
      REAL(10), PARAMETER :: AMU=1.67333D-24							   |	      REAL*8, PARAMETER :: AMU=1.67333D-24
      REAL(10), PARAMETER :: THIRD=0.333333333D0						   |	      REAL*8, PARAMETER :: THIRD=0.333333333D0
      REAL(10), PARAMETER :: GAMIN=0.01D0							   |	      REAL*8, PARAMETER :: GAMIN=0.01D0
      REAL(10), PARAMETER :: GAMAX=25.0D0							   |	      REAL*8, PARAMETER :: GAMAX=25.0D0
      REAL(10), PARAMETER :: PI=3.1415926536E0							   |	      REAL*8, PARAMETER :: PI=3.1415926536E0
!												   |	!
      REAL(10) AA,ASQ,BSQ,FRQ,WAVE								   |	      REAL*8 AA,ASQ,BSQ,FRQ,WAVE
      REAL(10) CON,OBA,WSQ,CCKAB,BETP1,BETW1							   |	      REAL*8 CON,OBA,WSQ,CCKAB,BETP1,BETW1
      REAL(10) RYD										   |	      REAL*8 RYD
      REAL(10) GAM01,GAM02									   |	      REAL*8 GAM01,GAM02
      REAL(10) EE,SRE,CUE									   |	      REAL*8 EE,SRE,CUE
      REAL(10) F0,TT,SRT									   |	      REAL*8 F0,TT,SRT
      REAL(10) DOP										   |	      REAL*8 DOP
!												   |	!
      REAL(10) BETA,BETAP,BETAW									   |	      REAL*8 BETA,BETAP,BETAW
      REAL(10) GAMA,GAM0,GAML,GAMW								   |	      REAL*8 GAMA,GAM0,GAML,GAMW
      REAL(10) FPW,SSS,REN,FAC									   |	      REAL*8 FPW,SSS,REN,FAC
      REAL(10) CKABD,OCKAB									   |	      REAL*8 CKABD,OCKAB
      REAL(10) TBG_STRK										   |	      REAL*8 TBG_STRK
      REAL(10) TH_STRK										   |	      REAL*8 TH_STRK
      REAL(10) DCONV_STRK									   |	      REAL*8 DCONV_STRK
      REAL(10) FUNCTION DCONV_STRK(DLAM)							   |	      REAL*8 FUNCTION DCONV_STRK(DLAM)
      REAL(10) DLAM										   |	      REAL*8 DLAM
      REAL(10), PARAMETER :: HALF=0.5E0								   |	      REAL*8, PARAMETER :: HALF=0.5E0
      REAL(10), PARAMETER :: ZERO=0.0E0								   |	      REAL*8, PARAMETER :: ZERO=0.0E0
      REAL(10), PARAMETER :: SRTPI=5.6418958E-1							   |	      REAL*8, PARAMETER :: SRTPI=5.6418958E-1
      REAL(10), PARAMETER :: RANGE=6.0E0							   |	      REAL*8, PARAMETER :: RANGE=6.0E0
!												   |	!
      REAL(10) X(NS),ERX(NS),EX(NS)								   |	      REAL*8 X(NS),ERX(NS),EX(NS)
      REAL(10) DB,X1,CON									   |	      REAL*8 DB,X1,CON
      REAL(10) XN,DX,GR,CR,TEX,TERX								   |	      REAL*8 XN,DX,GR,CR,TEX,TERX
      REAL(10) DOPLER_STRK									   |	      REAL*8 DOPLER_STRK
      REAL(10) ASINT_STRK									   |	      REAL*8 ASINT_STRK
      REAL(10) ERR_STRK										   |	      REAL*8 ERR_STRK
      REAL(10) FUNCTION TBG_STRK(BET,GAM)							   |	      REAL*8 FUNCTION TBG_STRK(BET,GAM)
      REAL(10) BET,GAM										   |	      REAL*8 BET,GAM
      REAL(10), PARAMETER :: PI=3.14159265358979						   |	      REAL*8, PARAMETER :: PI=3.14159265358979
      REAL(10) TF_STRK										   |	      REAL*8 TF_STRK
      REAL(10) TG_STRK										   |	      REAL*8 TG_STRK
      REAL(10) TH_STRK										   |	      REAL*8 TH_STRK
      REAL(10) FUNCTION TG_STRK(BET,GAM)							   |	      REAL*8 FUNCTION TG_STRK(BET,GAM)
      REAL(10) BET,GAM										   |	      REAL*8 BET,GAM
      REAL(10), PARAMETER :: C4=1.5D0								   |	      REAL*8, PARAMETER :: C4=1.5D0
      REAL(10), PARAMETER :: C5=3.4636008D1							   |	      REAL*8, PARAMETER :: C5=3.4636008D1
      REAL(10), PARAMETER :: C6=-1.3253986E2							   |	      REAL*8, PARAMETER :: C6=-1.3253986E2
      REAL(10), PARAMETER :: PI2=1.57079632679489						   |	      REAL*8, PARAMETER :: PI2=1.57079632679489
!												   |	!
      REAL(10) G2,B,C,BET2,CC,R									   |	      REAL*8 G2,B,C,BET2,CC,R
      REAL(10) P,P2,Q,Q2									   |	      REAL*8 P,P2,Q,Q2
      REAL(10) SINA,COSA2,SINA2									   |	      REAL*8 SINA,COSA2,SINA2
      REAL(10) Y1,Y2										   |	      REAL*8 Y1,Y2
      REAL(10) X1,X2,X3,X4,X5									   |	      REAL*8 X1,X2,X3,X4,X5
      REAL(10) D1,D2,D3,D4,D5,D6,D7,D8,D9							   |	      REAL*8 D1,D2,D3,D4,D5,D6,D7,D8,D9
      REAL(10) SUM1,SUM2,SUM3,SUM4								   |	      REAL*8 SUM1,SUM2,SUM3,SUM4
      REAL(10) FUNCTION TF_STRK(B,G)								   |	      REAL*8 FUNCTION TF_STRK(B,G)
      REAL(10) B										   |	      REAL*8 B
      REAL(10) G										   |	      REAL*8 G
      REAL(10), PARAMETER :: C0=1.0007744D-01							   |	      REAL*8, PARAMETER :: C0=1.0007744D-01
      REAL(10), PARAMETER :: C1=4.93208719D-03							   |	      REAL*8, PARAMETER :: C1=4.93208719D-03
      REAL(10), PARAMETER :: C2=-7.09873526D-03							   |	      REAL*8, PARAMETER :: C2=-7.09873526D-03
      REAL(10), PARAMETER :: C3=7.11559325D-04							   |	      REAL*8, PARAMETER :: C3=7.11559325D-04
      REAL(10) X1,G2										   |	      REAL*8 X1,G2
      REAL(10) D,D1,D2,D3									   |	      REAL*8 D,D1,D2,D3
      REAL(10) FUNCTION TH_STRK(X)								   |	      REAL*8 FUNCTION TH_STRK(X)
      REAL(10) X										   |	      REAL*8 X
      REAL(10), PARAMETER :: C0=1.0007744D-01							   |	      REAL*8, PARAMETER :: C0=1.0007744D-01
      REAL(10), PARAMETER :: C1=4.93208719D-03							   |	      REAL*8, PARAMETER :: C1=4.93208719D-03
      REAL(10), PARAMETER :: C2=-7.09873526D-03							   |	      REAL*8, PARAMETER :: C2=-7.09873526D-03
      REAL(10), PARAMETER :: C3=7.11559325D-04							   |	      REAL*8, PARAMETER :: C3=7.11559325D-04
      REAL(10), PARAMETER :: C4=1.5D0								   |	      REAL*8, PARAMETER :: C4=1.5D0
      REAL(10), PARAMETER :: C5=3.4636008D1							   |	      REAL*8, PARAMETER :: C5=3.4636008D1
      REAL(10), PARAMETER :: C6=-1.3253986D2							   |	      REAL*8, PARAMETER :: C6=-1.3253986D2
      REAL(10) B,B2,SRT										   |	      REAL*8 B,B2,SRT
      REAL(10) FUNCTION ASINT_STRK(X0,X1,DB)							   |	      REAL*8 FUNCTION ASINT_STRK(X0,X1,DB)
      REAL(10) X0,X1,DB										   |	      REAL*8 X0,X1,DB
      REAL(10), PARAMETER :: SRTPI=5.6418958D-1							   |	      REAL*8, PARAMETER :: SRTPI=5.6418958D-1
      REAL(10), PARAMETER :: C23=6.666666667D-1							   |	      REAL*8, PARAMETER :: C23=6.666666667D-1
      REAL(10), PARAMETER :: HALF=0.5D0								   |	      REAL*8, PARAMETER :: HALF=0.5D0
      REAL(10), PARAMETER :: ONE=1.0D0								   |	      REAL*8, PARAMETER :: ONE=1.0D0
      REAL(10), PARAMETER :: TWO=2.0D0								   |	      REAL*8, PARAMETER :: TWO=2.0D0
      REAL(10), PARAMETER :: STEP=0.2D0								   |	      REAL*8, PARAMETER :: STEP=0.2D0
      REAL(10) H,X,DX										   |	      REAL*8 H,X,DX
      REAL(10) F										   |	      REAL*8 F
      REAL(10) DOPLER_STRK									   |	      REAL*8 DOPLER_STRK
      REAL(10) FUNCTION DOPLER_STRK(X)								   |	      REAL*8 FUNCTION DOPLER_STRK(X)
      REAL(10) X,SQ										   |	      REAL*8 X,SQ
      REAL(10) FUNCTION ERR_STRK(X)								   |	      REAL*8 FUNCTION ERR_STRK(X)
      REAL(10) X										   |	      REAL*8 X
      REAL(10) T,EX,ONE										   |	      REAL*8 T,EX,ONE
      REAL(10) DOPLER_STRK									   |	      REAL*8 DOPLER_STRK
./stark/init_prof_module.f
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
./stark/init_prof_module_v2.f
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) FUN_PI										   |		REAL*8 FUN_PI
./stark/prof_mod.f
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PI										   |		REAL*8 PI
	REAL(10), ALLOCATABLE :: PROF_STORE(:,:,:)						   |		REAL*8, ALLOCATABLE :: PROF_STORE(:,:,:)
	REAL(10), ALLOCATABLE :: NU_STORE(:,:)							   |		REAL*8, ALLOCATABLE :: NU_STORE(:,:)
	REAL(10), ALLOCATABLE :: AMASS_STORE(:)							   |		REAL*8, ALLOCATABLE :: AMASS_STORE(:)
	REAL(10), ALLOCATABLE :: NU_ZERO_STORE(:)						   |		REAL*8, ALLOCATABLE :: NU_ZERO_STORE(:)
	REAL(10), ALLOCATABLE :: PR_GRIEM(:)							   |		REAL*8, ALLOCATABLE :: PR_GRIEM(:)
	REAL(10), ALLOCATABLE :: DWS_GRIEM(:)							   |		REAL*8, ALLOCATABLE :: DWS_GRIEM(:)
	  REAL(10), ALLOCATABLE :: VGT_PROF(:,:)						   |		  REAL*8, ALLOCATABLE :: VGT_PROF(:,:)
./stark/rd_bs_strk_tab.f
	REAL(10), ALLOCATABLE :: STKTA_DWS(:)	!Offset from line center (Ang)			   |		REAL*8, ALLOCATABLE :: STKTA_DWS(:)	!Offset from line center (Ang)
	REAL(10), ALLOCATABLE :: STKTA_TS(:)	!Temperature (Log T(K))				   |		REAL*8, ALLOCATABLE :: STKTA_TS(:)	!Temperature (Log T(K))
	REAL(10), ALLOCATABLE :: STKTA_ES(:)	!Log Ne (cgs units) 				   |		REAL*8, ALLOCATABLE :: STKTA_ES(:)	!Log Ne (cgs units) 
	REAL(10), ALLOCATABLE :: STKTA_PS(:)	!Phi(v)						   |		REAL*8, ALLOCATABLE :: STKTA_PS(:)	!Phi(v)
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
./stark/rd_strk_list.f
	REAL(10), ALLOCATABLE :: LST_WAVE(:)							   |		REAL*8, ALLOCATABLE :: LST_WAVE(:)
	REAL(10), ALLOCATABLE :: LST_GAM_RAD(:)							   |		REAL*8, ALLOCATABLE :: LST_GAM_RAD(:)
	REAL(10), ALLOCATABLE :: LST_GAM_COL(:)							   |		REAL*8, ALLOCATABLE :: LST_GAM_COL(:)
	REAL(10), ALLOCATABLE :: LST_V_PROF_LIMIT(:)						   |		REAL*8, ALLOCATABLE :: LST_V_PROF_LIMIT(:)
	REAL(10), ALLOCATABLE :: INT_WRK(:)							   |		REAL*8, ALLOCATABLE :: INT_WRK(:)
	REAL(10), ALLOCATABLE :: DP_WRK(:)							   |		REAL*8, ALLOCATABLE :: DP_WRK(:)
	REAL(10) LAM_VAC									   |		REAL*8 LAM_VAC
./stark/set_griem.f
	REAL(10) PROF(NFREQ,ND),NU(NFREQ)							   |		REAL*8 PROF(NFREQ,ND),NU(NFREQ)
	REAL(10) ED_IN(ND),TEMP_IN(ND),VDOP_IN(ND)						   |		REAL*8 ED_IN(ND),TEMP_IN(ND),VDOP_IN(ND)
	REAL(10) AMASS_IN,Z_IN									   |		REAL*8 AMASS_IN,Z_IN
	REAL(10) LAM_ZERO,NU_ZERO,RHYD								   |		REAL*8 LAM_ZERO,NU_ZERO,RHYD
	REAL(10) RYDBERG_HYDROGEN								   |		REAL*8 RYDBERG_HYDROGEN
	REAL(10) DWS(NF_MAX),PR(NF_MAX)								   |		REAL*8 DWS(NF_MAX),PR(NF_MAX)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
      IMPLICIT REAL(10) (A-H,O-Z)								   |	      IMPLICIT DOUBLE PRECISION (A-H,O-Z)
./stark/set_prof.f
	REAL(10) PROF(ND)									   |		REAL*8 PROF(ND)
	REAL(10) NU(ML_END)  		!Can actually be larger					   |		REAL*8 NU(ML_END)  		!Can actually be larger
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN,Z_IN,NU_ZERO								   |		REAL*8 AMASS_IN,Z_IN,NU_ZERO
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_ED,NU_DOP									   |		REAL*8 TMP_ED,NU_DOP
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
./stark/set_prof_limits_v1.f
	REAL(10) VEC_STRT_FREQ									   |		REAL*8 VEC_STRT_FREQ
	REAL(10) VEC_VDOP_MIN									   |		REAL*8 VEC_VDOP_MIN
	REAL(10) DOP_LIMIT									   |		REAL*8 DOP_LIMIT
	REAL(10) VOIGT_LIMIT									   |		REAL*8 VOIGT_LIMIT
	REAL(10) CHIL(ND) 									   |		REAL*8 CHIL(ND) 
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_NAT									   |		REAL*8 GAM_NAT
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) VTURB_FIX									   |		REAL*8 VTURB_FIX
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) NU_DOP(ND)									   |		REAL*8 NU_DOP(ND)
	REAL(10) LINE_TO_CONT_RATIO(ND)								   |		REAL*8 LINE_TO_CONT_RATIO(ND)
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) PROF_LINE_CENTER								   |		REAL*8 PROF_LINE_CENTER
./stark/set_prof_limits_v2.f
	REAL(10) VEC_STRT_FREQ									   |		REAL*8 VEC_STRT_FREQ
	REAL(10) VEC_VDOP_MIN									   |		REAL*8 VEC_VDOP_MIN
	REAL(10) DOP_LIMIT									   |		REAL*8 DOP_LIMIT
	REAL(10) VOIGT_LIMIT									   |		REAL*8 VOIGT_LIMIT
!												   |	!
	REAL(10) CHIL(ND) 									   |		REAL*8 CHIL(ND) 
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_RAD									   |		REAL*8 GAM_RAD
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) VTURB_FIX									   |		REAL*8 VTURB_FIX
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) NU_DOP(ND)									   |		REAL*8 NU_DOP(ND)
	REAL(10) LINE_TO_CONT_RATIO(ND)								   |		REAL*8 LINE_TO_CONT_RATIO(ND)
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) WAVE										   |		REAL*8 WAVE
	REAL(10) LOC_GAM_RAD									   |		REAL*8 LOC_GAM_RAD
	REAL(10) LOC_GAM_COL									   |		REAL*8 LOC_GAM_COL
	REAL(10) V_PROF_LIMIT									   |		REAL*8 V_PROF_LIMIT
	REAL(10) PROF_LINE_CENTER								   |		REAL*8 PROF_LINE_CENTER
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./stark/set_prof_limits_v3.f
	REAL(10) VEC_STRT_FREQ									   |		REAL*8 VEC_STRT_FREQ
	REAL(10) VEC_VDOP_MIN									   |		REAL*8 VEC_VDOP_MIN
	REAL(10) DOP_LIMIT									   |		REAL*8 DOP_LIMIT
	REAL(10) VOIGT_LIMIT									   |		REAL*8 VOIGT_LIMIT
!												   |	!
	REAL(10) CHIL(ND) 									   |		REAL*8 CHIL(ND) 
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_RAD									   |		REAL*8 GAM_RAD
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) AMASS_DOP									   |		REAL*8 AMASS_DOP
	REAL(10) VTURB										   |		REAL*8 VTURB
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) NU_DOP(ND)									   |		REAL*8 NU_DOP(ND)
	REAL(10) LINE_TO_CONT_RATIO(ND)								   |		REAL*8 LINE_TO_CONT_RATIO(ND)
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) WAVE										   |		REAL*8 WAVE
	REAL(10) LOC_GAM_RAD									   |		REAL*8 LOC_GAM_RAD
	REAL(10) LOC_GAM_COL									   |		REAL*8 LOC_GAM_COL
	REAL(10) V_PROF_LIMIT									   |		REAL*8 V_PROF_LIMIT
	REAL(10) PROF_LINE_CENTER								   |		REAL*8 PROF_LINE_CENTER
	REAL(10) T1,T2										   |		REAL*8 T1,T2
./stark/set_prof_limits_v4.f
	REAL(10) VEC_STRT_FREQ									   |		REAL*8 VEC_STRT_FREQ
	REAL(10) VEC_VDOP_MIN									   |		REAL*8 VEC_VDOP_MIN
	REAL(10) DOP_LIMIT									   |		REAL*8 DOP_LIMIT
	REAL(10) VOIGT_LIMIT									   |		REAL*8 VOIGT_LIMIT
!												   |	!
	REAL(10) CHIL(ND) 									   |		REAL*8 CHIL(ND) 
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_RAD									   |		REAL*8 GAM_RAD
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) AMASS_DOP									   |		REAL*8 AMASS_DOP
	REAL(10) VTURB										   |		REAL*8 VTURB
	REAL(10) V_PROF_LIMIT									   |		REAL*8 V_PROF_LIMIT
	REAL(10) MAX_PROF_ED									   |		REAL*8 MAX_PROF_ED
	REAL(10) SPEED_OF_LIGHT									   |		REAL*8 SPEED_OF_LIGHT
	REAL(10) ESEC(ND)									   |		REAL*8 ESEC(ND)
	REAL(10) ED_MOD(ND)									   |		REAL*8 ED_MOD(ND)
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) NU_DOP(ND)									   |		REAL*8 NU_DOP(ND)
	REAL(10) LINE_TO_CONT_RATIO(ND)								   |		REAL*8 LINE_TO_CONT_RATIO(ND)
	REAL(10) dNU										   |		REAL*8 dNU
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) WAVE										   |		REAL*8 WAVE
	REAL(10) LOC_GAM_RAD									   |		REAL*8 LOC_GAM_RAD
	REAL(10) LOC_GAM_COL									   |		REAL*8 LOC_GAM_COL
	REAL(10) PROF_LINE_CENTER								   |		REAL*8 PROF_LINE_CENTER
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) LOCAL_V_PROF_LIMIT								   |		REAL*8 LOCAL_V_PROF_LIMIT
./stark/set_prof_v2.f
	REAL(10) PROF(ND)									   |		REAL*8 PROF(ND)
	REAL(10) NU(ML_END)  		!Can actually be larger					   |		REAL*8 NU(ML_END)  		!Can actually be larger
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_NAT									   |		REAL*8 GAM_NAT
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) VTURB_FIX		!Turbulent velocity (km/s): same at all depths		   |		REAL*8 VTURB_FIX		!Turbulent velocity (km/s): same at all depths
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_ED,NU_DOP									   |		REAL*8 TMP_ED,NU_DOP
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) A_VOIGT									   |		REAL*8 A_VOIGT
	REAL(10) V_VOIGT									   |		REAL*8 V_VOIGT
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./stark/set_prof_v3.f
	REAL(10) PROF(ND)									   |		REAL*8 PROF(ND)
	REAL(10) NU(ML_END)  		!Can actually be larger					   |		REAL*8 NU(ML_END)  		!Can actually be larger
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) POP_PROTON(ND)									   |		REAL*8 POP_PROTON(ND)
	REAL(10) POP_HEPLUS(ND)									   |		REAL*8 POP_HEPLUS(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_RAD									   |		REAL*8 GAM_RAD
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) VTURB_FIX		!Turbulent velocity (km/s): same at all depths		   |		REAL*8 VTURB_FIX		!Turbulent velocity (km/s): same at all depths
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_ED,NU_DOP									   |		REAL*8 TMP_ED,NU_DOP
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) XNU(ML_END-ML_ST+1)								   |		REAL*8 XNU(ML_END-ML_ST+1)
	REAL(10) A_VOIGT									   |		REAL*8 A_VOIGT
	REAL(10) V_VOIGT									   |		REAL*8 V_VOIGT
	REAL(10) LOC_GAM_RAD									   |		REAL*8 LOC_GAM_RAD
	REAL(10) LOC_GAM_COL									   |		REAL*8 LOC_GAM_COL
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./stark/set_prof_v4.f
	REAL(10) PROF(ND)									   |		REAL*8 PROF(ND)
	REAL(10) NU(ML_END)  		!Can actually be larger					   |		REAL*8 NU(ML_END)  		!Can actually be larger
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) POP_PROTON(ND)									   |		REAL*8 POP_PROTON(ND)
	REAL(10) POP_HEPLUS(ND)									   |		REAL*8 POP_HEPLUS(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_RAD									   |		REAL*8 GAM_RAD
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) VTURB		!Turbulent velocity (km/s): same at all depths			   |		REAL*8 VTURB		!Turbulent velocity (km/s): same at all depths
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) AMASS_DOP									   |		REAL*8 AMASS_DOP
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_ED,NU_DOP									   |		REAL*8 TMP_ED,NU_DOP
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) XNU(ML_END-ML_ST+1)								   |		REAL*8 XNU(ML_END-ML_ST+1)
	REAL(10) A_VOIGT									   |		REAL*8 A_VOIGT
	REAL(10) V_VOIGT									   |		REAL*8 V_VOIGT
	REAL(10) LOC_GAM_RAD									   |		REAL*8 LOC_GAM_RAD
	REAL(10) LOC_GAM_COL									   |		REAL*8 LOC_GAM_COL
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./stark/set_prof_v5.f
	REAL(10) PROF(ND)									   |		REAL*8 PROF(ND)
	REAL(10) NU(ML_END)  		!Can actually be larger					   |		REAL*8 NU(ML_END)  		!Can actually be larger
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) POP_PROTON(ND)									   |		REAL*8 POP_PROTON(ND)
	REAL(10) POP_HEPLUS(ND)									   |		REAL*8 POP_HEPLUS(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_RAD									   |		REAL*8 GAM_RAD
	REAL(10) C4_INTER									   |		REAL*8 C4_INTER
	REAL(10) VTURB		!Turbulent velocity (km/s): same at all depths			   |		REAL*8 VTURB		!Turbulent velocity (km/s): same at all depths
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) AMASS_DOP									   |		REAL*8 AMASS_DOP
	REAL(10) MAX_PROF_ED									   |		REAL*8 MAX_PROF_ED
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_ED,NU_DOP									   |		REAL*8 TMP_ED,NU_DOP
	REAL(10) TMP_VEC(ND)									   |		REAL*8 TMP_VEC(ND)
	REAL(10) ED_MOD(ND)									   |		REAL*8 ED_MOD(ND)
	REAL(10) XNU(ML_END-ML_ST+1)								   |		REAL*8 XNU(ML_END-ML_ST+1)
	REAL(10) A_VOIGT									   |		REAL*8 A_VOIGT
	REAL(10) V_VOIGT									   |		REAL*8 V_VOIGT
	REAL(10) LOC_GAM_RAD									   |		REAL*8 LOC_GAM_RAD
	REAL(10) LOC_GAM_COL									   |		REAL*8 LOC_GAM_COL
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./stark/set_prof_v6.f
	REAL(10) LINE_PROF_SIM(ND,MAX_SIM)							   |		REAL*8 LINE_PROF_SIM(ND,MAX_SIM)
	REAL(10) AMASS_SIM(MAX_SIM)								   |		REAL*8 AMASS_SIM(MAX_SIM)
	REAL(10) ED_IN(ND)									   |		REAL*8 ED_IN(ND)
	REAL(10) POP_PROTON(ND)									   |		REAL*8 POP_PROTON(ND)
	REAL(10) POP_HEPLUS(ND)									   |		REAL*8 POP_HEPLUS(ND)
	REAL(10) TEMP_IN(ND)									   |		REAL*8 TEMP_IN(ND)
	REAL(10) VTURB_IN(ND)									   |		REAL*8 VTURB_IN(ND)
	REAL(10) Z_POP(NT)									   |		REAL*8 Z_POP(NT)
!												   |	!
	REAL(10) VTURB		!Turbulent velocity (km/s): same at all depths			   |		REAL*8 VTURB		!Turbulent velocity (km/s): same at all depths
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) AMASS_DOP	!Same for all species when used.				   |		REAL*8 AMASS_DOP	!Same for all species when used.
	REAL(10) MAX_PROF_ED	!Limits witdt of Voigt/Stark profiles				   |		REAL*8 MAX_PROF_ED	!Limits witdt of Voigt/Stark profiles
	REAL(10), ALLOCATABLE ::  XNU(:)							   |		REAL*8, ALLOCATABLE ::  XNU(:)
	REAL(10) VTURB_SQ(ND)									   |		REAL*8 VTURB_SQ(ND)
	REAL(10) ED_MOD(ND)									   |		REAL*8 ED_MOD(ND)
!												   |	!
	REAL(10) AMASS_IN									   |		REAL*8 AMASS_IN
	REAL(10) Z_IN										   |		REAL*8 Z_IN
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) GAM_RAD									   |		REAL*8 GAM_RAD
	REAL(10) C4_INTER									   |		REAL*8 C4_INTER
!												   |	!
	REAL(10) T1,T2										   |		REAL*8 T1,T2
	REAL(10) TMP_ED,NU_DOP									   |		REAL*8 TMP_ED,NU_DOP
	REAL(10) A_VOIGT									   |		REAL*8 A_VOIGT
	REAL(10) V_VOIGT									   |		REAL*8 V_VOIGT
	REAL(10) LOC_GAM_RAD									   |		REAL*8 LOC_GAM_RAD
	REAL(10) LOC_GAM_COL									   |		REAL*8 LOC_GAM_COL
	REAL(10) VOIGT										   |		REAL*8 VOIGT
./stark/strk_bs_hhe.f
	REAL(10) PROF(ND,NF)									   |		REAL*8 PROF(ND,NF)
	REAL(10) FREQ(NF)									   |		REAL*8 FREQ(NF)
	REAL(10) ED(ND)										   |		REAL*8 ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) VTURB(ND)									   |		REAL*8 VTURB(ND)
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) WAVE										   |		REAL*8 WAVE
	REAL(10) AMASS										   |		REAL*8 AMASS
	REAL(10) TLOG										   |		REAL*8 TLOG
	REAL(10) ELOG										   |		REAL*8 ELOG
	REAL(10) ST1,ST2									   |		REAL*8 ST1,ST2
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10), ALLOCATABLE :: STARK(:)							   |		REAL*8, ALLOCATABLE :: STARK(:)
	REAL(10), ALLOCATABLE :: TMP_DWS(:)							   |		REAL*8, ALLOCATABLE :: TMP_DWS(:)
	REAL(10) DLAM(NF)									   |		REAL*8 DLAM(NF)
	REAL(10) LOC_PROF(NF)									   |		REAL*8 LOC_PROF(NF)
	REAL(10) T_WGT										   |		REAL*8 T_WGT
	REAL(10) ED_WGT										   |		REAL*8 ED_WGT
	REAL(10) DLAM_THERM									   |		REAL*8 DLAM_THERM
	REAL(10) DLAM_TURB									   |		REAL*8 DLAM_TURB
./stark/tst_griem.f
	REAL(10) PROF(NFREQ,ND_MAX)								   |		REAL*8 PROF(NFREQ,ND_MAX)
	REAL(10) NU(NFREQ),LAM(NFREQ),LOGLAM(NFREQ)						   |		REAL*8 NU(NFREQ),LAM(NFREQ),LOGLAM(NFREQ)
	REAL(10) ED_IN(ND_MAX),TEMP_IN(ND_MAX),VDOP_IN(ND_MAX)					   |		REAL*8 ED_IN(ND_MAX),TEMP_IN(ND_MAX),VDOP_IN(ND_MAX)
	REAL(10) Z_IN,AMASS_IN									   |		REAL*8 Z_IN,AMASS_IN
	REAL(10) RYDBERG_HYDROGEN								   |		REAL*8 RYDBERG_HYDROGEN
	REAL(10) DEL_NU,T1,RHYD,LAM_ZERO,NU_ZERO						   |		REAL*8 DEL_NU,T1,RHYD,LAM_ZERO,NU_ZERO
	REAL(10) KTH_LAM(17),KTH_GRI(17)							   |		REAL*8 KTH_LAM(17),KTH_GRI(17)
./stark/tst_set_prof.f
	REAL(10) ED_IN(ND_MAX)									   |		REAL*8 ED_IN(ND_MAX)
	REAL(10) TEMP_IN(ND_MAX)								   |		REAL*8 TEMP_IN(ND_MAX)
	REAL(10) CHIL(ND_MAX)									   |		REAL*8 CHIL(ND_MAX)
	REAL(10) VDOP_IN(ND_MAX)								   |		REAL*8 VDOP_IN(ND_MAX)
	REAL(10) ZERO_VEC(ND_MAX)								   |		REAL*8 ZERO_VEC(ND_MAX)
	REAL(10) PROF(NFREQ,ND_MAX)								   |		REAL*8 PROF(NFREQ,ND_MAX)
	REAL(10) PRO_VEC(ND_MAX)								   |		REAL*8 PRO_VEC(ND_MAX)
	REAL(10) NU(NFREQ),LAM(NFREQ)								   |		REAL*8 NU(NFREQ),LAM(NFREQ)
	REAL(10) VEL_KMS(NFREQ),LOGLAM(NFREQ)							   |		REAL*8 VEL_KMS(NFREQ),LOGLAM(NFREQ)
	REAL(10) NORM(ND_MAX)									   |		REAL*8 NORM(ND_MAX)
	REAL(10) Z_IN,AMASS_IN									   |		REAL*8 Z_IN,AMASS_IN
	REAL(10) C_KMS										   |		REAL*8 C_KMS
	REAL(10) VTURB										   |		REAL*8 VTURB
	REAL(10) VTURB_FIX									   |		REAL*8 VTURB_FIX
	REAL(10) GAM_NAT									   |		REAL*8 GAM_NAT
	REAL(10) GAM_COL									   |		REAL*8 GAM_COL
	REAL(10) DOP_PROF_LIMIT									   |		REAL*8 DOP_PROF_LIMIT
	REAL(10) VOIGT_PROF_LIMIT								   |		REAL*8 VOIGT_PROF_LIMIT
	REAL(10) V_PROF_LIMIT									   |		REAL*8 V_PROF_LIMIT
	REAL(10) LAM_VAC,SPEED_OF_LIGHT								   |		REAL*8 LAM_VAC,SPEED_OF_LIGHT
	REAL(10) START_FREQ									   |		REAL*8 START_FREQ
	REAL(10) DEL_NU										   |		REAL*8 DEL_NU
	REAL(10) NU_ZERO									   |		REAL*8 NU_ZERO
	REAL(10) LAMBDA										   |		REAL*8 LAMBDA
	REAL(10) TDOP										   |		REAL*8 TDOP
	REAL(10) AMASS_DOP									   |		REAL*8 AMASS_DOP
	REAL(10) MAX_PROF_ED									   |		REAL*8 MAX_PROF_ED
	REAL(10) T1										   |		REAL*8 T1
./stark/voigtn.f
      REAL(10) VOIGTN,AA,VV									   |	      REAL*8 VOIGTN,AA,VV
      REAL(10) H(25)										   |	      REAL*8 H(25)
      REAL(10) V,V2,V4,V6									   |	      REAL*8 V,V2,V4,V6
      REAL(10) A,A2,A4,A6									   |	      REAL*8 A,A2,A4,A6
      REAL(10) Z,Z2                       							   |	      REAL*8 Z,Z2                       
      REAL(10) X,W										   |	      REAL*8 X,W
      REAL(10) C1,C2										   |	      REAL*8 C1,C2
      REAL(10) DAWSON										   |	      REAL*8 DAWSON
      REAL(10) DAWSON,XX									   |	      REAL*8 DAWSON,XX
      REAL(10) X,U										   |	      REAL*8 X,U
      REAL(10) UP,DOWN										   |	      REAL*8 UP,DOWN
./stark/strk_ds.f90
	REAL(10) FREQ(NF)		!Frequncy in units of 10^15 Hz				   |		REAL*8 FREQ(NF)		!Frequncy in units of 10^15 Hz
	REAL(10) PRO(ND,NF)	!Profile							   |		REAL*8 PRO(ND,NF)	!Profile
	REAL(10) TE(ND)		!Electron temperature (10^4 K)					   |		REAL*8 TE(ND)		!Electron temperature (10^4 K)
	REAL(10) ED(ND)		!Electron density (cgs units)					   |		REAL*8 ED(ND)		!Electron density (cgs units)
	REAL(10) VTURB(ND)	!Turbulent velocity km/s					   |		REAL*8 VTURB(ND)	!Turbulent velocity km/s
	REAL(10) NU_ZERO		!Line frequency (10^15 Hz)				   |		REAL*8 NU_ZERO		!Line frequency (10^15 Hz)
	REAL(10) AMASS		!Species mass in AMU						   |		REAL*8 AMASS		!Species mass in AMU
	REAL(10) STKTB_TS(MXS)									   |		REAL*8 STKTB_TS(MXS)
	REAL(10) STKTB_WS(MXS)									   |		REAL*8 STKTB_WS(MXS)
	REAL(10) STKTB_DS(MXS)									   |		REAL*8 STKTB_DS(MXS)
	REAL(10) STKTB_AS(MXS)									   |		REAL*8 STKTB_AS(MXS)
	REAL(10) STKTB_DLP									   |		REAL*8 STKTB_DLP
	REAL(10) STKTB_ELE									   |		REAL*8 STKTB_ELE
	REAL(10) DLS,FOS,FT,RFT,WT,RWT,RBHZ,RBA,TT,EE,VMOT,WF,Y,PP				   |		REAL*8 DLS,FOS,FT,RFT,WT,RWT,RBHZ,RBA,TT,EE,VMOT,WF,Y,PP
	REAL(10) VM,RHOM,ALF,SIGMA,X,A,CON,DB,P,VA,VB,D,W					   |		REAL*8 VM,RHOM,ALF,SIGMA,X,A,CON,DB,P,VA,VB,D,W
	REAL(10) TMP										   |		REAL*8 TMP
	REAL(10) CLIGHT,SRT									   |		REAL*8 CLIGHT,SRT
	REAL(10) VOIGTN										   |		REAL*8 VOIGTN
./stark/strk_hei_ir.f90
	REAL(10) FREQ(NF)			!Frequncy in units of 10^15 Hz			   |		REAL*8 FREQ(NF)			!Frequncy in units of 10^15 Hz
	REAL(10) PRO(ND,NF)		!Profile						   |		REAL*8 PRO(ND,NF)		!Profile
	REAL(10) TE(ND)			!Electron temperature (10^4 K)				   |		REAL*8 TE(ND)			!Electron temperature (10^4 K)
	REAL(10) ED(ND)			!Electron density (cgs units)				   |		REAL*8 ED(ND)			!Electron density (cgs units)
	REAL(10) POP_PROTON(ND)		!Proton density (cgs units)				   |		REAL*8 POP_PROTON(ND)		!Proton density (cgs units)
	REAL(10) POP_HEPLUS(ND)		!He+ density (cgs units)				   |		REAL*8 POP_HEPLUS(ND)		!He+ density (cgs units)
	REAL(10) VTURB(ND)		!Turbulent velocity km/s				   |		REAL*8 VTURB(ND)		!Turbulent velocity km/s
	REAL(10) NU_ZERO			!Line frequency (10^15 Hz)			   |		REAL*8 NU_ZERO			!Line frequency (10^15 Hz)
	REAL(10) AMASS			!Species mass in AMU					   |		REAL*8 AMASS			!Species mass in AMU
	REAL(10) STKTB_TS(MXS)									   |		REAL*8 STKTB_TS(MXS)
	REAL(10) STKTB_WS(MXS)									   |		REAL*8 STKTB_WS(MXS)
	REAL(10) STKTB_DS(MXS)									   |		REAL*8 STKTB_DS(MXS)
	REAL(10) STKTB_WPS(MXS)									   |		REAL*8 STKTB_WPS(MXS)
	REAL(10) STKTB_DPS(MXS)									   |		REAL*8 STKTB_DPS(MXS)
	REAL(10) STKTB_WIS(MXS)									   |		REAL*8 STKTB_WIS(MXS)
	REAL(10) STKTB_DIS(MXS)									   |		REAL*8 STKTB_DIS(MXS)
	REAL(10) STKTB_DLP									   |		REAL*8 STKTB_DLP
	REAL(10) STKTB_ELE									   |		REAL*8 STKTB_ELE
	REAL(10) DLS,FOS,FT,RFT,WT,RWT,RBHZ,RBA,TT,EE,VMOT,WF,Y					   |		REAL*8 DLS,FOS,FT,RFT,WT,RWT,RBHZ,RBA,TT,EE,VMOT,WF,Y
	REAL(10) X,A,CON,DB,P,VA,D,W								   |		REAL*8 X,A,CON,DB,P,VA,D,W
	REAL(10) TMP										   |		REAL*8 TMP
	REAL(10) CLIGHT,SRT									   |		REAL*8 CLIGHT,SRT
	REAL(10) VOIGTN										   |		REAL*8 VOIGTN
 
Comparing files in ./txt_files with those in  /home/hillier/wnode04/cmf_testing_real8//txt_files
 
./txt_files/Makefile
./txt_files/maingen_opt_desc.txt
./txt_files/maingen_options.txt
./txt_files/plt_jh_opt_desc.txt
./txt_files/plt_jh_options.txt
./txt_files/plt_spec_opt_desc.txt
./txt_files/plt_spec_options.txt
./txt_files/wr_f_opt_desc.txt
./txt_files/wr_f_options.txt
 
Comparing files in ./tools with those in  /home/hillier/wnode04/cmf_testing_real8//tools
 
./tools/Makefile
./tools/check_vec_nan.f
	REAL(10) VEC(ND)									   |		REAL*8 VEC(ND)
./tools/chk_little_endian.f
./tools/chk_string.f
./tools/condit_string.f
./tools/constants_mod.f
! Created 7-Jan-2008 :: Based on cur_cmf/subs/phys_con.f					   |	! Altered 15-Sep-2023 :" Updated values of several constants.
												   >	! Created  7-Jan-2008 :: Based on cur_cmf/subs/phys_con.f
	REAL(10), PARAMETER :: SPEED_OF_LIGHT        =2.99792458D+10 	!Exact cm/s		   |		REAL*8, PARAMETER :: SPEED_OF_LIGHT         = 2.99792458D+10      !Exact cm/s
	REAL(10), PARAMETER :: ELECTRON_VOLT         =1.60217733D-12      !ergs			   |		REAL*8, PARAMETER :: ELECTRON_VOLT          = 1.60217733D-12      !ergs
	REAL(10), PARAMETER :: GRAVITATIONAL_CONSTANT=6.67259D-08		!cm^3/gm/s	   |		REAL*8, PARAMETER :: GRAVITATIONAL_CONSTANT = 6.67259D-08         !cm^3/gm/s
	REAL(10), PARAMETER :: PLANCKS_CONSTANT      =6.626075D-27	!erg sec		   |		REAL*8, PARAMETER :: PLANCKS_CONSTANT       = 6.62607015D-27      !erg sec
	REAL(10), PARAMETER :: ATOMIC_MASS_UNIT      =1.660540D-24	!gm			   |		REAL*8, PARAMETER :: ATOMIC_MASS_UNIT       = 1.6605390666D-24    !gm
	REAL(10), PARAMETER :: ELECTRON_MASS         =9.109389D-28	!gm			   |		REAL*8, PARAMETER :: ELECTRON_MASS          = 9.1093837015D-28    !gm
	REAL(10), PARAMETER :: BOLTZMANN_CONSTANT    =1.380658D-16	!erg/K			   |		REAL*8, PARAMETER :: ELECTRON_CHARGE        = 4.80320427E-10      !esu
	REAL(10), PARAMETER :: STEFAN_BOLTZ          =5.670400D-05	!ergs/cm^2/K^4		   |		REAL*8, PARAMETER :: BOLTZMANN_CONSTANT     = 1.380649D-16        !erg/K
												   >		REAL*8, PARAMETER :: STEFAN_BOLTZ           = 5.670374419D-05     !ergs/cm^2/K^4
	REAL(10), PARAMETER :: RYDBERG_INF     =109737.31534D0		!/cm			   |		REAL*8, PARAMETER :: RYDBERG_INF     =109737.31534D0		!/cm
	REAL(10), PARAMETER :: RYDBERG_HYDROGEN=109677.6D0		!/cm			   |		REAL*8, PARAMETER :: RYDBERG_HYDROGEN=109677.6D0		!/cm
	REAL(10), PARAMETER :: RYDBERG_HELIUM  =109722.3D0		!/cm			   |		REAL*8, PARAMETER :: RYDBERG_HELIUM  =109722.3D0		!/cm
	REAL(10), PARAMETER :: RYDBERG_CARBON  =109732.3D0		!/cm			   |		REAL*8, PARAMETER :: RYDBERG_CARBON  =109732.3D0		!/cm
	REAL(10), PARAMETER :: RYDBERG_NITROGEN=109733.0D0		!/cm			   |		REAL*8, PARAMETER :: RYDBERG_NITROGEN=109733.0D0		!/cm
	REAL(10), PARAMETER :: RYDBERG_OXYGEN  =109733.5D0		!/cm			   |		REAL*8, PARAMETER :: RYDBERG_OXYGEN  =109733.5D0		!/cm
	REAL(10), PARAMETER :: MASS_SUN=1.989D+33  			!gm			   |		REAL*8, PARAMETER :: MASS_SUN=1.989D+33  			!gm
	REAL(10), PARAMETER :: RAD_SUN =6.9599D+10			!cm (changed 7-Jan-2008)   |		REAL*8, PARAMETER :: RAD_SUN =6.9599D+10			!cm (changed 7-Jan-2008)
	REAL(10), PARAMETER :: LUM_SUN =3.826D+33				!erg/s		   |		REAL*8, PARAMETER :: LUM_SUN =3.826D+33				!erg/s
	REAL(10), PARAMETER :: TEFF_SUN=5770.0D0				!K		   |		REAL*8, PARAMETER :: TEFF_SUN=5770.0D0				!K
	REAL(10), PARAMETER :: ASTRONOMICAL_UNIT=1.49597892D+13		!cm			   |		REAL*8, PARAMETER :: ASTRONOMICAL_UNIT=1.49597892D+13		!cm
	REAL(10), PARAMETER :: PARSEC           =3.0856D+18       	!cm			   |		REAL*8, PARAMETER :: PARSEC           =3.0856D+18       	!cm
	REAL(10), PARAMETER :: JANSKY           =1.0D-23			!ergs/cm^2/s/Hz	   |		REAL*8, PARAMETER :: JANSKY           =1.0D-23			!ergs/cm^2/s/Hz
	REAL(10), PARAMETER ::           PI=3.141592653589793238462643D0			   |		REAL*8, PARAMETER ::           PI=3.141592653589793238462643D0
	REAL(10), PARAMETER ::       FUN_PI=3.141592653589793238462643D0			   |		REAL*8, PARAMETER ::       FUN_PI=3.141592653589793238462643D0
	REAL(10), PARAMETER :: SECS_IN_YEAR=31557600.0D0     		!365.25*24*60*60	   |		REAL*8, PARAMETER :: SECS_IN_YEAR=31557600.0D0     		!365.25*24*60*60
./tools/count_occur.f
./tools/form_sp_num.f
	REAL(10) VAL										   |		REAL*8 VAL
./tools/gen_in.f
	REAL(10) VAL										   |		REAL*8 VAL
	REAL(10) VAL(NMAX)									   |		REAL*8 VAL(NMAX)
./tools/get_indx.f
	REAL(10) R(NW),RVAL									   |		REAL*8 R(NW),RVAL
./tools/get_lu.f
./tools/lambert_wm_fun.f
	REAL(10) FUNCTION LAMBERT_WM_FUN(Z,LNZ)							   |		REAL*8 FUNCTION LAMBERT_WM_FUN(Z,LNZ)
	REAL(10) Z										   |		REAL*8 Z
	REAL(10) LNZ										   |		REAL*8 LNZ
	REAL(10) W										   |		REAL*8 W
	REAL(10) EN										   |		REAL*8 EN
	REAL(10) QN										   |		REAL*8 QN
	REAL(10) ZN										   |		REAL*8 ZN
	REAL(10) T1										   |		REAL*8 T1
	REAL(10) WOLD										   |		REAL*8 WOLD
./tools/mod_color_pen_def.f
./tools/new_gen_in.f
	REAL(10) VAL										   |		REAL*8 VAL
	REAL(10) VAL(NMAX)									   |		REAL*8 VAL(NMAX)
./tools/rd_energy.f
	REAL(10) STAT_WT(NMAX)									   |		REAL*8 STAT_WT(NMAX)
	REAL(10) ENERGY(NMAX)									   |		REAL*8 ENERGY(NMAX)
	REAL(10) FEDGE(NMAX)									   |		REAL*8 FEDGE(NMAX)
	REAL(10) IONIZATION_EN,ZION								   |		REAL*8 IONIZATION_EN,ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,RD_FREE_VAL							   |		REAL*8 SPEED_OF_LIGHT,RD_FREE_VAL
	REAL(10) SPEED_LIGHT									   |		REAL*8 SPEED_LIGHT
./tools/rd_energy_v2.f
	REAL(10) STAT_WT(NMAX)									   |		REAL*8 STAT_WT(NMAX)
	REAL(10) ENERGY(NMAX)									   |		REAL*8 ENERGY(NMAX)
	REAL(10) FEDGE(NMAX)									   |		REAL*8 FEDGE(NMAX)
	REAL(10) IONIZATION_EN,ZION								   |		REAL*8 IONIZATION_EN,ZION
	REAL(10) CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN						   |		REAL*8 CHIBF,CHIFF,HDKT,TWOHCSQ,OPLIN,EMLIN
	REAL(10) SPEED_OF_LIGHT,RD_FREE_VAL							   |		REAL*8 SPEED_OF_LIGHT,RD_FREE_VAL
	REAL(10) SPEED_LIGHT									   |		REAL*8 SPEED_LIGHT
./tools/rd_rvtj.f
	REAL(10) RMDOT,LUM,ABUNDH								   |		REAL*8 RMDOT,LUM,ABUNDH
	REAL(10) R(ND),V(ND),SIGMA(ND),ED(ND)							   |		REAL*8 R(ND),V(ND),SIGMA(ND),ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) POP_ATOM(ND),POP_ION(ND)							   |		REAL*8 POP_ATOM(ND),POP_ION(ND)
	REAL(10) MASS_DENSITY(ND),CLUMP_FAC(ND)							   |		REAL*8 MASS_DENSITY(ND),CLUMP_FAC(ND)
	REAL(10) ROSS_MEAN(ND),FLUX_MEAN(ND)							   |		REAL*8 ROSS_MEAN(ND),FLUX_MEAN(ND)
./tools/rd_rvtj_v2.f
	REAL(10) RMDOT,LUM,ABUNDH								   |		REAL*8 RMDOT,LUM,ABUNDH
	REAL(10) R(ND),V(ND),SIGMA(ND),ED(ND)							   |		REAL*8 R(ND),V(ND),SIGMA(ND),ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) TGREY(ND),dE_RAD_DECAY(ND)							   |		REAL*8 TGREY(ND),dE_RAD_DECAY(ND)
	REAL(10) POP_ATOM(ND),POP_ION(ND)							   |		REAL*8 POP_ATOM(ND),POP_ION(ND)
	REAL(10) MASS_DENSITY(ND),CLUMP_FAC(ND)							   |		REAL*8 MASS_DENSITY(ND),CLUMP_FAC(ND)
	REAL(10) ROSS_MEAN(ND),FLUX_MEAN(ND)							   |		REAL*8 ROSS_MEAN(ND),FLUX_MEAN(ND)
./tools/rd_rvtj_v4.f
	REAL(10) RMDOT,LUM,ABUNDH								   |		REAL*8 RMDOT,LUM,ABUNDH
	REAL(10) R(ND),V(ND),SIGMA(ND),ED(ND)							   |		REAL*8 R(ND),V(ND),SIGMA(ND),ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) TGREY(ND),dE_RAD_DECAY(ND)							   |		REAL*8 TGREY(ND),dE_RAD_DECAY(ND)
	REAL(10) POP_ATOM(ND),POP_ION(ND)							   |		REAL*8 POP_ATOM(ND),POP_ION(ND)
	REAL(10) MASS_DENSITY(ND),CLUMP_FAC(ND)							   |		REAL*8 MASS_DENSITY(ND),CLUMP_FAC(ND)
	REAL(10) ROSS_MEAN(ND),FLUX_MEAN(ND),PLANCK_MEAN(ND)					   |		REAL*8 ROSS_MEAN(ND),FLUX_MEAN(ND),PLANCK_MEAN(ND)
	REAL(10) T1										   |		REAL*8 T1
./tools/rd_rvtj_v5.f
	REAL(10) RMDOT,LUM,ABUNDH								   |		REAL*8 RMDOT,LUM,ABUNDH
	REAL(10) R(ND),V(ND),SIGMA(ND),ED(ND)							   |		REAL*8 R(ND),V(ND),SIGMA(ND),ED(ND)
	REAL(10) T(ND)										   |		REAL*8 T(ND)
	REAL(10) TGREY(ND),dE_RAD_DECAY(ND)							   |		REAL*8 TGREY(ND),dE_RAD_DECAY(ND)
	REAL(10) POP_ATOM(ND),POP_ION(ND)							   |		REAL*8 POP_ATOM(ND),POP_ION(ND)
	REAL(10) MASS_DENSITY(ND),CLUMP_FAC(ND)							   |		REAL*8 MASS_DENSITY(ND),CLUMP_FAC(ND)
	REAL(10) ROSS_MEAN(ND),FLUX_MEAN(ND),PLANCK_MEAN(ND),ABS_MEAN(ND)			   |		REAL*8 ROSS_MEAN(ND),FLUX_MEAN(ND),PLANCK_MEAN(ND),ABS_MEAN(ND)
	REAL(10) J_INT(ND),H_INT(ND),K_INT(ND)							   |		REAL*8 J_INT(ND),H_INT(ND),K_INT(ND)
	REAL(10) T1										   |		REAL*8 T1
./tools/rd_sing_vec_rvtj.f
	REAL(10) XV(ND)										   |		REAL*8 XV(ND)
./tools/read_chi_data_file.f
	REAL(10) ETA_CMF(ND,NCF)								   |		REAL*8 ETA_CMF(ND,NCF)
	REAL(10) FREQ_CMF(NCF)									   |		REAL*8 FREQ_CMF(NCF)
	REAL(10) T1										   |		REAL*8 T1
./tools/read_keyword.f
	REAL(10) VALUE										   |		REAL*8 VALUE
./tools/set_case_fn.f
./tools/sm_phot_v3.f
	REAL(10) NU(NSM_MAX)									   |		REAL*8 NU(NSM_MAX)
	REAL(10) CROSS(NSM_MAX)									   |		REAL*8 CROSS(NSM_MAX)
	REAL(10) SIG_GAU_KMS									   |		REAL*8 SIG_GAU_KMS
	REAL(10) FRAC_SIG_GAU									   |		REAL*8 FRAC_SIG_GAU
	REAL(10) CUT_ACCURACY									   |		REAL*8 CUT_ACCURACY
	REAL(10) NU_SM(NSM_MAX)									   |		REAL*8 NU_SM(NSM_MAX)
	REAL(10) CROSS_SM(NSM_MAX)								   |		REAL*8 CROSS_SM(NSM_MAX)
	REAL(10) Z(NZ)										   |		REAL*8 Z(NZ)
	REAL(10) NU_FINE(NLOC)									   |		REAL*8 NU_FINE(NLOC)
	REAL(10) CROSS_FINE(NLOC)								   |		REAL*8 CROSS_FINE(NLOC)
	REAL(10) T1,T2,DIFF,SUM,SIG_NEW								   |		REAL*8 T1,T2,DIFF,SUM,SIG_NEW
	REAL(10) LAST_FREQ									   |		REAL*8 LAST_FREQ
	REAL(10) DNU										   |		REAL*8 DNU
	REAL(10) dCROSS										   |		REAL*8 dCROSS
	REAL(10) SIG_GAU									   |		REAL*8 SIG_GAU
	REAL(10) NU_ST										   |		REAL*8 NU_ST
	REAL(10) MAX_DEL									   |		REAL*8 MAX_DEL
	REAL(10) PTS_PER_SIG									   |		REAL*8 PTS_PER_SIG
./tools/sve_file.f
./tools/test_usr_option.f
      REAL(10) :: a,g										   |	      real*8 :: a,g
      REAL(10), dimension(10) :: d,e								   |	      real*8, dimension(10) :: d,e
./tools/tst_gen_in.f
	REAL(10) VEC(NMAX)									   |		REAL*8 VEC(NMAX)
./tools/tst_get_indx.f
	REAL(10) XD,XVECD(N)									   |		REAL*8 XD,XVECD(N)
	REAL(10) VALD										   |		REAL*8 VALD
./tools/tst_new_gen.f
	REAL(10) VEC(NMAX)									   |		REAL*8 VEC(NMAX)
./tools/update_keyword.f
	REAL(10) VALUE										   |		REAL*8 VALUE
./tools/upper_case.f
./tools/usr_hidden_4.f
./tools/usr_hidden.f
      REAL(10) :: input										   |	      real*8 :: input
      REAL(10), dimension(dim) :: input								   |	      real*8, dimension(dim) :: input
      REAL(10) t1										   |	      real*8 t1
./tools/usr_option_4.f
./tools/usr_option.f
      REAL(10) :: input										   |	      real*8 :: input
      REAL(10), dimension(dim) :: input								   |	      real*8, dimension(dim) :: input
      REAL(10) t1										   |	      real*8 t1
./tools/wr_col_str.f
./tools/wr_fmt_string.f
./tools/wr_string_4.f
./tools/wr_string.f
      REAL(10) :: input,t1									   |	      real*8 :: input,t1
      REAL(10), dimension(dim) :: input								   |	      real*8, dimension(dim) :: input
      REAL(10) :: t1										   |	      real*8 :: t1
      REAL(10) :: t1										   |	      real*8 :: t1
      REAL(10) :: t1										   |	      real*8 :: t1
 
Comparing files in ./unix with those in  /home/hillier/wnode04/cmf_testing_real8//unix
 
./unix/Makefile
./unix/date_time.f
./unix/dir_acc_pars_gen.f
	REAL(10) X										   |		REAL*8 X
	WORD_SIZE=16										   |		WORD_SIZE=8
./unix/dir_delimiter.f
./unix/f01btf.f
./unix/f04ayf.f
./unix/gen_asci_open.f
./unix/set_line_buffering.f
./unix/term_io.f
./unix/tst_mon.f
	REAL(10) R(ND)										   |		REAL*8 R(ND)
	REAL(10) CHI(ND)									   |		REAL*8 CHI(ND)
	REAL(10) QZR(NQ)									   |		REAL*8 QZR(NQ)
	REAL(10) NEW_CHI(NQ)									   |		REAL*8 NEW_CHI(NQ)
	REAL(10) DELR										   |		REAL*8 DELR
./unix/tst_sec.f
        REAL(10) T1										   |	        REAL*8 T1
./unix/tst_tune.f
	REAL(10) A(NMAX)									   |		REAL*8 A(NMAX)
	REAL(10) B(NMAX)									   |		REAL*8 B(NMAX)
	REAL(10) SUM										   |		REAL*8 SUM
./unix/tune.f
        REAL(10), SAVE :: T0,OVERHEAD								   |	        REAL*8, SAVE :: T0,OVERHEAD
        REAL(10), SAVE :: ST_CPU(MAX_IDS)							   |	        REAL*8, SAVE :: ST_CPU(MAX_IDS)
	REAL(10), SAVE :: CPUTOT(MAX_IDS)							   |		REAL*8, SAVE :: CPUTOT(MAX_IDS)
        REAL(10), SAVE :: WALLTOT(MAX_IDS)							   |	        REAL*8, SAVE :: WALLTOT(MAX_IDS)
	REAL(10), SAVE :: RR0									   |		REAL*8, SAVE :: RR0
./unix/tune_hp.f
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) BEFORE(MAX_IDS),AFTER(MAX_IDS),CPUTOT(MAX_IDS)					   |	        REAL*8 BEFORE(MAX_IDS),AFTER(MAX_IDS),CPUTOT(MAX_IDS)
        REAL(10) RUNTOT(MAX_IDS)								   |	        REAL*8 RUNTOT(MAX_IDS)
./unix/tune_intel.f
        REAL(10) OVERHEAD, StartTime, StopTime							   |	        REAL*8 OVERHEAD, StartTime, StopTime
        REAL(10) ST_CPU(MAX_IDS)								   |	        REAL*8 ST_CPU(MAX_IDS)
	REAL(10) CPUTOT(MAX_IDS)								   |		REAL*8 CPUTOT(MAX_IDS)
        REAL(10) WALLTOT(MAX_IDS)								   |	        REAL*8 WALLTOT(MAX_IDS)
	REAL(10) CLK_PERIOD,RR0									   |		REAL*8 CLK_PERIOD,RR0
./unix/tune_osf.f
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) ST_CPU(MAX_IDS)								   |	        REAL*8 ST_CPU(MAX_IDS)
	REAL(10) CPUTOT(MAX_IDS)								   |		REAL*8 CPUTOT(MAX_IDS)
        REAL(10) WALLTOT(MAX_IDS)								   |	        REAL*8 WALLTOT(MAX_IDS)
	REAL(10) CLK_PERIOD,RR0									   |		REAL*8 CLK_PERIOD,RR0
./unix/tune_osf_garb.f
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) ST_CPU(MAX_IDS)								   |	        REAL*8 ST_CPU(MAX_IDS)
	REAL(10) CPUTOT(MAX_IDS)								   |		REAL*8 CPUTOT(MAX_IDS)
        REAL(10) WALLTOT(MAX_IDS)								   |	        REAL*8 WALLTOT(MAX_IDS)
	REAL(10) CLK_PERIOD,RR0									   |		REAL*8 CLK_PERIOD,RR0
./unix/tune_osf_old.f
        REAL(10) T0,OVERHEAD									   |	        REAL*8 T0,OVERHEAD
        REAL(10) BEFORE(MAX_IDS),AFTER(MAX_IDS),CPUTOT(MAX_IDS)					   |	        REAL*8 BEFORE(MAX_IDS),AFTER(MAX_IDS),CPUTOT(MAX_IDS)
        REAL(10) RUNTOT(MAX_IDS)								   |	        REAL*8 RUNTOT(MAX_IDS)
./unix/verbose_info.f
./unix/wr_pwd.f
