	SUBROUTINE GET_LINE_ID_PG(TRANS_NAME,EW,LINE_CENTER,FWHM_KMS)
	USE LINE_ID_MOD
	CHARACTER(LEN=*) TRANS_NAME
	REAL*4 EW
	REAL*4 LINE_CENTER
	REAL*4 FWHM_KS
!
	INTEGER,PARAMETER :: NMATCH=5
	REAL*4 OFF_STORE(NMATCH)
	INTEGER PNT_STORE(NMATCH)
	INTEGER PNT
!
	INTEGER I,K
	REAL*4 T1
	REAL*4 SHIFT
	REAL*4 TAU_VAL
!
	IF(N_LINE_IDS .EQ. 0)THEN
	  TRANS_NAME=' '
	END IF
!
	OFF_STORE=1.0D+10
	PNT_STORE=0
	DO I=1,N_LINE_IDS-1
	  T1=2.998D+05*ABS(ID_WAVE(I)/LINE_CENTER-1.0D0)/FWHM_KMS
	  DO K=1,NMATCH
	    IF(T1 .LT. OFF_STORE(K))THEN
	      OFF_STORE(K+1:NMATCH)=OFF_STORE(K:NMATCH-1)
	      OFF_STORE(K)=T1
              PNT_STORE(K)=I
	      EXIT
	    END IF
	  END DO
	END DO
!
! Now decide on best line
!
	I=PNT_STORE(1)
	TRANS_NAME=FULL_LINE_ID(I)
	TAU_VAL=TAU(I)
	DO K=2,NMATCH
	  IF(OFF_STORE(K) .LT. 0.1)THEN
	    I=PNT_STORE(K)
	    IF(TAU(I) .GT. 3*TAU_VAL)THEN
	      TRANS_NAME=FULL_LINE_ID(I)
	      TAU_VAL=TAU(I)
	    END IF
	  END IF
	END DO
!
	RETURN
	END
